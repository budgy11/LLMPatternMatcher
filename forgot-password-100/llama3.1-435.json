{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how to create a \"Forgot Password\" function in PHP:\n\n**Database Schema:**\n\nWe'll assume you have a database table `users` with the following schema:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY,\n  email VARCHAR(255),\n  password_hash VARCHAR(255)\n);\n```\n**PHP Code:**\n```php\n// config.php (load configuration settings)\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Load the database connection\nrequire_once 'db.php';\n\n// Forgot password function\nfunction forgotPassword($email) {\n  // Check if email exists in the database\n  $stmt = $mysqli->prepare(\"SELECT * FROM users WHERE email = ?\");\n  $stmt->bind_param('s', $email);\n  $stmt->execute();\n  $result = $stmt->get_result();\n\n  if ($result->num_rows == 0) {\n    // Email not found in the database\n    return false;\n  }\n\n  // Generate a new password and store it as a temporary token\n  $new_password = bin2hex(random_bytes(16));\n  $token = md5(uniqid(mt_rand(), true));\n\n  // Update user's email with the new password token\n  $stmt = $mysqli->prepare(\"UPDATE users SET password_token = ? WHERE email = ?\");\n  $stmt->bind_param('ss', $token, $email);\n  $stmt->execute();\n\n  // Send an email to the user with the new password\n  sendEmail($email, $new_password);\n\n  return true;\n}\n\n// Function to send email with the new password\nfunction sendEmail($email, $password) {\n  // Your email sending library (e.g., PHPMailer)\n  $mail = new PHPMailer();\n  $mail->isSMTP();\n  $mail->Host = 'smtp.example.com';\n  $mail->Port = 587;\n  $mail->Username = 'your_email@example.com';\n  $mail->Password = 'your_password';\n\n  $body = \"Your new password is: $password\";\n  $mail->Body = $body;\n\n  // Send email to user\n  if (!$mail->send()) {\n    return false; // Email failed to send\n  }\n\n  return true;\n}\n```\n**Usage Example:**\n\nTo use the `forgotPassword` function, simply call it with the user's email address:\n```php\n$email = 'user@example.com';\nif (forgotPassword($email)) {\n  echo \"Email sent with new password\";\n} else {\n  echo \"Email not found in database or failed to send\";\n}\n```\nThis code generates a new random password for the specified email, stores it as a temporary token in the `users` table, and sends an email to the user with their new password.\n\nNote that you should replace the placeholders (`your_username`, `your_password`, etc.) with your actual database credentials. Additionally, this is a basic example and you may want to add additional security measures (e.g., validation, rate limiting) as needed.", "code_blocks": [null, "```php\n// config.php (load configuration settings)\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Load the database connection\nrequire_once 'db.php';\n\n// Forgot password function\nfunction forgotPassword($email) {\n  // Check if email exists in the database\n  $stmt = $mysqli->prepare(\"SELECT * FROM users WHERE email = ?\");\n  $stmt->bind_param('s', $email);\n  $stmt->execute();\n  $result = $stmt->get_result();\n\n  if ($result->num_rows == 0) {\n    // Email not found in the database\n    return false;\n  }\n\n  // Generate a new password and store it as a temporary token\n  $new_password = bin2hex(random_bytes(16));\n  $token = md5(uniqid(mt_rand(), true));\n\n  // Update user's email with the new password token\n  $stmt = $mysqli->prepare(\"UPDATE users SET password_token = ? WHERE email = ?\");\n  $stmt->bind_param('ss', $token, $email);\n  $stmt->execute();\n\n  // Send an email to the user with the new password\n  sendEmail($email, $new_password);\n\n  return true;\n}\n\n// Function to send email with the new password\nfunction sendEmail($email, $password) {\n  // Your email sending library (e.g., PHPMailer)\n  $mail = new PHPMailer();\n  $mail->isSMTP();\n  $mail->Host = 'smtp.example.com';\n  $mail->Port = 587;\n  $mail->Username = 'your_email@example.com';\n  $mail->Password = 'your_password';\n\n  $body = \"Your new password is: $password\";\n  $mail->Body = $body;\n\n  // Send email to user\n  if (!$mail->send()) {\n    return false; // Email failed to send\n  }\n\n  return true;\n}\n```", "```php\n$email = 'user@example.com';\nif (forgotPassword($email)) {\n  echo \"Email sent with new password\";\n} else {\n  echo \"Email not found in database or failed to send\";\n}\n```"]}
