{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nThis example demonstrates a simple \"forgot password\" function using PHP. The user will enter their email address, and if the account exists, an email with a password reset link will be sent to the user.\n\n**Database Setup**\n\nFirst, you need to create a database table for users. In this example, we'll use MySQL:\n\n```sql\nCREATE TABLE users (\n  id INT AUTO_INCREMENT,\n  email VARCHAR(255) NOT NULL UNIQUE,\n  password VARCHAR(255) NOT NULL,\n  PRIMARY KEY (id)\n);\n```\n\n**PHP Code**\n\n```php\n<?php\n\n// Configuration\n$host = 'localhost';\n$dbName = 'database_name';\n$user = 'database_user';\n$password = 'database_password';\n\n// Connect to database\n$conn = new mysqli($host, $user, $password, $dbName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send password reset email\nfunction sendPasswordResetEmail($email, $token) {\n    // Send email using your preferred method (e.g. SMTP)\n    $to = $email;\n    $subject = 'Password Reset';\n    $body = 'Click here to reset your password: <a href=\"' . $token . '\">Reset Password</a>';\n    mail($to, $subject, $body);\n}\n\n// Function to check if user exists\nfunction checkUserExists($email) {\n    global $conn;\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($query);\n    return $result->num_rows > 0;\n}\n\n// Forgot password function\nif (isset($_POST['forgot_password'])) {\n    // Get user input\n    $email = $_POST['email'];\n    \n    // Check if user exists\n    if (checkUserExists($email)) {\n        // Generate token for password reset\n        $token = bin2hex(random_bytes(32));\n        \n        // Update user data with new token\n        $query = \"UPDATE users SET token = '$token' WHERE email = '$email'\";\n        $conn->query($query);\n        \n        // Send password reset email\n        sendPasswordResetEmail($email, 'http://yourdomain.com/reset-password.php?token=' . $token);\n    } else {\n        echo 'User not found.';\n    }\n}\n\n?>\n```\n\n**HTML Form**\n\nCreate a form to collect the user's email address:\n\n```html\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" name=\"forgot_password\" value=\"Reset Password\">\n</form>\n```\n\n**Password Reset Link**\n\nCreate a new PHP file (`reset-password.php`) to handle the password reset:\n\n```php\n<?php\n\n// Configuration\n$host = 'localhost';\n$dbName = 'database_name';\n$user = 'database_user';\n$password = 'database_password';\n\n// Connect to database\n$conn = new mysqli($host, $user, $password, $dbName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get token from URL\n$token = $_GET['token'];\n\n// Update user password\n$query = \"UPDATE users SET password = 'new_password' WHERE token = '$token'\";\n$conn->query($query);\n\necho 'Password updated successfully.';\n\n?>\n```\n\nThis is a basic example to get you started with implementing a forgot password function in PHP. You should adapt it to your specific use case and security requirements. Always remember to hash passwords before storing them in the database.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$host = 'localhost';\n$dbName = 'database_name';\n$user = 'database_user';\n$password = 'database_password';\n\n// Connect to database\n$conn = new mysqli($host, $user, $password, $dbName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send password reset email\nfunction sendPasswordResetEmail($email, $token) {\n    // Send email using your preferred method (e.g. SMTP)\n    $to = $email;\n    $subject = 'Password Reset';\n    $body = 'Click here to reset your password: <a href=\"' . $token . '\">Reset Password</a>';\n    mail($to, $subject, $body);\n}\n\n// Function to check if user exists\nfunction checkUserExists($email) {\n    global $conn;\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($query);\n    return $result->num_rows > 0;\n}\n\n// Forgot password function\nif (isset($_POST['forgot_password'])) {\n    // Get user input\n    $email = $_POST['email'];\n    \n    // Check if user exists\n    if (checkUserExists($email)) {\n        // Generate token for password reset\n        $token = bin2hex(random_bytes(32));\n        \n        // Update user data with new token\n        $query = \"UPDATE users SET token = '$token' WHERE email = '$email'\";\n        $conn->query($query);\n        \n        // Send password reset email\n        sendPasswordResetEmail($email, 'http://yourdomain.com/reset-password.php?token=' . $token);\n    } else {\n        echo 'User not found.';\n    }\n}\n\n?>\n```", null, "```php\n<?php\n\n// Configuration\n$host = 'localhost';\n$dbName = 'database_name';\n$user = 'database_user';\n$password = 'database_password';\n\n// Connect to database\n$conn = new mysqli($host, $user, $password, $dbName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get token from URL\n$token = $_GET['token'];\n\n// Update user password\n$query = \"UPDATE users SET password = 'new_password' WHERE token = '$token'\";\n$conn->query($query);\n\necho 'Password updated successfully.';\n\n?>\n```"]}
