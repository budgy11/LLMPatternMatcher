{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a \"Forgot Password\" functionality in PHP:\n\n**forgot_password.php**\n```php\n<?php\n// Configuration\n$database_host = 'localhost';\n$database_username = 'username';\n$database_password = 'password';\n$database_name = 'database';\n\n// Connect to database\n$conn = new mysqli($database_host, $database_username, $database_password, $database_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get email from form submission\n$email = $_POST['email'];\n\n// Check if email is valid\nif (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n    echo 'Invalid email address';\n    exit;\n}\n\n// Query to retrieve user ID and password reset token\n$stmt = $conn->prepare(\"SELECT id, password_reset_token FROM users WHERE email = ?\");\n$stmt->bind_param('s', $email);\n$stmt->execute();\n$result = $stmt->get_result();\n\nif ($result->num_rows > 0) {\n    // User exists, retrieve data\n    while ($row = $result->fetch_assoc()) {\n        $userId = $row['id'];\n        $passwordResetToken = $row['password_reset_token'];\n\n        // Generate a random password and update the database with new password\n        $newPassword = substr(str_shuffle('0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'), 0, 10);\n        $stmt = $conn->prepare(\"UPDATE users SET password = ?, password_reset_token = ? WHERE id = ?\");\n        $stmt->bind_param('sss', $newPassword, $passwordResetToken, $userId);\n        $stmt->execute();\n\n        // Send email with new password and password reset link\n        sendEmail($email, $newPassword);\n\n        echo 'New password sent to your email';\n    }\n} else {\n    echo 'User not found';\n}\n\n// Close database connection\n$conn->close();\n?>\n\n<!-- Form to enter email for forgot password -->\n<form action=\"\" method=\"post\">\n  <input type=\"text\" name=\"email\" placeholder=\"Enter your email address\">\n  <button type=\"submit\">Send new password</button>\n</form>\n```\n\n**send_email.php**\n```php\n<?php\n\n// Configuration (use a mail server or library like PHPMailer)\n$fromEmail = 'your-email@example.com';\n$fromName = 'Your Name';\n\n// Email content\n$message = '\nDear '. $name .',\n\nYour new password is: ' . $newPassword . '\n\nTo log in to your account, use the following link:\n<a href=\"' . $passwordResetLink . '\">Click here</a>\n\nBest regards,\n' . $fromName;\n\n// Send email using mail() function\n$headers = \"From: \" . $fromEmail;\n$headers .= \"Content-Type: text/html; charset=UTF-8\";\nmail($to, 'New Password', $message, $headers);\n\n?>\n```\n\nThis example includes two PHP files:\n\n1. **forgot_password.php**: Handles the form submission and sends a new password to the user's email.\n2. **send_email.php**: Sends an email with the new password and password reset link.\n\nNote that this is a basic implementation and you should consider security measures such as:\n\n* Using a secure connection (HTTPS) for the password reset link\n* Validating and sanitizing user input data\n* Hashing passwords instead of storing plain text\n* Implementing rate limiting for password reset attempts\n\nAlso, make sure to adapt the code to your specific database schema and email configuration.", "code_blocks": ["```php\n<?php\n// Configuration\n$database_host = 'localhost';\n$database_username = 'username';\n$database_password = 'password';\n$database_name = 'database';\n\n// Connect to database\n$conn = new mysqli($database_host, $database_username, $database_password, $database_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get email from form submission\n$email = $_POST['email'];\n\n// Check if email is valid\nif (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n    echo 'Invalid email address';\n    exit;\n}\n\n// Query to retrieve user ID and password reset token\n$stmt = $conn->prepare(\"SELECT id, password_reset_token FROM users WHERE email = ?\");\n$stmt->bind_param('s', $email);\n$stmt->execute();\n$result = $stmt->get_result();\n\nif ($result->num_rows > 0) {\n    // User exists, retrieve data\n    while ($row = $result->fetch_assoc()) {\n        $userId = $row['id'];\n        $passwordResetToken = $row['password_reset_token'];\n\n        // Generate a random password and update the database with new password\n        $newPassword = substr(str_shuffle('0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'), 0, 10);\n        $stmt = $conn->prepare(\"UPDATE users SET password = ?, password_reset_token = ? WHERE id = ?\");\n        $stmt->bind_param('sss', $newPassword, $passwordResetToken, $userId);\n        $stmt->execute();\n\n        // Send email with new password and password reset link\n        sendEmail($email, $newPassword);\n\n        echo 'New password sent to your email';\n    }\n} else {\n    echo 'User not found';\n}\n\n// Close database connection\n$conn->close();\n?>\n\n<!-- Form to enter email for forgot password -->\n<form action=\"\" method=\"post\">\n  <input type=\"text\" name=\"email\" placeholder=\"Enter your email address\">\n  <button type=\"submit\">Send new password</button>\n</form>\n```", "```php\n<?php\n\n// Configuration (use a mail server or library like PHPMailer)\n$fromEmail = 'your-email@example.com';\n$fromName = 'Your Name';\n\n// Email content\n$message = '\nDear '. $name .',\n\nYour new password is: ' . $newPassword . '\n\nTo log in to your account, use the following link:\n<a href=\"' . $passwordResetLink . '\">Click here</a>\n\nBest regards,\n' . $fromName;\n\n// Send email using mail() function\n$headers = \"From: \" . $fromEmail;\n$headers .= \"Content-Type: text/html; charset=UTF-8\";\nmail($to, 'New Password', $message, $headers);\n\n?>\n```"]}
