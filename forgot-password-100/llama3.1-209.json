{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nThis is an example of a simple forgot password function using PHP. It assumes you have already set up a user table with the necessary columns (e.g., `email`, `password`, etc.).\n\n**Database Schema**\n\nFor this example, let's assume we have a `users` table with the following structure:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY,\n  email VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\n```\n**PHP Code**\n\nCreate a new PHP file (e.g., `forgot_password.php`) and add the following code:\n```php\n<?php\n\n// Configuration\nrequire_once 'config.php';\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Get email from form input\n  $email = $_POST['email'];\n\n  // Validate email address\n  if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n    echo \"Invalid email address\";\n    exit;\n  }\n\n  // Check if user exists in database\n  $sql = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $sql);\n\n  if (mysqli_num_rows($result) == 1) {\n    // User exists, generate new password and send reset link\n    $user_data = mysqli_fetch_assoc($result);\n    $new_password = substr(md5(uniqid(mt_rand(), true)), 0, 8);\n    $update_sql = \"UPDATE users SET password = '$new_password' WHERE email = '$email'\";\n    mysqli_query($conn, $update_sql);\n\n    // Send reset link to user via email\n    $subject = 'Reset Password';\n    $message = '\n      <p>Hello ' . $user_data['name'] . ',</p>\n      <p>Your new password is: <strong>' . $new_password . '</strong></p>\n      <p>Click this link to reset your password: <a href=\"' . $_SERVER['PHP_SELF'] . '?email=' . $email . '\">Reset Password</a></p>\n    ';\n    mail($user_data['email'], $subject, $message);\n\n    echo \"New password has been sent to your email\";\n  } else {\n    echo \"User not found\";\n  }\n} else {\n  // Display forgot password form\n  ?>\n  <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" value=\"Submit\">\n  </form>\n  <?php\n}\n?>\n```\n**How it Works**\n\n1. The script checks if the form has been submitted.\n2. It validates the email address and checks if a user exists in the database with that email address.\n3. If the user exists, a new password is generated using `md5` and `uniqid`.\n4. The script updates the user's password in the database.\n5. A reset link is sent to the user via email.\n\n**Security Notes**\n\n* This example uses `mysqli_query` for simplicity. In production environments, consider using prepared statements or a more secure library like PDO.\n* Make sure to configure your server's PHP settings and mail configuration correctly.\n* Consider implementing additional security measures, such as password hashing with bcrypt or PBKDF2.\n\n**Example Use Case**\n\n1. User visits the forgot password page (`forgot_password.php`).\n2. User enters their email address in the form.\n3. The script checks if the user exists in the database and sends a reset link to their email address.\n\nRemember to modify this example according to your specific requirements and security needs.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\nrequire_once 'config.php';\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Get email from form input\n  $email = $_POST['email'];\n\n  // Validate email address\n  if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n    echo \"Invalid email address\";\n    exit;\n  }\n\n  // Check if user exists in database\n  $sql = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $sql);\n\n  if (mysqli_num_rows($result) == 1) {\n    // User exists, generate new password and send reset link\n    $user_data = mysqli_fetch_assoc($result);\n    $new_password = substr(md5(uniqid(mt_rand(), true)), 0, 8);\n    $update_sql = \"UPDATE users SET password = '$new_password' WHERE email = '$email'\";\n    mysqli_query($conn, $update_sql);\n\n    // Send reset link to user via email\n    $subject = 'Reset Password';\n    $message = '\n      <p>Hello ' . $user_data['name'] . ',</p>\n      <p>Your new password is: <strong>' . $new_password . '</strong></p>\n      <p>Click this link to reset your password: <a href=\"' . $_SERVER['PHP_SELF'] . '?email=' . $email . '\">Reset Password</a></p>\n    ';\n    mail($user_data['email'], $subject, $message);\n\n    echo \"New password has been sent to your email\";\n  } else {\n    echo \"User not found\";\n  }\n} else {\n  // Display forgot password form\n  ?>\n  <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" value=\"Submit\">\n  </form>\n  <?php\n}\n?>\n```"]}
