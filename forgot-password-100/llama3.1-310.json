{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nThis example demonstrates a basic forgot password functionality using PHP. It sends an email to the user with a reset link that redirects them to a new page where they can enter their new password.\n\n**Database Structure**\n------------------------\n\nWe assume you have a `users` table with the following columns:\n\n| Column Name | Data Type |\n| --- | --- |\n| id | int (primary key) |\n| email | varchar(255) |\n| password | varchar(255) |\n\n**PHP Code**\n-------------\n\n```php\n<?php\n\n// Include configuration file\nrequire_once 'config.php';\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Sanitize input data\n    $email = filter_var($_POST['email'], FILTER_SANITIZE_EMAIL);\n\n    // Query database to retrieve user ID and password reset token\n    $query = \"SELECT id, password_reset_token FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) > 0) {\n        $row = mysqli_fetch_assoc($result);\n\n        // Generate new password reset link\n        $passwordResetLink = \"http://example.com/reset-password?token=\" . $row['password_reset_token'] . \"&email=$email\";\n\n        // Send email with password reset link\n        sendEmail($email, 'Reset Password', $passwordResetLink);\n    } else {\n        echo \"Invalid email or account not found.\";\n    }\n}\n\n// Function to send email using PHPMailer (or your preferred library)\nfunction sendEmail($toEmail, $subject, $message) {\n    require_once 'PHPMailer/PHPMailerAutoload.php';\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->CharSet = 'UTF-8';\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->Username = 'your_email@example.com';\n    $mail->Password = 'your_password';\n    $mail->setFrom('your_email@example.com', 'Your Name');\n    $mail->addAddress($toEmail);\n    $mail->Subject = $subject;\n    $mail->Body = $message;\n    if (!$mail->send()) {\n        echo \"Error sending email: \" . $mail->ErrorInfo;\n    }\n}\n\n// Include HTML form\ninclude_once 'forgot-password-form.php';\n\n?>\n```\n\n**HTML Form**\n-------------\n\nCreate a new file named `forgot-password-form.php` with the following code:\n\n```php\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Forgot Password</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\" required>\n    <button type=\"submit\">Reset Password</button>\n</form>\n\n<?php\n// Display error message if form submission was unsuccessful\nif (isset($_GET['error'])) {\n    echo '<p style=\"color: red;\">' . $_GET['error'] . '</p>';\n}\n?>\n\n</body>\n</html>\n```\n\n**Security Notes**\n\n* Make sure to configure your PHP and email library settings securely.\n* Use a secure method for generating the password reset token, such as `uniqid()` or a cryptographically secure random number generator.\n* Store the password reset token in a secure manner, such as using a dedicated database table with encrypted columns.\n\nThis is a basic example of how to create a forgot password functionality using PHP. You should adapt it to your specific use case and security requirements.", "code_blocks": ["```php\n<?php\n\n// Include configuration file\nrequire_once 'config.php';\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Sanitize input data\n    $email = filter_var($_POST['email'], FILTER_SANITIZE_EMAIL);\n\n    // Query database to retrieve user ID and password reset token\n    $query = \"SELECT id, password_reset_token FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) > 0) {\n        $row = mysqli_fetch_assoc($result);\n\n        // Generate new password reset link\n        $passwordResetLink = \"http://example.com/reset-password?token=\" . $row['password_reset_token'] . \"&email=$email\";\n\n        // Send email with password reset link\n        sendEmail($email, 'Reset Password', $passwordResetLink);\n    } else {\n        echo \"Invalid email or account not found.\";\n    }\n}\n\n// Function to send email using PHPMailer (or your preferred library)\nfunction sendEmail($toEmail, $subject, $message) {\n    require_once 'PHPMailer/PHPMailerAutoload.php';\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->CharSet = 'UTF-8';\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->Username = 'your_email@example.com';\n    $mail->Password = 'your_password';\n    $mail->setFrom('your_email@example.com', 'Your Name');\n    $mail->addAddress($toEmail);\n    $mail->Subject = $subject;\n    $mail->Body = $message;\n    if (!$mail->send()) {\n        echo \"Error sending email: \" . $mail->ErrorInfo;\n    }\n}\n\n// Include HTML form\ninclude_once 'forgot-password-form.php';\n\n?>\n```", "```php\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Forgot Password</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\" required>\n    <button type=\"submit\">Reset Password</button>\n</form>\n\n<?php\n// Display error message if form submission was unsuccessful\nif (isset($_GET['error'])) {\n    echo '<p style=\"color: red;\">' . $_GET['error'] . '</p>';\n}\n?>\n\n</body>\n</html>\n```"]}
