{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can create a \"Forgot Password\" function in PHP:\n\n**Database Schema**\n\nFor this example, let's assume we have the following table `users` with columns `id`, `email`, `password`, and `reset_token`.\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY,\n  email VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL,\n  reset_token VARCHAR(255),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n\n**PHP Code**\n\nWe'll use the following PHP code to create a \"Forgot Password\" function. This example uses a simple password hashing system (MD5) for demonstration purposes, but you should consider using more secure methods like bcrypt or PBKDF2.\n```php\n<?php\n\n// Configuration settings\ndefine('DB_HOST', 'your_database_host');\ndefine('DB_USER', 'your_database_username');\ndefine('DB_PASSWORD', 'your_database_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Function to connect to database\nfunction dbConnect() {\n  $conn = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n  if (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n  }\n  return $conn;\n}\n\n// Function to reset password (Forgot Password)\nfunction forgotPassword($email) {\n  // Connect to database\n  $conn = dbConnect();\n\n  // Generate a random token for resetting password\n  $resetToken = bin2hex(random_bytes(32));\n\n  // Check if email exists in the database\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $query);\n  if (mysqli_num_rows($result) > 0) {\n    // Update reset token for this user\n    $updateQuery = \"UPDATE users SET reset_token = '$resetToken' WHERE email = '$email'\";\n    mysqli_query($conn, $updateQuery);\n\n    // Send an email to the user with a link to reset password\n    sendEmail($email, $resetToken);\n  } else {\n    echo \"Email not found\";\n  }\n\n  // Close database connection\n  mysqli_close($conn);\n}\n\n// Function to send email (Forgot Password)\nfunction sendEmail($email, $resetToken) {\n  // Email configuration settings\n  define('EMAIL_SUBJECT', 'Reset Your Password');\n  define('EMAIL_BODY', 'Click this link to reset your password: <a href=\"http://your-website.com/reset-password?token=' . $resetToken . '\">Reset Password</a>');\n  define('FROM_EMAIL', 'your-email@gmail.com');\n\n  // Create email headers\n  $headers = \"MIME-Version: 1.0\\r\\n\";\n  $headers .= \"Content-Type: text/html; charset=UTF-8\\r\\n\";\n  $headers .= \"From: \" . FROM_EMAIL;\n\n  // Send email using PHP's mail() function\n  if (mail($email, EMAIL_SUBJECT, EMAIL_BODY, $headers)) {\n    echo \"Email sent successfully!\";\n  } else {\n    echo \"Failed to send email\";\n  }\n}\n\n?>\n```\n\n**HTML Form**\n\nYou can use the following HTML form to call the `forgotPassword()` function when submitted.\n```html\n<form action=\"forgot-password.php\" method=\"post\">\n  <input type=\"email\" name=\"email\" placeholder=\"Enter your email\">\n  <button type=\"submit\">Send Reset Link</button>\n</form>\n```\n\nThis code generates a random token for resetting the password and sends an email to the user with a link to reset their password. Make sure to replace placeholders (e.g., database credentials, email settings) with actual values.\n\nRemember that this example is simplified and should not be used in production without proper security measures and hashing mechanisms.", "code_blocks": [null, "```php\n<?php\n\n// Configuration settings\ndefine('DB_HOST', 'your_database_host');\ndefine('DB_USER', 'your_database_username');\ndefine('DB_PASSWORD', 'your_database_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Function to connect to database\nfunction dbConnect() {\n  $conn = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n  if (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n  }\n  return $conn;\n}\n\n// Function to reset password (Forgot Password)\nfunction forgotPassword($email) {\n  // Connect to database\n  $conn = dbConnect();\n\n  // Generate a random token for resetting password\n  $resetToken = bin2hex(random_bytes(32));\n\n  // Check if email exists in the database\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $query);\n  if (mysqli_num_rows($result) > 0) {\n    // Update reset token for this user\n    $updateQuery = \"UPDATE users SET reset_token = '$resetToken' WHERE email = '$email'\";\n    mysqli_query($conn, $updateQuery);\n\n    // Send an email to the user with a link to reset password\n    sendEmail($email, $resetToken);\n  } else {\n    echo \"Email not found\";\n  }\n\n  // Close database connection\n  mysqli_close($conn);\n}\n\n// Function to send email (Forgot Password)\nfunction sendEmail($email, $resetToken) {\n  // Email configuration settings\n  define('EMAIL_SUBJECT', 'Reset Your Password');\n  define('EMAIL_BODY', 'Click this link to reset your password: <a href=\"http://your-website.com/reset-password?token=' . $resetToken . '\">Reset Password</a>');\n  define('FROM_EMAIL', 'your-email@gmail.com');\n\n  // Create email headers\n  $headers = \"MIME-Version: 1.0\\r\\n\";\n  $headers .= \"Content-Type: text/html; charset=UTF-8\\r\\n\";\n  $headers .= \"From: \" . FROM_EMAIL;\n\n  // Send email using PHP's mail() function\n  if (mail($email, EMAIL_SUBJECT, EMAIL_BODY, $headers)) {\n    echo \"Email sent successfully!\";\n  } else {\n    echo \"Failed to send email\";\n  }\n}\n\n?>\n```", null]}
