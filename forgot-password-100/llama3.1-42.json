{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how you can create a \"Forgot Password\" function in PHP:\n\n**Step 1: Create a table to store user credentials**\n\nFirst, we need to create a table in our database to store user credentials. Let's call it `users`.\n```sql\nCREATE TABLE users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    email VARCHAR(255) UNIQUE NOT NULL,\n    password VARCHAR(255) NOT NULL\n);\n```\n**Step 2: Create a PHP script to handle the forgot password function**\n\nCreate a new PHP file, for example `forgot_password.php`.\n```php\n<?php\n\n// Configuration settings\n$db_host = 'localhost';\n$db_username = 'your_database_username';\n$db_password = 'your_database_password';\n$db_name = 'your_database_name';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\nif (!$conn) {\n    die('Could not connect: ' . mysqli_error());\n}\n\n// Define function to send password reset email\nfunction send_password_reset_email($email, $token) {\n    // Replace with your own email service (e.g. Mailgun, Sendgrid)\n    $subject = 'Password Reset';\n    $body = \"Click this link to reset your password: <a href='http://example.com/reset-password?token=$token'>Reset Password</a>\";\n    mail($email, $subject, $body);\n}\n\n// Handle forgot password form submission\nif (isset($_POST['forgot_password'])) {\n    // Get email from form input\n    $email = $_POST['email'];\n\n    // Query database to get user credentials\n    $query = \"SELECT * FROM users WHERE email='$email'\";\n    $result = mysqli_query($conn, $query);\n\n    if ($result && mysqli_num_rows($result) > 0) {\n        // Get user data from query result\n        $user_data = mysqli_fetch_assoc($result);\n        $token = bin2hex(random_bytes(32));\n\n        // Update password reset token in database\n        $query = \"UPDATE users SET password_reset_token='$token' WHERE email='$email'\";\n        mysqli_query($conn, $query);\n\n        // Send password reset email\n        send_password_reset_email($user_data['email'], $token);\n    } else {\n        echo 'Invalid email or password';\n    }\n}\n\n// Close database connection\nmysqli_close($conn);\n\n?>\n```\n**Step 3: Create a form to collect user's email**\n\nCreate an HTML form that collects the user's email address. For example:\n```html\n<form action=\"forgot_password.php\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" value=\"Send Password Reset Email\" name=\"forgot_password\">\n</form>\n```\n**How it works**\n\n1. The user submits the form with their email address.\n2. The PHP script checks if an account exists with the provided email address by querying the database.\n3. If the email is valid, a password reset token is generated and stored in the `users` table alongside the user's email address.\n4. A password reset email is sent to the user with a link that includes the password reset token.\n5. The user can then click on this link to access a page where they can enter their new password.\n\nNote: This is a basic example and you should consider adding security measures such as:\n\n* Password hashing using a library like bcrypt\n* Validating form input data to prevent SQL injection attacks\n* Using HTTPS to encrypt communication between the client and server", "code_blocks": [null, "```php\n<?php\n\n// Configuration settings\n$db_host = 'localhost';\n$db_username = 'your_database_username';\n$db_password = 'your_database_password';\n$db_name = 'your_database_name';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\nif (!$conn) {\n    die('Could not connect: ' . mysqli_error());\n}\n\n// Define function to send password reset email\nfunction send_password_reset_email($email, $token) {\n    // Replace with your own email service (e.g. Mailgun, Sendgrid)\n    $subject = 'Password Reset';\n    $body = \"Click this link to reset your password: <a href='http://example.com/reset-password?token=$token'>Reset Password</a>\";\n    mail($email, $subject, $body);\n}\n\n// Handle forgot password form submission\nif (isset($_POST['forgot_password'])) {\n    // Get email from form input\n    $email = $_POST['email'];\n\n    // Query database to get user credentials\n    $query = \"SELECT * FROM users WHERE email='$email'\";\n    $result = mysqli_query($conn, $query);\n\n    if ($result && mysqli_num_rows($result) > 0) {\n        // Get user data from query result\n        $user_data = mysqli_fetch_assoc($result);\n        $token = bin2hex(random_bytes(32));\n\n        // Update password reset token in database\n        $query = \"UPDATE users SET password_reset_token='$token' WHERE email='$email'\";\n        mysqli_query($conn, $query);\n\n        // Send password reset email\n        send_password_reset_email($user_data['email'], $token);\n    } else {\n        echo 'Invalid email or password';\n    }\n}\n\n// Close database connection\nmysqli_close($conn);\n\n?>\n```", null]}
