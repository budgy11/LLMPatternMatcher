{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how to create a \"Forgot Password\" function using PHP:\n\n**Password Reset Process:**\n\n1. User clicks on the \"Forgot Password\" link.\n2. The user enters their email address associated with their account.\n3. An email is sent to the user's email address containing a password reset link.\n4. The user clicks on the password reset link, which takes them to a page where they can enter a new password.\n\n**PHP Code:**\n```php\n// config.php (store database credentials and other settings)\n<?php\n\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'username');\ndefine('DB_PASSWORD', 'password');\ndefine('DB_NAME', 'database_name');\n\n?>\n```\n\n```php\n// forgot_password.php\n<?php\n\nrequire_once 'config.php';\n\n// If the user has clicked on the \"Forgot Password\" link, this script will run.\nif (isset($_POST['email'])) {\n  // Get the email address from the form submission.\n  $email = $_POST['email'];\n\n  // Check if the email address is associated with an account in the database.\n  $sql = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $sql);\n\n  if (mysqli_num_rows($result) > 0) {\n    // If the email address is found, generate a password reset token and send an email to the user.\n    $token = bin2hex(random_bytes(32));\n    $sql = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n    mysqli_query($conn, $sql);\n\n    // Send an email to the user with a link to reset their password.\n    $to = $email;\n    $subject = 'Reset Your Password';\n    $message = \"\n      <html>\n        <body>\n          <p>Click on this link to reset your password:</p>\n          <a href='reset_password.php?token=$token'>Reset Password</a>\n        </body>\n      </html>\n    \";\n\n    // Send the email using PHP's mail function or a library like SwiftMailer.\n    $headers = 'From: example@example.com' . \"\\r\\n\" .\n      'Content-type: text/html; charset=UTF-8' . \"\\r\\n\";\n    mail($to, $subject, $message, $headers);\n\n    // Display a success message to the user.\n    echo 'A password reset link has been sent to your email address.';\n  } else {\n    // If the email address is not found in the database, display an error message.\n    echo 'Email address not found. Please try again.';\n  }\n}\n\n?>\n```\n\n```php\n// reset_password.php\n<?php\n\nrequire_once 'config.php';\n\n// Get the password reset token from the URL parameter.\n$token = $_GET['token'];\n\n// Check if the password reset token is valid and associated with an account in the database.\n$sql = \"SELECT * FROM users WHERE password_reset_token = '$token'\";\n$result = mysqli_query($conn, $sql);\n\nif (mysqli_num_rows($result) > 0) {\n  // If the token is valid, display a form for the user to enter their new password.\n  echo '<h1>Reset Your Password</h1>';\n  echo '\n    <form action=\"reset_password.php\" method=\"post\">\n      <label for=\"password\">New Password:</label>\n      <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n      <label for=\"confirm_password\">Confirm New Password:</label>\n      <input type=\"password\" id=\"confirm_password\" name=\"confirm_password\"><br><br>\n      <input type=\"submit\" value=\"Reset Password\">\n    </form>\n  ';\n\n  // If the form is submitted, update the user's password in the database.\n  if (isset($_POST['password'])) {\n    $newPassword = $_POST['password'];\n    $sql = \"UPDATE users SET password = '$newPassword', password_reset_token = '' WHERE email = '$email'\";\n    mysqli_query($conn, $sql);\n\n    // Display a success message to the user.\n    echo 'Your password has been successfully reset.';\n  }\n} else {\n  // If the token is not valid or associated with an account in the database, display an error message.\n  echo 'Invalid password reset link. Please try again.';\n}\n\n?>\n```\n\n**Security Notes:**\n\n* Store the password reset token securely and make sure it's associated with a specific user account.\n* Use HTTPS to encrypt communication between the client and server when sending the password reset email.\n* Make sure to validate user input and prevent SQL injection attacks.\n\nThis code provides a basic example of how to create a \"Forgot Password\" function using PHP. However, please note that this is just an example and you should adapt it to your specific use case and requirements.", "code_blocks": ["```php\n// config.php (store database credentials and other settings)\n<?php\n\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'username');\ndefine('DB_PASSWORD', 'password');\ndefine('DB_NAME', 'database_name');\n\n?>\n```", "```php\n// forgot_password.php\n<?php\n\nrequire_once 'config.php';\n\n// If the user has clicked on the \"Forgot Password\" link, this script will run.\nif (isset($_POST['email'])) {\n  // Get the email address from the form submission.\n  $email = $_POST['email'];\n\n  // Check if the email address is associated with an account in the database.\n  $sql = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $sql);\n\n  if (mysqli_num_rows($result) > 0) {\n    // If the email address is found, generate a password reset token and send an email to the user.\n    $token = bin2hex(random_bytes(32));\n    $sql = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n    mysqli_query($conn, $sql);\n\n    // Send an email to the user with a link to reset their password.\n    $to = $email;\n    $subject = 'Reset Your Password';\n    $message = \"\n      <html>\n        <body>\n          <p>Click on this link to reset your password:</p>\n          <a href='reset_password.php?token=$token'>Reset Password</a>\n        </body>\n      </html>\n    \";\n\n    // Send the email using PHP's mail function or a library like SwiftMailer.\n    $headers = 'From: example@example.com' . \"\\r\\n\" .\n      'Content-type: text/html; charset=UTF-8' . \"\\r\\n\";\n    mail($to, $subject, $message, $headers);\n\n    // Display a success message to the user.\n    echo 'A password reset link has been sent to your email address.';\n  } else {\n    // If the email address is not found in the database, display an error message.\n    echo 'Email address not found. Please try again.';\n  }\n}\n\n?>\n```", "```php\n// reset_password.php\n<?php\n\nrequire_once 'config.php';\n\n// Get the password reset token from the URL parameter.\n$token = $_GET['token'];\n\n// Check if the password reset token is valid and associated with an account in the database.\n$sql = \"SELECT * FROM users WHERE password_reset_token = '$token'\";\n$result = mysqli_query($conn, $sql);\n\nif (mysqli_num_rows($result) > 0) {\n  // If the token is valid, display a form for the user to enter their new password.\n  echo '<h1>Reset Your Password</h1>';\n  echo '\n    <form action=\"reset_password.php\" method=\"post\">\n      <label for=\"password\">New Password:</label>\n      <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n      <label for=\"confirm_password\">Confirm New Password:</label>\n      <input type=\"password\" id=\"confirm_password\" name=\"confirm_password\"><br><br>\n      <input type=\"submit\" value=\"Reset Password\">\n    </form>\n  ';\n\n  // If the form is submitted, update the user's password in the database.\n  if (isset($_POST['password'])) {\n    $newPassword = $_POST['password'];\n    $sql = \"UPDATE users SET password = '$newPassword', password_reset_token = '' WHERE email = '$email'\";\n    mysqli_query($conn, $sql);\n\n    // Display a success message to the user.\n    echo 'Your password has been successfully reset.';\n  }\n} else {\n  // If the token is not valid or associated with an account in the database, display an error message.\n  echo 'Invalid password reset link. Please try again.';\n}\n\n?>\n```"]}
