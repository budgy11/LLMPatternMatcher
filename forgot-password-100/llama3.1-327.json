{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a \"forgot password\" function in PHP that sends a password reset link to the user's email:\n\n**Note:** This example assumes you have a database table named `users` with columns `email`, `username`, and `password`.\n\n**Database Schema:**\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  email VARCHAR(255) NOT NULL,\n  username VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\n```\n\n**PHP Code (forgot_password.php):**\n```php\n<?php\n\n// Configuration variables\ndefine('BASE_URL', 'http://example.com');\ndefine('EMAIL_SUBJECT', 'Reset your password');\ndefine('EMAIL_BODY', 'Click the link below to reset your password.');\n\n// Email configuration\n$emailConfig = array(\n    'host' => 'smtp.example.com',\n    'username' => 'your_email@example.com',\n    'password' => 'your_password',\n);\n\n// Function to send email using PHPMailer\nfunction sendEmail($email, $subject, $body) {\n  require_once 'PHPMailer/PHPMailerAutoload.php';\n  $mail = new PHPMailer();\n  $mail->isSMTP();\n  $mail->Host = $emailConfig['host'];\n  $mail->Username = $emailConfig['username'];\n  $mail->Password = $emailConfig['password'];\n  $mail->Port = 587;\n  $mail->IsHTML(true);\n  $mail->setFrom($emailConfig['username'], 'Your Name');\n  $mail->addAddress($email, '');\n  $mail->Subject = $subject;\n  $mail->Body = $body;\n  return $mail->send();\n}\n\n// Handle forgot password request\nif (isset($_POST['forgot_password'])) {\n  // Get user input\n  $email = $_POST['email'];\n\n  // Validate email\n  if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n    echo 'Invalid email address.';\n    exit;\n  }\n\n  // Query database for user\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $query);\n  if ($row = mysqli_fetch_assoc($result)) {\n    // Generate random token\n    $token = bin2hex(random_bytes(32));\n\n    // Update password reset token in database\n    $updateQuery = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n    mysqli_query($conn, $updateQuery);\n\n    // Send email with password reset link\n    $link = BASE_URL . '/reset_password.php?token=' . $token;\n    sendEmail($email, EMAIL_SUBJECT, sprintf(EMAIL_BODY, $link));\n    echo 'A password reset link has been sent to your email.';\n  } else {\n    echo 'No account found with that email address.';\n  }\n}\n?>\n\n<!-- Form for forgot password -->\n<form action=\"\" method=\"post\">\n  <input type=\"email\" name=\"email\" placeholder=\"Email Address\">\n  <button type=\"submit\" name=\"forgot_password\">Send Password Reset Link</button>\n</form>\n```\n\n**Explanation:**\n\n1. The script sends an email with a password reset link to the user's email address.\n2. When the user submits the forgot password form, the script queries the database for the user's account using their email address.\n3. If the account is found, it generates a random token and updates the password reset token in the database.\n4. The script sends an email with a password reset link to the user's email address.\n\n**Note:**\n\n* This example uses the `mysqli` extension for database interaction. You should consider switching to `PDO` or `mysqli` for better security.\n* Make sure to update the email configuration variables (`emailConfig`) to match your actual email settings.\n* The script assumes that you have a `reset_password.php` file in the same directory, which will handle the password reset process.\n\nI hope this helps! Let me know if you have any questions or need further clarification.", "code_blocks": [null, "```php\n<?php\n\n// Configuration variables\ndefine('BASE_URL', 'http://example.com');\ndefine('EMAIL_SUBJECT', 'Reset your password');\ndefine('EMAIL_BODY', 'Click the link below to reset your password.');\n\n// Email configuration\n$emailConfig = array(\n    'host' => 'smtp.example.com',\n    'username' => 'your_email@example.com',\n    'password' => 'your_password',\n);\n\n// Function to send email using PHPMailer\nfunction sendEmail($email, $subject, $body) {\n  require_once 'PHPMailer/PHPMailerAutoload.php';\n  $mail = new PHPMailer();\n  $mail->isSMTP();\n  $mail->Host = $emailConfig['host'];\n  $mail->Username = $emailConfig['username'];\n  $mail->Password = $emailConfig['password'];\n  $mail->Port = 587;\n  $mail->IsHTML(true);\n  $mail->setFrom($emailConfig['username'], 'Your Name');\n  $mail->addAddress($email, '');\n  $mail->Subject = $subject;\n  $mail->Body = $body;\n  return $mail->send();\n}\n\n// Handle forgot password request\nif (isset($_POST['forgot_password'])) {\n  // Get user input\n  $email = $_POST['email'];\n\n  // Validate email\n  if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n    echo 'Invalid email address.';\n    exit;\n  }\n\n  // Query database for user\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $query);\n  if ($row = mysqli_fetch_assoc($result)) {\n    // Generate random token\n    $token = bin2hex(random_bytes(32));\n\n    // Update password reset token in database\n    $updateQuery = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n    mysqli_query($conn, $updateQuery);\n\n    // Send email with password reset link\n    $link = BASE_URL . '/reset_password.php?token=' . $token;\n    sendEmail($email, EMAIL_SUBJECT, sprintf(EMAIL_BODY, $link));\n    echo 'A password reset link has been sent to your email.';\n  } else {\n    echo 'No account found with that email address.';\n  }\n}\n?>\n\n<!-- Form for forgot password -->\n<form action=\"\" method=\"post\">\n  <input type=\"email\" name=\"email\" placeholder=\"Email Address\">\n  <button type=\"submit\" name=\"forgot_password\">Send Password Reset Link</button>\n</form>\n```"]}
