{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can create a forgot password function in PHP:\n\n**Database Schema:**\nWe will assume that we have a table named `users` with the following columns:\n\n| Column Name | Data Type |\n|-------------|-----------|\n| id          | int       |\n| email       | varchar   |\n| password    | varchar   |\n\n**Forgot Password Function Code:**\n\n```php\n<?php\n\n// Include database connection file\nrequire_once 'db_connection.php';\n\n// Define variables for the forgot password form\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n\n    // Get user input from the form\n    $email = $_POST['email'];\n\n    // Query to check if email exists in the database\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n\n    // Check if result is not empty\n    if (mysqli_num_rows($result) > 0) {\n\n        // Get user's ID from the query results\n        $user_id = mysqli_fetch_assoc($result)['id'];\n\n        // Generate a new password\n        $new_password = bin2hex(random_bytes(10));\n\n        // Query to update user's password in the database\n        $query = \"UPDATE users SET password = '$new_password' WHERE id = '$user_id'\";\n        mysqli_query($conn, $query);\n\n        // Send email with the new password\n        sendEmail($email, $new_password);\n\n        echo \"Password has been sent to your email. Please check your inbox.\";\n    } else {\n        echo \"Email does not exist in our database.\";\n    }\n\n    // Close connection\n    mysqli_close($conn);\n} else {\n\n    // Display forgot password form\n    ?>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        Email: <input type=\"email\" name=\"email\"><br>\n        <button type=\"submit\">Send Password</button>\n    </form>\n    <?php\n}\n\n// Function to send email with new password\nfunction sendEmail($to_email, $new_password) {\n    // Use PHPMailer library or a similar library to send email\n    require_once 'PHPMailer/PHPMailer.php';\n    require_once 'PHPMailer/SMTP.php';\n\n    $mail = new PHPMailer\\PHPMailer\\PHPMailer();\n\n    $mail->isSMTP();\n    $mail->Host       = 'smtp.example.com';\n    $mail->Username   = 'example@example.com';\n    $mail->Password   = 'password';\n    $mail->Port       = 587;\n    $mail->CharSet     = 'UTF-8';\n\n    $mail->setFrom('example@example.com', 'Your Name');\n    $mail->addAddress($to_email);\n    $mail->isHTML(true);\n\n    $body = '\n        <p>Dear User,</p>\n        <p>Your new password is:</p>\n        <h2>' . $new_password . '</h2>\n        <p>Thank you for using our website!</p>\n    ';\n\n    $mail->Body = $body;\n    $mail->AltBody = 'This is a plain-text message body';\n\n    if (!$mail->send()) {\n        echo \"Message could not be sent. Error: \";\n        echo $mail->ErrorInfo;\n    }\n}\n?>\n```\n\n**Explanation:**\n\n1. The above code uses the PHPMailer library to send an email with the new password.\n2. When a user submits the forgot password form, the script checks if the provided email exists in the database.\n3. If the email exists, it generates a new random password and updates the user's password in the database.\n4. The script then sends an email to the user with their new password using PHPMailer.\n\n**Note:**\n\n1. You need to replace `'smtp.example.com'`, `'example@example.com'`, and `'password'` with your actual SMTP server, username, and password.\n2. Make sure you have the PHPMailer library installed in your project. You can download it from [here](https://github.com/PHPMailer/PHPMailer).\n3. This code assumes that you are using a MySQL database for storing user credentials. If you're using a different database system, you'll need to modify the SQL queries accordingly.\n4. Don't forget to hash and store passwords securely in your production environment.\n\nPlease let me know if you have any questions or concerns about this example!", "code_blocks": ["```php\n<?php\n\n// Include database connection file\nrequire_once 'db_connection.php';\n\n// Define variables for the forgot password form\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n\n    // Get user input from the form\n    $email = $_POST['email'];\n\n    // Query to check if email exists in the database\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n\n    // Check if result is not empty\n    if (mysqli_num_rows($result) > 0) {\n\n        // Get user's ID from the query results\n        $user_id = mysqli_fetch_assoc($result)['id'];\n\n        // Generate a new password\n        $new_password = bin2hex(random_bytes(10));\n\n        // Query to update user's password in the database\n        $query = \"UPDATE users SET password = '$new_password' WHERE id = '$user_id'\";\n        mysqli_query($conn, $query);\n\n        // Send email with the new password\n        sendEmail($email, $new_password);\n\n        echo \"Password has been sent to your email. Please check your inbox.\";\n    } else {\n        echo \"Email does not exist in our database.\";\n    }\n\n    // Close connection\n    mysqli_close($conn);\n} else {\n\n    // Display forgot password form\n    ?>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        Email: <input type=\"email\" name=\"email\"><br>\n        <button type=\"submit\">Send Password</button>\n    </form>\n    <?php\n}\n\n// Function to send email with new password\nfunction sendEmail($to_email, $new_password) {\n    // Use PHPMailer library or a similar library to send email\n    require_once 'PHPMailer/PHPMailer.php';\n    require_once 'PHPMailer/SMTP.php';\n\n    $mail = new PHPMailer\\PHPMailer\\PHPMailer();\n\n    $mail->isSMTP();\n    $mail->Host       = 'smtp.example.com';\n    $mail->Username   = 'example@example.com';\n    $mail->Password   = 'password';\n    $mail->Port       = 587;\n    $mail->CharSet     = 'UTF-8';\n\n    $mail->setFrom('example@example.com', 'Your Name');\n    $mail->addAddress($to_email);\n    $mail->isHTML(true);\n\n    $body = '\n        <p>Dear User,</p>\n        <p>Your new password is:</p>\n        <h2>' . $new_password . '</h2>\n        <p>Thank you for using our website!</p>\n    ';\n\n    $mail->Body = $body;\n    $mail->AltBody = 'This is a plain-text message body';\n\n    if (!$mail->send()) {\n        echo \"Message could not be sent. Error: \";\n        echo $mail->ErrorInfo;\n    }\n}\n?>\n```"]}
