{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how to create a \"forgot password\" function in PHP:\n\n**Assumptions:**\n\n* We have a database table called `users` with columns for `username`, `email`, and `password`.\n* We are using the `mysqli` extension for interacting with our database.\n* We will send the new password via email.\n\n**PHP Code:**\n```php\n<?php\n\n// Include configuration file\nrequire_once 'config.php';\n\n// Define function to reset password\nfunction forgot_password($username, $email) {\n  // Check if username and email are set\n  if (!isset($username) || !isset($email)) {\n    return array('error' => 'Please enter both your username and email address.');\n  }\n\n  // Query database for user with matching username and email\n  $query = \"SELECT * FROM users WHERE username='$username' AND email='$email'\";\n  $result = mysqli_query($conn, $query);\n\n  // Check if user exists in database\n  if (mysqli_num_rows($result) == 0) {\n    return array('error' => 'User not found.');\n  }\n\n  // Get user's ID from result\n  $user_id = mysqli_fetch_assoc($result)['id'];\n\n  // Generate new password and store it in variable\n  $new_password = substr(md5(uniqid()), 0, 8);\n\n  // Update user's password in database\n  $query = \"UPDATE users SET password='$new_password' WHERE id='$user_id'\";\n  mysqli_query($conn, $query);\n\n  // Send new password to user via email\n  send_email($email, $username, $new_password);\n}\n\n// Define function to send email with new password\nfunction send_email($email, $username, $new_password) {\n  // Set up email headers and body\n  $headers = 'From: Your Email Address <your@email.com>' . \"\\r\\n\";\n  $body = \"Dear $username,\\n\\nYour new password is: $new_password\\n\\nBest regards,\\n[Your Name]\";\n\n  // Send email using PHP's mail function\n  if (mail($email, 'New Password', $body, $headers)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Call forgot_password function with username and email as arguments\nforgot_password($_POST['username'], $_POST['email']);\n\n?>\n```\n**HTML Code:**\n```html\n<form action=\"\" method=\"post\">\n  <label for=\"username\">Username:</label>\n  <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n  <label for=\"email\">Email Address:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n  <button type=\"submit\">Submit</button>\n</form>\n\n<?php\nif (isset($_POST['submit'])) {\n  // Display any errors that occurred during password reset process\n  if ($error = forgot_password($_POST['username'], $_POST['email'])) {\n    echo '<p style=\"color: red;\">' . $error['error'] . '</p>';\n  }\n}\n?>\n```\n**Notes:**\n\n* This code uses the `mysqli` extension to interact with your database. Make sure you have this extension enabled on your server.\n* The `send_email` function uses PHP's built-in `mail` function to send an email to the user. You may need to configure your mail server to use a different function or service (e.g., Gmail SMTP).\n* This code generates a random new password using MD5 and uniqid(). You can modify this behavior if you prefer.\n* Make sure to replace `'Your Email Address'` and `'[Your Name]'` with the actual email address and name of your website in the `send_email` function.", "code_blocks": ["```php\n<?php\n\n// Include configuration file\nrequire_once 'config.php';\n\n// Define function to reset password\nfunction forgot_password($username, $email) {\n  // Check if username and email are set\n  if (!isset($username) || !isset($email)) {\n    return array('error' => 'Please enter both your username and email address.');\n  }\n\n  // Query database for user with matching username and email\n  $query = \"SELECT * FROM users WHERE username='$username' AND email='$email'\";\n  $result = mysqli_query($conn, $query);\n\n  // Check if user exists in database\n  if (mysqli_num_rows($result) == 0) {\n    return array('error' => 'User not found.');\n  }\n\n  // Get user's ID from result\n  $user_id = mysqli_fetch_assoc($result)['id'];\n\n  // Generate new password and store it in variable\n  $new_password = substr(md5(uniqid()), 0, 8);\n\n  // Update user's password in database\n  $query = \"UPDATE users SET password='$new_password' WHERE id='$user_id'\";\n  mysqli_query($conn, $query);\n\n  // Send new password to user via email\n  send_email($email, $username, $new_password);\n}\n\n// Define function to send email with new password\nfunction send_email($email, $username, $new_password) {\n  // Set up email headers and body\n  $headers = 'From: Your Email Address <your@email.com>' . \"\\r\\n\";\n  $body = \"Dear $username,\\n\\nYour new password is: $new_password\\n\\nBest regards,\\n[Your Name]\";\n\n  // Send email using PHP's mail function\n  if (mail($email, 'New Password', $body, $headers)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Call forgot_password function with username and email as arguments\nforgot_password($_POST['username'], $_POST['email']);\n\n?>\n```", null]}
