{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can create a \"Forgot Password\" function using PHP:\n\n**Database Setup**\n\nFirst, let's assume we have a MySQL database table named `users` with the following structure:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\n```\n**PHP Code**\n\nCreate a new PHP file (e.g. `forgot_password.php`) and add the following code:\n```php\n<?php\n\n// Configuration\n$databaseHost = 'localhost';\n$databaseName = 'mydatabase';\n$databaseUsername = 'myusername';\n$databasePassword = 'mypassword';\n\n// Connect to database\n$conn = new mysqli($databaseHost, $databaseUsername, $databasePassword, $databaseName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send password reset email\nfunction sendResetEmail($email) {\n  // Generate random token for password reset\n  $token = substr(md5(uniqid(mt_rand(), true)), 0, 32);\n\n  // Insert token into database\n  $sql = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n  if ($conn->query($sql) === TRUE) {\n    // Send email with reset link\n    $subject = 'Reset Password';\n    $body = '<p>Please click on the following link to reset your password:</p>\n            <p><a href=\"http://example.com/reset_password.php?token=' . $token . '\">Reset Password</a></p>';\n    mail($email, $subject, $body);\n  } else {\n    echo \"Error updating record: \" . $conn->error;\n  }\n}\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Get email from form input\n  $email = $_POST['email'];\n\n  // Validate email address\n  if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n    echo \"Invalid email address\";\n  } else {\n    // Call function to send reset email\n    sendResetEmail($email);\n\n    // Display success message\n    echo \"Password reset link has been sent to your email.\";\n  }\n} else {\n  // Display form if not submitted\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"email\">Email:</label>\n  <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n  <input type=\"submit\" value=\"Reset Password\">\n</form>\n\n<?php\n}\n?>\n```\n**How it works**\n\n1. The user submits the form with their email address.\n2. The PHP script checks if the form has been submitted using `$_SERVER['REQUEST_METHOD']`.\n3. If the form has been submitted, the script validates the email address using `filter_var()` and checks for any errors.\n4. If the email is valid, the script calls the `sendResetEmail()` function to send a password reset email with a link to the user's email.\n5. The `sendResetEmail()` function generates a random token, inserts it into the database, and sends an email with a reset link.\n\n**Note**: This code assumes you have a MySQL database set up with the necessary configuration. You'll need to modify the database credentials and table structure according to your specific setup. Additionally, this code does not include any error handling or security measures beyond basic validation.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$databaseHost = 'localhost';\n$databaseName = 'mydatabase';\n$databaseUsername = 'myusername';\n$databasePassword = 'mypassword';\n\n// Connect to database\n$conn = new mysqli($databaseHost, $databaseUsername, $databasePassword, $databaseName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send password reset email\nfunction sendResetEmail($email) {\n  // Generate random token for password reset\n  $token = substr(md5(uniqid(mt_rand(), true)), 0, 32);\n\n  // Insert token into database\n  $sql = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n  if ($conn->query($sql) === TRUE) {\n    // Send email with reset link\n    $subject = 'Reset Password';\n    $body = '<p>Please click on the following link to reset your password:</p>\n            <p><a href=\"http://example.com/reset_password.php?token=' . $token . '\">Reset Password</a></p>';\n    mail($email, $subject, $body);\n  } else {\n    echo \"Error updating record: \" . $conn->error;\n  }\n}\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Get email from form input\n  $email = $_POST['email'];\n\n  // Validate email address\n  if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n    echo \"Invalid email address\";\n  } else {\n    // Call function to send reset email\n    sendResetEmail($email);\n\n    // Display success message\n    echo \"Password reset link has been sent to your email.\";\n  }\n} else {\n  // Display form if not submitted\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"email\">Email:</label>\n  <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n  <input type=\"submit\" value=\"Reset Password\">\n</form>\n\n<?php\n}\n?>\n```"]}
