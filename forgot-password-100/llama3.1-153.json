{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can implement a \"Forgot Password\" function in PHP:\n\n**password_recover.php**\n```php\n<?php\n// Configuration settings\n$mysql_host = 'localhost';\n$mysql_user = 'your_username';\n$mysql_password = 'your_password';\n$mysql_database = 'your_database';\n\n// Connect to the database\n$conn = mysqli_connect($mysql_host, $mysql_user, $mysql_password, $mysql_database);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Function to send password recovery email\nfunction send_recovery_email($email, $username) {\n    // Set the subject and body of the email\n    $subject = 'Password Recovery for ' . $username;\n    $body = '<p>Hello,</p>\n            <p>Please click on the following link to reset your password:</p>\n            <a href=\"' . $_SERVER['REQUEST_URI'] . '\">Reset Password</a>';\n\n    // Send the email using PHPMailer (install this library)\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->SMTPSecure = 'tls';\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@gmail.com'; // your email account\n    $mail->Password = 'your_password'; // your email password\n    $mail->setFrom('your_email@gmail.com', 'Your Email');\n    $mail->addAddress($email, $username);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n\n    if (!$mail->send()) {\n        echo \"Mailer Error: \" . $mail->ErrorInfo;\n        return false;\n    }\n\n    return true;\n}\n\n// Check if the form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get the email address from the form data\n    $email = $_POST['email'];\n    $username = $_POST['username'];\n\n    // Validate the input\n    if (empty($email) || empty($username)) {\n        echo \"Both email and username are required.\";\n        exit;\n    }\n\n    // Query to get the user's data from the database\n    $sql = \"SELECT * FROM users WHERE email='$email' AND username='$username'\";\n    $result = mysqli_query($conn, $sql);\n\n    if (mysqli_num_rows($result) == 1) {\n        // Get the user's ID\n        $user_id = mysqli_fetch_assoc($result)['id'];\n\n        // Send the password recovery email\n        send_recovery_email($email, $username);\n        echo \"A password reset link has been sent to your email.\";\n    } else {\n        echo \"User not found. Please check your email and username.\";\n    }\n}\n\n// Close the database connection\nmysqli_close($conn);\n?>\n```\n**password_recover_form.html**\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Forgot Password</title>\n</head>\n<body>\n    <h1>Forgotten Password?</h1>\n    <p>Please enter your email and username to reset your password.</p>\n    <form method=\"post\" action=\"<?php echo $_SERVER['REQUEST_URI']; ?>\">\n        <label for=\"email\">Email:</label>\n        <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n        <label for=\"username\">Username:</label>\n        <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n        <button type=\"submit\">Submit</button>\n    </form>\n</body>\n</html>\n```\n**Explanation:**\n\n1. The `password_recover.php` script sets up a database connection to retrieve the user's data.\n2. It defines a function `send_recovery_email()` that sends an email with a password reset link using PHPMailer.\n3. When the form is submitted, it checks if both email and username are provided, and then queries the database to get the user's data based on their email and username.\n4. If the query returns exactly one row (i.e., the user exists), it sends the password recovery email using `send_recovery_email()`.\n5. The form is rendered in `password_recover_form.html`, which posts to the same script.\n\n**Note:** This example uses a simple email sending mechanism, but you should consider implementing more secure methods, such as password hashing and salting, for storing passwords securely. Additionally, ensure that your email account has the necessary authentication settings to send emails using PHPMailer.", "code_blocks": ["```php\n<?php\n// Configuration settings\n$mysql_host = 'localhost';\n$mysql_user = 'your_username';\n$mysql_password = 'your_password';\n$mysql_database = 'your_database';\n\n// Connect to the database\n$conn = mysqli_connect($mysql_host, $mysql_user, $mysql_password, $mysql_database);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Function to send password recovery email\nfunction send_recovery_email($email, $username) {\n    // Set the subject and body of the email\n    $subject = 'Password Recovery for ' . $username;\n    $body = '<p>Hello,</p>\n            <p>Please click on the following link to reset your password:</p>\n            <a href=\"' . $_SERVER['REQUEST_URI'] . '\">Reset Password</a>';\n\n    // Send the email using PHPMailer (install this library)\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->SMTPSecure = 'tls';\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@gmail.com'; // your email account\n    $mail->Password = 'your_password'; // your email password\n    $mail->setFrom('your_email@gmail.com', 'Your Email');\n    $mail->addAddress($email, $username);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n\n    if (!$mail->send()) {\n        echo \"Mailer Error: \" . $mail->ErrorInfo;\n        return false;\n    }\n\n    return true;\n}\n\n// Check if the form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get the email address from the form data\n    $email = $_POST['email'];\n    $username = $_POST['username'];\n\n    // Validate the input\n    if (empty($email) || empty($username)) {\n        echo \"Both email and username are required.\";\n        exit;\n    }\n\n    // Query to get the user's data from the database\n    $sql = \"SELECT * FROM users WHERE email='$email' AND username='$username'\";\n    $result = mysqli_query($conn, $sql);\n\n    if (mysqli_num_rows($result) == 1) {\n        // Get the user's ID\n        $user_id = mysqli_fetch_assoc($result)['id'];\n\n        // Send the password recovery email\n        send_recovery_email($email, $username);\n        echo \"A password reset link has been sent to your email.\";\n    } else {\n        echo \"User not found. Please check your email and username.\";\n    }\n}\n\n// Close the database connection\nmysqli_close($conn);\n?>\n```", null]}
