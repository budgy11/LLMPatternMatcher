{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how to create a \"Forgot Password\" function in PHP:\n\n**Note:** This example assumes you have a MySQL database with a table named `users` containing columns for `username`, `email`, and `password`.\n\n**Database Schema:**\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\n```\n**Forgot Password Form (HTML/PHP):**\n```php\n<?php\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Handle form submission\n  $email = $_POST['email'];\n  $username = $_POST['username'];\n\n  // Query database to retrieve user's email and password\n  $query = \"SELECT * FROM users WHERE email = '$email' AND username = '$username'\";\n  $result = mysqli_query($conn, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    // User exists, generate new password and send reset link via email\n    $user_data = mysqli_fetch_assoc($result);\n    $new_password = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 8);\n    $reset_link = \"http://example.com/reset-password?email=$email&username=$username&password=$new_password\";\n\n    // Send password reset email\n    mail($user_data['email'], 'Password Reset', \"Your new password is: $new_password\\n\\nClick the link below to reset your password:\\n$reset_link\");\n\n    echo \"A password reset link has been sent to your email.\";\n  } else {\n    echo \"Invalid email or username.\";\n  }\n}\n?>\n\n<form action=\"\" method=\"post\">\n  <label for=\"email\">Email:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n  <label for=\"username\">Username:</label>\n  <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n  <input type=\"submit\" value=\"Send Reset Link\">\n</form>\n```\n**Password Reset Form (HTML/PHP):**\n```php\n<?php\nif ($_SERVER['REQUEST_METHOD'] == 'GET') {\n  $email = $_GET['email'];\n  $username = $_GET['username'];\n  $password = $_GET['password'];\n\n  // Verify password reset link and update user's password\n  if ($email && $username && $password) {\n    $query = \"UPDATE users SET password = '$password' WHERE email = '$email' AND username = '$username'\";\n    mysqli_query($conn, $query);\n\n    echo \"Your password has been successfully updated.\";\n  } else {\n    echo \"Invalid reset link.\";\n  }\n}\n?>\n\n<form action=\"\" method=\"post\">\n  <label for=\"new_password\">New Password:</label>\n  <input type=\"password\" id=\"new_password\" name=\"new_password\"><br><br>\n  <input type=\"submit\" value=\"Update Password\">\n</form>\n```\n**Security Notes:**\n\n* Always use prepared statements to prevent SQL injection attacks.\n* Use a secure password hashing algorithm (e.g. `bcrypt`, `argon2`) to store passwords securely.\n* Never store plaintext passwords in the database.\n* Use HTTPS to encrypt data transmitted between client and server.\n\nThis example demonstrates a basic \"Forgot Password\" function using PHP and MySQL. However, please note that this is not a production-ready solution and should be modified to suit your specific requirements and security needs.", "code_blocks": [null, "```php\n<?php\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Handle form submission\n  $email = $_POST['email'];\n  $username = $_POST['username'];\n\n  // Query database to retrieve user's email and password\n  $query = \"SELECT * FROM users WHERE email = '$email' AND username = '$username'\";\n  $result = mysqli_query($conn, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    // User exists, generate new password and send reset link via email\n    $user_data = mysqli_fetch_assoc($result);\n    $new_password = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 8);\n    $reset_link = \"http://example.com/reset-password?email=$email&username=$username&password=$new_password\";\n\n    // Send password reset email\n    mail($user_data['email'], 'Password Reset', \"Your new password is: $new_password\\n\\nClick the link below to reset your password:\\n$reset_link\");\n\n    echo \"A password reset link has been sent to your email.\";\n  } else {\n    echo \"Invalid email or username.\";\n  }\n}\n?>\n\n<form action=\"\" method=\"post\">\n  <label for=\"email\">Email:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n  <label for=\"username\">Username:</label>\n  <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n  <input type=\"submit\" value=\"Send Reset Link\">\n</form>\n```", "```php\n<?php\nif ($_SERVER['REQUEST_METHOD'] == 'GET') {\n  $email = $_GET['email'];\n  $username = $_GET['username'];\n  $password = $_GET['password'];\n\n  // Verify password reset link and update user's password\n  if ($email && $username && $password) {\n    $query = \"UPDATE users SET password = '$password' WHERE email = '$email' AND username = '$username'\";\n    mysqli_query($conn, $query);\n\n    echo \"Your password has been successfully updated.\";\n  } else {\n    echo \"Invalid reset link.\";\n  }\n}\n?>\n\n<form action=\"\" method=\"post\">\n  <label for=\"new_password\">New Password:</label>\n  <input type=\"password\" id=\"new_password\" name=\"new_password\"><br><br>\n  <input type=\"submit\" value=\"Update Password\">\n</form>\n```"]}
