{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how to create a \"forgot password\" function using PHP:\n\n**Database Schema:**\n\nAssuming you have a database table named `users` with the following structure:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  email VARCHAR(255) NOT NULL,\n  password_hash VARCHAR(255) NOT NULL\n);\n```\n**Forgot Password Function:**\n\nCreate a PHP file (e.g. `forgot_password.php`) and add the following code:\n```php\n<?php\n\n// Configuration\n$db_host = 'your_database_host';\n$db_username = 'your_database_username';\n$db_password = 'your_database_password';\n$db_name = 'your_database_name';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Form data\n$email = $_POST['email'];\n\n// Check if email exists in database\n$query = \"SELECT * FROM users WHERE email = '$email'\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    // Email found, proceed with password reset\n\n    // Generate a random password\n    $new_password = bin2hex(random_bytes(16));\n\n    // Update user's password in database\n    $update_query = \"UPDATE users SET password_hash = '$new_password' WHERE email = '$email'\";\n    $conn->query($update_query);\n\n    // Send email to user with new password\n    $subject = 'Your temporary password';\n    $body = \"Dear user,\\n\\nYour temporary password is: $new_password\\n\\nBest regards,\\n[Your Name]\";\n    mail($email, $subject, $body);\n\n    echo \"Password reset successfully sent to your email.\";\n} else {\n    echo \"Email not found in our database. Please try again.\";\n}\n\n// Close connection\n$conn->close();\n\n?>\n```\n**HTML Form:**\n\nCreate a simple HTML form (e.g. `forgot_password.html`) to collect the user's email address:\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Forgot Password</title>\n</head>\n<body>\n\n<form action=\"forgot_password.php\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" value=\"Submit\">\n</form>\n\n</body>\n</html>\n```\n**How it works:**\n\n1. The user submits the HTML form with their email address.\n2. The `forgot_password.php` script connects to the database using the provided credentials.\n3. It checks if an email address exists in the `users` table.\n4. If the email is found, a random password is generated and stored in the database instead of the original password hash.\n5. An email is sent to the user with their new temporary password.\n6. The script closes the database connection.\n\nNote: This example uses a simple `mail()` function to send an email. You may want to use a more robust email library or service, such as PHPMailer or Gmail's SMTP server.\n\nAlso, keep in mind that this is just a basic example and you should adapt it to your specific needs and security requirements (e.g., password hashing algorithm, email verification).", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$db_host = 'your_database_host';\n$db_username = 'your_database_username';\n$db_password = 'your_database_password';\n$db_name = 'your_database_name';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Form data\n$email = $_POST['email'];\n\n// Check if email exists in database\n$query = \"SELECT * FROM users WHERE email = '$email'\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    // Email found, proceed with password reset\n\n    // Generate a random password\n    $new_password = bin2hex(random_bytes(16));\n\n    // Update user's password in database\n    $update_query = \"UPDATE users SET password_hash = '$new_password' WHERE email = '$email'\";\n    $conn->query($update_query);\n\n    // Send email to user with new password\n    $subject = 'Your temporary password';\n    $body = \"Dear user,\\n\\nYour temporary password is: $new_password\\n\\nBest regards,\\n[Your Name]\";\n    mail($email, $subject, $body);\n\n    echo \"Password reset successfully sent to your email.\";\n} else {\n    echo \"Email not found in our database. Please try again.\";\n}\n\n// Close connection\n$conn->close();\n\n?>\n```", null]}
