{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n====================================\n\nBelow is an example implementation of a forgot password function using PHP. This example assumes you have a database with a `users` table containing columns for `id`, `email`, and `password`.\n\n### Database Schema (SQL)\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  email VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\n```\n### PHP Code (Forgot Password Function)\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction forgotPassword($email)\n{\n    global $conn;\n\n    // Query to retrieve user by email\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // User found, generate new password and send reset link via email\n\n        // Generate random password\n        $newPassword = substr(str_shuffle(\"0123456789abcdefghijklmnopqrstuvwxyz\"), 0, 8);\n\n        // Update user's password in database\n        $query = \"UPDATE users SET password = '$newPassword' WHERE email = '$email'\";\n        $conn->query($query);\n\n        // Send reset link via email (example using PHPMailer)\n        require_once 'PHPMailer/PHPMailerAutoload.php';\n\n        $mail = new PHPMailer();\n\n        $mail->isSMTP();\n        $mail->Host       = 'smtp.example.com';\n        $mail->SMTPAuth    = true;\n        $mail->Username    = 'your_email@example.com';\n        $mail->Password    = 'your_password';\n        $mail->Port        = 587;\n\n        $mail->setFrom('your_email@example.com', 'Your Name');\n        $mail->addAddress($email);\n        $mail->Subject = 'Reset Password';\n\n        // Send email with reset link\n        $resetLink = \"http://example.com/reset-password.php?email=$email&newPassword=$newPassword\";\n        $body = \"<p>Please click on the following link to reset your password:</p><p>$resetLink</p>\";\n        $mail->Body    = $body;\n\n        if (!$mail->send()) {\n            echo 'Message could not be sent.';\n            echo 'Mailer Error: ' . $mail->ErrorInfo;\n        } else {\n            echo 'Email sent successfully!';\n        }\n\n        return true; // Reset link sent\n    }\n\n    return false; // User not found\n}\n\n// Example usage:\n$email = \"example@example.com\";\nif (forgotPassword($email)) {\n    echo \"Reset link sent to $email.\";\n} else {\n    echo \"User not found with email $email.\";\n}\n?>\n```\nThis implementation includes:\n\n1. Database connection and query execution using `mysqli`.\n2. Password generation using `substr` and random string generation.\n3. Email sending using PHPMailer ( example).\n4. Forgot password function that returns `true` if reset link is sent successfully, or `false` if user not found.\n\nNote: This is a basic implementation for demonstration purposes. You should consider security best practices when implementing a forgot password feature in your application.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction forgotPassword($email)\n{\n    global $conn;\n\n    // Query to retrieve user by email\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // User found, generate new password and send reset link via email\n\n        // Generate random password\n        $newPassword = substr(str_shuffle(\"0123456789abcdefghijklmnopqrstuvwxyz\"), 0, 8);\n\n        // Update user's password in database\n        $query = \"UPDATE users SET password = '$newPassword' WHERE email = '$email'\";\n        $conn->query($query);\n\n        // Send reset link via email (example using PHPMailer)\n        require_once 'PHPMailer/PHPMailerAutoload.php';\n\n        $mail = new PHPMailer();\n\n        $mail->isSMTP();\n        $mail->Host       = 'smtp.example.com';\n        $mail->SMTPAuth    = true;\n        $mail->Username    = 'your_email@example.com';\n        $mail->Password    = 'your_password';\n        $mail->Port        = 587;\n\n        $mail->setFrom('your_email@example.com', 'Your Name');\n        $mail->addAddress($email);\n        $mail->Subject = 'Reset Password';\n\n        // Send email with reset link\n        $resetLink = \"http://example.com/reset-password.php?email=$email&newPassword=$newPassword\";\n        $body = \"<p>Please click on the following link to reset your password:</p><p>$resetLink</p>\";\n        $mail->Body    = $body;\n\n        if (!$mail->send()) {\n            echo 'Message could not be sent.';\n            echo 'Mailer Error: ' . $mail->ErrorInfo;\n        } else {\n            echo 'Email sent successfully!';\n        }\n\n        return true; // Reset link sent\n    }\n\n    return false; // User not found\n}\n\n// Example usage:\n$email = \"example@example.com\";\nif (forgotPassword($email)) {\n    echo \"Reset link sent to $email.\";\n} else {\n    echo \"User not found with email $email.\";\n}\n?>\n```"]}
