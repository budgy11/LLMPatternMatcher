{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how you can create a \"Forgot Password\" function in PHP:\n\n**Database Schema**\n\nFirst, let's assume we have a table named `users` with the following columns:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY,\n  email VARCHAR(255) NOT NULL,\n  password_hash VARCHAR(255) NOT NULL\n);\n```\n\n**PHP Code**\n\nCreate a new PHP file (e.g. `forgot_password.php`) and add the following code:\n```php\n<?php\n\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'your_database';\n\n// Connect to database\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to reset password\nfunction forgot_password($email)\n{\n    // SQL query to select user by email\n    $sql = \"SELECT * FROM users WHERE email = '$email'\";\n    \n    // Execute query and get result\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        // Get the user's ID and password hash\n        $user = $result->fetch_assoc();\n\n        // Generate a random password\n        $password = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 10);\n\n        // Update the password in database (with hashing)\n        $new_password_hash = password_hash($password, PASSWORD_DEFAULT);\n        $sql = \"UPDATE users SET password_hash = '$new_password_hash' WHERE id = '\" . $user['id'] . \"'\";\n        $conn->query($sql);\n\n        // Send email with new password\n        $to = $email;\n        $subject = 'Reset Password';\n        $body = 'Your new password is: ' . $password;\n\n        mail($to, $subject, $body);\n        \n        echo \"New password sent to your email\";\n    } else {\n        echo \"Email not found in database\";\n    }\n}\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $email = $_POST['email'];\n    \n    // Check if email is valid (e.g. contains '@')\n    if (strpos($email, '@') !== false) {\n        forgot_password($email);\n    } else {\n        echo \"Invalid email address\";\n    }\n}\n\n// Close database connection\n$conn->close();\n\n?>\n```\n\n**HTML Form**\n\nCreate a new HTML file (`forgot_password_form.html`) with the following code:\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Forgot Password</title>\n</head>\n<body>\n    <h1>Forgot Password?</h1>\n    <form action=\"forgot_password.php\" method=\"post\">\n        Email: <input type=\"email\" name=\"email\"><br><br>\n        <input type=\"submit\" value=\"Submit\">\n    </form>\n</body>\n</html>\n```\n\n**How it works**\n\nWhen a user submits the form with their email address, the PHP script checks if the email is valid (contains '@'). If so, it executes the `forgot_password` function to generate a new random password and update the user's password in the database. The new password is then sent to the user via email using PHP's built-in `mail()` function.\n\nPlease note that this is just an example code and you should modify it according to your specific requirements (e.g., use a more secure way of sending emails). Additionally, remember to replace `'your_username'`, `'your_password'` and `'your_database'` with your actual database credentials.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'your_database';\n\n// Connect to database\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to reset password\nfunction forgot_password($email)\n{\n    // SQL query to select user by email\n    $sql = \"SELECT * FROM users WHERE email = '$email'\";\n    \n    // Execute query and get result\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        // Get the user's ID and password hash\n        $user = $result->fetch_assoc();\n\n        // Generate a random password\n        $password = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 10);\n\n        // Update the password in database (with hashing)\n        $new_password_hash = password_hash($password, PASSWORD_DEFAULT);\n        $sql = \"UPDATE users SET password_hash = '$new_password_hash' WHERE id = '\" . $user['id'] . \"'\";\n        $conn->query($sql);\n\n        // Send email with new password\n        $to = $email;\n        $subject = 'Reset Password';\n        $body = 'Your new password is: ' . $password;\n\n        mail($to, $subject, $body);\n        \n        echo \"New password sent to your email\";\n    } else {\n        echo \"Email not found in database\";\n    }\n}\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $email = $_POST['email'];\n    \n    // Check if email is valid (e.g. contains '@')\n    if (strpos($email, '@') !== false) {\n        forgot_password($email);\n    } else {\n        echo \"Invalid email address\";\n    }\n}\n\n// Close database connection\n$conn->close();\n\n?>\n```", null]}
