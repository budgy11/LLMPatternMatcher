{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a forgotten password function in PHP:\n\n**password_recover.php**\n```php\n<?php\nrequire_once 'config.php'; // database connection settings\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $email = $_POST['email'];\n\n    // Query to retrieve user data\n    $query = \"SELECT * FROM users WHERE email = :email\";\n    $stmt = $pdo->prepare($query);\n    $stmt->bindParam(':email', $email);\n    $stmt->execute();\n\n    if ($stmt->rowCount() == 1) {\n        $user_data = $stmt->fetch();\n\n        // Generate a random password\n        $new_password = substr(md5(uniqid(mt_rand(), true)), 0, 8);\n\n        // Update user data with new password\n        $query = \"UPDATE users SET password = :password WHERE email = :email\";\n        $stmt = $pdo->prepare($query);\n        $stmt->bindParam(':email', $email);\n        $stmt->bindParam(':password', $new_password);\n        $stmt->execute();\n\n        // Send a reset link to the user's email\n        send_email_reset_link($user_data['email'], $new_password);\n\n        echo \"Your password has been updated successfully. Please check your email for further instructions.\";\n    } else {\n        echo \"Email not found\";\n    }\n}\n\n// Function to send a reset link to the user's email\nfunction send_email_reset_link($email, $password) {\n    $subject = 'Reset Your Password';\n    $body = 'Your new password is: ' . $password;\n    mail($email, $subject, $body);\n}\n?>\n```\n\n**config.php**\n```php\n<?php\n$pdo = new PDO('mysql:host=localhost;dbname=mydatabase', 'username', 'password');\n?>\n```\nThis code does the following:\n\n1. Checks if a form has been submitted.\n2. Queries the database to retrieve user data based on the provided email address.\n3. If the email is found, generates a random password and updates it in the database.\n4. Sends an email with the new password to the user.\n\n**HTML Form**\n```html\n<form action=\"password_recover.php\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\">\n    <button type=\"submit\">Submit</button>\n</form>\n```\nThis form submits a POST request to `password_recover.php` with the user's email address.\n\nNote: This is a basic example and you should implement additional security measures, such as:\n\n* Hashing passwords instead of storing plain text\n* Verifying the reset link before updating the password\n* Limiting the number of attempts to prevent brute-force attacks\n\nAlso, this code uses PHP's built-in `mail()` function, which may not work in all environments. You may need to use a more robust email library or service.", "code_blocks": ["```php\n<?php\nrequire_once 'config.php'; // database connection settings\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $email = $_POST['email'];\n\n    // Query to retrieve user data\n    $query = \"SELECT * FROM users WHERE email = :email\";\n    $stmt = $pdo->prepare($query);\n    $stmt->bindParam(':email', $email);\n    $stmt->execute();\n\n    if ($stmt->rowCount() == 1) {\n        $user_data = $stmt->fetch();\n\n        // Generate a random password\n        $new_password = substr(md5(uniqid(mt_rand(), true)), 0, 8);\n\n        // Update user data with new password\n        $query = \"UPDATE users SET password = :password WHERE email = :email\";\n        $stmt = $pdo->prepare($query);\n        $stmt->bindParam(':email', $email);\n        $stmt->bindParam(':password', $new_password);\n        $stmt->execute();\n\n        // Send a reset link to the user's email\n        send_email_reset_link($user_data['email'], $new_password);\n\n        echo \"Your password has been updated successfully. Please check your email for further instructions.\";\n    } else {\n        echo \"Email not found\";\n    }\n}\n\n// Function to send a reset link to the user's email\nfunction send_email_reset_link($email, $password) {\n    $subject = 'Reset Your Password';\n    $body = 'Your new password is: ' . $password;\n    mail($email, $subject, $body);\n}\n?>\n```", "```php\n<?php\n$pdo = new PDO('mysql:host=localhost;dbname=mydatabase', 'username', 'password');\n?>\n```", null]}
