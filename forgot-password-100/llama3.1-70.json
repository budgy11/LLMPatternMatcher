{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nBelow is an example of how to create a \"forgot password\" function in PHP. This script will send an email with a link to reset the password.\n\n**Password Reset Script**\n```php\n<?php\n\n// Configuration variables\ndefine('RESET_LINK', 'https://example.com/reset-password.php');\ndefine('ADMIN_EMAIL', 'admin@example.com');\n\n// Function to generate a random token\nfunction generateToken() {\n    return bin2hex(random_bytes(16));\n}\n\n// Function to send reset email\nfunction sendResetEmail($email, $token) {\n    // Email headers\n    $headers = \"From: Admin <\" . ADMIN_EMAIL . \">\" . \"\\r\\n\";\n    $headers .= \"Content-Type: text/html; charset=utf-8\\r\\n\";\n\n    // Email body\n    $body = \"\n        <h1>Reset Your Password</h1>\n        <p>Please click the link below to reset your password:</p>\n        <a href='\" . RESET_LINK . \"?token=\" . $token . \"'>Reset Password</a>\n    \";\n\n    // Send email using mail() function\n    mail($email, 'Reset Password', $body, $headers);\n}\n\n// Forgot password function\nfunction forgotPassword($email) {\n    // Generate a random token\n    $token = generateToken();\n\n    // Store the token in the database (replace with your own database functions)\n    storeTokenInDatabase($email, $token);\n\n    // Send reset email\n    sendResetEmail($email, $token);\n}\n\n// Example usage:\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $email = $_POST['email'];\n\n    if ($email) {\n        forgotPassword($email);\n        echo \"An email has been sent to your account with a link to reset your password.\";\n    } else {\n        echo \"Invalid email address.\";\n    }\n} else {\n    ?>\n    <h1>Forgot Password</h1>\n    <form action=\"\" method=\"post\">\n        <label for=\"email\">Email:</label>\n        <input type=\"email\" id=\"email\" name=\"email\" required><br><br>\n        <button type=\"submit\">Submit</button>\n    </form>\n    <?php\n}\n\n?>\n```\n**Explanation:**\n\n1. The script starts by defining two configuration variables: `RESET_LINK` and `ADMIN_EMAIL`.\n2. A function called `generateToken()` generates a random token using the `random_bytes()` function.\n3. Another function, `sendResetEmail()`, sends an email to the user with a link to reset their password.\n4. The `forgotPassword()` function takes an email address as input and calls both `generateToken()` and `sendResetEmail()` functions.\n5. To use this script, you need to implement a database function called `storeTokenInDatabase()` that stores the generated token in your database with the corresponding user's email address.\n\n**Note:**\n\n* This is just an example script and should be adapted to fit your specific needs.\n* The script assumes you are using a mail() function or an email library like PHPMailer.\n* Always make sure to hash passwords before storing them in your database, as demonstrated in other code examples.", "code_blocks": ["```php\n<?php\n\n// Configuration variables\ndefine('RESET_LINK', 'https://example.com/reset-password.php');\ndefine('ADMIN_EMAIL', 'admin@example.com');\n\n// Function to generate a random token\nfunction generateToken() {\n    return bin2hex(random_bytes(16));\n}\n\n// Function to send reset email\nfunction sendResetEmail($email, $token) {\n    // Email headers\n    $headers = \"From: Admin <\" . ADMIN_EMAIL . \">\" . \"\\r\\n\";\n    $headers .= \"Content-Type: text/html; charset=utf-8\\r\\n\";\n\n    // Email body\n    $body = \"\n        <h1>Reset Your Password</h1>\n        <p>Please click the link below to reset your password:</p>\n        <a href='\" . RESET_LINK . \"?token=\" . $token . \"'>Reset Password</a>\n    \";\n\n    // Send email using mail() function\n    mail($email, 'Reset Password', $body, $headers);\n}\n\n// Forgot password function\nfunction forgotPassword($email) {\n    // Generate a random token\n    $token = generateToken();\n\n    // Store the token in the database (replace with your own database functions)\n    storeTokenInDatabase($email, $token);\n\n    // Send reset email\n    sendResetEmail($email, $token);\n}\n\n// Example usage:\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $email = $_POST['email'];\n\n    if ($email) {\n        forgotPassword($email);\n        echo \"An email has been sent to your account with a link to reset your password.\";\n    } else {\n        echo \"Invalid email address.\";\n    }\n} else {\n    ?>\n    <h1>Forgot Password</h1>\n    <form action=\"\" method=\"post\">\n        <label for=\"email\">Email:</label>\n        <input type=\"email\" id=\"email\" name=\"email\" required><br><br>\n        <button type=\"submit\">Submit</button>\n    </form>\n    <?php\n}\n\n?>\n```"]}
