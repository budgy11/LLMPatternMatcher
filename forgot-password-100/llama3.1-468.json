{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a simple \"Forgot Password\" function in PHP that emails the user their new password. This code assumes you have already set up a database to store users' information and that you are using MySQL as your database management system.\n\n**Please note:**\n\n*   This is a basic implementation and should not be used for production without proper security measures.\n*   Always use HTTPS (SSL/TLS) when transferring passwords over the internet.\n*   Use secure password hashing algorithms like bcrypt or Argon2 to store passwords securely.\n*   Validate user input properly to prevent SQL injection.\n\n**`forgot_password.php`**\n```php\n<?php\n\n// Configuration variables\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to the database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Check if form has been submitted\nif (isset($_POST['submit'])) {\n\n    // Sanitize input\n    $email = filter_var($_POST['email'], FILTER_SANITIZE_EMAIL);\n\n    // Query to get user's information from database\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n\n    // Execute query and get result\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n\n        // Get user's ID, username, and password (hashed)\n        $user_data = $result->fetch_assoc();\n        $user_id = $user_data['id'];\n        $username = $user_data['username'];\n        $password_hash = $user_data['password'];\n\n        // Generate a new password\n        $new_password = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 10);\n\n        // Update user's password in the database\n        $update_query = \"UPDATE users SET password = '$new_password' WHERE id = '$user_id'\";\n        $conn->query($update_query);\n\n        // Send email with new password\n        $to_email = $email;\n        $subject = 'Your new password';\n        $body = 'Dear ' . $username . ', your new password is: ' . $new_password;\n\n        // Email configuration variables (replace with actual settings)\n        $from_email = 'your_email@example.com';\n        $smtp_host = 'smtp.example.com';\n        $smtp_username = 'your_smtp_username';\n        $smtp_password = 'your_smtp_password';\n\n        // Send email using PHPMailer or your preferred email library\n        require_once 'PHPMailer/PHPMailerAutoload.php'; // Replace with actual location\n        $mail = new PHPMailer(true);\n\n        try {\n            // Setup email\n            $mail->isSMTP();\n            $mail->Host = $smtp_host;\n            $mail->SMTPAuth = true;\n            $mail->Username = $smtp_username;\n            $mail->Password = $smtp_password;\n            $mail->From = $from_email;\n            $mail->FromName = 'Your Website';\n            $mail->AddAddress($to_email);\n            $mail->IsHTML(true);\n\n            // Set email body\n            $mail->Subject = $subject;\n            $mail->Body = $body;\n\n            // Send email\n            if (!$mail->Send()) {\n                throw new Exception('Error sending email');\n            }\n\n        } catch (Exception $e) {\n            echo 'Email not sent: ' . $mail->ErrorInfo;\n        }\n\n    } else {\n        echo 'No user found with that email';\n    }\n}\n\n// Close database connection\n$conn->close();\n\n?>\n```\nThis code does the following:\n\n1.  Connects to your MySQL database using PHP's `mysqli` extension.\n2.  Checks if the form has been submitted by verifying the existence of a POST variable named `submit`.\n3.  Sanitizes the email input using the `filter_var()` function.\n4.  Queries the database for user information with the provided email address.\n5.  If a matching user is found, generates a new password and updates it in the database.\n6.  Sends an email to the user's registered email address with their new password.\n\nMake sure you replace placeholders like `your_username`, `your_password`, etc., with your actual database credentials and settings. This example assumes you are using PHPMailer for sending emails; modify this part according to your email library of choice or mail server configuration.", "code_blocks": ["```php\n<?php\n\n// Configuration variables\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to the database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Check if form has been submitted\nif (isset($_POST['submit'])) {\n\n    // Sanitize input\n    $email = filter_var($_POST['email'], FILTER_SANITIZE_EMAIL);\n\n    // Query to get user's information from database\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n\n    // Execute query and get result\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n\n        // Get user's ID, username, and password (hashed)\n        $user_data = $result->fetch_assoc();\n        $user_id = $user_data['id'];\n        $username = $user_data['username'];\n        $password_hash = $user_data['password'];\n\n        // Generate a new password\n        $new_password = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 10);\n\n        // Update user's password in the database\n        $update_query = \"UPDATE users SET password = '$new_password' WHERE id = '$user_id'\";\n        $conn->query($update_query);\n\n        // Send email with new password\n        $to_email = $email;\n        $subject = 'Your new password';\n        $body = 'Dear ' . $username . ', your new password is: ' . $new_password;\n\n        // Email configuration variables (replace with actual settings)\n        $from_email = 'your_email@example.com';\n        $smtp_host = 'smtp.example.com';\n        $smtp_username = 'your_smtp_username';\n        $smtp_password = 'your_smtp_password';\n\n        // Send email using PHPMailer or your preferred email library\n        require_once 'PHPMailer/PHPMailerAutoload.php'; // Replace with actual location\n        $mail = new PHPMailer(true);\n\n        try {\n            // Setup email\n            $mail->isSMTP();\n            $mail->Host = $smtp_host;\n            $mail->SMTPAuth = true;\n            $mail->Username = $smtp_username;\n            $mail->Password = $smtp_password;\n            $mail->From = $from_email;\n            $mail->FromName = 'Your Website';\n            $mail->AddAddress($to_email);\n            $mail->IsHTML(true);\n\n            // Set email body\n            $mail->Subject = $subject;\n            $mail->Body = $body;\n\n            // Send email\n            if (!$mail->Send()) {\n                throw new Exception('Error sending email');\n            }\n\n        } catch (Exception $e) {\n            echo 'Email not sent: ' . $mail->ErrorInfo;\n        }\n\n    } else {\n        echo 'No user found with that email';\n    }\n}\n\n// Close database connection\n$conn->close();\n\n?>\n```"]}
