{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n====================================\n\nThe following is an example of how to create a forgot password function using PHP. This script will send a link to the user's email with a token that they can use to reset their password.\n\n**Database Setup**\n\nFirst, you'll need to set up your database table for storing users and their passwords (using hashing). We'll assume you have the following columns:\n\n* `id`\n* `email`\n* `password` (hashed using PHP's built-in hash library)\n* `token` (for token-based password reset)\n\n**PHP Code**\n\n```php\n// Require the configuration file and database connection script\nrequire_once 'config.php';\nrequire_once 'db_connection.php';\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get user's email\n    $email = $_POST['email'];\n\n    // Query database to find user by email\n    $stmt = $mysqli->prepare(\"SELECT * FROM users WHERE email = ?\");\n    $stmt->bind_param('s', $email);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // User exists, generate and store token\n        $user = $result->fetch_assoc();\n        $token = bin2hex(random_bytes(32));\n\n        // Update user's token in database\n        $update_stmt = $mysqli->prepare(\"UPDATE users SET token = ? WHERE id = ?\");\n        $update_stmt->bind_param('si', $token, $user['id']);\n        $update_stmt->execute();\n\n        // Send email with reset link\n        send_reset_email($email, $token);\n\n        echo \"A password reset link has been sent to your email.\";\n    } else {\n        echo \"User not found.\";\n    }\n}\n\n// Function to send password reset email\nfunction send_reset_email($email, $token) {\n    // Your mail configuration settings\n    $mail_config = array(\n        'host' => 'smtp.example.com',\n        'port' => 587,\n        'username' => 'your-email@example.com',\n        'password' => 'your-password'\n    );\n\n    // Create a new instance of PHPMailer\n    require_once 'phpmailer/PHPMailer.php';\n    $mail = new \\PHPMailer\\PHPMailer\\PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = $mail_config['host'];\n    $mail->Port = $mail_config['port'];\n    $mail->SMTPAuth = true;\n    $mail->Username = $mail_config['username'];\n    $mail->Password = $mail_config['password'];\n\n    // Set From and To email addresses\n    $mail->setFrom($mail_config['username'], 'Your Name');\n    $mail->addAddress($email);\n\n    // Set email content\n    $reset_link = \"http://example.com/reset-password.php?token=$token\";\n    $body = \"Hello,\\n\\nClick this link to reset your password: $reset_link\\n\\nBest regards, The System\";\n\n    $mail->isHTML(true);\n    $mail->Subject = 'Reset Your Password';\n    $mail->Body = $body;\n\n    // Send the email\n    if (!$mail->send()) {\n        echo 'Error sending mail: ' . $mail->ErrorInfo;\n    }\n}\n```\n\n**Usage**\n\nTo use this function, simply access the following URL in your web browser:\n\n`http://example.com/forgot-password.php`\n\nThis will display a form for entering the user's email address. After submitting the form, an email with a password reset link will be sent to the user.\n\nThe password reset link is in the format: `http://example.com/reset-password.php?token=your_token_here`", "code_blocks": ["```php\n// Require the configuration file and database connection script\nrequire_once 'config.php';\nrequire_once 'db_connection.php';\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get user's email\n    $email = $_POST['email'];\n\n    // Query database to find user by email\n    $stmt = $mysqli->prepare(\"SELECT * FROM users WHERE email = ?\");\n    $stmt->bind_param('s', $email);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // User exists, generate and store token\n        $user = $result->fetch_assoc();\n        $token = bin2hex(random_bytes(32));\n\n        // Update user's token in database\n        $update_stmt = $mysqli->prepare(\"UPDATE users SET token = ? WHERE id = ?\");\n        $update_stmt->bind_param('si', $token, $user['id']);\n        $update_stmt->execute();\n\n        // Send email with reset link\n        send_reset_email($email, $token);\n\n        echo \"A password reset link has been sent to your email.\";\n    } else {\n        echo \"User not found.\";\n    }\n}\n\n// Function to send password reset email\nfunction send_reset_email($email, $token) {\n    // Your mail configuration settings\n    $mail_config = array(\n        'host' => 'smtp.example.com',\n        'port' => 587,\n        'username' => 'your-email@example.com',\n        'password' => 'your-password'\n    );\n\n    // Create a new instance of PHPMailer\n    require_once 'phpmailer/PHPMailer.php';\n    $mail = new \\PHPMailer\\PHPMailer\\PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = $mail_config['host'];\n    $mail->Port = $mail_config['port'];\n    $mail->SMTPAuth = true;\n    $mail->Username = $mail_config['username'];\n    $mail->Password = $mail_config['password'];\n\n    // Set From and To email addresses\n    $mail->setFrom($mail_config['username'], 'Your Name');\n    $mail->addAddress($email);\n\n    // Set email content\n    $reset_link = \"http://example.com/reset-password.php?token=$token\";\n    $body = \"Hello,\\n\\nClick this link to reset your password: $reset_link\\n\\nBest regards, The System\";\n\n    $mail->isHTML(true);\n    $mail->Subject = 'Reset Your Password';\n    $mail->Body = $body;\n\n    // Send the email\n    if (!$mail->send()) {\n        echo 'Error sending mail: ' . $mail->ErrorInfo;\n    }\n}\n```"]}
