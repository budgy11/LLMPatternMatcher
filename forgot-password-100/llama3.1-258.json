{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nIn this example, we will create a simple \"forgot password\" function using PHP. This function will send an email to the user with a link to reset their password.\n\n**Database Schema**\n-------------------\n\nFor this example, let's assume we have a database table called `users` with the following schema:\n\n| Column Name | Data Type |\n| --- | --- |\n| id | int (primary key) |\n| username | varchar(50) |\n| email | varchar(100) |\n| password | varchar(255) |\n\n**PHP Code**\n-------------\n\n### Forgot Password Function\n\n```php\nfunction forgot_password($username, $email)\n{\n    // Validate input data\n    if (!$username || !$email) {\n        return 'Please enter both username and email';\n    }\n\n    // Connect to database\n    $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n    // Query the database for user data\n    $stmt = $db->prepare(\"SELECT * FROM users WHERE username = :username AND email = :email\");\n    $stmt->bindParam(':username', $username);\n    $stmt->bindParam(':email', $email);\n    $stmt->execute();\n\n    if ($stmt->rowCount() > 0) {\n        // Get user data\n        $user_data = $stmt->fetch(PDO::FETCH_ASSOC);\n\n        // Generate a unique token for password reset\n        $token = bin2hex(random_bytes(32));\n\n        // Update the user's token in the database\n        $stmt = $db->prepare(\"UPDATE users SET password_reset_token = :token WHERE id = :id\");\n        $stmt->bindParam(':token', $token);\n        $stmt->bindParam(':id', $user_data['id']);\n        $stmt->execute();\n\n        // Send email to user with reset link\n        send_password_reset_email($email, $token);\n\n        return 'Email sent to ' . $email;\n    } else {\n        return 'User not found';\n    }\n}\n\nfunction send_password_reset_email($email, $token)\n{\n    // Email configuration (replace with your own settings)\n    $subject = 'Reset Your Password';\n    $from = 'your_email@example.com';\n    $to = $email;\n\n    // Create email body\n    $body = \"\n        <p>Hello,\n        \n        You are receiving this email because you requested to reset your password.\n        \n        To reset your password, please click the following link:\n        <a href='http://example.com/reset-password?token=$token'>Reset Password</a>\n        \n        Best regards,\n        Your Website\n    \";\n\n    // Send email using PHPMailer or any other library (replace with your own settings)\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->Username = 'your_email@example.com';\n    $mail->Password = 'your_password';\n    $mail->setFrom($from, 'Your Website');\n    $mail->addAddress($to);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n    $mail->send();\n}\n```\n\n**Example Usage**\n-----------------\n\nTo use this function, simply call `forgot_password()` and pass in the user's username and email:\n\n```php\n$username = 'example_user';\n$email = 'example@example.com';\n\necho forgot_password($username, $email);\n```\n\nThis will send an email to the user with a link to reset their password.\n\n**Note**\n-------\n\n* This is a basic implementation and should be adapted to your specific needs.\n* Make sure to secure your database credentials and replace them in the code above.\n* You may also want to add additional validation and security measures, such as verifying the token on each request.", "code_blocks": ["```php\nfunction forgot_password($username, $email)\n{\n    // Validate input data\n    if (!$username || !$email) {\n        return 'Please enter both username and email';\n    }\n\n    // Connect to database\n    $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);\n\n    // Query the database for user data\n    $stmt = $db->prepare(\"SELECT * FROM users WHERE username = :username AND email = :email\");\n    $stmt->bindParam(':username', $username);\n    $stmt->bindParam(':email', $email);\n    $stmt->execute();\n\n    if ($stmt->rowCount() > 0) {\n        // Get user data\n        $user_data = $stmt->fetch(PDO::FETCH_ASSOC);\n\n        // Generate a unique token for password reset\n        $token = bin2hex(random_bytes(32));\n\n        // Update the user's token in the database\n        $stmt = $db->prepare(\"UPDATE users SET password_reset_token = :token WHERE id = :id\");\n        $stmt->bindParam(':token', $token);\n        $stmt->bindParam(':id', $user_data['id']);\n        $stmt->execute();\n\n        // Send email to user with reset link\n        send_password_reset_email($email, $token);\n\n        return 'Email sent to ' . $email;\n    } else {\n        return 'User not found';\n    }\n}\n\nfunction send_password_reset_email($email, $token)\n{\n    // Email configuration (replace with your own settings)\n    $subject = 'Reset Your Password';\n    $from = 'your_email@example.com';\n    $to = $email;\n\n    // Create email body\n    $body = \"\n        <p>Hello,\n        \n        You are receiving this email because you requested to reset your password.\n        \n        To reset your password, please click the following link:\n        <a href='http://example.com/reset-password?token=$token'>Reset Password</a>\n        \n        Best regards,\n        Your Website\n    \";\n\n    // Send email using PHPMailer or any other library (replace with your own settings)\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->Username = 'your_email@example.com';\n    $mail->Password = 'your_password';\n    $mail->setFrom($from, 'Your Website');\n    $mail->addAddress($to);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n    $mail->send();\n}\n```", "```php\n$username = 'example_user';\n$email = 'example@example.com';\n\necho forgot_password($username, $email);\n```"]}
