{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how to create a \"Forgot Password\" function in PHP:\n\n**Step 1: Database Setup**\n\nFirst, you need to set up your database with a table for users. Here's an example SQL query:\n```sql\nCREATE TABLE users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    email VARCHAR(255) UNIQUE NOT NULL,\n    password_hash VARCHAR(255) NOT NULL\n);\n```\n**Step 2: PHP Code**\n\nCreate a new PHP file (e.g., `forgot_password.php`) and add the following code:\n```php\n<?php\n\n// Configuration settings\ndefine('DB_HOST', 'your_host');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n}\n\n// Function to check if email exists in database\nfunction check_email_exists($email) {\n    global $mysqli;\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $mysqli->query($query);\n    return $result->num_rows > 0;\n}\n\n// Function to send password reset link via email\nfunction send_password_reset_link($email, $token) {\n    global $mysqli;\n    // Email settings (e.g., SMTP)\n    $to = $email;\n    $subject = \"Password Reset Link\";\n    $body = \"<p>Click on the following link to reset your password:</p>\n            <a href='https://your-website.com/reset_password.php?token=$token'>$token</a>\";\n\n    // Send email using PHPMailer or SMTP\n}\n\n// Function to handle forgot password request\nfunction forgot_password($email) {\n    global $mysqli;\n    // Check if email exists in database\n    if (check_email_exists($email)) {\n        // Generate random token for password reset link\n        $token = bin2hex(random_bytes(16));\n        // Update user's token in database\n        $query = \"UPDATE users SET token = '$token' WHERE email = '$email'\";\n        $mysqli->query($query);\n\n        // Send password reset link via email\n        send_password_reset_link($email, $token);\n    } else {\n        echo \"Email does not exist in our records.\";\n    }\n}\n\n// Handle forgot password request\nif (isset($_POST['forgot_password'])) {\n    $email = trim($_POST['email']);\n    forgot_password($email);\n} elseif (isset($_GET['token'])) {\n    // If token is passed, it means user clicked on the reset link. In this case,\n    // you can redirect them to a page where they can enter their new password.\n}\n\n?>\n```\n**Step 3: HTML Form**\n\nCreate an HTML form for users to submit their email address:\n```html\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Email Address\">\n    <button type=\"submit\" name=\"forgot_password\">Forgot Password</button>\n</form>\n```\n**How it works**\n\n1. When a user submits the forgot password form, the `forgot_password()` function is called with their email address.\n2. The `check_email_exists()` function checks if the email address exists in the database. If it does, the `send_password_reset_link()` function generates a random token for the password reset link and sends an email to the user with the link.\n3. When the user clicks on the password reset link, the `token` parameter is passed to the script. In this case, you can redirect them to a page where they can enter their new password.\n\nNote: This code assumes that you have PHPMailer or SMTP set up for sending emails. You'll need to modify the `send_password_reset_link()` function accordingly.\n\nAlso, keep in mind that this is a basic example and you should consider implementing additional security measures, such as:\n\n* Hashing passwords using a library like bcrypt\n* Implementing token-based authentication (e.g., JWT)\n* Using HTTPS to encrypt communication between client and server\n\nI hope this helps! Let me know if you have any questions or need further clarification.", "code_blocks": [null, "```php\n<?php\n\n// Configuration settings\ndefine('DB_HOST', 'your_host');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n}\n\n// Function to check if email exists in database\nfunction check_email_exists($email) {\n    global $mysqli;\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $mysqli->query($query);\n    return $result->num_rows > 0;\n}\n\n// Function to send password reset link via email\nfunction send_password_reset_link($email, $token) {\n    global $mysqli;\n    // Email settings (e.g., SMTP)\n    $to = $email;\n    $subject = \"Password Reset Link\";\n    $body = \"<p>Click on the following link to reset your password:</p>\n            <a href='https://your-website.com/reset_password.php?token=$token'>$token</a>\";\n\n    // Send email using PHPMailer or SMTP\n}\n\n// Function to handle forgot password request\nfunction forgot_password($email) {\n    global $mysqli;\n    // Check if email exists in database\n    if (check_email_exists($email)) {\n        // Generate random token for password reset link\n        $token = bin2hex(random_bytes(16));\n        // Update user's token in database\n        $query = \"UPDATE users SET token = '$token' WHERE email = '$email'\";\n        $mysqli->query($query);\n\n        // Send password reset link via email\n        send_password_reset_link($email, $token);\n    } else {\n        echo \"Email does not exist in our records.\";\n    }\n}\n\n// Handle forgot password request\nif (isset($_POST['forgot_password'])) {\n    $email = trim($_POST['email']);\n    forgot_password($email);\n} elseif (isset($_GET['token'])) {\n    // If token is passed, it means user clicked on the reset link. In this case,\n    // you can redirect them to a page where they can enter their new password.\n}\n\n?>\n```", null]}
