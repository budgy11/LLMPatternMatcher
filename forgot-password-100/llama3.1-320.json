{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of a simple \"forgot password\" function in PHP, including HTML and CSS for a basic layout. This system sends a new random password to the user's email address.\n\n**Important Notes:**\n\n1. For this to work you'll need access to your server's mail settings.\n2. The database schema is assumed as following:\n   - `users` table with fields: `id`, `email`, `password`\n\n**Database Setup (using MySQL):**\n\n```sql\nCREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  email VARCHAR(255),\n  password VARCHAR(255)\n);\n```\n\n**PHP File (`forgot_password.php`):**\n\n```php\n<?php\n\n// Configuration settings\ndefine('DB_HOST', 'your_host');\ndefine('DB_USER', 'your_username');\ndefine ('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to Database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Handle the form submission\nif (isset($_POST['submit'])) {\n    $email = $_POST['email'];\n\n    // Query to check for user existence\n    $sql = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        $row = $result->fetch_assoc();\n\n        // Generate a new password\n        $new_password = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 8);\n        \n        // Update the user's password in database\n        $update_sql = \"UPDATE users SET password = '$new_password' WHERE email = '$email'\";\n        $conn->query($update_sql);\n\n        // Email settings\n        $to = $email;\n        $subject = 'Your new password';\n        $message = 'Dear User, your new password is: '.$new_password;\n\n        // Send the email using mail() function (this is a basic example and may require configuration)\n        if(mail($to,$subject,$message)) {\n            echo '<div class=\"alert alert-success\">New password sent successfully!</div>';\n        } else {\n            echo '<div class=\"alert alert-danger\">Failed to send new password.</div>';\n        }\n    } else {\n        echo '<div class=\"alert alert-danger\">User not found.</div>';\n    }\n}\n\n// Close database connection\n$conn->close();\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Forgot Password</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n        }\n        .alert {\n            padding: 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        }\n        .success {\n            background-color: #3e8e41;\n            color: white;\n        }\n        .danger {\n            background-color: #dc3545;\n            color: white;\n        }\n    </style>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\"><br><br>\n    <button type=\"submit\" class=\"btn btn-primary\" name=\"submit\">Send new password</button>\n</form>\n\n<?php\n// Display any messages here\n?>\n\n</body>\n</html>\n```\n\nThis script performs the following actions:\n\n1. Connects to a MySQL database.\n2. Checks if a user exists with the provided email address.\n3. Generates a random password and updates it in the database for that user.\n4. Sends an email to the user with their new password using PHP's `mail()` function.\n\nRemember, this is a very basic example. A real-world application would likely use a more secure method of generating and sending passwords (e.g., via a service like Mailgun), especially considering security best practices for storing sensitive information like passwords securely in the database.", "code_blocks": [null, "```php\n<?php\n\n// Configuration settings\ndefine('DB_HOST', 'your_host');\ndefine('DB_USER', 'your_username');\ndefine ('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to Database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Handle the form submission\nif (isset($_POST['submit'])) {\n    $email = $_POST['email'];\n\n    // Query to check for user existence\n    $sql = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        $row = $result->fetch_assoc();\n\n        // Generate a new password\n        $new_password = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 8);\n        \n        // Update the user's password in database\n        $update_sql = \"UPDATE users SET password = '$new_password' WHERE email = '$email'\";\n        $conn->query($update_sql);\n\n        // Email settings\n        $to = $email;\n        $subject = 'Your new password';\n        $message = 'Dear User, your new password is: '.$new_password;\n\n        // Send the email using mail() function (this is a basic example and may require configuration)\n        if(mail($to,$subject,$message)) {\n            echo '<div class=\"alert alert-success\">New password sent successfully!</div>';\n        } else {\n            echo '<div class=\"alert alert-danger\">Failed to send new password.</div>';\n        }\n    } else {\n        echo '<div class=\"alert alert-danger\">User not found.</div>';\n    }\n}\n\n// Close database connection\n$conn->close();\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Forgot Password</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n        }\n        .alert {\n            padding: 15px;\n            border-radius: 5px;\n            margin-bottom: 20px;\n        }\n        .success {\n            background-color: #3e8e41;\n            color: white;\n        }\n        .danger {\n            background-color: #dc3545;\n            color: white;\n        }\n    </style>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\"><br><br>\n    <button type=\"submit\" class=\"btn btn-primary\" name=\"submit\">Send new password</button>\n</form>\n\n<?php\n// Display any messages here\n?>\n\n</body>\n</html>\n```"]}
