{"prompt": "Create a user login function using php", "llm_output": "Here is an example of a basic user login function in PHP:\n\n**Database Table Structure**\n\nLet's assume we have a database table called `users` with the following structure:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL\n);\n```\n**Login Function**\n\nThe login function will check if a user exists in the database and if their password matches.\n```php\n// functions.php\n\nfunction login_user($username, $password) {\n  // Connect to the database\n  require_once 'db.php';\n  $conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\n  // Check connection\n  if (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n  }\n\n  // Query the database for the user\n  $query = \"SELECT * FROM users WHERE username = '$username'\";\n  $result = mysqli_query($conn, $query);\n\n  // Check if a user exists\n  if (mysqli_num_rows($result) == 1) {\n    // Get the user's data from the result set\n    $user_data = mysqli_fetch_assoc($result);\n    \n    // Hash the password provided by the user with salt\n    $salt = \"your_salt\";\n    $password_hashed = hash('sha256', $password . $salt);\n\n    // Check if the hashed password matches the one in the database\n    if ($password_hashed == $user_data['password']) {\n      // If it matches, create a session for the user and return their data\n      $_SESSION['username'] = $user_data['username'];\n      $_SESSION['email'] = $user_data['email'];\n\n      echo \"Login successful!\";\n      return true;\n    } else {\n      echo \"Incorrect password\";\n      return false;\n    }\n  } else {\n    // If no user exists, display an error message\n    echo \"User does not exist\";\n    return false;\n  }\n\n  // Close the connection\n  mysqli_close($conn);\n}\n```\n**Example Use Case**\n\n```php\n// login.php\n\nrequire_once 'functions.php';\n\nif (isset($_POST['username']) && isset($_POST['password'])) {\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  if (login_user($username, $password)) {\n    // If the login is successful, redirect to a protected page\n    header('Location: protected-page.php');\n    exit;\n  }\n}\n\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <input type=\"text\" name=\"username\" placeholder=\"Username\">\n  <input type=\"password\" name=\"password\" placeholder=\"Password\">\n  <button type=\"submit\">Login</button>\n</form>\n```\n**Security Note**\n\n* This is a basic example and should not be used in production without proper security measures.\n* Passwords should always be stored hashed (e.g. with `hash('sha256', $password)`) and never plain text.\n* Use prepared statements to prevent SQL injection attacks.\n* This code does not include CSRF protection, which should also be implemented for security reasons.\n\nPlease adjust the code according to your specific requirements and follow best practices for security and coding standards.", "code_blocks": [null, "```php\n// functions.php\n\nfunction login_user($username, $password) {\n  // Connect to the database\n  require_once 'db.php';\n  $conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\n  // Check connection\n  if (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n  }\n\n  // Query the database for the user\n  $query = \"SELECT * FROM users WHERE username = '$username'\";\n  $result = mysqli_query($conn, $query);\n\n  // Check if a user exists\n  if (mysqli_num_rows($result) == 1) {\n    // Get the user's data from the result set\n    $user_data = mysqli_fetch_assoc($result);\n    \n    // Hash the password provided by the user with salt\n    $salt = \"your_salt\";\n    $password_hashed = hash('sha256', $password . $salt);\n\n    // Check if the hashed password matches the one in the database\n    if ($password_hashed == $user_data['password']) {\n      // If it matches, create a session for the user and return their data\n      $_SESSION['username'] = $user_data['username'];\n      $_SESSION['email'] = $user_data['email'];\n\n      echo \"Login successful!\";\n      return true;\n    } else {\n      echo \"Incorrect password\";\n      return false;\n    }\n  } else {\n    // If no user exists, display an error message\n    echo \"User does not exist\";\n    return false;\n  }\n\n  // Close the connection\n  mysqli_close($conn);\n}\n```", "```php\n// login.php\n\nrequire_once 'functions.php';\n\nif (isset($_POST['username']) && isset($_POST['password'])) {\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  if (login_user($username, $password)) {\n    // If the login is successful, redirect to a protected page\n    header('Location: protected-page.php');\n    exit;\n  }\n}\n\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <input type=\"text\" name=\"username\" placeholder=\"Username\">\n  <input type=\"password\" name=\"password\" placeholder=\"Password\">\n  <button type=\"submit\">Login</button>\n</form>\n```"]}
