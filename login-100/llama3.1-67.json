{"prompt": "Create a user login function using php", "llm_output": "Here's an example of a simple user login function in PHP:\n\n**login.php**\n```php\n<?php\n// Configuration settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to the database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to check user credentials\nfunction login_user($username, $password) {\n    global $conn;\n    // SQL query to select the user from the database\n    $sql = \"SELECT * FROM users WHERE username = '$username'\";\n    \n    // Execute the query and store the result in an array\n    $result = mysqli_query($conn, $sql);\n    \n    if ($result->num_rows > 0) {\n        // If a user is found, retrieve their data\n        while ($row = $result->fetch_assoc()) {\n            if (password_verify($password, $row['password'])) {\n                // User credentials match; return the user's ID and username\n                return array('user_id' => $row['id'], 'username' => $row['username']);\n            }\n        }\n    }\n    \n    // If no user is found or passwords don't match, return null\n    return null;\n}\n\n// Example usage:\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n    \n    $user_data = login_user($username, $password);\n    \n    if ($user_data !== null) {\n        // User is logged in; store their ID and username as session variables\n        session_start();\n        $_SESSION['logged_in'] = true;\n        $_SESSION['user_id'] = $user_data['user_id'];\n        $_SESSION['username'] = $user_data['username'];\n        \n        // Redirect to a protected page (e.g. dashboard.php)\n        header(\"Location: dashboard.php\");\n        exit;\n    } else {\n        echo \"Invalid username or password.\";\n    }\n}\n?>\n```\nThis example demonstrates the following:\n\n1. **Database connection**: We establish a connection to the database using `mysqli`.\n2. **Login function**: The `login_user` function checks user credentials by:\n\t* Retrieving the user's data from the database using an SQL query.\n\t* Verifying the password using `password_verify`.\n3. **Example usage**: We demonstrate how to use the `login_user` function with a simple form submission.\n\nNote that this example uses `mysqli`, which is considered outdated in favor of `PDO` (PHP Data Objects). If you're building a new application, consider using `PDO`.\n\nTo enhance security:\n\n1. Use prepared statements or parameterized queries.\n2. Store passwords securely using a library like `password_hash`.\n3. Implement additional authentication and authorization mechanisms (e.g., session-based, token-based).\n\nRemember to replace the placeholders (`your_username`, `your_password`, etc.) with your actual database credentials!", "code_blocks": ["```php\n<?php\n// Configuration settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to the database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to check user credentials\nfunction login_user($username, $password) {\n    global $conn;\n    // SQL query to select the user from the database\n    $sql = \"SELECT * FROM users WHERE username = '$username'\";\n    \n    // Execute the query and store the result in an array\n    $result = mysqli_query($conn, $sql);\n    \n    if ($result->num_rows > 0) {\n        // If a user is found, retrieve their data\n        while ($row = $result->fetch_assoc()) {\n            if (password_verify($password, $row['password'])) {\n                // User credentials match; return the user's ID and username\n                return array('user_id' => $row['id'], 'username' => $row['username']);\n            }\n        }\n    }\n    \n    // If no user is found or passwords don't match, return null\n    return null;\n}\n\n// Example usage:\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n    \n    $user_data = login_user($username, $password);\n    \n    if ($user_data !== null) {\n        // User is logged in; store their ID and username as session variables\n        session_start();\n        $_SESSION['logged_in'] = true;\n        $_SESSION['user_id'] = $user_data['user_id'];\n        $_SESSION['username'] = $user_data['username'];\n        \n        // Redirect to a protected page (e.g. dashboard.php)\n        header(\"Location: dashboard.php\");\n        exit;\n    } else {\n        echo \"Invalid username or password.\";\n    }\n}\n?>\n```"]}
