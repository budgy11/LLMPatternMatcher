{"prompt": "Create a user login function using php", "llm_output": "Here is an example of a simple user login function in PHP:\n\n**login.php**\n```php\n<?php\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Create a database connection\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction login_user() {\n    // Get user input\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Check if username and password are set\n    if (empty($username) || empty($password)) {\n        return array('error' => 'Username or password is required');\n    }\n\n    // Hash the password for comparison\n    $hashed_password = hash('sha256', $password);\n\n    // Query to check user credentials\n    $query = \"SELECT * FROM users WHERE username = '$username' AND password = '$hashed_password'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // User exists, return their ID and role\n        $row = $result->fetch_assoc();\n        return array('success' => true, 'user_id' => $row['id'], 'role' => $row['role']);\n    } else {\n        // User does not exist or incorrect password\n        return array('error' => 'Invalid username or password');\n    }\n}\n\n// Check if login form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Call the login_user function and store result in $result variable\n    $result = login_user();\n\n    // Check if user logged in successfully\n    if ($result['success']) {\n        // Redirect to dashboard or other protected page\n        header('Location: dashboard.php');\n        exit;\n    } else {\n        // Display error message\n        echo 'Error logging in: ' . $result['error'];\n    }\n} else {\n    // Display login form\n    ?>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        <label>Username:</label>\n        <input type=\"text\" name=\"username\"><br><br>\n        <label>Password:</label>\n        <input type=\"password\" name=\"password\"><br><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n    <?php\n}\n\n?>\n```\nThis code defines a `login_user` function that takes in the username and password, hashes the password for comparison with the stored hash, and checks if the user exists in the database. If the user is found, it returns their ID and role.\n\nThe script then checks if the login form has been submitted (using `$_SERVER['REQUEST_METHOD'] == 'POST'`) and calls the `login_user` function to check user credentials. If the user logs in successfully, it redirects them to a protected page (in this case, `dashboard.php`). Otherwise, it displays an error message.\n\nNote that this is a basic example and you should consider implementing additional security measures such as:\n\n* Using prepared statements to prevent SQL injection\n* Hashing passwords with a library like bcrypt\n* Storing session data securely using a library like PHP's built-in session extension\n* Implementing rate limiting or IP blocking for brute-force attacks\n\nAlso, make sure to replace the placeholder database connection settings with your actual database credentials.", "code_blocks": ["```php\n<?php\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Create a database connection\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction login_user() {\n    // Get user input\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Check if username and password are set\n    if (empty($username) || empty($password)) {\n        return array('error' => 'Username or password is required');\n    }\n\n    // Hash the password for comparison\n    $hashed_password = hash('sha256', $password);\n\n    // Query to check user credentials\n    $query = \"SELECT * FROM users WHERE username = '$username' AND password = '$hashed_password'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // User exists, return their ID and role\n        $row = $result->fetch_assoc();\n        return array('success' => true, 'user_id' => $row['id'], 'role' => $row['role']);\n    } else {\n        // User does not exist or incorrect password\n        return array('error' => 'Invalid username or password');\n    }\n}\n\n// Check if login form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Call the login_user function and store result in $result variable\n    $result = login_user();\n\n    // Check if user logged in successfully\n    if ($result['success']) {\n        // Redirect to dashboard or other protected page\n        header('Location: dashboard.php');\n        exit;\n    } else {\n        // Display error message\n        echo 'Error logging in: ' . $result['error'];\n    }\n} else {\n    // Display login form\n    ?>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        <label>Username:</label>\n        <input type=\"text\" name=\"username\"><br><br>\n        <label>Password:</label>\n        <input type=\"password\" name=\"password\"><br><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n    <?php\n}\n\n?>\n```"]}
