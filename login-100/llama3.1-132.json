{"prompt": "Create a user login function using php", "llm_output": "Here's an example of a basic user login function using PHP, MySQLi, and password hashing:\n\n**Database Setup:**\n\nFirst, create a database named `users` with the following table structure:\n```sql\nCREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL,\n  password_hash VARCHAR(255) NOT NULL\n);\n```\n**Login Function:**\n```php\n<?php\n\n// Include database connection settings\nrequire_once 'db.php';\n\nfunction login($username, $password) {\n  // Hash the input password for comparison\n  $hashed_password = hash('sha256', $password);\n\n  // Query database to retrieve user data\n  $query = \"SELECT * FROM users WHERE username = '$username' AND password_hash = '$hashed_password'\";\n  $result = mysqli_query($db, $query);\n\n  if ($result->num_rows == 1) {\n    // Login successful, return user ID and session variables\n    $row = $result->fetch_assoc();\n    $_SESSION['user_id'] = $row['id'];\n    $_SESSION['username'] = $row['username'];\n\n    return true;\n  } else {\n    // Login failed, display error message\n    echo 'Invalid username or password';\n    return false;\n  }\n}\n\n?>\n```\n**Database Connection (db.php):**\n```php\n<?php\n\n// Database connection settings\n$host = 'localhost';\n$username = 'your_username';\n$password = 'your_password';\n$dbname = 'users';\n\n// Establish database connection\n$db = new mysqli($host, $username, $password, $dbname);\n\nif ($db->connect_error) {\n  die(\"Connection failed: \" . $db->connect_error);\n}\n\n?>\n```\n**Login Form (login.php):**\n```php\n<?php\n\nrequire_once 'db.php';\nrequire_once 'login_function.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Handle form submission\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  if (login($username, $password)) {\n    header('Location: index.php');\n    exit;\n  }\n}\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Login</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"username\">Username:</label>\n  <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n  <label for=\"password\">Password:</label>\n  <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n  <button type=\"submit\">Login</button>\n</form>\n\n<?php if (isset($_GET['error'])) : ?>\n  <p style=\"color: red;\"><?php echo $_GET['error']; ?></p>\n<?php endif; ?>\n\n</body>\n</html>\n```\n**Example Use Case:**\n\n1. Open the `login.php` file in your web browser.\n2. Fill out the username and password fields with valid credentials.\n3. Click the \"Login\" button to submit the form.\n4. If the login is successful, you will be redirected to the `index.php` page.\n\nNote:\n\n* This example uses a simple password hashing algorithm (SHA-256) for demonstration purposes only. In production environments, consider using more secure algorithms like bcrypt or Argon2.\n* Always keep your database connection settings and credentials secure by not hard-coding them directly in your code.\n* Consider implementing additional security measures such as CSRF protection, rate limiting, and password reset functionality.\n\nI hope this example helps you get started with creating a user login function using PHP!", "code_blocks": [null, "```php\n<?php\n\n// Include database connection settings\nrequire_once 'db.php';\n\nfunction login($username, $password) {\n  // Hash the input password for comparison\n  $hashed_password = hash('sha256', $password);\n\n  // Query database to retrieve user data\n  $query = \"SELECT * FROM users WHERE username = '$username' AND password_hash = '$hashed_password'\";\n  $result = mysqli_query($db, $query);\n\n  if ($result->num_rows == 1) {\n    // Login successful, return user ID and session variables\n    $row = $result->fetch_assoc();\n    $_SESSION['user_id'] = $row['id'];\n    $_SESSION['username'] = $row['username'];\n\n    return true;\n  } else {\n    // Login failed, display error message\n    echo 'Invalid username or password';\n    return false;\n  }\n}\n\n?>\n```", "```php\n<?php\n\n// Database connection settings\n$host = 'localhost';\n$username = 'your_username';\n$password = 'your_password';\n$dbname = 'users';\n\n// Establish database connection\n$db = new mysqli($host, $username, $password, $dbname);\n\nif ($db->connect_error) {\n  die(\"Connection failed: \" . $db->connect_error);\n}\n\n?>\n```", "```php\n<?php\n\nrequire_once 'db.php';\nrequire_once 'login_function.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Handle form submission\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  if (login($username, $password)) {\n    header('Location: index.php');\n    exit;\n  }\n}\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Login</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"username\">Username:</label>\n  <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n  <label for=\"password\">Password:</label>\n  <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n  <button type=\"submit\">Login</button>\n</form>\n\n<?php if (isset($_GET['error'])) : ?>\n  <p style=\"color: red;\"><?php echo $_GET['error']; ?></p>\n<?php endif; ?>\n\n</body>\n</html>\n```"]}
