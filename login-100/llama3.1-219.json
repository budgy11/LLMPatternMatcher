{"prompt": "Create a user login function using php", "llm_output": "Here's an example of a simple user login function in PHP:\n\n**login.php**\n```php\n<?php\n// Database connection settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Function to connect to the database\nfunction db_connect() {\n  $conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n  if ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n  }\n  return $conn;\n}\n\n// Function to check user credentials\nfunction login_user($username, $password) {\n  // Connect to the database\n  $conn = db_connect();\n\n  // Prepare query to retrieve user data\n  $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ? AND password = ?\");\n  $stmt->bind_param(\"ss\", $username, $password);\n\n  // Execute query and get result\n  $stmt->execute();\n  $result = $stmt->get_result();\n\n  // Check if user exists\n  if ($result->num_rows > 0) {\n    // User exists, return true\n    return true;\n  } else {\n    // User doesn't exist or credentials are incorrect\n    return false;\n  }\n\n  // Close connection\n  $conn->close();\n}\n\n// Function to get user data by username\nfunction get_user_data($username) {\n  // Connect to the database\n  $conn = db_connect();\n\n  // Prepare query to retrieve user data\n  $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ?\");\n  $stmt->bind_param(\"s\", $username);\n\n  // Execute query and get result\n  $stmt->execute();\n  $result = $stmt->get_result();\n\n  // Check if user exists\n  if ($result->num_rows > 0) {\n    // User exists, return data as an array\n    return $result->fetch_assoc();\n  } else {\n    // User doesn't exist or credentials are incorrect\n    return null;\n  }\n\n  // Close connection\n  $conn->close();\n}\n\n// Example usage:\nif (isset($_POST['login'])) {\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  if (login_user($username, $password)) {\n    $user_data = get_user_data($username);\n    // User is logged in, display welcome message or redirect to dashboard\n    echo \"Welcome, $user_data[name]!\";\n  } else {\n    // User credentials are incorrect or doesn't exist\n    echo \"Invalid username or password.\";\n  }\n}\n\n// Form for user login\n?>\n<form action=\"\" method=\"post\">\n  <label>Username:</label>\n  <input type=\"text\" name=\"username\"><br><br>\n  <label>Password:</label>\n  <input type=\"password\" name=\"password\"><br><br>\n  <input type=\"submit\" name=\"login\" value=\"Login\">\n</form>\n```\nThis example includes three functions:\n\n1. `db_connect()`: Establishes a connection to the database using the defined settings.\n2. `login_user($username, $password)`: Checks user credentials by executing a SQL query with prepared statements and returns true if the user exists and password is correct.\n3. `get_user_data($username)`: Retrieves user data from the database based on the provided username.\n\nIn the example usage section, we demonstrate how to use these functions in an HTML form. When the login button is clicked, it sends a POST request to the same page with the username and password fields. The script then checks if the user credentials are correct using the `login_user()` function. If the user exists and password is correct, it retrieves the user data using the `get_user_data()` function and displays a welcome message.\n\nNote: This example uses prepared statements for SQL queries to prevent SQL injection attacks. Additionally, passwords should never be stored in plain text; instead, use password hashing and verification functions like `password_hash()` and `password_verify()`.", "code_blocks": ["```php\n<?php\n// Database connection settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Function to connect to the database\nfunction db_connect() {\n  $conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n  if ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n  }\n  return $conn;\n}\n\n// Function to check user credentials\nfunction login_user($username, $password) {\n  // Connect to the database\n  $conn = db_connect();\n\n  // Prepare query to retrieve user data\n  $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ? AND password = ?\");\n  $stmt->bind_param(\"ss\", $username, $password);\n\n  // Execute query and get result\n  $stmt->execute();\n  $result = $stmt->get_result();\n\n  // Check if user exists\n  if ($result->num_rows > 0) {\n    // User exists, return true\n    return true;\n  } else {\n    // User doesn't exist or credentials are incorrect\n    return false;\n  }\n\n  // Close connection\n  $conn->close();\n}\n\n// Function to get user data by username\nfunction get_user_data($username) {\n  // Connect to the database\n  $conn = db_connect();\n\n  // Prepare query to retrieve user data\n  $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ?\");\n  $stmt->bind_param(\"s\", $username);\n\n  // Execute query and get result\n  $stmt->execute();\n  $result = $stmt->get_result();\n\n  // Check if user exists\n  if ($result->num_rows > 0) {\n    // User exists, return data as an array\n    return $result->fetch_assoc();\n  } else {\n    // User doesn't exist or credentials are incorrect\n    return null;\n  }\n\n  // Close connection\n  $conn->close();\n}\n\n// Example usage:\nif (isset($_POST['login'])) {\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  if (login_user($username, $password)) {\n    $user_data = get_user_data($username);\n    // User is logged in, display welcome message or redirect to dashboard\n    echo \"Welcome, $user_data[name]!\";\n  } else {\n    // User credentials are incorrect or doesn't exist\n    echo \"Invalid username or password.\";\n  }\n}\n\n// Form for user login\n?>\n<form action=\"\" method=\"post\">\n  <label>Username:</label>\n  <input type=\"text\" name=\"username\"><br><br>\n  <label>Password:</label>\n  <input type=\"password\" name=\"password\"><br><br>\n  <input type=\"submit\" name=\"login\" value=\"Login\">\n</form>\n```"]}
