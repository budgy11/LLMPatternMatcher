{"prompt": "Create a user login function using php", "llm_output": "Here is an example of a simple user login function in PHP:\n\n**login.php**\n```php\n<?php\n\n// Database connection settings\n$host = 'localhost';\n$dbname = 'mydatabase';\n$username = 'myusername';\n$password = 'mypassword';\n\n// Connect to database\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n\nfunction login_user($email, $password) {\n    // SQL query to retrieve user data\n    $stmt = $conn->prepare('SELECT * FROM users WHERE email = :email');\n    $stmt->bindParam(':email', $email);\n    $stmt->execute();\n\n    // Fetch the user's password and hash it for comparison\n    $user = $stmt->fetch();\n    if ($user && password_verify($password, $user['password'])) {\n        return array(\n            'success' => true,\n            'message' => 'Login successful',\n            'user_id' => $user['id'],\n            'username' => $user['username']\n        );\n    } else {\n        return array(\n            'success' => false,\n            'message' => 'Invalid email or password'\n        );\n    }\n}\n\nfunction authenticate_user() {\n    if (isset($_POST['email']) && isset($_POST['password'])) {\n        $email = $_POST['email'];\n        $password = $_POST['password'];\n\n        $response = login_user($email, $password);\n\n        if ($response['success'] == true) {\n            // Set session variables\n            $_SESSION['user_id'] = $response['user_id'];\n            $_SESSION['username'] = $response['username'];\n\n            header('Location: dashboard.php');\n            exit;\n        } else {\n            // Display error message\n            echo 'Invalid email or password';\n        }\n    } else {\n        // Redirect to login page if no email or password provided\n        header('Location: index.php');\n        exit;\n    }\n}\n\n// Call the authenticate_user function on each request\nauthenticate_user();\n\n?>\n```\n\nThis script assumes you have a `users` table in your database with columns for `id`, `email`, `password`, and `username`. The `login_user` function takes an email address and password as input, retrieves the corresponding user data from the database, hashes the provided password, and compares it to the stored hashed password. If the passwords match, the function returns an array containing the user's ID and username.\n\nThe `authenticate_user` function checks if a POST request has been made with `email` and `password` fields filled in. If so, it calls `login_user` with these values as arguments. If the login is successful, it sets session variables for the user's ID and username and redirects them to the dashboard page.\n\n**Example use case:**\n\n* User submits a form on the index.php page containing their email address and password.\n* The form data is sent as a POST request to the login script (login.php).\n* The `authenticate_user` function checks if the request contains valid input data and calls `login_user` with these values as arguments.\n* If the login is successful, the user is redirected to the dashboard page.\n\n**Security notes:**\n\n* This example uses prepared statements to prevent SQL injection attacks.\n* It also hashes passwords using the built-in PHP `password_verify` function for password storage.\n* Passwords should be stored securely (e.g., hashed and salted) in a database, not in plain text.\n* Always validate user input data before passing it to your database.", "code_blocks": ["```php\n<?php\n\n// Database connection settings\n$host = 'localhost';\n$dbname = 'mydatabase';\n$username = 'myusername';\n$password = 'mypassword';\n\n// Connect to database\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n\nfunction login_user($email, $password) {\n    // SQL query to retrieve user data\n    $stmt = $conn->prepare('SELECT * FROM users WHERE email = :email');\n    $stmt->bindParam(':email', $email);\n    $stmt->execute();\n\n    // Fetch the user's password and hash it for comparison\n    $user = $stmt->fetch();\n    if ($user && password_verify($password, $user['password'])) {\n        return array(\n            'success' => true,\n            'message' => 'Login successful',\n            'user_id' => $user['id'],\n            'username' => $user['username']\n        );\n    } else {\n        return array(\n            'success' => false,\n            'message' => 'Invalid email or password'\n        );\n    }\n}\n\nfunction authenticate_user() {\n    if (isset($_POST['email']) && isset($_POST['password'])) {\n        $email = $_POST['email'];\n        $password = $_POST['password'];\n\n        $response = login_user($email, $password);\n\n        if ($response['success'] == true) {\n            // Set session variables\n            $_SESSION['user_id'] = $response['user_id'];\n            $_SESSION['username'] = $response['username'];\n\n            header('Location: dashboard.php');\n            exit;\n        } else {\n            // Display error message\n            echo 'Invalid email or password';\n        }\n    } else {\n        // Redirect to login page if no email or password provided\n        header('Location: index.php');\n        exit;\n    }\n}\n\n// Call the authenticate_user function on each request\nauthenticate_user();\n\n?>\n```"]}
