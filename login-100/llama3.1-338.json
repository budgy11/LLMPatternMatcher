{"prompt": "Create a user login function using php", "llm_output": "Here is an example of a basic user login function in PHP:\n\n```php\n<?php\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'your_database_username';\n$db_password = 'your_database_password';\n$db_name = 'your_database_name';\n\n// Establish database connection\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to check user credentials and login\nfunction check_login($username, $password) {\n    global $conn;\n\n    // SQL query to retrieve password hash for given username\n    $sql = \"SELECT password_hash FROM users WHERE username = '$username'\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        // If user exists, retrieve their password hash and compare with provided password\n        while ($row = $result->fetch_assoc()) {\n            $password_hash = $row['password_hash'];\n            if (password_verify($password, $password_hash)) {\n                // User login successful. Start session and redirect to protected page.\n                session_start();\n                $_SESSION['username'] = $username;\n                header('Location: protected_page.php');\n                exit;\n            } else {\n                echo 'Incorrect password';\n            }\n        }\n    } else {\n        echo 'User not found';\n    }\n\n    return false; // If user login fails, function returns false\n}\n\n// Function to register new user\nfunction register_user($username, $password) {\n    global $conn;\n\n    // SQL query to insert new user into database\n    $sql = \"INSERT INTO users (username, password_hash)\n            VALUES ('$username', '\" . password_hash($password, PASSWORD_DEFAULT) . \"')\";\n\n    if ($conn->query($sql)) {\n        echo 'User registered successfully';\n        return true;\n    } else {\n        echo 'Error registering user: ' . $conn->error;\n        return false;\n    }\n}\n\n// Login form processing\nif (isset($_POST['login'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Call check_login function to verify user credentials\n    check_login($username, $password);\n} elseif (isset($_POST['register'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Call register_user function to create new user account\n    register_user($username, $password);\n}\n\n?>\n```\n\nThis script includes two functions: `check_login` and `register_user`. The `check_login` function compares the provided password with the stored password hash for a given username. If they match, it starts a session and redirects the user to a protected page. The `register_user` function inserts a new user into the database.\n\n**Security Note:** This script uses `password_hash` and `password_verify` functions to securely store and verify passwords. Please ensure that your PHP version supports these functions (PHP 5.5 or later). Also, make sure to replace placeholders like `$db_host`, `$db_username`, etc., with actual values for your database connection.\n\n**Example Use Case:**\n\nSuppose we have a form on `login.php` page:\n```html\n<form action=\"login.php\" method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" name=\"login\" value=\"Login\">\n</form>\n\n<form action=\"login.php\" method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" name=\"register\" value=\"Register\">\n</form>\n```\n\nWhen the user submits the login form, the script will call `check_login` function to verify their credentials. If successful, it redirects them to a protected page (`protected_page.php`).", "code_blocks": ["```php\n<?php\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'your_database_username';\n$db_password = 'your_database_password';\n$db_name = 'your_database_name';\n\n// Establish database connection\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to check user credentials and login\nfunction check_login($username, $password) {\n    global $conn;\n\n    // SQL query to retrieve password hash for given username\n    $sql = \"SELECT password_hash FROM users WHERE username = '$username'\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        // If user exists, retrieve their password hash and compare with provided password\n        while ($row = $result->fetch_assoc()) {\n            $password_hash = $row['password_hash'];\n            if (password_verify($password, $password_hash)) {\n                // User login successful. Start session and redirect to protected page.\n                session_start();\n                $_SESSION['username'] = $username;\n                header('Location: protected_page.php');\n                exit;\n            } else {\n                echo 'Incorrect password';\n            }\n        }\n    } else {\n        echo 'User not found';\n    }\n\n    return false; // If user login fails, function returns false\n}\n\n// Function to register new user\nfunction register_user($username, $password) {\n    global $conn;\n\n    // SQL query to insert new user into database\n    $sql = \"INSERT INTO users (username, password_hash)\n            VALUES ('$username', '\" . password_hash($password, PASSWORD_DEFAULT) . \"')\";\n\n    if ($conn->query($sql)) {\n        echo 'User registered successfully';\n        return true;\n    } else {\n        echo 'Error registering user: ' . $conn->error;\n        return false;\n    }\n}\n\n// Login form processing\nif (isset($_POST['login'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Call check_login function to verify user credentials\n    check_login($username, $password);\n} elseif (isset($_POST['register'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Call register_user function to create new user account\n    register_user($username, $password);\n}\n\n?>\n```", null]}
