{"prompt": "Create a user login function using php", "llm_output": "**User Login Function in PHP**\n=====================================\n\nThis example demonstrates a basic user login functionality using PHP. It includes user authentication, validation, and data storage.\n\n### **Database Setup**\n\nFirst, create a MySQL database with the following schema:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255) NOT NULL UNIQUE,\n  password VARCHAR(255) NOT NULL\n);\n```\n\n**`login.php` file**\n---------------------\n\n```php\n<?php\n\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'your_database_name';\n\n// Connect to database\n$conn = mysqli_connect($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif (!$conn) {\n  die(\"Connection failed: \" . mysqli_connect_error());\n}\n\nfunction loginUser() {\n  global $conn;\n\n  // Get form data\n  $username = $_POST['username'];\n  $password = sha1($_POST['password']);\n\n  // Validate input\n  if (empty($username) || empty($password)) {\n    return 'Error: Both username and password are required.';\n  }\n\n  // Query database for user\n  $query = \"SELECT * FROM users WHERE username='$username' AND password='$password'\";\n  $result = mysqli_query($conn, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    // User found, log them in\n    while ($row = mysqli_fetch_assoc($result)) {\n      $_SESSION['user_id'] = $row['id'];\n      $_SESSION['username'] = $row['username'];\n      return 'Login successful.';\n    }\n  } else {\n    // Incorrect login credentials\n    return 'Invalid username or password. Please try again.';\n  }\n\n  mysqli_close($conn);\n}\n\nif (isset($_POST['login'])) {\n  echo loginUser();\n} else {\n  // Display login form if not submitted\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <input type=\"text\" name=\"username\" placeholder=\"Username\">\n  <input type=\"password\" name=\"password\" placeholder=\"Password\">\n  <button type=\"submit\" name=\"login\">Login</button>\n</form>\n<?php\n}\n?>\n```\n\n### **Explanation**\n\nThis script:\n\n1. Connects to the MySQL database using the provided credentials.\n2. Defines a `loginUser()` function that takes in user input and queries the database for matching username and password (hashed with SHA-1).\n3. If a match is found, it sets session variables with the user's ID and username.\n4. When the login form is submitted, it calls the `loginUser()` function and displays an error message or success message accordingly.\n\n### **Security Notes**\n\n* This example uses SHA-1 hashing for password storage. In production environments, consider using a stronger hashing algorithm like bcrypt or PBKDF2.\n* Always validate user input to prevent SQL injection attacks.\n* Store sensitive data (e.g., passwords) securely using a library like PHP's built-in `password_hash()` and `password_verify()`.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'your_database_name';\n\n// Connect to database\n$conn = mysqli_connect($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif (!$conn) {\n  die(\"Connection failed: \" . mysqli_connect_error());\n}\n\nfunction loginUser() {\n  global $conn;\n\n  // Get form data\n  $username = $_POST['username'];\n  $password = sha1($_POST['password']);\n\n  // Validate input\n  if (empty($username) || empty($password)) {\n    return 'Error: Both username and password are required.';\n  }\n\n  // Query database for user\n  $query = \"SELECT * FROM users WHERE username='$username' AND password='$password'\";\n  $result = mysqli_query($conn, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    // User found, log them in\n    while ($row = mysqli_fetch_assoc($result)) {\n      $_SESSION['user_id'] = $row['id'];\n      $_SESSION['username'] = $row['username'];\n      return 'Login successful.';\n    }\n  } else {\n    // Incorrect login credentials\n    return 'Invalid username or password. Please try again.';\n  }\n\n  mysqli_close($conn);\n}\n\nif (isset($_POST['login'])) {\n  echo loginUser();\n} else {\n  // Display login form if not submitted\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <input type=\"text\" name=\"username\" placeholder=\"Username\">\n  <input type=\"password\" name=\"password\" placeholder=\"Password\">\n  <button type=\"submit\" name=\"login\">Login</button>\n</form>\n<?php\n}\n?>\n```"]}
