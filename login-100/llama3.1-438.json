{"prompt": "Create a user login function using php", "llm_output": "Here's an example of how you can create a basic user login function in PHP:\n\n```php\n<?php\n\n// Database connection settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n}\n\n// Function to check user credentials\nfunction check_credentials($username, $password) {\n    global $mysqli;\n\n    // Query to get user data from database\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $mysqli->query($query);\n\n    if ($result->num_rows == 0) {\n        return array(false, 'Invalid username or password');\n    }\n\n    // Get the stored hash of the user's password\n    $row = $result->fetch_assoc();\n    $stored_hash = $row['password'];\n\n    // Check if the submitted password matches the stored hash\n    if (password_verify($password, $stored_hash)) {\n        return array(true, 'Login successful');\n    } else {\n        return array(false, 'Invalid username or password');\n    }\n}\n\n// Function to login user and set session variables\nfunction login_user($username) {\n    global $mysqli;\n\n    // Query to get user data from database\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $mysqli->query($query);\n\n    if ($result->num_rows == 0) {\n        return array(false, 'Invalid username or password');\n    }\n\n    // Get the stored data for the user\n    $row = $result->fetch_assoc();\n\n    // Set session variables\n    $_SESSION['username'] = $row['username'];\n    $_SESSION['email'] = $row['email'];\n\n    return array(true, 'Login successful');\n}\n\n// Function to handle login form submission\nfunction process_login($username, $password) {\n    list($success, $message) = check_credentials($username, $password);\n\n    if ($success) {\n        login_user($username);\n        $_SESSION['logged_in'] = true;\n        header('Location: index.php');\n        exit();\n    } else {\n        return array(false, 'Invalid username or password');\n    }\n}\n\n// Example usage:\nif (isset($_POST['login'])) {\n    $username = trim($_POST['username']);\n    $password = trim($_POST['password']);\n\n    list($success, $message) = process_login($username, $password);\n\n    if ($success) {\n        echo 'You have been logged in successfully';\n    } else {\n        echo 'Login failed: ' . $message;\n    }\n}\n```\n\nThis script uses the `mysqli` extension to connect to a MySQL database. It has three functions:\n\n1. `check_credentials`: Checks the submitted username and password against the stored data in the database.\n2. `login_user`: Logs in the user by setting session variables.\n3. `process_login`: Handles the login form submission by calling the above two functions.\n\nThe example usage at the end shows how to use these functions to handle a login form submission. When the form is submitted, it calls the `process_login` function with the submitted username and password. The result of this function determines whether the user logs in successfully or not.\n\nRemember to replace `'your_username'`, `'your_password'`, and `'your_database_name'` with your actual database credentials and name.\n\n**Note:** This is a basic example, you should use prepared statements instead of concatenating variables directly into SQL queries.", "code_blocks": ["```php\n<?php\n\n// Database connection settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n}\n\n// Function to check user credentials\nfunction check_credentials($username, $password) {\n    global $mysqli;\n\n    // Query to get user data from database\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $mysqli->query($query);\n\n    if ($result->num_rows == 0) {\n        return array(false, 'Invalid username or password');\n    }\n\n    // Get the stored hash of the user's password\n    $row = $result->fetch_assoc();\n    $stored_hash = $row['password'];\n\n    // Check if the submitted password matches the stored hash\n    if (password_verify($password, $stored_hash)) {\n        return array(true, 'Login successful');\n    } else {\n        return array(false, 'Invalid username or password');\n    }\n}\n\n// Function to login user and set session variables\nfunction login_user($username) {\n    global $mysqli;\n\n    // Query to get user data from database\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $mysqli->query($query);\n\n    if ($result->num_rows == 0) {\n        return array(false, 'Invalid username or password');\n    }\n\n    // Get the stored data for the user\n    $row = $result->fetch_assoc();\n\n    // Set session variables\n    $_SESSION['username'] = $row['username'];\n    $_SESSION['email'] = $row['email'];\n\n    return array(true, 'Login successful');\n}\n\n// Function to handle login form submission\nfunction process_login($username, $password) {\n    list($success, $message) = check_credentials($username, $password);\n\n    if ($success) {\n        login_user($username);\n        $_SESSION['logged_in'] = true;\n        header('Location: index.php');\n        exit();\n    } else {\n        return array(false, 'Invalid username or password');\n    }\n}\n\n// Example usage:\nif (isset($_POST['login'])) {\n    $username = trim($_POST['username']);\n    $password = trim($_POST['password']);\n\n    list($success, $message) = process_login($username, $password);\n\n    if ($success) {\n        echo 'You have been logged in successfully';\n    } else {\n        echo 'Login failed: ' . $message;\n    }\n}\n```"]}
