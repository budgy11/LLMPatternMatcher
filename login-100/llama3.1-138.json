{"prompt": "Create a user login function using php", "llm_output": "Here's an example of how you can create a simple user login system in PHP. This will include functions to register new users, login existing users, and check if the username is already taken.\n\n**Note:** For security reasons, we'll use prepared statements with `mysqli` extension for database interactions.\n\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to the database\nfunction connectDatabase() {\n    $conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n    return $conn;\n}\n\n// Register a user\nfunction registerUser($username, $email, $password) {\n    $conn = connectDatabase();\n    $stmt = $conn->prepare(\"INSERT INTO users (username, email, password) VALUES (?, ?, ?)\");\n    $stmt->bind_param('sss', $username, $email, password_hash($password, PASSWORD_DEFAULT));\n    if ($stmt->execute()) {\n        echo \"User created successfully\";\n    } else {\n        echo \"Error creating user: \" . $conn->error;\n    }\n    $stmt->close();\n    $conn->close();\n}\n\n// Login a user\nfunction loginUser($username, $password) {\n    $conn = connectDatabase();\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ?\");\n    $stmt->bind_param('s', $username);\n    if ($stmt->execute()) {\n        $result = $stmt->get_result();\n        if ($result->num_rows == 1) {\n            $user = $result->fetch_assoc();\n            if (password_verify($password, $user['password'])) {\n                echo \"Login successful\";\n                // You can now log the user in\n                $_SESSION['username'] = $username;\n                return true;\n            } else {\n                echo \"Incorrect password\";\n                return false;\n            }\n        } else {\n            echo \"User not found\";\n            return false;\n        }\n    } else {\n        echo \"Error checking username: \" . $conn->error;\n        return false;\n    }\n    $stmt->close();\n    $conn->close();\n}\n\n// Check if a username is already taken\nfunction checkUsername($username) {\n    $conn = connectDatabase();\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ?\");\n    $stmt->bind_param('s', $username);\n    if ($stmt->execute()) {\n        return $stmt->get_result()->num_rows > 0;\n    } else {\n        echo \"Error checking username: \" . $conn->error;\n        return false;\n    }\n    $stmt->close();\n    $conn->close();\n}\n\n// Example usage\nregisterUser('johnDoe', 'johndoe@example.com', 'password123');\nif (loginUser('johnDoe', 'password123')) {\n    echo \"Welcome, John Doe!\";\n} else {\n    echo \"Failed to login\";\n}\n?>\n```\n\n**Note:**\n\n*   Make sure you replace `DB_HOST`, `DB_USERNAME`, `DB_PASSWORD`, and `DB_NAME` with your actual database credentials.\n*   For security reasons, it's recommended to use a prepared statement library like PDO or MySQLi instead of concatenating SQL queries.\n*   This example uses the `mysqli` extension. If you're using PHP 7.x or later, consider using the `PDO` extension for more modern and secure database interactions.\n\n**Security Considerations:**\n\n*   **Never store passwords in plaintext:** Always hash passwords before storing them in your database.\n*   **Use a secure password hashing algorithm:** Use functions like `password_hash()` to generate secure hashes of your users' passwords.\n*   **Validate user input:** Always validate and sanitize any data coming from the user (e.g., username, email) to prevent SQL injection attacks.", "code_blocks": ["```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to the database\nfunction connectDatabase() {\n    $conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n    return $conn;\n}\n\n// Register a user\nfunction registerUser($username, $email, $password) {\n    $conn = connectDatabase();\n    $stmt = $conn->prepare(\"INSERT INTO users (username, email, password) VALUES (?, ?, ?)\");\n    $stmt->bind_param('sss', $username, $email, password_hash($password, PASSWORD_DEFAULT));\n    if ($stmt->execute()) {\n        echo \"User created successfully\";\n    } else {\n        echo \"Error creating user: \" . $conn->error;\n    }\n    $stmt->close();\n    $conn->close();\n}\n\n// Login a user\nfunction loginUser($username, $password) {\n    $conn = connectDatabase();\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ?\");\n    $stmt->bind_param('s', $username);\n    if ($stmt->execute()) {\n        $result = $stmt->get_result();\n        if ($result->num_rows == 1) {\n            $user = $result->fetch_assoc();\n            if (password_verify($password, $user['password'])) {\n                echo \"Login successful\";\n                // You can now log the user in\n                $_SESSION['username'] = $username;\n                return true;\n            } else {\n                echo \"Incorrect password\";\n                return false;\n            }\n        } else {\n            echo \"User not found\";\n            return false;\n        }\n    } else {\n        echo \"Error checking username: \" . $conn->error;\n        return false;\n    }\n    $stmt->close();\n    $conn->close();\n}\n\n// Check if a username is already taken\nfunction checkUsername($username) {\n    $conn = connectDatabase();\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ?\");\n    $stmt->bind_param('s', $username);\n    if ($stmt->execute()) {\n        return $stmt->get_result()->num_rows > 0;\n    } else {\n        echo \"Error checking username: \" . $conn->error;\n        return false;\n    }\n    $stmt->close();\n    $conn->close();\n}\n\n// Example usage\nregisterUser('johnDoe', 'johndoe@example.com', 'password123');\nif (loginUser('johnDoe', 'password123')) {\n    echo \"Welcome, John Doe!\";\n} else {\n    echo \"Failed to login\";\n}\n?>\n```"]}
