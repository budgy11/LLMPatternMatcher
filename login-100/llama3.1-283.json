{"prompt": "Create a user login function using php", "llm_output": "Here's an example of a simple user login function in PHP. This script assumes you have a database setup to store user credentials.\n\n**Note:** Please keep in mind that storing passwords as plain text is not secure, so we'll be hashing them with `password_hash()` and verifying them using `password_verify()`. \n\n```php\n<?php\n\n// Database connection settings (update these)\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction login_user() {\n    if (isset($_POST['login'])) {\n        $username = $_POST['username'];\n        $password = $_POST['password'];\n\n        // Prepare and execute SQL query to select user from database\n        $sql = \"SELECT * FROM users WHERE username = '$username'\";\n        $result = $conn->query($sql);\n\n        if ($result->num_rows > 0) {\n            while ($row = $result->fetch_assoc()) {\n                // Hashed password in the database\n                if (password_verify($password, $row['password'])) {\n                    $_SESSION['logged_in'] = true;\n                    header('Location: index.php'); // Redirect to index page after login\n                    exit();\n                }\n            }\n        }\n\n        echo \"Invalid username or password\";\n    } else {\n        echo \"Not a POST request\";\n    }\n}\n\n// Start the session\nsession_start();\n\n// Check if user is already logged in\nif (isset($_SESSION['logged_in'])) {\n    header('Location: index.php'); // Redirect to index page after login\n    exit();\n}\n\n?>\n\n<!-- HTML form for user input -->\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" name=\"login\" value=\"Login\">\n</form>\n\n<?php login_user(); ?>\n```\n\n**Explanation:**\n\n1. The script connects to the database using `mysqli`.\n2. It defines a function `login_user()` that checks for POST requests.\n3. If there's a POST request, it extracts username and password from the form data.\n4. It queries the database to select the user with the matching username.\n5. If the query returns results, it hashes the submitted password using `password_verify()` against the hashed password in the database.\n6. If both passwords match, it sets `$_SESSION['logged_in']` to true and redirects to the index page.\n\n**Security Notes:**\n\n1. Never store plain text passwords; use hashing and salting for secure password storage.\n2. Always validate user input data before querying the database.\n3. Use prepared statements or parameterized queries instead of direct concatenation.\n4. Implement proper error handling, logging, and security measures in your application.\n\nThis script is a simplified example to illustrate the basic functionality of user login using PHP. It's essential to add additional security layers and adapt it according to your specific requirements.", "code_blocks": ["```php\n<?php\n\n// Database connection settings (update these)\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction login_user() {\n    if (isset($_POST['login'])) {\n        $username = $_POST['username'];\n        $password = $_POST['password'];\n\n        // Prepare and execute SQL query to select user from database\n        $sql = \"SELECT * FROM users WHERE username = '$username'\";\n        $result = $conn->query($sql);\n\n        if ($result->num_rows > 0) {\n            while ($row = $result->fetch_assoc()) {\n                // Hashed password in the database\n                if (password_verify($password, $row['password'])) {\n                    $_SESSION['logged_in'] = true;\n                    header('Location: index.php'); // Redirect to index page after login\n                    exit();\n                }\n            }\n        }\n\n        echo \"Invalid username or password\";\n    } else {\n        echo \"Not a POST request\";\n    }\n}\n\n// Start the session\nsession_start();\n\n// Check if user is already logged in\nif (isset($_SESSION['logged_in'])) {\n    header('Location: index.php'); // Redirect to index page after login\n    exit();\n}\n\n?>\n\n<!-- HTML form for user input -->\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" name=\"login\" value=\"Login\">\n</form>\n\n<?php login_user(); ?>\n```"]}
