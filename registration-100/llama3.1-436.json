{"prompt": "Create a user registration function using php", "llm_output": "Here's an example of a user registration function in PHP that includes validation and error handling.\n\n```php\n<?php\nfunction registerUser($username, $email, $password) {\n    // Validate input data\n    if (empty($username)) {\n        throw new Exception(\"Username cannot be empty\");\n    }\n    \n    if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n        throw new Exception(\"Invalid email address\");\n    }\n\n    if (strlen($password) < 8) {\n        throw new Exception(\"Password must be at least 8 characters long\");\n    }\n\n    try {\n        // Connect to database\n        $mysqli = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n        if ($mysqli->connect_errno) {\n            throw new Exception(\"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error);\n        }\n\n        // Check for existing username and email\n        $query = \"SELECT * FROM users WHERE username = '$username' OR email = '$email'\";\n        \n        if ($result = $mysqli->query($query)) {\n            while ($row = $result->fetch_assoc()) {\n                throw new Exception(\"Username or email already in use\");\n            }\n        } else {\n            throw new Exception(\"Failed to query database: (\" . $mysqli->errno . \") \" . $mysqli->error);\n        }\n\n        // Hash password\n        $passwordHash = password_hash($password, PASSWORD_DEFAULT);\n\n        // Insert user into database\n        $query = \"INSERT INTO users (username, email, password) VALUES ('$username', '$email', '$passwordHash')\";\n        \n        if ($mysqli->query($query)) {\n            return true;\n        } else {\n            throw new Exception(\"Failed to insert user: (\" . $mysqli->errno . \") \" . $mysqli->error);\n        }\n    } catch (Exception $e) {\n        // Log the error\n        print \"Error: \" . $e->getMessage() . \"\\n\";\n        \n        return false;\n    }\n\n    finally {\n        if (isset($mysqli)) {\n            $mysqli->close();\n        }\n    }\n}\n?>\n```\n\nYou can use this function in your code like so:\n\n```php\ntry {\n    registerUser(\"john_doe\", \"johndoe@example.com\", \"mysecretpassword\");\n    print \"User successfully registered\\n\";\n} catch (Exception $e) {\n    print \"Error registering user: \" . $e->getMessage() . \"\\n\";\n}\n```\n\nNote that this function uses MySQLi for database interactions, but you can easily replace it with PDO or another library.\n\nAlso note that this is a basic example and should not be used in production without proper error handling and security measures. \n\nAdditionally, please don't forget to replace `\"localhost\"`, `\"username\"`, `\"password\"`, `\"database\"` with your actual database credentials.", "code_blocks": ["```php\n<?php\nfunction registerUser($username, $email, $password) {\n    // Validate input data\n    if (empty($username)) {\n        throw new Exception(\"Username cannot be empty\");\n    }\n    \n    if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n        throw new Exception(\"Invalid email address\");\n    }\n\n    if (strlen($password) < 8) {\n        throw new Exception(\"Password must be at least 8 characters long\");\n    }\n\n    try {\n        // Connect to database\n        $mysqli = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n        if ($mysqli->connect_errno) {\n            throw new Exception(\"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error);\n        }\n\n        // Check for existing username and email\n        $query = \"SELECT * FROM users WHERE username = '$username' OR email = '$email'\";\n        \n        if ($result = $mysqli->query($query)) {\n            while ($row = $result->fetch_assoc()) {\n                throw new Exception(\"Username or email already in use\");\n            }\n        } else {\n            throw new Exception(\"Failed to query database: (\" . $mysqli->errno . \") \" . $mysqli->error);\n        }\n\n        // Hash password\n        $passwordHash = password_hash($password, PASSWORD_DEFAULT);\n\n        // Insert user into database\n        $query = \"INSERT INTO users (username, email, password) VALUES ('$username', '$email', '$passwordHash')\";\n        \n        if ($mysqli->query($query)) {\n            return true;\n        } else {\n            throw new Exception(\"Failed to insert user: (\" . $mysqli->errno . \") \" . $mysqli->error);\n        }\n    } catch (Exception $e) {\n        // Log the error\n        print \"Error: \" . $e->getMessage() . \"\\n\";\n        \n        return false;\n    }\n\n    finally {\n        if (isset($mysqli)) {\n            $mysqli->close();\n        }\n    }\n}\n?>\n```", "```php\ntry {\n    registerUser(\"john_doe\", \"johndoe@example.com\", \"mysecretpassword\");\n    print \"User successfully registered\\n\";\n} catch (Exception $e) {\n    print \"Error registering user: \" . $e->getMessage() . \"\\n\";\n}\n```"]}
