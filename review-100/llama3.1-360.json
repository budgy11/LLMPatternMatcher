{"prompt": "Create a user review function using php", "llm_output": "Here is an example of a simple user review system in PHP:\n\n**review.php**\n```php\n<?php\n\n// Connect to database\n$db = new mysqli('localhost', 'username', 'password', 'database');\n\n// Function to create a new review\nfunction add_review($product_id, $rating, $comment) {\n  global $db;\n  $query = \"INSERT INTO reviews (product_id, rating, comment)\n            VALUES ('$product_id', '$rating', '$comment')\";\n  mysqli_query($db, $query);\n}\n\n// Function to retrieve all reviews for a product\nfunction get_reviews($product_id) {\n  global $db;\n  $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n  $result = mysqli_query($db, $query);\n  return $result;\n}\n\n// Function to calculate average rating for a product\nfunction avg_rating($product_id) {\n  global $db;\n  $query = \"SELECT AVG(rating) AS average FROM reviews WHERE product_id = '$product_id'\";\n  $result = mysqli_query($db, $query);\n  $row = mysqli_fetch_assoc($result);\n  return isset($row['average']) ? $row['average'] : 0;\n}\n\n// Function to display review form\nfunction display_review_form($product_id) {\n  ?>\n  <form action=\"\" method=\"post\">\n    <label>Rating:</label>\n    <select name=\"rating\" required>\n      <option value=\"1\">1</option>\n      <option value=\"2\">2</option>\n      <option value=\"3\">3</option>\n      <option value=\"4\">4</option>\n      <option value=\"5\">5</option>\n    </select>\n    <br>\n    <label>Comment:</label>\n    <textarea name=\"comment\" required></textarea>\n    <br>\n    <input type=\"submit\" name=\"submit\" value=\"Submit Review\">\n  </form>\n  <?php\n}\n\n// Function to display reviews for a product\nfunction display_reviews($product_id) {\n  $reviews = get_reviews($product_id);\n  while ($row = mysqli_fetch_assoc($reviews)) {\n    echo \"Rating: $row[rating] stars\";\n    echo \"<br>Comment: $row[comment]\";\n    echo \"<hr>\";\n  }\n}\n\n// Check if user submitted review form\nif (isset($_POST['submit'])) {\n  add_review($_POST['product_id'], $_POST['rating'], $_POST['comment']);\n  header('Location: ' . $_SERVER['PHP_SELF'] . '?success=true');\n  exit;\n}\n\n?>\n```\n**index.php**\n```php\n<?php include 'review.php'; ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Product Reviews</title>\n</head>\n<body>\n\n  <?php if (isset($_GET['success'])): ?>\n    <p>Review submitted successfully!</p>\n  <?php endif; ?>\n\n  <h1>Reviews for Product ID <?= $_GET['product_id'] ?></h1>\n\n  <?php display_reviews($_GET['product_id']); ?>\n\n  <?php display_review_form($_GET['product_id']); ?>\n\n</body>\n</html>\n```\nThis example includes:\n\n* A `review.php` file that contains the functions to create a new review, retrieve all reviews for a product, calculate average rating, and display review form.\n* An `index.php` file that uses the functions from `review.php` to display reviews and review form.\n\nTo use this code, simply include it in your project and replace `'localhost'`, `'username'`, `'password'`, and `'database'` with your actual database credentials. Make sure to create a table named `reviews` in your database with columns for `product_id`, `rating`, and `comment`.", "code_blocks": ["```php\n<?php\n\n// Connect to database\n$db = new mysqli('localhost', 'username', 'password', 'database');\n\n// Function to create a new review\nfunction add_review($product_id, $rating, $comment) {\n  global $db;\n  $query = \"INSERT INTO reviews (product_id, rating, comment)\n            VALUES ('$product_id', '$rating', '$comment')\";\n  mysqli_query($db, $query);\n}\n\n// Function to retrieve all reviews for a product\nfunction get_reviews($product_id) {\n  global $db;\n  $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n  $result = mysqli_query($db, $query);\n  return $result;\n}\n\n// Function to calculate average rating for a product\nfunction avg_rating($product_id) {\n  global $db;\n  $query = \"SELECT AVG(rating) AS average FROM reviews WHERE product_id = '$product_id'\";\n  $result = mysqli_query($db, $query);\n  $row = mysqli_fetch_assoc($result);\n  return isset($row['average']) ? $row['average'] : 0;\n}\n\n// Function to display review form\nfunction display_review_form($product_id) {\n  ?>\n  <form action=\"\" method=\"post\">\n    <label>Rating:</label>\n    <select name=\"rating\" required>\n      <option value=\"1\">1</option>\n      <option value=\"2\">2</option>\n      <option value=\"3\">3</option>\n      <option value=\"4\">4</option>\n      <option value=\"5\">5</option>\n    </select>\n    <br>\n    <label>Comment:</label>\n    <textarea name=\"comment\" required></textarea>\n    <br>\n    <input type=\"submit\" name=\"submit\" value=\"Submit Review\">\n  </form>\n  <?php\n}\n\n// Function to display reviews for a product\nfunction display_reviews($product_id) {\n  $reviews = get_reviews($product_id);\n  while ($row = mysqli_fetch_assoc($reviews)) {\n    echo \"Rating: $row[rating] stars\";\n    echo \"<br>Comment: $row[comment]\";\n    echo \"<hr>\";\n  }\n}\n\n// Check if user submitted review form\nif (isset($_POST['submit'])) {\n  add_review($_POST['product_id'], $_POST['rating'], $_POST['comment']);\n  header('Location: ' . $_SERVER['PHP_SELF'] . '?success=true');\n  exit;\n}\n\n?>\n```", "```php\n<?php include 'review.php'; ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Product Reviews</title>\n</head>\n<body>\n\n  <?php if (isset($_GET['success'])): ?>\n    <p>Review submitted successfully!</p>\n  <?php endif; ?>\n\n  <h1>Reviews for Product ID <?= $_GET['product_id'] ?></h1>\n\n  <?php display_reviews($_GET['product_id']); ?>\n\n  <?php display_review_form($_GET['product_id']); ?>\n\n</body>\n</html>\n```"]}
