{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you could create a simple user review system using PHP. This example includes a basic form to submit reviews, a database to store the reviews, and a function to retrieve and display all reviews.\n\n```php\n<?php\n\n// Database connection details\n$host = 'localhost';\n$dbname = 'reviews_database';\n$username = 'your_username';\n$password = 'your_password';\n\n// Function to connect to database\nfunction dbConnect() {\n    global $host, $dbname, $username, $password;\n    \n    try {\n        // Attempt to connect\n        $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n        \n        return $conn;\n    } catch (PDOException $e) {\n        echo \"Connection failed: \" . $e->getMessage();\n        exit();\n    }\n}\n\n// Function to create table if it doesn't exist\nfunction createTable() {\n    global $host, $dbname, $username, $password;\n    \n    $conn = dbConnect();\n    \n    try {\n        // SQL command to create the reviews table\n        $sql = \"\n            CREATE TABLE IF NOT EXISTS reviews (\n                id INT PRIMARY KEY AUTO_INCREMENT,\n                review_text TEXT,\n                rating INT,\n                user_name VARCHAR(255),\n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            );\n        \";\n        \n        $conn->exec($sql);\n    } catch (PDOException $e) {\n        echo \"Table creation failed: \" . $e->getMessage();\n        exit();\n    }\n}\n\n// Function to insert a review into the database\nfunction addReview() {\n    global $host, $dbname, $username, $password;\n    \n    $conn = dbConnect();\n    \n    try {\n        // SQL command to insert a new review\n        $sql = \"\n            INSERT INTO reviews (review_text, rating, user_name)\n            VALUES (:review_text, :rating, :user_name);\n        \";\n        \n        $stmt = $conn->prepare($sql);\n        $stmt->bindParam(':review_text', $_POST['review']);\n        $stmt->bindParam(':rating', $_POST['rating']);\n        $stmt->bindParam(':user_name', $_POST['username']);\n        \n        if ($stmt->execute()) {\n            echo \"Review submitted successfully!\";\n        } else {\n            echo \"Error submitting review: \" . $stmt->errorInfo()[2];\n        }\n    } catch (PDOException $e) {\n        echo \"Insert failed: \" . $e->getMessage();\n    }\n}\n\n// Function to display all reviews\nfunction displayReviews() {\n    global $host, $dbname, $username, $password;\n    \n    $conn = dbConnect();\n    \n    try {\n        // SQL command to retrieve all reviews\n        $sql = \"\n            SELECT id, review_text, rating, user_name, created_at\n            FROM reviews\n            ORDER BY created_at DESC;\n        \";\n        \n        $stmt = $conn->query($sql);\n        \n        $reviews = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        \n        foreach ($reviews as $review) {\n            echo \"Review ID: \" . $review['id'] . \"<br>\";\n            echo \"Review Text: \" . $review['review_text'] . \"<br>\";\n            echo \"Rating: \" . $review['rating'] . \"<br>\";\n            echo \"User Name: \" . $review['user_name'] . \"<br>\";\n            echo \"Created At: \" . date('Y-m-d H:i:s', strtotime($review['created_at'])) . \"<br><hr>\";\n        }\n    } catch (PDOException $e) {\n        echo \"Error retrieving reviews: \" . $e->getMessage();\n    }\n}\n\n// Connect to the database and create the table if it doesn't exist\ncreateTable();\n\n?>\n```\n\nYou can use the following HTML form to submit a review:\n\n```html\n<form action=\"\" method=\"POST\">\n    <label for=\"review\">Review:</label>\n    <textarea id=\"review\" name=\"review\"></textarea><br>\n    <label for=\"rating\">Rating (1-5):</label>\n    <input type=\"number\" id=\"rating\" name=\"rating\"><br>\n    <label for=\"username\">Username:</label>\n    <input type=\"text\" id=\"username\" name=\"username\"><br>\n    <button type=\"submit\">Submit Review</button>\n</form>\n\n<p>Reviews:</p>\n<?php displayReviews(); ?>\n```\n\nThis is a basic example, and you can customize it to fit your needs. You may also want to include error handling for form submission errors.\n\nPlease note that this code assumes a MySQL database with the `reviews_database` schema and table structure specified in the `createTable()` function. Make sure to adjust the connection details (`$host`, `$dbname`, `$username`, `$password`) according to your actual database setup.", "code_blocks": ["```php\n<?php\n\n// Database connection details\n$host = 'localhost';\n$dbname = 'reviews_database';\n$username = 'your_username';\n$password = 'your_password';\n\n// Function to connect to database\nfunction dbConnect() {\n    global $host, $dbname, $username, $password;\n    \n    try {\n        // Attempt to connect\n        $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n        \n        return $conn;\n    } catch (PDOException $e) {\n        echo \"Connection failed: \" . $e->getMessage();\n        exit();\n    }\n}\n\n// Function to create table if it doesn't exist\nfunction createTable() {\n    global $host, $dbname, $username, $password;\n    \n    $conn = dbConnect();\n    \n    try {\n        // SQL command to create the reviews table\n        $sql = \"\n            CREATE TABLE IF NOT EXISTS reviews (\n                id INT PRIMARY KEY AUTO_INCREMENT,\n                review_text TEXT,\n                rating INT,\n                user_name VARCHAR(255),\n                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n            );\n        \";\n        \n        $conn->exec($sql);\n    } catch (PDOException $e) {\n        echo \"Table creation failed: \" . $e->getMessage();\n        exit();\n    }\n}\n\n// Function to insert a review into the database\nfunction addReview() {\n    global $host, $dbname, $username, $password;\n    \n    $conn = dbConnect();\n    \n    try {\n        // SQL command to insert a new review\n        $sql = \"\n            INSERT INTO reviews (review_text, rating, user_name)\n            VALUES (:review_text, :rating, :user_name);\n        \";\n        \n        $stmt = $conn->prepare($sql);\n        $stmt->bindParam(':review_text', $_POST['review']);\n        $stmt->bindParam(':rating', $_POST['rating']);\n        $stmt->bindParam(':user_name', $_POST['username']);\n        \n        if ($stmt->execute()) {\n            echo \"Review submitted successfully!\";\n        } else {\n            echo \"Error submitting review: \" . $stmt->errorInfo()[2];\n        }\n    } catch (PDOException $e) {\n        echo \"Insert failed: \" . $e->getMessage();\n    }\n}\n\n// Function to display all reviews\nfunction displayReviews() {\n    global $host, $dbname, $username, $password;\n    \n    $conn = dbConnect();\n    \n    try {\n        // SQL command to retrieve all reviews\n        $sql = \"\n            SELECT id, review_text, rating, user_name, created_at\n            FROM reviews\n            ORDER BY created_at DESC;\n        \";\n        \n        $stmt = $conn->query($sql);\n        \n        $reviews = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        \n        foreach ($reviews as $review) {\n            echo \"Review ID: \" . $review['id'] . \"<br>\";\n            echo \"Review Text: \" . $review['review_text'] . \"<br>\";\n            echo \"Rating: \" . $review['rating'] . \"<br>\";\n            echo \"User Name: \" . $review['user_name'] . \"<br>\";\n            echo \"Created At: \" . date('Y-m-d H:i:s', strtotime($review['created_at'])) . \"<br><hr>\";\n        }\n    } catch (PDOException $e) {\n        echo \"Error retrieving reviews: \" . $e->getMessage();\n    }\n}\n\n// Connect to the database and create the table if it doesn't exist\ncreateTable();\n\n?>\n```", null]}
