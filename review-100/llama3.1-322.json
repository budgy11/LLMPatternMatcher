{"prompt": "Create a user review function using php", "llm_output": "Here is an example of a user review system implemented in PHP:\n\n**database.sql**\n```sql\nCREATE TABLE reviews (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  product_id INT,\n  user_id INT,\n  rating INT,\n  comment TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  description TEXT\n);\n```\n**review.php**\n```php\n<?php\n\nclass Review {\n  private $db;\n\n  function __construct() {\n    $this->db = new PDO('mysql:host=localhost;dbname=reviews', 'username', 'password');\n  }\n\n  function add_review($product_id, $user_id, $rating, $comment) {\n    $stmt = $this->db->prepare(\"INSERT INTO reviews (product_id, user_id, rating, comment) VALUES (:product_id, :user_id, :rating, :comment)\");\n    $stmt->bindParam(':product_id', $product_id);\n    $stmt->bindParam(':user_id', $user_id);\n    $stmt->bindParam(':rating', $rating);\n    $stmt->bindParam(':comment', $comment);\n    $stmt->execute();\n  }\n\n  function get_reviews($product_id) {\n    $stmt = $this->db->prepare(\"SELECT * FROM reviews WHERE product_id = :product_id ORDER BY created_at DESC\");\n    $stmt->bindParam(':product_id', $product_id);\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n  }\n\n  function get_product_reviews($product_id) {\n    $reviews = $this->get_reviews($product_id);\n    $product_name = $this->get_product_name($product_id);\n    foreach ($reviews as &$review) {\n      $review['product_name'] = $product_name;\n    }\n    return $reviews;\n  }\n\n  function get_product_name($product_id) {\n    $stmt = $this->db->prepare(\"SELECT name FROM products WHERE id = :product_id\");\n    $stmt->bindParam(':product_id', $product_id);\n    $stmt->execute();\n    return $stmt->fetchColumn();\n  }\n}\n\n?>\n```\n**index.php**\n```php\n<?php\n\nrequire 'review.php';\n\n$review = new Review();\n\nif (isset($_POST['submit'])) {\n  $product_id = $_POST['product_id'];\n  $user_id = $_POST['user_id'];\n  $rating = $_POST['rating'];\n  $comment = $_POST['comment'];\n\n  $review->add_review($product_id, $user_id, $rating, $comment);\n}\n\n$product_reviews = $review->get_product_reviews($_GET['id']);\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Reviews</title>\n</head>\n<body>\n\n<h1>Reviews for <?php echo $_GET['name']; ?></h1>\n\n<?php foreach ($product_reviews as $review) : ?>\n  <div class=\"review\">\n    <p><?php echo $review['rating'] . '/5 stars'; ?></p>\n    <p><?php echo $review['comment']; ?></p>\n  </div>\n<?php endforeach; ?>\n\n<form action=\"\" method=\"post\">\n  <label for=\"product_id\">Product ID:</label>\n  <input type=\"text\" id=\"product_id\" name=\"product_id\"><br><br>\n  <label for=\"rating\">Rating (1-5):</label>\n  <input type=\"number\" id=\"rating\" name=\"rating\" min=\"1\" max=\"5\"><br><br>\n  <label for=\"comment\">Comment:</label>\n  <textarea id=\"comment\" name=\"comment\"></textarea><br><br>\n  <input type=\"submit\" name=\"submit\" value=\"Submit Review\">\n</form>\n\n</body>\n</html>\n```\nThis code creates a simple review system where users can leave reviews for products. The `Review` class handles the database interactions, and the `index.php` file displays the product reviews and allows users to submit new reviews.\n\n**Example use case:**\n\n1. Create a table in your MySQL database with the schema defined in `database.sql`.\n2. Replace `'username'`, `'password'` in `review.php` with your actual database credentials.\n3. Open `index.php` in a web browser and navigate to `http://localhost/index.php?id=1&name=Product%20Name`. This will display the reviews for the product with ID 1.\n4. Fill out the review form and submit it. The review will be added to the database.\n\nNote: This is just a basic example, you should add proper error handling, security measures (e.g. validation, sanitization), and possibly more features depending on your specific requirements.", "code_blocks": [null, "```php\n<?php\n\nclass Review {\n  private $db;\n\n  function __construct() {\n    $this->db = new PDO('mysql:host=localhost;dbname=reviews', 'username', 'password');\n  }\n\n  function add_review($product_id, $user_id, $rating, $comment) {\n    $stmt = $this->db->prepare(\"INSERT INTO reviews (product_id, user_id, rating, comment) VALUES (:product_id, :user_id, :rating, :comment)\");\n    $stmt->bindParam(':product_id', $product_id);\n    $stmt->bindParam(':user_id', $user_id);\n    $stmt->bindParam(':rating', $rating);\n    $stmt->bindParam(':comment', $comment);\n    $stmt->execute();\n  }\n\n  function get_reviews($product_id) {\n    $stmt = $this->db->prepare(\"SELECT * FROM reviews WHERE product_id = :product_id ORDER BY created_at DESC\");\n    $stmt->bindParam(':product_id', $product_id);\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n  }\n\n  function get_product_reviews($product_id) {\n    $reviews = $this->get_reviews($product_id);\n    $product_name = $this->get_product_name($product_id);\n    foreach ($reviews as &$review) {\n      $review['product_name'] = $product_name;\n    }\n    return $reviews;\n  }\n\n  function get_product_name($product_id) {\n    $stmt = $this->db->prepare(\"SELECT name FROM products WHERE id = :product_id\");\n    $stmt->bindParam(':product_id', $product_id);\n    $stmt->execute();\n    return $stmt->fetchColumn();\n  }\n}\n\n?>\n```", "```php\n<?php\n\nrequire 'review.php';\n\n$review = new Review();\n\nif (isset($_POST['submit'])) {\n  $product_id = $_POST['product_id'];\n  $user_id = $_POST['user_id'];\n  $rating = $_POST['rating'];\n  $comment = $_POST['comment'];\n\n  $review->add_review($product_id, $user_id, $rating, $comment);\n}\n\n$product_reviews = $review->get_product_reviews($_GET['id']);\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Reviews</title>\n</head>\n<body>\n\n<h1>Reviews for <?php echo $_GET['name']; ?></h1>\n\n<?php foreach ($product_reviews as $review) : ?>\n  <div class=\"review\">\n    <p><?php echo $review['rating'] . '/5 stars'; ?></p>\n    <p><?php echo $review['comment']; ?></p>\n  </div>\n<?php endforeach; ?>\n\n<form action=\"\" method=\"post\">\n  <label for=\"product_id\">Product ID:</label>\n  <input type=\"text\" id=\"product_id\" name=\"product_id\"><br><br>\n  <label for=\"rating\">Rating (1-5):</label>\n  <input type=\"number\" id=\"rating\" name=\"rating\" min=\"1\" max=\"5\"><br><br>\n  <label for=\"comment\">Comment:</label>\n  <textarea id=\"comment\" name=\"comment\"></textarea><br><br>\n  <input type=\"submit\" name=\"submit\" value=\"Submit Review\">\n</form>\n\n</body>\n</html>\n```"]}
