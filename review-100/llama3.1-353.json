{"prompt": "Create a user review function using php", "llm_output": "Here's an example of a simple user review system using PHP, HTML, and MySQL. This example includes functionality to create reviews, list all reviews, update reviews, and delete reviews.\n\n**Database Setup:**\n\nBefore we dive into the code, let's set up our database with a table called `reviews`. Create a new file named `create_db.php` and add the following SQL code:\n\n```php\nCREATE TABLE reviews (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  title VARCHAR(255),\n  content TEXT,\n  rating TINYINT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  user_id INT,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n```\n\n**Database Connection:**\n\nCreate a new file named `db_connection.php` and add the following code:\n\n```php\n<?php\n\n$servername = \"localhost\";\n$username = \"your_username\";\n$password = \"your_password\";\n$dbname = \"your_database\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n?>\n```\n\n**Functions:**\n\nCreate a new file named `functions.php` and add the following code:\n\n```php\n<?php\n\nfunction create_review($title, $content, $rating, $user_id) {\n  global $conn;\n  \n  $sql = \"INSERT INTO reviews (title, content, rating, user_id) VALUES ('$title', '$content', '$rating', '$user_id')\";\n  if ($conn->query($sql)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction get_reviews() {\n  global $conn;\n  \n  $sql = \"SELECT * FROM reviews ORDER BY id DESC\";\n  $result = $conn->query($sql);\n  while ($row = $result->fetch_assoc()) {\n    echo \"\n      <div class='review'>\n        <h2>$row[title]</h2>\n        <p>$row[content]</p>\n        <p>Rating: $row[rating] / 5</p>\n        <p>Created at: $row[created_at]</p>\n      </div>\n    \";\n  }\n}\n\nfunction update_review($id, $new_title, $new_content, $new_rating) {\n  global $conn;\n  \n  $sql = \"UPDATE reviews SET title='$new_title', content='$new_content', rating='$new_rating' WHERE id=$id\";\n  if ($conn->query($sql)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction delete_review($id) {\n  global $conn;\n  \n  $sql = \"DELETE FROM reviews WHERE id=$id\";\n  if ($conn->query($sql)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n?>\n```\n\n**HTML Code:**\n\nCreate a new file named `index.php` and add the following code:\n\n```php\n<?php\n\nrequire_once 'db_connection.php';\nrequire_once 'functions.php';\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Reviews</title>\n  <style>\n    .review {\n      border: 1px solid #ccc;\n      padding: 20px;\n      margin-bottom: 10px;\n    }\n  </style>\n</head>\n<body>\n\n<h1>Reviews</h1>\n\n<form action=\"\" method=\"post\">\n  <input type=\"text\" name=\"title\" placeholder=\"Title\">\n  <textarea name=\"content\"></textarea>\n  <select name=\"rating\">\n    <option value=\"1\">1/5</option>\n    <option value=\"2\">2/5</option>\n    <option value=\"3\">3/5</option>\n    <option value=\"4\">4/5</option>\n    <option value=\"5\">5/5</option>\n  </select>\n  <input type=\"submit\" name=\"submit\" value=\"Create Review\">\n</form>\n\n<?php\nif (isset($_POST['submit'])) {\n  create_review($_POST['title'], $_POST['content'], $_POST['rating'], $_GET['user_id']);\n}\n?>\n\n<h2>All Reviews:</h2>\n<div class=\"reviews-container\">\n  <?php get_reviews(); ?>\n</div>\n\n<h2>Update Review:</h2>\n<form action=\"\" method=\"post\">\n  <input type=\"text\" name=\"new_title\" placeholder=\"New Title\">\n  <textarea name=\"new_content\"></textarea>\n  <select name=\"new_rating\">\n    <option value=\"1\">1/5</option>\n    <option value=\"2\">2/5</option>\n    <option value=\"3\">3/5</option>\n    <option value=\"4\">4/5</option>\n    <option value=\"5\">5/5</option>\n  </select>\n  <input type=\"hidden\" name=\"id\" value=\"<?php echo $_GET['id']; ?>\">\n  <input type=\"submit\" name=\"update_submit\" value=\"Update Review\">\n</form>\n\n<?php\nif (isset($_POST['update_submit'])) {\n  update_review($_POST['id'], $_POST['new_title'], $_POST['new_content'], $_POST['new_rating']);\n}\n?>\n\n<h2>Delete Review:</h2>\n<form action=\"\" method=\"post\">\n  <input type=\"hidden\" name=\"delete_id\" value=\"<?php echo $_GET['id']; ?>\">\n  <input type=\"submit\" name=\"delete_submit\" value=\"Delete Review\">\n</form>\n\n<?php\nif (isset($_POST['delete_submit'])) {\n  delete_review($_POST['delete_id']);\n}\n?>\n\n</body>\n</html>\n```\n\nThis code includes the following functionality:\n\n*   Creating a new review using the `create_review` function in `functions.php`.\n*   Listing all reviews using the `get_reviews` function in `functions.php`.\n*   Updating an existing review using the `update_review` function in `functions.php`.\n*   Deleting an existing review using the `delete_review` function in `functions.php`.\n\nTo run this code, save it to your local server and navigate to `index.php`. Make sure to replace `your_username`, `your_password`, and `your_database` with your actual MySQL credentials.\n\nNote that you should take necessary precautions to prevent SQL injection attacks by using prepared statements or parameterized queries in a real-world application. This code is provided as a simplified example for demonstration purposes only.", "code_blocks": ["```php\nCREATE TABLE reviews (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  title VARCHAR(255),\n  content TEXT,\n  rating TINYINT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  user_id INT,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n```", "```php\n<?php\n\n$servername = \"localhost\";\n$username = \"your_username\";\n$password = \"your_password\";\n$dbname = \"your_database\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n?>\n```", "```php\n<?php\n\nfunction create_review($title, $content, $rating, $user_id) {\n  global $conn;\n  \n  $sql = \"INSERT INTO reviews (title, content, rating, user_id) VALUES ('$title', '$content', '$rating', '$user_id')\";\n  if ($conn->query($sql)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction get_reviews() {\n  global $conn;\n  \n  $sql = \"SELECT * FROM reviews ORDER BY id DESC\";\n  $result = $conn->query($sql);\n  while ($row = $result->fetch_assoc()) {\n    echo \"\n      <div class='review'>\n        <h2>$row[title]</h2>\n        <p>$row[content]</p>\n        <p>Rating: $row[rating] / 5</p>\n        <p>Created at: $row[created_at]</p>\n      </div>\n    \";\n  }\n}\n\nfunction update_review($id, $new_title, $new_content, $new_rating) {\n  global $conn;\n  \n  $sql = \"UPDATE reviews SET title='$new_title', content='$new_content', rating='$new_rating' WHERE id=$id\";\n  if ($conn->query($sql)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction delete_review($id) {\n  global $conn;\n  \n  $sql = \"DELETE FROM reviews WHERE id=$id\";\n  if ($conn->query($sql)) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n?>\n```", "```php\n<?php\n\nrequire_once 'db_connection.php';\nrequire_once 'functions.php';\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Reviews</title>\n  <style>\n    .review {\n      border: 1px solid #ccc;\n      padding: 20px;\n      margin-bottom: 10px;\n    }\n  </style>\n</head>\n<body>\n\n<h1>Reviews</h1>\n\n<form action=\"\" method=\"post\">\n  <input type=\"text\" name=\"title\" placeholder=\"Title\">\n  <textarea name=\"content\"></textarea>\n  <select name=\"rating\">\n    <option value=\"1\">1/5</option>\n    <option value=\"2\">2/5</option>\n    <option value=\"3\">3/5</option>\n    <option value=\"4\">4/5</option>\n    <option value=\"5\">5/5</option>\n  </select>\n  <input type=\"submit\" name=\"submit\" value=\"Create Review\">\n</form>\n\n<?php\nif (isset($_POST['submit'])) {\n  create_review($_POST['title'], $_POST['content'], $_POST['rating'], $_GET['user_id']);\n}\n?>\n\n<h2>All Reviews:</h2>\n<div class=\"reviews-container\">\n  <?php get_reviews(); ?>\n</div>\n\n<h2>Update Review:</h2>\n<form action=\"\" method=\"post\">\n  <input type=\"text\" name=\"new_title\" placeholder=\"New Title\">\n  <textarea name=\"new_content\"></textarea>\n  <select name=\"new_rating\">\n    <option value=\"1\">1/5</option>\n    <option value=\"2\">2/5</option>\n    <option value=\"3\">3/5</option>\n    <option value=\"4\">4/5</option>\n    <option value=\"5\">5/5</option>\n  </select>\n  <input type=\"hidden\" name=\"id\" value=\"<?php echo $_GET['id']; ?>\">\n  <input type=\"submit\" name=\"update_submit\" value=\"Update Review\">\n</form>\n\n<?php\nif (isset($_POST['update_submit'])) {\n  update_review($_POST['id'], $_POST['new_title'], $_POST['new_content'], $_POST['new_rating']);\n}\n?>\n\n<h2>Delete Review:</h2>\n<form action=\"\" method=\"post\">\n  <input type=\"hidden\" name=\"delete_id\" value=\"<?php echo $_GET['id']; ?>\">\n  <input type=\"submit\" name=\"delete_submit\" value=\"Delete Review\">\n</form>\n\n<?php\nif (isset($_POST['delete_submit'])) {\n  delete_review($_POST['delete_id']);\n}\n?>\n\n</body>\n</html>\n```"]}
