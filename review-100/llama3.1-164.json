{"prompt": "Create a user review function using php", "llm_output": "**User Review Function in PHP**\n=====================================\n\nThis is an example of a user review function in PHP that allows users to submit reviews for products or services. The function includes functionality for adding, editing, and deleting reviews.\n\n### Code\n```php\n// db.php (database connection file)\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nfunction add_review($product_id, $review_text, $user_id) {\n  global $conn;\n  \n  // Check if review already exists for product\n  $query = \"SELECT * FROM reviews WHERE product_id = '$product_id' AND user_id = '$user_id'\";\n  $result = mysqli_query($conn, $query);\n  if (mysqli_num_rows($result) > 0) {\n    return false; // Review already exists\n  }\n  \n  // Insert new review into database\n  $query = \"INSERT INTO reviews (product_id, review_text, user_id) VALUES ('$product_id', '$review_text', '$user_id')\";\n  mysqli_query($conn, $query);\n  return true;\n}\n\nfunction get_reviews($product_id) {\n  global $conn;\n  \n  // Retrieve all reviews for product from database\n  $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n  $result = mysqli_query($conn, $query);\n  return $result;\n}\n\nfunction edit_review($review_id, $new_review_text) {\n  global $conn;\n  \n  // Update review in database\n  $query = \"UPDATE reviews SET review_text = '$new_review_text' WHERE id = '$review_id'\";\n  mysqli_query($conn, $query);\n}\n\nfunction delete_review($review_id) {\n  global $conn;\n  \n  // Delete review from database\n  $query = \"DELETE FROM reviews WHERE id = '$review_id'\";\n  mysqli_query($conn, $query);\n}\n```\n\n### Example Usage\n\n```php\n// Add a new review for product with ID 1\nif (add_review(1, 'Great product!', 1)) {\n  echo 'Review added successfully!';\n} else {\n  echo 'Error adding review.';\n}\n\n// Get all reviews for product with ID 2\n$result = get_reviews(2);\nwhile ($review = mysqli_fetch_assoc($result)) {\n  echo $review['review_text'] . '<br>';\n}\n\n// Edit a review with ID 1\nedit_review(1, 'Even better than before!');\n\n// Delete a review with ID 3\ndelete_review(3);\n```\n\n### Database Schema\n\nAssuming the database is named `reviews_db` and has two tables: `products` and `reviews`.\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  description TEXT\n);\n\nCREATE TABLE reviews (\n  id INT PRIMARY KEY,\n  product_id INT,\n  review_text TEXT,\n  user_id INT,\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\nThis is just a basic example of how to implement a user review function in PHP using MySQL as the database management system. You may need to modify and extend this code to fit your specific requirements.", "code_blocks": ["```php\n// db.php (database connection file)\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nfunction add_review($product_id, $review_text, $user_id) {\n  global $conn;\n  \n  // Check if review already exists for product\n  $query = \"SELECT * FROM reviews WHERE product_id = '$product_id' AND user_id = '$user_id'\";\n  $result = mysqli_query($conn, $query);\n  if (mysqli_num_rows($result) > 0) {\n    return false; // Review already exists\n  }\n  \n  // Insert new review into database\n  $query = \"INSERT INTO reviews (product_id, review_text, user_id) VALUES ('$product_id', '$review_text', '$user_id')\";\n  mysqli_query($conn, $query);\n  return true;\n}\n\nfunction get_reviews($product_id) {\n  global $conn;\n  \n  // Retrieve all reviews for product from database\n  $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n  $result = mysqli_query($conn, $query);\n  return $result;\n}\n\nfunction edit_review($review_id, $new_review_text) {\n  global $conn;\n  \n  // Update review in database\n  $query = \"UPDATE reviews SET review_text = '$new_review_text' WHERE id = '$review_id'\";\n  mysqli_query($conn, $query);\n}\n\nfunction delete_review($review_id) {\n  global $conn;\n  \n  // Delete review from database\n  $query = \"DELETE FROM reviews WHERE id = '$review_id'\";\n  mysqli_query($conn, $query);\n}\n```", "```php\n// Add a new review for product with ID 1\nif (add_review(1, 'Great product!', 1)) {\n  echo 'Review added successfully!';\n} else {\n  echo 'Error adding review.';\n}\n\n// Get all reviews for product with ID 2\n$result = get_reviews(2);\nwhile ($review = mysqli_fetch_assoc($result)) {\n  echo $review['review_text'] . '<br>';\n}\n\n// Edit a review with ID 1\nedit_review(1, 'Even better than before!');\n\n// Delete a review with ID 3\ndelete_review(3);\n```", null]}
