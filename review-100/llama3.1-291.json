{"prompt": "Create a user review function using php", "llm_output": "**User Review Function in PHP**\n=====================================\n\nBelow is an example of a simple user review system in PHP. This code includes functions for creating, reading, updating, and deleting (CRUD) reviews.\n\n### Database Setup\n\nFor this example, we'll assume you have a MySQL database with the following table structure:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255)\n);\n\nCREATE TABLE reviews (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  content TEXT,\n  rating TINYINT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n```\n### PHP Code\n\n**`review.php`**\n```php\n// Include database connection settings\nrequire 'db.php';\n\nfunction create_review($data) {\n  $sql = \"INSERT INTO reviews (user_id, content, rating) VALUES (:user_id, :content, :rating)\";\n  $stmt = $pdo->prepare($sql);\n  $stmt->execute([\n    ':user_id' => $data['user_id'],\n    ':content' => $data['content'],\n    ':rating' => $data['rating']\n  ]);\n  return $pdo->lastInsertId();\n}\n\nfunction get_reviews() {\n  $sql = \"SELECT r.id, u.name, r.content, r.rating FROM reviews r JOIN users u ON r.user_id = u.id\";\n  $stmt = $pdo->query($sql);\n  return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction update_review($id, $data) {\n  $sql = \"UPDATE reviews SET content = :content, rating = :rating WHERE id = :id\";\n  $stmt = $pdo->prepare($sql);\n  $stmt->execute([\n    ':id' => $id,\n    ':content' => $data['content'],\n    ':rating' => $data['rating']\n  ]);\n}\n\nfunction delete_review($id) {\n  $sql = \"DELETE FROM reviews WHERE id = :id\";\n  $stmt = $pdo->prepare($sql);\n  $stmt->execute([\n    ':id' => $id\n  ]);\n}\n```\n### Example Usage\n\n**Create a new review**\n```php\n$data = [\n  'user_id' => 1,\n  'content' => 'This is a great product!',\n  'rating' => 5\n];\n$new_review_id = create_review($data);\necho \"New review created with ID: $new_review_id\";\n```\n**Get all reviews**\n```php\n$reviews = get_reviews();\nforeach ($reviews as $review) {\n  echo \"$review[name] rated this product $review[rating]/5: $review[content]\";\n}\n```\n**Update an existing review**\n```php\n$data = [\n  'content' => 'This is an updated review!',\n  'rating' => 4\n];\nupdate_review(1, $data);\necho \"Review with ID 1 updated successfully!\";\n```\n**Delete a review**\n```php\ndelete_review(2);\necho \"Review with ID 2 deleted successfully!\";\n```\nNote that this is a simplified example and you should consider implementing additional security measures, such as validation and sanitization of user input.", "code_blocks": [null, "```php\n// Include database connection settings\nrequire 'db.php';\n\nfunction create_review($data) {\n  $sql = \"INSERT INTO reviews (user_id, content, rating) VALUES (:user_id, :content, :rating)\";\n  $stmt = $pdo->prepare($sql);\n  $stmt->execute([\n    ':user_id' => $data['user_id'],\n    ':content' => $data['content'],\n    ':rating' => $data['rating']\n  ]);\n  return $pdo->lastInsertId();\n}\n\nfunction get_reviews() {\n  $sql = \"SELECT r.id, u.name, r.content, r.rating FROM reviews r JOIN users u ON r.user_id = u.id\";\n  $stmt = $pdo->query($sql);\n  return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction update_review($id, $data) {\n  $sql = \"UPDATE reviews SET content = :content, rating = :rating WHERE id = :id\";\n  $stmt = $pdo->prepare($sql);\n  $stmt->execute([\n    ':id' => $id,\n    ':content' => $data['content'],\n    ':rating' => $data['rating']\n  ]);\n}\n\nfunction delete_review($id) {\n  $sql = \"DELETE FROM reviews WHERE id = :id\";\n  $stmt = $pdo->prepare($sql);\n  $stmt->execute([\n    ':id' => $id\n  ]);\n}\n```", "```php\n$data = [\n  'user_id' => 1,\n  'content' => 'This is a great product!',\n  'rating' => 5\n];\n$new_review_id = create_review($data);\necho \"New review created with ID: $new_review_id\";\n```", "```php\n$reviews = get_reviews();\nforeach ($reviews as $review) {\n  echo \"$review[name] rated this product $review[rating]/5: $review[content]\";\n}\n```", "```php\n$data = [\n  'content' => 'This is an updated review!',\n  'rating' => 4\n];\nupdate_review(1, $data);\necho \"Review with ID 1 updated successfully!\";\n```", "```php\ndelete_review(2);\necho \"Review with ID 2 deleted successfully!\";\n```"]}
