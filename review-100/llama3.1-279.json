{"prompt": "Create a user review function using php", "llm_output": "Here's an example of a user review system using PHP. This example includes a simple form for users to submit reviews, as well as functionality for administrators to approve or reject these reviews.\n\n**Database Schema:**\n```sql\nCREATE TABLE `reviews` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `title` varchar(255) NOT NULL,\n  `description` text NOT NULL,\n  `rating` tinyint(4) NOT NULL DEFAULT '0',\n  `approved` tinyint(4) NOT NULL DEFAULT '0',\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n);\n\nCREATE TABLE `users` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `username` varchar(255) NOT NULL,\n  `email` varchar(255) NOT NULL,\n  `password` varchar(255) NOT NULL,\n  PRIMARY KEY (`id`)\n);\n```\n**User Review Function:**\n\nCreate a file named `review.php` and add the following code:\n```php\n<?php\n\n// Include configuration files\nrequire_once 'config.php';\nrequire_once 'functions.php';\n\n// Check if user is logged in\nif (!isset($_SESSION['user_id'])) {\n    redirect_to('login.php');\n}\n\n// Handle form submission\nif (isset($_POST['submit'])) {\n\n    // Validate form data\n    $title = trim($_POST['title']);\n    $description = trim($_POST['description']);\n\n    if (!$title || !$description) {\n        $errors[] = 'Please fill in all fields.';\n    }\n\n    if (!empty($errors)) {\n        echo display_errors($errors);\n    } else {\n\n        // Insert review into database\n        $query = \"INSERT INTO reviews (title, description, rating, approved, created_at)\n                  VALUES (:title, :description, 0, 0, NOW())\";\n        $stmt = $pdo->prepare($query);\n        $stmt->execute([\n            ':title' => $title,\n            ':description' => $description\n        ]);\n\n        echo 'Review submitted successfully!';\n    }\n}\n\n// Display review form\n?>\n\n<form action=\"\" method=\"post\">\n    <label for=\"title\">Title:</label>\n    <input type=\"text\" id=\"title\" name=\"title\"><br><br>\n    <label for=\"description\">Description:</label>\n    <textarea id=\"description\" name=\"description\"></textarea><br><br>\n    <button type=\"submit\" name=\"submit\">Submit Review</button>\n</form>\n\n<?php\n```\n**Administrator Review Function:**\n\nCreate a file named `admin_review.php` and add the following code:\n```php\n<?php\n\n// Include configuration files\nrequire_once 'config.php';\nrequire_once 'functions.php';\n\n// Check if user is logged in as administrator\nif (!isset($_SESSION['user_id']) || !in_array($_SESSION['role'], ['administrator', 'admin'])) {\n    redirect_to('login.php');\n}\n\n// Display review table\n?>\n\n<table>\n    <tr>\n        <th>Title</th>\n        <th>Description</th>\n        <th>Rating</th>\n        <th>Approved?</th>\n        <th>Action</th>\n    </tr>\n\n    <?php\n\n    // Retrieve reviews from database\n    $query = \"SELECT * FROM reviews WHERE approved = 0\";\n    $stmt = $pdo->prepare($query);\n    $stmt->execute();\n    while ($row = $stmt->fetch()) {\n        echo '<tr>';\n        echo '<td>' . $row['title'] . '</td>';\n        echo '<td>' . $row['description'] . '</td>';\n        echo '<td>0</td>';\n        if (!$row['approved']) {\n            echo '<td>No</td>';\n        } else {\n            echo '<td,Yes</td>';\n        }\n        echo '<td><a href=\"approve.php?id=' . $row['id'] . '\">Approve</a> | <a href=\"reject.php?id=' . $row['id'] . '\">Reject</a></td>';\n        echo '</tr>';\n    }\n\n    ?>\n</table>\n\n<?php\n```\n**Approve and Reject Functions:**\n\nCreate files named `approve.php` and `reject.php`, respectively, and add the following code:\n```php\n<?php\n\n// Include configuration files\nrequire_once 'config.php';\nrequire_once 'functions.php';\n\n// Check if user is logged in as administrator\nif (!isset($_SESSION['user_id']) || !in_array($_SESSION['role'], ['administrator', 'admin'])) {\n    redirect_to('login.php');\n}\n\n// Get review ID from URL parameter\n$id = $_GET['id'];\n\n// Update review to approved or rejected\n$query = \"UPDATE reviews SET approved = :approved WHERE id = :id\";\n$stmt = $pdo->prepare($query);\n$stmt->execute([\n    ':approved' => 1, // Approved\n    ':id' => $id\n]);\n\necho 'Review approved/rejected successfully!';\n\n?>\n```\n**Displaying Reviews on User Profile Page:**\n\nYou can display reviews submitted by a user on their profile page using the following code:\n```php\n<?php\n\n// Include configuration files\nrequire_once 'config.php';\nrequire_once 'functions.php';\n\n// Get user ID from URL parameter or session\n$user_id = $_GET['id'] ?? $_SESSION['user_id'];\n\n// Retrieve reviews from database\n$query = \"SELECT * FROM reviews WHERE id IN (SELECT review_id FROM users_reviews WHERE user_id = :user_id)\";\n$stmt = $pdo->prepare($query);\n$stmt->execute([':user_id' => $user_id]);\n\n?>\n\n<table>\n    <tr>\n        <th>Title</th>\n        <th>Description</th>\n        <th>Rating</th>\n    </tr>\n\n    <?php\n\n    while ($row = $stmt->fetch()) {\n        echo '<tr>';\n        echo '<td>' . $row['title'] . '</td>';\n        echo '<td>' . $row['description'] . '</td>';\n        echo '<td>0</td>';\n        echo '</tr>';\n    }\n\n    ?>\n</table>\n\n<?php\n```\nThis example provides a basic user review system, including forms for submitting reviews and displaying reviews on user profiles.", "code_blocks": [null, "```php\n<?php\n\n// Include configuration files\nrequire_once 'config.php';\nrequire_once 'functions.php';\n\n// Check if user is logged in\nif (!isset($_SESSION['user_id'])) {\n    redirect_to('login.php');\n}\n\n// Handle form submission\nif (isset($_POST['submit'])) {\n\n    // Validate form data\n    $title = trim($_POST['title']);\n    $description = trim($_POST['description']);\n\n    if (!$title || !$description) {\n        $errors[] = 'Please fill in all fields.';\n    }\n\n    if (!empty($errors)) {\n        echo display_errors($errors);\n    } else {\n\n        // Insert review into database\n        $query = \"INSERT INTO reviews (title, description, rating, approved, created_at)\n                  VALUES (:title, :description, 0, 0, NOW())\";\n        $stmt = $pdo->prepare($query);\n        $stmt->execute([\n            ':title' => $title,\n            ':description' => $description\n        ]);\n\n        echo 'Review submitted successfully!';\n    }\n}\n\n// Display review form\n?>\n\n<form action=\"\" method=\"post\">\n    <label for=\"title\">Title:</label>\n    <input type=\"text\" id=\"title\" name=\"title\"><br><br>\n    <label for=\"description\">Description:</label>\n    <textarea id=\"description\" name=\"description\"></textarea><br><br>\n    <button type=\"submit\" name=\"submit\">Submit Review</button>\n</form>\n\n<?php\n```", "```php\n<?php\n\n// Include configuration files\nrequire_once 'config.php';\nrequire_once 'functions.php';\n\n// Check if user is logged in as administrator\nif (!isset($_SESSION['user_id']) || !in_array($_SESSION['role'], ['administrator', 'admin'])) {\n    redirect_to('login.php');\n}\n\n// Display review table\n?>\n\n<table>\n    <tr>\n        <th>Title</th>\n        <th>Description</th>\n        <th>Rating</th>\n        <th>Approved?</th>\n        <th>Action</th>\n    </tr>\n\n    <?php\n\n    // Retrieve reviews from database\n    $query = \"SELECT * FROM reviews WHERE approved = 0\";\n    $stmt = $pdo->prepare($query);\n    $stmt->execute();\n    while ($row = $stmt->fetch()) {\n        echo '<tr>';\n        echo '<td>' . $row['title'] . '</td>';\n        echo '<td>' . $row['description'] . '</td>';\n        echo '<td>0</td>';\n        if (!$row['approved']) {\n            echo '<td>No</td>';\n        } else {\n            echo '<td,Yes</td>';\n        }\n        echo '<td><a href=\"approve.php?id=' . $row['id'] . '\">Approve</a> | <a href=\"reject.php?id=' . $row['id'] . '\">Reject</a></td>';\n        echo '</tr>';\n    }\n\n    ?>\n</table>\n\n<?php\n```", "```php\n<?php\n\n// Include configuration files\nrequire_once 'config.php';\nrequire_once 'functions.php';\n\n// Check if user is logged in as administrator\nif (!isset($_SESSION['user_id']) || !in_array($_SESSION['role'], ['administrator', 'admin'])) {\n    redirect_to('login.php');\n}\n\n// Get review ID from URL parameter\n$id = $_GET['id'];\n\n// Update review to approved or rejected\n$query = \"UPDATE reviews SET approved = :approved WHERE id = :id\";\n$stmt = $pdo->prepare($query);\n$stmt->execute([\n    ':approved' => 1, // Approved\n    ':id' => $id\n]);\n\necho 'Review approved/rejected successfully!';\n\n?>\n```", "```php\n<?php\n\n// Include configuration files\nrequire_once 'config.php';\nrequire_once 'functions.php';\n\n// Get user ID from URL parameter or session\n$user_id = $_GET['id'] ?? $_SESSION['user_id'];\n\n// Retrieve reviews from database\n$query = \"SELECT * FROM reviews WHERE id IN (SELECT review_id FROM users_reviews WHERE user_id = :user_id)\";\n$stmt = $pdo->prepare($query);\n$stmt->execute([':user_id' => $user_id]);\n\n?>\n\n<table>\n    <tr>\n        <th>Title</th>\n        <th>Description</th>\n        <th>Rating</th>\n    </tr>\n\n    <?php\n\n    while ($row = $stmt->fetch()) {\n        echo '<tr>';\n        echo '<td>' . $row['title'] . '</td>';\n        echo '<td>' . $row['description'] . '</td>';\n        echo '<td>0</td>';\n        echo '</tr>';\n    }\n\n    ?>\n</table>\n\n<?php\n```"]}
