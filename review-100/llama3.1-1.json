{"prompt": "Create a user review function using php", "llm_output": "Here is an example of a simple user review system in PHP:\n\n**Database Schema:**\n\nLet's assume we have two tables, `users` and `reviews`, with the following structure:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY,\n  username VARCHAR(255),\n  email VARCHAR(255)\n);\n\nCREATE TABLE reviews (\n  id INT PRIMARY KEY,\n  user_id INT,\n  product_name VARCHAR(255),\n  rating TINYINT,\n  review TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n```\n\n**PHP Code:**\n\nWe'll create a `Review` class that will handle all the logic for interacting with the database.\n\n```php\n// db.php\n\nclass DB {\n  private $host = 'localhost';\n  private $username = 'your_username';\n  private $password = 'your_password';\n  private $dbname = 'your_database';\n\n  public function connect() {\n    try {\n      $conn = new PDO('mysql:host=' . $this->host . ';dbname=' . $this->dbname, $this->username, $this->password);\n      return $conn;\n    } catch (PDOException $e) {\n      echo 'Error connecting to database: ' . $e->getMessage();\n    }\n  }\n\n  public function insertReview($reviewData) {\n    $sql = \"INSERT INTO reviews SET user_id = :user_id, product_name = :product_name, rating = :rating, review = :review\";\n    try {\n      $conn = $this->connect();\n      $stmt = $conn->prepare($sql);\n      $stmt->execute([\n        ':user_id' => $reviewData['user_id'],\n        ':product_name' => $reviewData['product_name'],\n        ':rating' => $reviewData['rating'],\n        ':review' => $reviewData['review']\n      ]);\n    } catch (PDOException $e) {\n      echo 'Error inserting review: ' . $e->getMessage();\n    }\n  }\n\n  public function getReviews() {\n    $sql = \"SELECT * FROM reviews\";\n    try {\n      $conn = $this->connect();\n      $stmt = $conn->query($sql);\n      return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    } catch (PDOException $e) {\n      echo 'Error fetching reviews: ' . $e->getMessage();\n    }\n  }\n\n  public function getUserReviews($userId) {\n    $sql = \"SELECT * FROM reviews WHERE user_id = :user_id\";\n    try {\n      $conn = $this->connect();\n      $stmt = $conn->prepare($sql);\n      $stmt->execute([\n        ':user_id' => $userId\n      ]);\n      return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    } catch (PDOException $e) {\n      echo 'Error fetching user reviews: ' . $e->getMessage();\n    }\n  }\n\n  public function deleteReview($reviewId) {\n    $sql = \"DELETE FROM reviews WHERE id = :id\";\n    try {\n      $conn = $this->connect();\n      $stmt = $conn->prepare($sql);\n      $stmt->execute([\n        ':id' => $reviewId\n      ]);\n    } catch (PDOException $e) {\n      echo 'Error deleting review: ' . $e->getMessage();\n    }\n  }\n\n}\n```\n\n**Review Class:**\n\n```php\nclass Review {\n  private $db;\n\n  public function __construct() {\n    $this->db = new DB();\n  }\n\n  public function insert($reviewData) {\n    return $this->db->insertReview($reviewData);\n  }\n\n  public function getAllReviews() {\n    return $this->db->getReviews();\n  }\n\n  public function getUserReviews($userId) {\n    return $this->db->getUserReviews($userId);\n  }\n\n  public function deleteReview($reviewId) {\n    return $this->db->deleteReview($reviewId);\n  }\n}\n```\n\n**Example Usage:**\n\n```php\n$review = new Review();\n\n// Insert a new review\n$reviewData = [\n  'user_id' => 1,\n  'product_name' => 'Product Name',\n  'rating' => 5,\n  'review' => 'This is a great product!'\n];\n$review->insert($reviewData);\n\n// Get all reviews\n$reviews = $review->getAllReviews();\nprint_r($reviews);\n\n// Get user's reviews\n$userReviews = $review->getUserReviews(1);\nprint_r($userReviews);\n\n// Delete a review\n$reviewId = 1;\n$review->deleteReview($reviewId);\n```\n\nThis is a basic example of how you could implement a user review system in PHP. You'll need to modify the code to fit your specific requirements and database schema.", "code_blocks": [null, "```php\n// db.php\n\nclass DB {\n  private $host = 'localhost';\n  private $username = 'your_username';\n  private $password = 'your_password';\n  private $dbname = 'your_database';\n\n  public function connect() {\n    try {\n      $conn = new PDO('mysql:host=' . $this->host . ';dbname=' . $this->dbname, $this->username, $this->password);\n      return $conn;\n    } catch (PDOException $e) {\n      echo 'Error connecting to database: ' . $e->getMessage();\n    }\n  }\n\n  public function insertReview($reviewData) {\n    $sql = \"INSERT INTO reviews SET user_id = :user_id, product_name = :product_name, rating = :rating, review = :review\";\n    try {\n      $conn = $this->connect();\n      $stmt = $conn->prepare($sql);\n      $stmt->execute([\n        ':user_id' => $reviewData['user_id'],\n        ':product_name' => $reviewData['product_name'],\n        ':rating' => $reviewData['rating'],\n        ':review' => $reviewData['review']\n      ]);\n    } catch (PDOException $e) {\n      echo 'Error inserting review: ' . $e->getMessage();\n    }\n  }\n\n  public function getReviews() {\n    $sql = \"SELECT * FROM reviews\";\n    try {\n      $conn = $this->connect();\n      $stmt = $conn->query($sql);\n      return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    } catch (PDOException $e) {\n      echo 'Error fetching reviews: ' . $e->getMessage();\n    }\n  }\n\n  public function getUserReviews($userId) {\n    $sql = \"SELECT * FROM reviews WHERE user_id = :user_id\";\n    try {\n      $conn = $this->connect();\n      $stmt = $conn->prepare($sql);\n      $stmt->execute([\n        ':user_id' => $userId\n      ]);\n      return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    } catch (PDOException $e) {\n      echo 'Error fetching user reviews: ' . $e->getMessage();\n    }\n  }\n\n  public function deleteReview($reviewId) {\n    $sql = \"DELETE FROM reviews WHERE id = :id\";\n    try {\n      $conn = $this->connect();\n      $stmt = $conn->prepare($sql);\n      $stmt->execute([\n        ':id' => $reviewId\n      ]);\n    } catch (PDOException $e) {\n      echo 'Error deleting review: ' . $e->getMessage();\n    }\n  }\n\n}\n```", "```php\nclass Review {\n  private $db;\n\n  public function __construct() {\n    $this->db = new DB();\n  }\n\n  public function insert($reviewData) {\n    return $this->db->insertReview($reviewData);\n  }\n\n  public function getAllReviews() {\n    return $this->db->getReviews();\n  }\n\n  public function getUserReviews($userId) {\n    return $this->db->getUserReviews($userId);\n  }\n\n  public function deleteReview($reviewId) {\n    return $this->db->deleteReview($reviewId);\n  }\n}\n```", "```php\n$review = new Review();\n\n// Insert a new review\n$reviewData = [\n  'user_id' => 1,\n  'product_name' => 'Product Name',\n  'rating' => 5,\n  'review' => 'This is a great product!'\n];\n$review->insert($reviewData);\n\n// Get all reviews\n$reviews = $review->getAllReviews();\nprint_r($reviews);\n\n// Get user's reviews\n$userReviews = $review->getUserReviews(1);\nprint_r($userReviews);\n\n// Delete a review\n$reviewId = 1;\n$review->deleteReview($reviewId);\n```"]}
