{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP:\n\n**Database Table Structure:**\n\nWe will be using the following database table structure for this example:\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY,\n  customer_name VARCHAR(255),\n  order_date DATE\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY,\n  order_id INT,\n  product_id INT,\n  quantity INT,\n  FOREIGN KEY (order_id) REFERENCES orders(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n**PHP Code:**\n\nWe will create a PHP script that allows customers to place an order, and also includes functionality for administrators to view orders and manage inventory.\n```php\n// database connection settings\n$host = 'localhost';\n$dbname = 'example_database';\n$user = 'root';\n$password = '';\n\n// connect to the database\n$conn = new mysqli($host, $user, $password, $dbname);\n\n// check if the database is connected successfully\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// function to place an order\nfunction placeOrder($customerName, $orderDate, $productIds, $quantities) {\n  // insert new order into orders table\n  $query = \"INSERT INTO orders (customer_name, order_date) VALUES (?, ?)\";\n  $stmt = $conn->prepare($query);\n  $stmt->bind_param(\"ss\", $customerName, $orderDate);\n  $stmt->execute();\n\n  // get the id of the newly inserted order\n  $orderId = $conn->insert_id;\n\n  // insert new order items into order_items table\n  foreach ($productIds as $index => $productId) {\n    $query = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES (?, ?, ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"iii\", $orderId, $productId, $quantities[$index]);\n    $stmt->execute();\n  }\n\n  return $orderId;\n}\n\n// function to view orders\nfunction viewOrders() {\n  // select all orders from the orders table\n  $query = \"SELECT * FROM orders\";\n  $result = $conn->query($query);\n\n  while ($row = $result->fetch_assoc()) {\n    echo \"Order ID: \" . $row['id'] . \"<br>\";\n    echo \"Customer Name: \" . $row['customer_name'] . \"<br>\";\n    echo \"Order Date: \" . $row['order_date'] . \"<br>\";\n\n    // select all order items for the current order\n    $query = \"SELECT * FROM order_items WHERE order_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $row['id']);\n    $stmt->execute();\n    $orderItemsResult = $stmt->get_result();\n\n    while ($orderItemRow = $orderItemsResult->fetch_assoc()) {\n      echo \"Product ID: \" . $orderItemRow['product_id'] . \"<br>\";\n      echo \"Quantity: \" . $orderItemRow['quantity'] . \"<br>\";\n    }\n  }\n}\n\n// function to manage inventory\nfunction manageInventory() {\n  // select all products from the products table\n  $query = \"SELECT * FROM products\";\n  $result = $conn->query($query);\n\n  while ($row = $result->fetch_assoc()) {\n    echo \"Product ID: \" . $row['id'] . \"<br>\";\n    echo \"Name: \" . $row['name'] . \"<br>\";\n    echo \"Price: $\" . $row['price'] . \"<br>\";\n\n    // select all order items for the current product\n    $query = \"SELECT * FROM order_items WHERE product_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $row['id']);\n    $stmt->execute();\n    $orderItemsResult = $stmt->get_result();\n\n    while ($orderItemRow = $orderItemsResult->fetch_assoc()) {\n      echo \"Order ID: \" . $orderItemRow['order_id'] . \"<br>\";\n      echo \"Quantity: \" . $orderItemRow['quantity'] . \"<br>\";\n    }\n  }\n}\n\n// example usage\nif (isset($_POST['place_order'])) {\n  $customerName = $_POST['customer_name'];\n  $orderDate = date('Y-m-d');\n  $productIds = array_map(function($value) { return intval($value); }, explode(',', $_POST['product_ids']));\n  $quantities = array_map(function($value) { return intval($value); }, explode(',', $_POST['quantities']));\n\n  $orderId = placeOrder($customerName, $orderDate, $productIds, $quantities);\n  echo \"Order placed successfully! Order ID: $orderId\";\n} elseif (isset($_POST['view_orders'])) {\n  viewOrders();\n} elseif (isset($_POST['manage_inventory'])) {\n  manageInventory();\n}\n```\n**HTML Form for Customer to Place an Order:**\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Place Order</title>\n</head>\n<body>\n\n<form action=\"\" method=\"post\">\n    <label for=\"customer_name\">Customer Name:</label>\n    <input type=\"text\" id=\"customer_name\" name=\"customer_name\"><br><br>\n\n    <label for=\"product_ids\">Product IDs (comma-separated):</label>\n    <input type=\"text\" id=\"product_ids\" name=\"product_ids\"><br><br>\n\n    <label for=\"quantities\">Quantities (comma-separated):</label>\n    <input type=\"text\" id=\"quantities\" name=\"quantities\"><br><br>\n\n    <input type=\"submit\" name=\"place_order\" value=\"Place Order\">\n</form>\n\n<form action=\"\" method=\"post\">\n    <input type=\"submit\" name=\"view_orders\" value=\"View Orders\">\n</form>\n\n<form action=\"\" method=\"post\">\n    <input type=\"submit\" name=\"manage_inventory\" value=\"Manage Inventory\">\n</form>\n```\nThis code sets up a basic purchase functionality with database operations. When a customer places an order, the order and its associated products are inserted into the `orders` and `order_items` tables respectively. When an administrator views orders or manages inventory, they can see the details of all orders and their associated products.\n\nNote: This is just a simple example to demonstrate basic functionality. In a real-world application, you would want to add error checking and validation for user input, implement authentication/authorization, handle order processing (e.g., payment gateways), etc.", "code_blocks": [null, "```php\n// database connection settings\n$host = 'localhost';\n$dbname = 'example_database';\n$user = 'root';\n$password = '';\n\n// connect to the database\n$conn = new mysqli($host, $user, $password, $dbname);\n\n// check if the database is connected successfully\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// function to place an order\nfunction placeOrder($customerName, $orderDate, $productIds, $quantities) {\n  // insert new order into orders table\n  $query = \"INSERT INTO orders (customer_name, order_date) VALUES (?, ?)\";\n  $stmt = $conn->prepare($query);\n  $stmt->bind_param(\"ss\", $customerName, $orderDate);\n  $stmt->execute();\n\n  // get the id of the newly inserted order\n  $orderId = $conn->insert_id;\n\n  // insert new order items into order_items table\n  foreach ($productIds as $index => $productId) {\n    $query = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES (?, ?, ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"iii\", $orderId, $productId, $quantities[$index]);\n    $stmt->execute();\n  }\n\n  return $orderId;\n}\n\n// function to view orders\nfunction viewOrders() {\n  // select all orders from the orders table\n  $query = \"SELECT * FROM orders\";\n  $result = $conn->query($query);\n\n  while ($row = $result->fetch_assoc()) {\n    echo \"Order ID: \" . $row['id'] . \"<br>\";\n    echo \"Customer Name: \" . $row['customer_name'] . \"<br>\";\n    echo \"Order Date: \" . $row['order_date'] . \"<br>\";\n\n    // select all order items for the current order\n    $query = \"SELECT * FROM order_items WHERE order_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $row['id']);\n    $stmt->execute();\n    $orderItemsResult = $stmt->get_result();\n\n    while ($orderItemRow = $orderItemsResult->fetch_assoc()) {\n      echo \"Product ID: \" . $orderItemRow['product_id'] . \"<br>\";\n      echo \"Quantity: \" . $orderItemRow['quantity'] . \"<br>\";\n    }\n  }\n}\n\n// function to manage inventory\nfunction manageInventory() {\n  // select all products from the products table\n  $query = \"SELECT * FROM products\";\n  $result = $conn->query($query);\n\n  while ($row = $result->fetch_assoc()) {\n    echo \"Product ID: \" . $row['id'] . \"<br>\";\n    echo \"Name: \" . $row['name'] . \"<br>\";\n    echo \"Price: $\" . $row['price'] . \"<br>\";\n\n    // select all order items for the current product\n    $query = \"SELECT * FROM order_items WHERE product_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $row['id']);\n    $stmt->execute();\n    $orderItemsResult = $stmt->get_result();\n\n    while ($orderItemRow = $orderItemsResult->fetch_assoc()) {\n      echo \"Order ID: \" . $orderItemRow['order_id'] . \"<br>\";\n      echo \"Quantity: \" . $orderItemRow['quantity'] . \"<br>\";\n    }\n  }\n}\n\n// example usage\nif (isset($_POST['place_order'])) {\n  $customerName = $_POST['customer_name'];\n  $orderDate = date('Y-m-d');\n  $productIds = array_map(function($value) { return intval($value); }, explode(',', $_POST['product_ids']));\n  $quantities = array_map(function($value) { return intval($value); }, explode(',', $_POST['quantities']));\n\n  $orderId = placeOrder($customerName, $orderDate, $productIds, $quantities);\n  echo \"Order placed successfully! Order ID: $orderId\";\n} elseif (isset($_POST['view_orders'])) {\n  viewOrders();\n} elseif (isset($_POST['manage_inventory'])) {\n  manageInventory();\n}\n```", null]}
