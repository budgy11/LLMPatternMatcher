{"prompt": "Create a purchase functionality using php", "llm_output": "Here's an example of how you can create a simple purchase functionality using PHP:\n\n**Note:** This is just a basic example, and in a real-world scenario, you would want to add more features such as payment processing, order management, and security measures.\n\n**Database Schema:**\n\nWe'll assume we have two tables in our database: `products` and `orders`.\n\n| Field Name | Data Type |\n| --- | --- |\n| id | int (primary key) |\n| name | varchar(255) |\n| price | decimal(10, 2) |\n| quantity | int |\n\n| Field Name | Data Type |\n| --- | --- |\n| id | int (primary key) |\n| customer_name | varchar(255) |\n| product_id | int (foreign key to products table) |\n| order_date | date |\n| total_cost | decimal(10, 2) |\n\n**PHP Code:**\n\nCreate a new file named `purchase.php` and add the following code:\n\n```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\nif (!$conn) {\n    die('Could not connect: ' . mysqli_error());\n}\n\n// Function to display products\nfunction displayProducts() {\n    global $conn;\n    $sql = \"SELECT * FROM products\";\n    $result = mysqli_query($conn, $sql);\n    \n    if (mysqli_num_rows($result) > 0) {\n        echo '<table border=\"1\" cellpadding=\"5\">';\n        while ($row = mysqli_fetch_assoc($result)) {\n            echo '<tr>';\n            echo '<td>' . $row['name'] . '</td>';\n            echo '<td>Price: $' . number_format($row['price'], 2) . '</td>';\n            echo '<td>Quantity: ' . $row['quantity'] . '</td>';\n            echo '<td><button class=\"add-to-cart\" data-id=\"' . $row['id'] . '\">Add to Cart</button></td>';\n            echo '</tr>';\n        }\n        echo '</table>';\n    } else {\n        echo 'No products found.';\n    }\n}\n\n// Function to add product to cart\nfunction addToCart($product_id) {\n    global $conn;\n    $_SESSION['cart'][$product_id] = true;\n    header('Location: purchase.php');\n    exit;\n}\n\n// Function to display cart contents\nfunction displayCart() {\n    global $conn, $_SESSION;\n    \n    if (isset($_SESSION['cart'])) {\n        echo '<h2>Cart Contents:</h2>';\n        echo '<ul>';\n        foreach ($_SESSION['cart'] as $product_id => $value) {\n            $sql = \"SELECT * FROM products WHERE id = '$product_id'\";\n            $result = mysqli_query($conn, $sql);\n            \n            if (mysqli_num_rows($result) > 0) {\n                while ($row = mysqli_fetch_assoc($result)) {\n                    echo '<li>';\n                    echo $row['name'] . ' - Price: $' . number_format($row['price'], 2);\n                    echo '</li>';\n                }\n            } else {\n                echo '<li>Product not found.</li>';\n            }\n        }\n        echo '</ul>';\n    } else {\n        echo '<h2>No products in cart.</h2>';\n    }\n}\n\n// Function to process purchase\nfunction processPurchase() {\n    global $conn, $_SESSION;\n    \n    if (isset($_POST['submit'])) {\n        // Validate form data\n        if (!empty($_POST['customer_name']) && !empty($_POST['payment_method'])) {\n            // Process payment and update database\n            // For simplicity, we'll just print a success message\n            echo 'Purchase processed successfully!';\n        } else {\n            echo 'Please fill out all fields.';\n        }\n    }\n}\n\n// Display products\ndisplayProducts();\n\n// Add event listeners to buttons\n?>\n\n<script>\n    document.addEventListener('DOMContentLoaded', function() {\n        const addToCartButtons = document.querySelectorAll('.add-to-cart');\n        \n        addToCartButtons.forEach(button => {\n            button.addEventListener('click', function() {\n                const productId = this.getAttribute('data-id');\n                addToCart(productId);\n            });\n        });\n    });\n</script>\n\n<?php\n// Display cart contents and process purchase form\ndisplayCart();\n?>\n\n<h2>Purchase Form:</h2>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"customer_name\">Customer Name:</label>\n    <input type=\"text\" id=\"customer_name\" name=\"customer_name\"><br><br>\n    <label for=\"payment_method\">Payment Method:</label>\n    <select id=\"payment_method\" name=\"payment_method\">\n        <option value=\"\">Select a payment method</option>\n        <option value=\"credit_card\">Credit Card</option>\n        <option value=\"paypal\">PayPal</option>\n    </select><br><br>\n    <input type=\"submit\" name=\"submit\" value=\"Purchase\">\n</form>\n\n<?php\nprocessPurchase();\n?>\n```\n\n**Explanation:**\n\n1. The script connects to the database and selects all products from the `products` table.\n2. It displays the products in a table with buttons to add each product to cart.\n3. When a button is clicked, it adds the corresponding product ID to the session cart array using the `addToCart()` function.\n4. The script then displays the contents of the cart.\n5. A purchase form is displayed at the bottom of the page, which allows customers to enter their name and select a payment method.\n6. When the \"Purchase\" button is clicked, it processes the purchase using the `processPurchase()` function.\n\n**Note:** This is a basic example and does not include any security measures or error handling. You should consider adding these features in your production code.", "code_blocks": ["```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\nif (!$conn) {\n    die('Could not connect: ' . mysqli_error());\n}\n\n// Function to display products\nfunction displayProducts() {\n    global $conn;\n    $sql = \"SELECT * FROM products\";\n    $result = mysqli_query($conn, $sql);\n    \n    if (mysqli_num_rows($result) > 0) {\n        echo '<table border=\"1\" cellpadding=\"5\">';\n        while ($row = mysqli_fetch_assoc($result)) {\n            echo '<tr>';\n            echo '<td>' . $row['name'] . '</td>';\n            echo '<td>Price: $' . number_format($row['price'], 2) . '</td>';\n            echo '<td>Quantity: ' . $row['quantity'] . '</td>';\n            echo '<td><button class=\"add-to-cart\" data-id=\"' . $row['id'] . '\">Add to Cart</button></td>';\n            echo '</tr>';\n        }\n        echo '</table>';\n    } else {\n        echo 'No products found.';\n    }\n}\n\n// Function to add product to cart\nfunction addToCart($product_id) {\n    global $conn;\n    $_SESSION['cart'][$product_id] = true;\n    header('Location: purchase.php');\n    exit;\n}\n\n// Function to display cart contents\nfunction displayCart() {\n    global $conn, $_SESSION;\n    \n    if (isset($_SESSION['cart'])) {\n        echo '<h2>Cart Contents:</h2>';\n        echo '<ul>';\n        foreach ($_SESSION['cart'] as $product_id => $value) {\n            $sql = \"SELECT * FROM products WHERE id = '$product_id'\";\n            $result = mysqli_query($conn, $sql);\n            \n            if (mysqli_num_rows($result) > 0) {\n                while ($row = mysqli_fetch_assoc($result)) {\n                    echo '<li>';\n                    echo $row['name'] . ' - Price: $' . number_format($row['price'], 2);\n                    echo '</li>';\n                }\n            } else {\n                echo '<li>Product not found.</li>';\n            }\n        }\n        echo '</ul>';\n    } else {\n        echo '<h2>No products in cart.</h2>';\n    }\n}\n\n// Function to process purchase\nfunction processPurchase() {\n    global $conn, $_SESSION;\n    \n    if (isset($_POST['submit'])) {\n        // Validate form data\n        if (!empty($_POST['customer_name']) && !empty($_POST['payment_method'])) {\n            // Process payment and update database\n            // For simplicity, we'll just print a success message\n            echo 'Purchase processed successfully!';\n        } else {\n            echo 'Please fill out all fields.';\n        }\n    }\n}\n\n// Display products\ndisplayProducts();\n\n// Add event listeners to buttons\n?>\n\n<script>\n    document.addEventListener('DOMContentLoaded', function() {\n        const addToCartButtons = document.querySelectorAll('.add-to-cart');\n        \n        addToCartButtons.forEach(button => {\n            button.addEventListener('click', function() {\n                const productId = this.getAttribute('data-id');\n                addToCart(productId);\n            });\n        });\n    });\n</script>\n\n<?php\n// Display cart contents and process purchase form\ndisplayCart();\n?>\n\n<h2>Purchase Form:</h2>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"customer_name\">Customer Name:</label>\n    <input type=\"text\" id=\"customer_name\" name=\"customer_name\"><br><br>\n    <label for=\"payment_method\">Payment Method:</label>\n    <select id=\"payment_method\" name=\"payment_method\">\n        <option value=\"\">Select a payment method</option>\n        <option value=\"credit_card\">Credit Card</option>\n        <option value=\"paypal\">PayPal</option>\n    </select><br><br>\n    <input type=\"submit\" name=\"submit\" value=\"Purchase\">\n</form>\n\n<?php\nprocessPurchase();\n?>\n```"]}
