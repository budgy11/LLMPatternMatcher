{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a simple \"Add to Cart\" and \"Checkout\" functionality in PHP. This will include the following features:\n\n*   Product list with prices\n*   Add product to cart functionality\n*   Display products in cart\n*   Calculate total cost of items in cart\n*   Checkout button\n\n**Note:** This is just a simple example, you may need to adapt it to your specific use case.\n\n### Database Setup\n\nFor this example, we will be using MySQL as our database. The schema for the `products` table and the `cart` table would look like this:\n\n```sql\nCREATE TABLE products (\n  id INT AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE cart (\n  id INT AUTO_INCREMENT,\n  user_id INT,\n  product_id INT,\n  quantity INT,\n  PRIMARY KEY (id),\n  FOREIGN KEY (user_id) REFERENCES users(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n### PHP Code\n\n```php\n// db.php: Database connection file\n<?php\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"store\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n?>\n\n// products.php: Display all products\n<?php\ninclude 'db.php';\n\n$sql = \"SELECT * FROM products\";\n$result = $conn->query($sql);\n\nif ($result->num_rows > 0) {\n    // output data of each row\n    while($row = $result->fetch_assoc()) {\n        echo \"Product ID: \" . $row[\"id\"]. \" - Product Name: \" . $row[\"name\"]. \" (\" . $row[\"price\"] . \")\" . \"<br>\";\n    }\n} else {\n    echo \"0 results\";\n}\n?>\n\n// cart.php: Display products in cart and add product to cart\n<?php\ninclude 'db.php';\n\nif (isset($_SESSION['cart'])) {\n    // Display products in cart\n    echo \"Products in Cart:<br>\";\n    $total = 0;\n    foreach ($_SESSION['cart'] as $product_id => $quantity) {\n        $sql = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($sql);\n        if ($result->num_rows > 0) {\n            while($row = $result->fetch_assoc()) {\n                echo \"Product Name: \" . $row[\"name\"]. \", Quantity: $quantity, Price: \" . $row[\"price\"] . \"<br>\";\n                $total += $row[\"price\"] * $quantity;\n            }\n        } else {\n            echo \"0 results\";\n        }\n    }\n} else {\n    // Display empty cart\n}\n\n// Add product to cart\nif (isset($_POST['add_to_cart'])) {\n    $product_id = $_POST['product_id'];\n    if (!isset($_SESSION['cart'][$product_id])) {\n        $_SESSION['cart'][$product_id] = 1;\n    } else {\n        $_SESSION['cart'][$product_id]++;\n    }\n}\n\n// Checkout button\nif (isset($_POST['checkout'])) {\n    // Process checkout logic here\n}\n?>\n\n// index.php: Main page with product list and cart functionality\n<?php\ninclude 'db.php';\n\n?>\n<html>\n<head>\n  <title>Store</title>\n</head>\n<body>\n\n<h2>Products:</h2>\n\n<form action=\"cart.php\" method=\"post\">\n    <?php\n        // Display products\n        $sql = \"SELECT * FROM products\";\n        $result = $conn->query($sql);\n        \n        if ($result->num_rows > 0) {\n            while($row = $result->fetch_assoc()) {\n                echo \"<input type='hidden' name='product_id[]' value='\" . $row[\"id\"] . \"'><br>\";\n                echo $row[\"name\"]. \" (\" . $row[\"price\"] . \")<br>\";\n                echo \"<button name='add_to_cart'>Add to Cart</button><br>\";\n            }\n        } else {\n            echo \"0 results\";\n        }\n    ?>\n</form>\n\n<?php\n// Display cart and checkout button\n?>\n\n<form action=\"\" method=\"post\">\n    <input type=\"submit\" name=\"checkout\" value=\"Checkout\">\n</form>\n\n</body>\n</html>\n```\n\n### Example Use Case\n\n1.  Open `index.php` in your web browser to view the product list.\n2.  Click on a product to add it to cart.\n3.  The cart will display the products you've added, with their respective prices and quantities.\n4.  Once you're done adding products to your cart, click on the \"Checkout\" button.\n\nThis is a basic implementation of the purchase functionality using PHP and MySQL. You can expand upon this example to include more features such as user authentication, payment processing, and order management.", "code_blocks": [null, "```php\n// db.php: Database connection file\n<?php\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"store\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n?>\n\n// products.php: Display all products\n<?php\ninclude 'db.php';\n\n$sql = \"SELECT * FROM products\";\n$result = $conn->query($sql);\n\nif ($result->num_rows > 0) {\n    // output data of each row\n    while($row = $result->fetch_assoc()) {\n        echo \"Product ID: \" . $row[\"id\"]. \" - Product Name: \" . $row[\"name\"]. \" (\" . $row[\"price\"] . \")\" . \"<br>\";\n    }\n} else {\n    echo \"0 results\";\n}\n?>\n\n// cart.php: Display products in cart and add product to cart\n<?php\ninclude 'db.php';\n\nif (isset($_SESSION['cart'])) {\n    // Display products in cart\n    echo \"Products in Cart:<br>\";\n    $total = 0;\n    foreach ($_SESSION['cart'] as $product_id => $quantity) {\n        $sql = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($sql);\n        if ($result->num_rows > 0) {\n            while($row = $result->fetch_assoc()) {\n                echo \"Product Name: \" . $row[\"name\"]. \", Quantity: $quantity, Price: \" . $row[\"price\"] . \"<br>\";\n                $total += $row[\"price\"] * $quantity;\n            }\n        } else {\n            echo \"0 results\";\n        }\n    }\n} else {\n    // Display empty cart\n}\n\n// Add product to cart\nif (isset($_POST['add_to_cart'])) {\n    $product_id = $_POST['product_id'];\n    if (!isset($_SESSION['cart'][$product_id])) {\n        $_SESSION['cart'][$product_id] = 1;\n    } else {\n        $_SESSION['cart'][$product_id]++;\n    }\n}\n\n// Checkout button\nif (isset($_POST['checkout'])) {\n    // Process checkout logic here\n}\n?>\n\n// index.php: Main page with product list and cart functionality\n<?php\ninclude 'db.php';\n\n?>\n<html>\n<head>\n  <title>Store</title>\n</head>\n<body>\n\n<h2>Products:</h2>\n\n<form action=\"cart.php\" method=\"post\">\n    <?php\n        // Display products\n        $sql = \"SELECT * FROM products\";\n        $result = $conn->query($sql);\n        \n        if ($result->num_rows > 0) {\n            while($row = $result->fetch_assoc()) {\n                echo \"<input type='hidden' name='product_id[]' value='\" . $row[\"id\"] . \"'><br>\";\n                echo $row[\"name\"]. \" (\" . $row[\"price\"] . \")<br>\";\n                echo \"<button name='add_to_cart'>Add to Cart</button><br>\";\n            }\n        } else {\n            echo \"0 results\";\n        }\n    ?>\n</form>\n\n<?php\n// Display cart and checkout button\n?>\n\n<form action=\"\" method=\"post\">\n    <input type=\"submit\" name=\"checkout\" value=\"Checkout\">\n</form>\n\n</body>\n</html>\n```"]}
