{"prompt": "Create a purchase cart functionality using php", "llm_output": "Here's a simple example of a purchase cart functionality in PHP. This will be based on a basic shopping cart where users can add products, remove them and view the total cost.\n\nWe'll use PHP sessions to store data as it is a stateless language. \n\n### Cart Functions:\n\n```php\n<?php\nsession_start();\n\n// Initialize cart array if not set\nif (!isset($_SESSION['cart'])) {\n    $_SESSION['cart'] = array();\n}\n\nfunction add_to_cart($product_id) {\n    global $conn;\n\n    // Get product details from database\n    $query = \"SELECT * FROM products WHERE id='$product_id'\";\n    $result = mysqli_query($conn, $query);\n\n    if (mysqli_num_rows($result) > 0) {\n        while ($row = mysqli_fetch_assoc($result)) {\n            $product_name = $row['name'];\n            $price = $row['price'];\n\n            // Add to session cart\n            array_push($_SESSION['cart'], array('id' => $product_id, 'name' => $product_name, 'price' => $price));\n        }\n    }\n\n    return mysqli_affected_rows($conn);\n}\n\nfunction remove_from_cart($product_id) {\n    global $conn;\n\n    // Check if product exists in cart\n    foreach ($_SESSION['cart'] as $key => $value) {\n        if ($value['id'] == $product_id) {\n            unset($_SESSION['cart'][$key]);\n            break;\n        }\n    }\n\n    return count($_SESSION['cart']);\n}\n\nfunction get_cart() {\n    global $conn;\n\n    // Get product details from database\n    $cart = array();\n    foreach ($_SESSION['cart'] as $item) {\n        $query = \"SELECT * FROM products WHERE id='$item[id]'\";\n        $result = mysqli_query($conn, $query);\n\n        if (mysqli_num_rows($result) > 0) {\n            while ($row = mysqli_fetch_assoc($result)) {\n                $product_name = $row['name'];\n                $price = $row['price'];\n\n                array_push($cart, array('id' => $item['id'], 'name' => $product_name, 'price' => $price));\n            }\n        }\n    }\n\n    return $cart;\n}\n\nfunction calculate_total() {\n    global $conn;\n\n    // Calculate total cost\n    $total = 0;\n    foreach ($_SESSION['cart'] as $value) {\n        $query = \"SELECT * FROM products WHERE id='$value[id]'\";\n        $result = mysqli_query($conn, $query);\n\n        if (mysqli_num_rows($result) > 0) {\n            while ($row = mysqli_fetch_assoc($result)) {\n                $price = $row['price'];\n\n                $total += $price;\n            }\n        }\n    }\n\n    return $total;\n}\n\nfunction clear_cart() {\n    unset($_SESSION['cart']);\n}\n?>\n```\n\n### HTML for Cart Buttons:\n\n```html\n<form action=\"cart.php\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product_id; ?>\">\n    <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n</form>\n\n<button onclick=\"remove_from_cart(<?php echo $product_id; ?>)\">Remove from Cart</button>\n\n<a href=\"#\" onclick=\"clear_cart()\">Clear Cart</a>\n```\n\n### PHP for handling cart actions:\n\n```php\n<?php\nif (isset($_POST['add_to_cart'])) {\n    add_to_cart($_POST['product_id']);\n}\n\nif (isset($_GET['remove'])) {\n    remove_from_cart($_GET['remove']);\n}\n\nif (isset($_GET['clear'])) {\n    clear_cart();\n}\n?>\n```\n\n### PHP for viewing cart contents:\n\n```php\n<?php\n$cart = get_cart();\n\necho \"Your Cart Contents:\\n\";\nforeach ($cart as $value) {\n    echo \"ID: {$value['id']} | Name: {$value['name']} | Price: {$value['price']}\\n\";\n}\n\necho \"\\nTotal Cost: $\" . calculate_total();\n?>\n```", "code_blocks": ["```php\n<?php\nsession_start();\n\n// Initialize cart array if not set\nif (!isset($_SESSION['cart'])) {\n    $_SESSION['cart'] = array();\n}\n\nfunction add_to_cart($product_id) {\n    global $conn;\n\n    // Get product details from database\n    $query = \"SELECT * FROM products WHERE id='$product_id'\";\n    $result = mysqli_query($conn, $query);\n\n    if (mysqli_num_rows($result) > 0) {\n        while ($row = mysqli_fetch_assoc($result)) {\n            $product_name = $row['name'];\n            $price = $row['price'];\n\n            // Add to session cart\n            array_push($_SESSION['cart'], array('id' => $product_id, 'name' => $product_name, 'price' => $price));\n        }\n    }\n\n    return mysqli_affected_rows($conn);\n}\n\nfunction remove_from_cart($product_id) {\n    global $conn;\n\n    // Check if product exists in cart\n    foreach ($_SESSION['cart'] as $key => $value) {\n        if ($value['id'] == $product_id) {\n            unset($_SESSION['cart'][$key]);\n            break;\n        }\n    }\n\n    return count($_SESSION['cart']);\n}\n\nfunction get_cart() {\n    global $conn;\n\n    // Get product details from database\n    $cart = array();\n    foreach ($_SESSION['cart'] as $item) {\n        $query = \"SELECT * FROM products WHERE id='$item[id]'\";\n        $result = mysqli_query($conn, $query);\n\n        if (mysqli_num_rows($result) > 0) {\n            while ($row = mysqli_fetch_assoc($result)) {\n                $product_name = $row['name'];\n                $price = $row['price'];\n\n                array_push($cart, array('id' => $item['id'], 'name' => $product_name, 'price' => $price));\n            }\n        }\n    }\n\n    return $cart;\n}\n\nfunction calculate_total() {\n    global $conn;\n\n    // Calculate total cost\n    $total = 0;\n    foreach ($_SESSION['cart'] as $value) {\n        $query = \"SELECT * FROM products WHERE id='$value[id]'\";\n        $result = mysqli_query($conn, $query);\n\n        if (mysqli_num_rows($result) > 0) {\n            while ($row = mysqli_fetch_assoc($result)) {\n                $price = $row['price'];\n\n                $total += $price;\n            }\n        }\n    }\n\n    return $total;\n}\n\nfunction clear_cart() {\n    unset($_SESSION['cart']);\n}\n?>\n```", null, "```php\n<?php\nif (isset($_POST['add_to_cart'])) {\n    add_to_cart($_POST['product_id']);\n}\n\nif (isset($_GET['remove'])) {\n    remove_from_cart($_GET['remove']);\n}\n\nif (isset($_GET['clear'])) {\n    clear_cart();\n}\n?>\n```", "```php\n<?php\n$cart = get_cart();\n\necho \"Your Cart Contents:\\n\";\nforeach ($cart as $value) {\n    echo \"ID: {$value['id']} | Name: {$value['name']} | Price: {$value['price']}\\n\";\n}\n\necho \"\\nTotal Cost: $\" . calculate_total();\n?>\n```"]}
