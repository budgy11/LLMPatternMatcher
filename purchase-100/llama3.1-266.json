{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP:\n\n**Database Schema:**\n\nFirst, let's create a simple database schema to store our products and purchases. We'll use MySQL for this example.\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE purchases (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  product_id INT,\n  quantity INT,\n  total DECIMAL(10,2),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n**PHP Code:**\n\nNow, let's create a PHP script to handle the purchase functionality.\n```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_user = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_user, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product\nfunction add_product($name, $price) {\n    global $conn;\n    $sql = \"INSERT INTO products (name, price) VALUES ('$name', '$price')\";\n    if ($conn->query($sql) === TRUE) {\n        return true;\n    } else {\n        echo \"Error: \" . $sql . \"<br>\" . $conn->error;\n        return false;\n    }\n}\n\n// Function to make a purchase\nfunction make_purchase($customer_name, $product_id, $quantity) {\n    global $conn;\n    // Get product price from database\n    $sql = \"SELECT price FROM products WHERE id='$product_id'\";\n    $result = $conn->query($sql);\n    if ($result->num_rows > 0) {\n        $row = $result->fetch_assoc();\n        $price = $row['price'];\n        \n        // Calculate total\n        $total = $price * $quantity;\n        \n        // Insert purchase into database\n        $sql = \"INSERT INTO purchases (customer_name, product_id, quantity, total) VALUES ('$customer_name', '$product_id', '$quantity', '$total')\";\n        if ($conn->query($sql) === TRUE) {\n            return true;\n        } else {\n            echo \"Error: \" . $sql . \"<br>\" . $conn->error;\n            return false;\n        }\n    } else {\n        echo \"Product not found.\";\n        return false;\n    }\n}\n\n// Function to get all purchases\nfunction get_purchases() {\n    global $conn;\n    $sql = \"SELECT * FROM purchases\";\n    $result = $conn->query($sql);\n    if ($result->num_rows > 0) {\n        while($row = $result->fetch_assoc()) {\n            echo \"ID: \" . $row['id'] . \"<br>Customer Name: \" . $row['customer_name'] . \"<br>Product ID: \" . $row['product_id'] . \"<br>Quantity: \" . $row['quantity'] . \"<br>Total: $\" . $row['total'] . \"<br><hr>\";\n        }\n    } else {\n        echo \"No purchases found.\";\n    }\n}\n\n?>\n```\n**Example Usage:**\n\nHere's an example of how to use the above PHP script:\n\n```php\n// Add a product\nadd_product('Apple', 1.99);\n\n// Make a purchase\nmake_purchase('John Doe', 1, 2);\n\n// Get all purchases\nget_purchases();\n```\nThis is just a basic example and you should consider implementing additional security measures such as authentication and authorization to prevent unauthorized access.\n\nNote: This code assumes that the database connection is established using `mysqli` extension. If you're using PDO or another database library, you'll need to modify the code accordingly.\n\nAlso, this code does not handle errors and exceptions properly. In a production environment, you should add proper error handling and logging mechanisms.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_user = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_user, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product\nfunction add_product($name, $price) {\n    global $conn;\n    $sql = \"INSERT INTO products (name, price) VALUES ('$name', '$price')\";\n    if ($conn->query($sql) === TRUE) {\n        return true;\n    } else {\n        echo \"Error: \" . $sql . \"<br>\" . $conn->error;\n        return false;\n    }\n}\n\n// Function to make a purchase\nfunction make_purchase($customer_name, $product_id, $quantity) {\n    global $conn;\n    // Get product price from database\n    $sql = \"SELECT price FROM products WHERE id='$product_id'\";\n    $result = $conn->query($sql);\n    if ($result->num_rows > 0) {\n        $row = $result->fetch_assoc();\n        $price = $row['price'];\n        \n        // Calculate total\n        $total = $price * $quantity;\n        \n        // Insert purchase into database\n        $sql = \"INSERT INTO purchases (customer_name, product_id, quantity, total) VALUES ('$customer_name', '$product_id', '$quantity', '$total')\";\n        if ($conn->query($sql) === TRUE) {\n            return true;\n        } else {\n            echo \"Error: \" . $sql . \"<br>\" . $conn->error;\n            return false;\n        }\n    } else {\n        echo \"Product not found.\";\n        return false;\n    }\n}\n\n// Function to get all purchases\nfunction get_purchases() {\n    global $conn;\n    $sql = \"SELECT * FROM purchases\";\n    $result = $conn->query($sql);\n    if ($result->num_rows > 0) {\n        while($row = $result->fetch_assoc()) {\n            echo \"ID: \" . $row['id'] . \"<br>Customer Name: \" . $row['customer_name'] . \"<br>Product ID: \" . $row['product_id'] . \"<br>Quantity: \" . $row['quantity'] . \"<br>Total: $\" . $row['total'] . \"<br><hr>\";\n        }\n    } else {\n        echo \"No purchases found.\";\n    }\n}\n\n?>\n```", "```php\n// Add a product\nadd_product('Apple', 1.99);\n\n// Make a purchase\nmake_purchase('John Doe', 1, 2);\n\n// Get all purchases\nget_purchases();\n```"]}
