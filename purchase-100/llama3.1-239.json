{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a simple purchase functionality using PHP:\n\n**Assumptions**\n\n* We have a database table named `products` with the following columns:\n\t+ `id`: unique identifier for each product\n\t+ `name`: name of the product\n\t+ `price`: price of the product\n\t+ `stock`: available stock of the product\n* We have a database table named `orders` with the following columns:\n\t+ `id`: unique identifier for each order\n\t+ `customer_name`: name of the customer who made the purchase\n\t+ `total_cost`: total cost of the order\n\t+ `status`: status of the order (e.g. \"pending\", \"shipped\", etc.)\n* We have a database table named `order_items` with the following columns:\n\t+ `id`: unique identifier for each order item\n\t+ `order_id`: foreign key referencing the orders table\n\t+ `product_id`: foreign key referencing the products table\n\t+ `quantity`: quantity of the product ordered\n\n**PHP Code**\n\n```php\n// database connection settings\n$host = 'localhost';\n$dbname = 'mydatabase';\n$username = 'myuser';\n$password = 'mypassword';\n\n// connect to database\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n\n// function to get products from database\nfunction getProducts() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $stmt = $conn->prepare($query);\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\n// function to add order to database\nfunction addOrder($customerName, $products) {\n    global $conn;\n    $totalCost = 0;\n    foreach ($products as $product) {\n        $totalCost += $product['price'] * $product['quantity'];\n    }\n    $query = \"INSERT INTO orders (customer_name, total_cost, status) VALUES (:customerName, :totalCost, 'pending')\";\n    $stmt = $conn->prepare($query);\n    $stmt->bindParam(':customerName', $customerName);\n    $stmt->bindParam(':totalCost', $totalCost);\n    $stmt->execute();\n    return $conn->lastInsertId();\n}\n\n// function to add order item to database\nfunction addOrderItem($orderId, $productId, $quantity) {\n    global $conn;\n    $query = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES (:orderId, :productId, :quantity)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bindParam(':orderId', $orderId);\n    $stmt->bindParam(':productId', $productId);\n    $stmt->bindParam(':quantity', $quantity);\n    $stmt->execute();\n}\n\n// function to process purchase\nfunction processPurchase() {\n    global $conn;\n    if (isset($_POST['customerName']) && isset($_POST['products'])) {\n        // get products from database\n        $products = getProducts();\n\n        // validate input\n        if (!empty($_POST['customerName']) && is_array($_POST['products'])) {\n            // add order to database\n            $orderId = addOrder($_POST['customerName'], $_POST['products']);\n\n            // add order items to database\n            foreach ($_POST['products'] as $product) {\n                addOrderItem($orderId, $product['id'], $product['quantity']);\n            }\n        } else {\n            echo \"Error: invalid input\";\n            return false;\n        }\n    }\n}\n\n// process purchase on form submission\nif (isset($_POST['submit'])) {\n    processPurchase();\n}\n```\n\n**HTML Form**\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase Form</title>\n</head>\n<body>\n    <form action=\"\" method=\"post\">\n        <label for=\"customerName\">Customer Name:</label>\n        <input type=\"text\" id=\"customerName\" name=\"customerName\"><br><br>\n\n        <h2>Products:</h2>\n        <table border=\"1\">\n            <?php foreach (getProducts() as $product): ?>\n                <tr>\n                    <td><?php echo $product['name']; ?></td>\n                    <td><?php echo $product['price']; ?></td>\n                    <td><input type=\"number\" name=\"products[<?php echo $product['id']; ?>][quantity]\" value=\"1\"></td>\n                </tr>\n            <?php endforeach; ?>\n        </table>\n\n        <input type=\"submit\" name=\"submit\" value=\"Purchase\">\n    </form>\n</body>\n</html>\n```\n\nThis code creates a simple purchase form that allows customers to select products and enter their customer name. When the form is submitted, the `processPurchase()` function is called to add an order to the database and process any associated order items.\n\nNote: This is just a basic example and you should consider implementing additional validation and security measures in a real-world application.", "code_blocks": ["```php\n// database connection settings\n$host = 'localhost';\n$dbname = 'mydatabase';\n$username = 'myuser';\n$password = 'mypassword';\n\n// connect to database\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n\n// function to get products from database\nfunction getProducts() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $stmt = $conn->prepare($query);\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\n// function to add order to database\nfunction addOrder($customerName, $products) {\n    global $conn;\n    $totalCost = 0;\n    foreach ($products as $product) {\n        $totalCost += $product['price'] * $product['quantity'];\n    }\n    $query = \"INSERT INTO orders (customer_name, total_cost, status) VALUES (:customerName, :totalCost, 'pending')\";\n    $stmt = $conn->prepare($query);\n    $stmt->bindParam(':customerName', $customerName);\n    $stmt->bindParam(':totalCost', $totalCost);\n    $stmt->execute();\n    return $conn->lastInsertId();\n}\n\n// function to add order item to database\nfunction addOrderItem($orderId, $productId, $quantity) {\n    global $conn;\n    $query = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES (:orderId, :productId, :quantity)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bindParam(':orderId', $orderId);\n    $stmt->bindParam(':productId', $productId);\n    $stmt->bindParam(':quantity', $quantity);\n    $stmt->execute();\n}\n\n// function to process purchase\nfunction processPurchase() {\n    global $conn;\n    if (isset($_POST['customerName']) && isset($_POST['products'])) {\n        // get products from database\n        $products = getProducts();\n\n        // validate input\n        if (!empty($_POST['customerName']) && is_array($_POST['products'])) {\n            // add order to database\n            $orderId = addOrder($_POST['customerName'], $_POST['products']);\n\n            // add order items to database\n            foreach ($_POST['products'] as $product) {\n                addOrderItem($orderId, $product['id'], $product['quantity']);\n            }\n        } else {\n            echo \"Error: invalid input\";\n            return false;\n        }\n    }\n}\n\n// process purchase on form submission\nif (isset($_POST['submit'])) {\n    processPurchase();\n}\n```", null]}
