{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how to create a simple purchase functionality using PHP:\n\n**Note:** This example assumes that you have a basic understanding of PHP and MySQL. You will need to create a database table to store the products and another table to store the orders.\n\n**Database Tables:**\n\nLet's assume we have two tables in our database: `products` and `orders`. The `products` table has the following structure:\n\n| Field Name | Data Type | Description |\n| --- | --- | --- |\n| id | int | Unique product ID |\n| name | varchar | Product name |\n| price | decimal | Product price |\n\nThe `orders` table has the following structure:\n\n| Field Name | Data Type | Description |\n| --- | --- | --- |\n| id | int | Unique order ID |\n| customer_id | int | Customer ID (links to customers table) |\n| product_id | int | Product ID (links to products table) |\n| quantity | int | Quantity of product purchased |\n\n**PHP Code:**\n\nWe will create a simple purchase functionality using PHP. We will use the following files:\n\n1. `index.php`: This is the main file where we will display the products and allow users to add them to cart.\n2. `cart.php`: This file will handle adding, removing and updating items in the cart.\n3. `checkout.php`: This file will handle processing the order.\n\n**index.php**\n```php\n<?php\n// Include database connection settings\ninclude 'db_connect.php';\n\n// Get all products from database\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n\n$products = array();\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $products[] = array(\n        'id' => $row['id'],\n        'name' => $row['name'],\n        'price' => $row['price']\n    );\n}\n\n// Display products\n?>\n\n<h1>Products</h1>\n<ul>\n    <?php foreach ($products as $product) { ?>\n        <li>\n            <?= $product['name'] ?> - <?= $product['price'] ?>\n            <a href=\"cart.php?action=add&id=<?= $product['id'] ?>\">Add to Cart</a>\n        </li>\n    <?php } ?>\n</ul>\n\n<a href=\"cart.php\">View Cart</a>\n```\n\n**cart.php**\n```php\n<?php\n// Include database connection settings\ninclude 'db_connect.php';\n\n// Check if user is adding or removing item from cart\nif (isset($_GET['action']) && $_GET['action'] == 'add') {\n    $product_id = $_GET['id'];\n    // Get product details from database\n    $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    $product = mysqli_fetch_assoc($result);\n\n    // Add item to cart if not already in cart\n    if (!isset($_SESSION['cart'])) {\n        $_SESSION['cart'] = array();\n    }\n    if (!in_array($product_id, $_SESSION['cart'])) {\n        $_SESSION['cart'][] = $product_id;\n    }\n\n} elseif (isset($_GET['action']) && $_GET['action'] == 'remove') {\n    $product_id = $_GET['id'];\n    // Remove item from cart\n    if (in_array($product_id, $_SESSION['cart'])) {\n        unset($_SESSION['cart'][array_search($product_id, $_SESSION['cart'])]);\n    }\n}\n\n// Display cart contents\n?>\n\n<h1>Cart</h1>\n<ul>\n    <?php foreach ($_SESSION['cart'] as $item) { ?>\n        <li>\n            <?= get_product_name($item) ?> - <?= get_product_price($item) ?>\n            <a href=\"cart.php?action=remove&id=<?= $item ?>\">Remove</a>\n        </li>\n    <?php } ?>\n</ul>\n\n<a href=\"checkout.php\">Checkout</a>\n\n<?php\nfunction get_product_name($product_id) {\n    // Get product name from database\n    $query = \"SELECT name FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_assoc($result)['name'];\n}\n\nfunction get_product_price($product_id) {\n    // Get product price from database\n    $query = \"SELECT price FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_assoc($result)['price'];\n}\n```\n\n**checkout.php**\n```php\n<?php\n// Include database connection settings\ninclude 'db_connect.php';\n\n// Get cart contents from session\n$cart_contents = $_SESSION['cart'];\n\n// Process order if form submitted\nif (isset($_POST['submit'])) {\n    // Insert order into database\n    $customer_id = $_POST['customer_id'];\n    foreach ($cart_contents as $item) {\n        $query = \"INSERT INTO orders (customer_id, product_id, quantity) VALUES ('$customer_id', '$item', 1)\";\n        mysqli_query($conn, $query);\n    }\n}\n\n// Display form to enter customer details\n?>\n\n<h1>Checkout</h1>\n<form action=\"checkout.php\" method=\"post\">\n    <label for=\"customer_id\">Customer ID:</label>\n    <input type=\"text\" id=\"customer_id\" name=\"customer_id\"><br><br>\n    <input type=\"submit\" name=\"submit\" value=\"Place Order\">\n</form>\n```\n\n**Note:** This is a very basic example and you should consider implementing security measures such as validation, sanitization and authentication to prevent SQL injection attacks. Additionally, this code assumes that the `get_product_name` and `get_product_price` functions are defined in the same scope as the `cart.php` file.\n\nThis code provides a simple purchase functionality where users can add products to their cart and then checkout to place an order. The order is inserted into the database when the user submits the form on the checkout page.", "code_blocks": ["```php\n<?php\n// Include database connection settings\ninclude 'db_connect.php';\n\n// Get all products from database\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n\n$products = array();\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $products[] = array(\n        'id' => $row['id'],\n        'name' => $row['name'],\n        'price' => $row['price']\n    );\n}\n\n// Display products\n?>\n\n<h1>Products</h1>\n<ul>\n    <?php foreach ($products as $product) { ?>\n        <li>\n            <?= $product['name'] ?> - <?= $product['price'] ?>\n            <a href=\"cart.php?action=add&id=<?= $product['id'] ?>\">Add to Cart</a>\n        </li>\n    <?php } ?>\n</ul>\n\n<a href=\"cart.php\">View Cart</a>\n```", "```php\n<?php\n// Include database connection settings\ninclude 'db_connect.php';\n\n// Check if user is adding or removing item from cart\nif (isset($_GET['action']) && $_GET['action'] == 'add') {\n    $product_id = $_GET['id'];\n    // Get product details from database\n    $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    $product = mysqli_fetch_assoc($result);\n\n    // Add item to cart if not already in cart\n    if (!isset($_SESSION['cart'])) {\n        $_SESSION['cart'] = array();\n    }\n    if (!in_array($product_id, $_SESSION['cart'])) {\n        $_SESSION['cart'][] = $product_id;\n    }\n\n} elseif (isset($_GET['action']) && $_GET['action'] == 'remove') {\n    $product_id = $_GET['id'];\n    // Remove item from cart\n    if (in_array($product_id, $_SESSION['cart'])) {\n        unset($_SESSION['cart'][array_search($product_id, $_SESSION['cart'])]);\n    }\n}\n\n// Display cart contents\n?>\n\n<h1>Cart</h1>\n<ul>\n    <?php foreach ($_SESSION['cart'] as $item) { ?>\n        <li>\n            <?= get_product_name($item) ?> - <?= get_product_price($item) ?>\n            <a href=\"cart.php?action=remove&id=<?= $item ?>\">Remove</a>\n        </li>\n    <?php } ?>\n</ul>\n\n<a href=\"checkout.php\">Checkout</a>\n\n<?php\nfunction get_product_name($product_id) {\n    // Get product name from database\n    $query = \"SELECT name FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_assoc($result)['name'];\n}\n\nfunction get_product_price($product_id) {\n    // Get product price from database\n    $query = \"SELECT price FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_assoc($result)['price'];\n}\n```", "```php\n<?php\n// Include database connection settings\ninclude 'db_connect.php';\n\n// Get cart contents from session\n$cart_contents = $_SESSION['cart'];\n\n// Process order if form submitted\nif (isset($_POST['submit'])) {\n    // Insert order into database\n    $customer_id = $_POST['customer_id'];\n    foreach ($cart_contents as $item) {\n        $query = \"INSERT INTO orders (customer_id, product_id, quantity) VALUES ('$customer_id', '$item', 1)\";\n        mysqli_query($conn, $query);\n    }\n}\n\n// Display form to enter customer details\n?>\n\n<h1>Checkout</h1>\n<form action=\"checkout.php\" method=\"post\">\n    <label for=\"customer_id\">Customer ID:</label>\n    <input type=\"text\" id=\"customer_id\" name=\"customer_id\"><br><br>\n    <input type=\"submit\" name=\"submit\" value=\"Place Order\">\n</form>\n```"]}
