{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP:\n\n**Database Setup**\n\nFirst, let's create a database to store the products and orders. We'll use MySQL for this example.\n\n```sql\nCREATE TABLE products (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  customer_name VARCHAR(255),\n  order_date DATE,\n  total DECIMAL(10,2)\n);\n\nCREATE TABLE order_items (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  order_id INT,\n  product_id INT,\n  quantity INT,\n  FOREIGN KEY (order_id) REFERENCES orders(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code**\n\nNow, let's create the PHP code for the purchase functionality:\n\n```php\n// Include database connection file\nrequire 'db.php';\n\n// Function to add product to cart\nfunction addProductToCart($product_id, $quantity) {\n  // Get product details from database\n  $product = getProductDetails($product_id);\n  \n  // If product is found\n  if ($product) {\n    // Check if quantity is valid\n    if ($quantity <= 0) {\n      echo 'Invalid quantity';\n      return;\n    }\n    \n    // Add product to cart\n    $cart[] = array(\n      'id' => $product_id,\n      'name' => $product['name'],\n      'price' => $product['price'],\n      'quantity' => $quantity\n    );\n  } else {\n    echo 'Product not found';\n  }\n}\n\n// Function to get product details from database\nfunction getProductDetails($id) {\n  // Query database for product details\n  $query = \"SELECT * FROM products WHERE id = '$id'\";\n  \n  // Execute query and fetch result\n  $result = mysqli_query($db, $query);\n  $product = mysqli_fetch_assoc($result);\n  \n  return $product;\n}\n\n// Function to place order\nfunction placeOrder() {\n  // Get cart contents\n  global $cart;\n  \n  // Calculate total cost of order\n  $total = 0;\n  foreach ($cart as $item) {\n    $total += $item['price'] * $item['quantity'];\n  }\n  \n  // Create new order in database\n  $order = array(\n    'customer_name' => $_POST['name'],\n    'order_date' => date('Y-m-d'),\n    'total' => $total\n  );\n  \n  // Insert order into database\n  mysqli_query($db, \"INSERT INTO orders SET name = '\" . $_POST['name'] . \"', order_date = NOW(), total = '$total'\");\n  \n  // Get last inserted ID (order ID)\n  $orderId = mysqli_insert_id($db);\n  \n  // Create new order item for each product in cart\n  foreach ($cart as $item) {\n    $query = \"INSERT INTO order_items SET order_id = '$orderId', product_id = '\" . $item['id'] . \"', quantity = '\" . $item['quantity'] . \"'\";\n    \n    mysqli_query($db, $query);\n  }\n}\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Process form data (e.g., add product to cart)\n  // ...\n\n  // Place order\n  placeOrder();\n}\n```\n\n**HTML Code**\n\nFinally, let's create the HTML code for the purchase functionality:\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Purchase</title>\n</head>\n<body>\n  <h1>Purchase</h1>\n  \n  <!-- Form to add product to cart -->\n  <form action=\"\" method=\"post\">\n    <label for=\"name\">Name:</label>\n    <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n    \n    <label for=\"product_id\">Product ID:</label>\n    <input type=\"number\" id=\"product_id\" name=\"product_id\"><br><br>\n    \n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n    \n    <input type=\"submit\" value=\"Add to Cart\">\n  </form>\n  \n  <!-- Form to place order -->\n  <h2>Place Order</h2>\n  <form action=\"\" method=\"post\">\n    <label for=\"name\">Name:</label>\n    <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n    \n    <input type=\"submit\" value=\"Place Order\">\n  </form>\n  \n  <!-- Display cart contents -->\n  <?php if (isset($cart)) { ?>\n  <h2>Cart Contents</h2>\n  <table border=\"1\">\n    <tr>\n      <th>Name</th>\n      <th>Price</th>\n      <th>Quantity</th>\n    </tr>\n    <?php foreach ($cart as $item) { ?>\n    <tr>\n      <td><?php echo $item['name']; ?></td>\n      <td><?php echo $item['price']; ?></td>\n      <td><?php echo $item['quantity']; ?></td>\n    </tr>\n    <?php } ?>\n  </table>\n  <?php } ?>\n</body>\n</html>\n```\n\nThis code provides a basic purchase functionality using PHP, including forms for adding products to cart and placing orders. The database connection is handled by the `db.php` file.\n\nNote that this is just an example and you should adjust it according to your specific needs. You may also want to add validation and error handling to ensure data integrity.", "code_blocks": [null, "```php\n// Include database connection file\nrequire 'db.php';\n\n// Function to add product to cart\nfunction addProductToCart($product_id, $quantity) {\n  // Get product details from database\n  $product = getProductDetails($product_id);\n  \n  // If product is found\n  if ($product) {\n    // Check if quantity is valid\n    if ($quantity <= 0) {\n      echo 'Invalid quantity';\n      return;\n    }\n    \n    // Add product to cart\n    $cart[] = array(\n      'id' => $product_id,\n      'name' => $product['name'],\n      'price' => $product['price'],\n      'quantity' => $quantity\n    );\n  } else {\n    echo 'Product not found';\n  }\n}\n\n// Function to get product details from database\nfunction getProductDetails($id) {\n  // Query database for product details\n  $query = \"SELECT * FROM products WHERE id = '$id'\";\n  \n  // Execute query and fetch result\n  $result = mysqli_query($db, $query);\n  $product = mysqli_fetch_assoc($result);\n  \n  return $product;\n}\n\n// Function to place order\nfunction placeOrder() {\n  // Get cart contents\n  global $cart;\n  \n  // Calculate total cost of order\n  $total = 0;\n  foreach ($cart as $item) {\n    $total += $item['price'] * $item['quantity'];\n  }\n  \n  // Create new order in database\n  $order = array(\n    'customer_name' => $_POST['name'],\n    'order_date' => date('Y-m-d'),\n    'total' => $total\n  );\n  \n  // Insert order into database\n  mysqli_query($db, \"INSERT INTO orders SET name = '\" . $_POST['name'] . \"', order_date = NOW(), total = '$total'\");\n  \n  // Get last inserted ID (order ID)\n  $orderId = mysqli_insert_id($db);\n  \n  // Create new order item for each product in cart\n  foreach ($cart as $item) {\n    $query = \"INSERT INTO order_items SET order_id = '$orderId', product_id = '\" . $item['id'] . \"', quantity = '\" . $item['quantity'] . \"'\";\n    \n    mysqli_query($db, $query);\n  }\n}\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Process form data (e.g., add product to cart)\n  // ...\n\n  // Place order\n  placeOrder();\n}\n```", null]}
