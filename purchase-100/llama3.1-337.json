{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP, MySQLi, and HTML. This example includes the following features:\n\n1. User login system\n2. Product display with prices and quantities\n3. Shopping cart functionality\n4. Checkout and payment processing (simulated for demonstration purposes)\n\n**Note:** This is a simplified example and should not be used in production without proper security measures and testing.\n\n### Database Setup\n\nCreate a MySQL database named `store` and add the following tables:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255),\n  password VARCHAR(255)\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2),\n  quantity INT\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  order_date DATE,\n  total DECIMAL(10,2)\n);\n```\n\n### PHP Code\n\n**login.php**\n```php\n<?php\nsession_start();\n\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    $query = \"SELECT * FROM users WHERE username='$username'\";\n    $result = mysqli_query($conn, $query);\n    if ($row = mysqli_fetch_assoc($result)) {\n        if (password_verify($password, $row['password'])) {\n            $_SESSION['user_id'] = $row['id'];\n            header('Location: products.php');\n            exit;\n        }\n    }\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Login\">\n</form>\n```\n\n**products.php**\n```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (!isset($_SESSION['user_id'])) {\n    header('Location: login.php');\n    exit;\n}\n\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n$products = array();\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $products[] = $row;\n}\n?>\n\n<h1>Products</h1>\n\n<ul>\n    <?php foreach ($products as $product) { ?>\n        <li>\n            <?= $product['name'] ?>: $<?= number_format($product['price'], 2) ?>\n            <form action=\"\" method=\"post\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?= $product['id'] ?>\">\n                <label>Quantity:</label>\n                <select name=\"quantity\">\n                    <?php for ($i = 1; $i <= $product['quantity']; $i++) { ?>\n                        <option value=\"<?= $i ?>\"><?= $i ?></option>\n                    <?php } ?>\n                </select>\n                <input type=\"submit\" value=\"Add to Cart\">\n            </form>\n        </li>\n    <?php } ?>\n</ul>\n\n<?php if (isset($_POST['product_id']) && isset($_POST['quantity'])) { ?>\n    <?= $_POST['product_id'] ?>: <?= $_POST['quantity'] ?>\n<?php } ?>\n```\n\n**cart.php**\n```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (!isset($_SESSION['user_id'])) {\n    header('Location: login.php');\n    exit;\n}\n\n$query = \"SELECT * FROM orders WHERE user_id=\".$_SESSION['user_id'];\n$result = mysqli_query($conn, $query);\n$orders = array();\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $orders[] = $row;\n}\n?>\n\n<h1>Cart</h1>\n\n<ul>\n    <?php foreach ($orders as $order) { ?>\n        <li>\n            <?= $order['id'] ?>: <?= date('Y-m-d', strtotime($order['order_date'])) ?> - Total: $<?= number_format($order['total'], 2) ?>\n        </li>\n    <?php } ?>\n</ul>\n\n<form action=\"\" method=\"post\">\n    <input type=\"submit\" value=\"Checkout\">\n</form>\n```\n\n**checkout.php**\n```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (!isset($_SESSION['user_id'])) {\n    header('Location: login.php');\n    exit;\n}\n\nif (isset($_POST['product_id']) && isset($_POST['quantity'])) {\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Simulated payment processing\n    $payment_status = 'paid';\n\n    $query = \"INSERT INTO orders (user_id, order_date, total)\n              VALUES (\".$_SESSION['user_id'].\", NOW(), '\".$_POST['total'].\"')\";\n    mysqli_query($conn, $query);\n\n    echo 'Order placed successfully!';\n}\n\n?>\n```\n\n**dbconnect.php**\n```php\n<?php\n$conn = new mysqli('localhost', 'username', 'password', 'store');\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n?>\n```\n\nThis is a basic example to get you started. You should replace the `dbconnect.php` file with your actual database credentials and modify the code as needed for your specific requirements.\n\nRemember that this is just an illustration of how to implement a purchase functionality using PHP, and it's essential to follow best practices for security, validation, and error handling in a real-world application.", "code_blocks": [null, "```php\n<?php\nsession_start();\n\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    $query = \"SELECT * FROM users WHERE username='$username'\";\n    $result = mysqli_query($conn, $query);\n    if ($row = mysqli_fetch_assoc($result)) {\n        if (password_verify($password, $row['password'])) {\n            $_SESSION['user_id'] = $row['id'];\n            header('Location: products.php');\n            exit;\n        }\n    }\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Login\">\n</form>\n```", "```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (!isset($_SESSION['user_id'])) {\n    header('Location: login.php');\n    exit;\n}\n\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n$products = array();\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $products[] = $row;\n}\n?>\n\n<h1>Products</h1>\n\n<ul>\n    <?php foreach ($products as $product) { ?>\n        <li>\n            <?= $product['name'] ?>: $<?= number_format($product['price'], 2) ?>\n            <form action=\"\" method=\"post\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?= $product['id'] ?>\">\n                <label>Quantity:</label>\n                <select name=\"quantity\">\n                    <?php for ($i = 1; $i <= $product['quantity']; $i++) { ?>\n                        <option value=\"<?= $i ?>\"><?= $i ?></option>\n                    <?php } ?>\n                </select>\n                <input type=\"submit\" value=\"Add to Cart\">\n            </form>\n        </li>\n    <?php } ?>\n</ul>\n\n<?php if (isset($_POST['product_id']) && isset($_POST['quantity'])) { ?>\n    <?= $_POST['product_id'] ?>: <?= $_POST['quantity'] ?>\n<?php } ?>\n```", "```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (!isset($_SESSION['user_id'])) {\n    header('Location: login.php');\n    exit;\n}\n\n$query = \"SELECT * FROM orders WHERE user_id=\".$_SESSION['user_id'];\n$result = mysqli_query($conn, $query);\n$orders = array();\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $orders[] = $row;\n}\n?>\n\n<h1>Cart</h1>\n\n<ul>\n    <?php foreach ($orders as $order) { ?>\n        <li>\n            <?= $order['id'] ?>: <?= date('Y-m-d', strtotime($order['order_date'])) ?> - Total: $<?= number_format($order['total'], 2) ?>\n        </li>\n    <?php } ?>\n</ul>\n\n<form action=\"\" method=\"post\">\n    <input type=\"submit\" value=\"Checkout\">\n</form>\n```", "```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (!isset($_SESSION['user_id'])) {\n    header('Location: login.php');\n    exit;\n}\n\nif (isset($_POST['product_id']) && isset($_POST['quantity'])) {\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Simulated payment processing\n    $payment_status = 'paid';\n\n    $query = \"INSERT INTO orders (user_id, order_date, total)\n              VALUES (\".$_SESSION['user_id'].\", NOW(), '\".$_POST['total'].\"')\";\n    mysqli_query($conn, $query);\n\n    echo 'Order placed successfully!';\n}\n\n?>\n```", "```php\n<?php\n$conn = new mysqli('localhost', 'username', 'password', 'store');\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n?>\n```"]}
