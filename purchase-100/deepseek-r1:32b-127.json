{"prompt": "Create a purchase functionality using php", "llm_output": "<think>\nOkay, I need to create a purchase functionality using PHP. Let me think about how to approach this.\n\nFirst, I should set up the basic HTML structure for the product display. Maybe include some products with images, names, descriptions, and prices. That way, users can see what's available to buy.\n\nNext, I'll need a shopping cart. Since PHP doesn't maintain state between requests, using sessions seems like a good idea. So I'll start a session at the beginning of each page. When a user adds a product to the cart, it should be stored in the session array.\n\nI should create functions for adding items and calculating totals. The add_to_cart function will check if the product is already in the cart and either update its quantity or add a new entry. The calculate_totals function will loop through each item in the cart, sum up the quantities and total price.\n\nOn the products page, I'll display each product with an \"Add to Cart\" button. When clicked, it should send the product ID via POST and call the add_to_cart function.\n\nFor the cart page, I'll show all selected items with their details and a remove button. Each item's quantity can be adjusted, so I'll need input fields for that. The update quantities will be handled by another form submission.\n\nI also need to handle cases where the cart is empty. So if there are no items in the session, display a message prompting the user to add products.\n\nFinally, on the checkout page, users should enter their details like name and address. After submitting, it'll show an order confirmation with the total price. I can include some styling for better presentation using inline CSS.\n\nI should test each part step by step: adding items, updating quantities, removing items, and checking out to ensure everything works smoothly. Also, make sure sessions are properly started on each page to maintain the cart state.\n</think>\n\nHere's an example of a purchase functionality using PHP:\n\nThis implementation includes:\n1. Product display\n2. Shopping cart management\n3. Checkout process\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Online Store</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        .product-card {\n            border: 1px solid #ddd;\n            padding: 15px;\n            margin-bottom: 20px;\n        }\n        .cart-item {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 10px;\n            border: 1px solid #ddd;\n            margin-bottom: 10px;\n        }\n    </style>\n</head>\n<body>\n\n<?php\nsession_start();\n\n// Sample product data\n$products = array(\n    array(\n        'id' => 1,\n        'name' => 'Laptop',\n        'description' => 'High performance laptop with 16GB RAM and 512GB SSD',\n        'price' => 999.99,\n        'image' => 'laptop.jpg'\n    ),\n    array(\n        'id' => 2,\n        'name' => 'Smartphone',\n        'description' => 'Latest smartphone with 64GB storage',\n        'price' => 799.99,\n        'image' => 'smartphone.jpg'\n    ),\n    array(\n        'id' => 3,\n        'name' => 'Tablet',\n        'description' => '10.5 inch tablet with 128GB storage',\n        'price' => 499.99,\n        'image' => 'tablet.jpg'\n    )\n);\n\n// Initialize cart if not exists\nif (!isset($_SESSION['cart'])) {\n    $_SESSION['cart'] = array();\n}\n\nfunction add_to_cart($productId, $quantity) {\n    global $products;\n    \n    foreach ($products as $product) {\n        if ($product['id'] == $productId) {\n            if (isset($_SESSION['cart'][$ productId])) {\n                $_SESSION['cart'][$productId]['quantity'] += $quantity;\n            } else {\n                $_SESSION['cart'][$productId] = array(\n                    'name' => $product['name'],\n                    'price' => $product['price'],\n                    'quantity' => $quantity\n                );\n            }\n        }\n    }\n}\n\nfunction calculate_totals() {\n    $totalQuantity = 0;\n    $totalPrice = 0;\n    \n    foreach ($_SESSION['cart'] as $item) {\n        $totalQuantity += $item['quantity'];\n        $totalPrice += $item['price'] * $item['quantity'];\n    }\n    \n    return array(\n        'total_quantity' => $totalQuantity,\n        'total_price' => $totalPrice\n    );\n}\n\nfunction remove_from_cart($productId) {\n    unset($_SESSION['cart'][$ productId]);\n}\n\nif (isset($_POST['add_to_cart'])) {\n    add_to_cart($_POST['product_id'], 1);\n} elseif (isset($_POST['update_cart'])) {\n    foreach ($_POST as $key => $value) {\n        if ($key != 'update_cart') {\n            $quantity = intval($value);\n            if ($quantity == 0) {\n                remove_from_cart($key);\n            } else {\n                $_SESSION['cart'][$key]['quantity'] = $quantity;\n            }\n        }\n    }\n} elseif (isset($_POST['checkout'])) {\n    // Process checkout here\n    echo \"<h2>Thank you for your order!</h2>\";\n    echo \"Order Details:<br>\";\n    foreach ($_SESSION['cart'] as $item) {\n        echo \"{$item['name']} - Quantity: {$item['quantity']}<br>\";\n    }\n    list($total_quantity, $total_price) = calculate_totals();\n    echo \"Total Price: $$total_price<br><br>\";\n    // Clear the cart\n    $_SESSION['cart'] = array();\n}\n?>\n\n<?php if (!isset($_GET['page'])) { ?>\n<!-- Products Page -->\n<h1>Our Products</h1>\n<?php foreach ($products as $product) { ?>\n<div class=\"product-card\">\n    <img src=\"<?php echo $product['image']; ?>\" alt=\"<?php echo $product['name']; ?>\" style=\"max-width: 200px;\">\n    <h3><?php echo $product['name']; ?></h3>\n    <p><?php echo $product['description']; ?></p>\n    <p>Price: <?php echo \"$\" . number_format($product['price'], 2); ?></p>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product['id']; ?>\">\n        <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n    </form>\n</div>\n<?php } ?>\n\n<a href=\"<?php echo $_SERVER['PHP_SELF']; ?>?page=cart\">View Cart</a>\n\n<?php } elseif ($_GET['page'] == 'cart') { ?>\n<!-- Cart Page -->\n<h1>Your Shopping Cart</h1>\n\n<?php if (empty($_SESSION['cart'])) { ?>\n<p>Your cart is empty. Please add some products.</p>\n<a href=\"<?php echo $_SERVER['PHP_SELF']; ?>\">Continue Shopping</a>\n\n<?php } else { ?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <?php foreach ($_SESSION['cart'] as $productId => $item) { ?>\n    <div class=\"cart-item\">\n        <span><?php echo $item['name']; ?></span>\n        <span>Price: <?php echo \"$\" . number_format($item['price'], 2); ?></span>\n        <input type=\"number\" name=\"<?php echo $productId; ?>\" value=\"<?php echo $item['quantity']; ?>\" min=\"0\">\n        <button type=\"submit\" name=\"update_cart\">Update</button>\n        <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\" style=\"display: inline;\">\n            <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $productId; ?>\">\n            <button type=\"submit\" name=\"remove_from_cart\">Remove</button>\n        </form>\n    </div>\n    <?php } ?>\n    \n    <p>Total Items: <?php echo calculate_totals()['total_quantity']; ?></p>\n    <p>Total Price: <?php echo \"$\" . number_format(calculate_totals()['total_price'], 2); ?></p>\n    \n    <button type=\"submit\" name=\"checkout\">Checkout</button>\n    <a href=\"<?php echo $_SERVER['PHP_SELF']; ?>\">Continue Shopping</a>\n</form>\n<?php } ?>\n\n<?php } elseif ($_GET['page'] == 'checkout') { ?>\n<!-- Checkout Page -->\n<h1>Checkout</h1>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"name\">Name:</label><br>\n    <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n    \n    <label for=\"address\">Address:</label><br>\n    <input type=\"text\" id=\"address\" name=\"address\"><br><br>\n    \n    <button type=\"submit\">Complete Purchase</button>\n</form>\n\n<?php } ?>\n\n</body>\n</html>\n```\n\nThis code creates a basic e-commerce system with the following features:\n\n1. Displays products with their details\n2. Allows users to add products to cart\n3. Shows current items in the shopping cart\n4. Allows quantity adjustment and item removal from cart\n5. Calculates total price and number of items\n6. Provides checkout functionality\n\nTo use this code:\n\n1. Save it as an PHP file (e.g., `index.php`)\n2. Make sure your server supports PHP sessions\n3. Open in a web browser\n\nThe system uses PHP sessions to maintain the cart state between pages. The products are stored in an array, but you could modify this to pull from a database.\n\nNote: This is a basic implementation and should be extended with:\n- Error handling\n- Input validation\n- Secure payment processing (e.g., Stripe or PayPal integration)\n- Database storage for products and orders\n- User authentication\n- More robust session management\n\nYou can enhance this further by adding features like:\n- Product categories\n- Search functionality\n- User accounts\n- Order history\n- Reviews and ratings\n- Coupon codes\n- Different payment methods", "code_blocks": [null]}
