{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how to create a simple purchase functionality using PHP. This example will use a MySQL database to store product information and customer information.\n\n**Database Schema:**\n\nFirst, we need to create the database schema for our application. We'll need three tables:\n\n1. `products`\n2. `customers`\n3. `orders`\n\nHere's an example of what these tables might look like:\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE customers (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  email VARCHAR(255)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY,\n  customer_id INT,\n  product_id INT,\n  order_date DATE,\n  total_cost DECIMAL(10,2),\n  FOREIGN KEY (customer_id) REFERENCES customers(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n**PHP Code:**\n\nNext, we'll create a PHP script to handle the purchase functionality. We'll use a simple form to collect customer and product information, then process the order using a MySQL query.\n\n```php\n<?php\n\n// Connect to database\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"mydatabase\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Form data\nif (isset($_POST['submit'])) {\n\n    // Get product ID from session or form data\n    if (isset($_SESSION['product_id'])) {\n        $product_id = $_SESSION['product_id'];\n    } elseif (isset($_POST['product_id'])) {\n        $product_id = $_POST['product_id'];\n    }\n\n    // Get customer information from session or form data\n    if (isset($_SESSION['customer_name'])) {\n        $customer_name = $_SESSION['customer_name'];\n    } elseif (isset($_POST['name'])) {\n        $customer_name = $_POST['name'];\n    }\n    if (isset($_SESSION['customer_email'])) {\n        $customer_email = $_SESSION['customer_email'];\n    } elseif (isset($_POST['email'])) {\n        $customer_email = $_POST['email'];\n    }\n\n    // Insert order into database\n    $sql = \"INSERT INTO orders (customer_id, product_id, order_date, total_cost) \n            VALUES (?, ?, NOW(), ?)\";\n    $stmt = $conn->prepare($sql);\n    $stmt->bind_param(\"iii\", $customer_id, $product_id, $total_cost);\n\n    // Get product price from database\n    $sql_product_price = \"SELECT price FROM products WHERE id = ?\";\n    $stmt_product_price = $conn->prepare($sql_product_price);\n    $stmt_product_price->bind_param(\"i\", $product_id);\n    $stmt_product_price->execute();\n    $result_product_price = $stmt_product_price->get_result();\n    $price = $result_product_price->fetch_assoc();\n\n    // Get customer ID from database\n    $sql_customer_id = \"SELECT id FROM customers WHERE name = ? AND email = ?\";\n    $stmt_customer_id = $conn->prepare($sql_customer_id);\n    $stmt_customer_id->bind_param(\"ss\", $customer_name, $customer_email);\n    $stmt_customer_id->execute();\n    $result_customer_id = $stmt_customer_id->get_result();\n    $customer_id = $result_customer_id->fetch_assoc();\n\n    // Calculate total cost\n    $total_cost = $price['price'];\n\n    // Execute query to insert order into database\n    $stmt->execute();\n\n    // Get order ID from database\n    $sql_order_id = \"SELECT id FROM orders WHERE customer_id = ? AND product_id = ?\";\n    $stmt_order_id = $conn->prepare($sql_order_id);\n    $stmt_order_id->bind_param(\"ii\", $customer_id, $product_id);\n    $stmt_order_id->execute();\n    $result_order_id = $stmt_order_id->get_result();\n\n    // Redirect user to order confirmation page\n    header('Location: order_confirmation.php');\n    exit;\n}\n\n// Display form\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"name\">Name:</label>\n  <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n  <label for=\"email\">Email:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n\n  <?php\n    // Display product list (optional)\n    $sql_product_list = \"SELECT * FROM products\";\n    $result_product_list = $conn->query($sql_product_list);\n    while ($row_product_list = $result_product_list->fetch_assoc()) {\n      echo \"<input type='radio' id='product_$row_product_list[id]' name='product_id' value='$row_product_list[id]'>\";\n      echo \"<label for='product_$row_product_list[id]'>$row_product_list[name]</label><br>\";\n    }\n  ?>\n\n  <button type=\"submit\" name=\"submit\">Purchase</button>\n</form>\n```\n**Order Confirmation Page:**\n\nCreate a new PHP file called `order_confirmation.php` to display the order confirmation message:\n```php\n<?php\n// Connect to database\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"mydatabase\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get order ID from session\n$order_id = $_SESSION['order_id'];\n\n// Display order confirmation message\necho \"Order Confirmation\";\necho \"<br>\";\necho \"Order ID: $order_id\";\necho \"<br>\";\necho \"Customer Name: \" . $_SESSION['customer_name'];\necho \"<br>\";\necho \"Product Name: \" . $_SESSION['product_name'];\necho \"<br>\";\necho \"Total Cost: $\" . $_SESSION['total_cost'];\n?>\n```\n**Note:** This is a basic example and does not include error handling or security measures. You should add these features to your application to make it more robust.\n\nI hope this helps! Let me know if you have any questions or need further assistance.", "code_blocks": [null, "```php\n<?php\n\n// Connect to database\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"mydatabase\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Form data\nif (isset($_POST['submit'])) {\n\n    // Get product ID from session or form data\n    if (isset($_SESSION['product_id'])) {\n        $product_id = $_SESSION['product_id'];\n    } elseif (isset($_POST['product_id'])) {\n        $product_id = $_POST['product_id'];\n    }\n\n    // Get customer information from session or form data\n    if (isset($_SESSION['customer_name'])) {\n        $customer_name = $_SESSION['customer_name'];\n    } elseif (isset($_POST['name'])) {\n        $customer_name = $_POST['name'];\n    }\n    if (isset($_SESSION['customer_email'])) {\n        $customer_email = $_SESSION['customer_email'];\n    } elseif (isset($_POST['email'])) {\n        $customer_email = $_POST['email'];\n    }\n\n    // Insert order into database\n    $sql = \"INSERT INTO orders (customer_id, product_id, order_date, total_cost) \n            VALUES (?, ?, NOW(), ?)\";\n    $stmt = $conn->prepare($sql);\n    $stmt->bind_param(\"iii\", $customer_id, $product_id, $total_cost);\n\n    // Get product price from database\n    $sql_product_price = \"SELECT price FROM products WHERE id = ?\";\n    $stmt_product_price = $conn->prepare($sql_product_price);\n    $stmt_product_price->bind_param(\"i\", $product_id);\n    $stmt_product_price->execute();\n    $result_product_price = $stmt_product_price->get_result();\n    $price = $result_product_price->fetch_assoc();\n\n    // Get customer ID from database\n    $sql_customer_id = \"SELECT id FROM customers WHERE name = ? AND email = ?\";\n    $stmt_customer_id = $conn->prepare($sql_customer_id);\n    $stmt_customer_id->bind_param(\"ss\", $customer_name, $customer_email);\n    $stmt_customer_id->execute();\n    $result_customer_id = $stmt_customer_id->get_result();\n    $customer_id = $result_customer_id->fetch_assoc();\n\n    // Calculate total cost\n    $total_cost = $price['price'];\n\n    // Execute query to insert order into database\n    $stmt->execute();\n\n    // Get order ID from database\n    $sql_order_id = \"SELECT id FROM orders WHERE customer_id = ? AND product_id = ?\";\n    $stmt_order_id = $conn->prepare($sql_order_id);\n    $stmt_order_id->bind_param(\"ii\", $customer_id, $product_id);\n    $stmt_order_id->execute();\n    $result_order_id = $stmt_order_id->get_result();\n\n    // Redirect user to order confirmation page\n    header('Location: order_confirmation.php');\n    exit;\n}\n\n// Display form\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"name\">Name:</label>\n  <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n  <label for=\"email\">Email:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n\n  <?php\n    // Display product list (optional)\n    $sql_product_list = \"SELECT * FROM products\";\n    $result_product_list = $conn->query($sql_product_list);\n    while ($row_product_list = $result_product_list->fetch_assoc()) {\n      echo \"<input type='radio' id='product_$row_product_list[id]' name='product_id' value='$row_product_list[id]'>\";\n      echo \"<label for='product_$row_product_list[id]'>$row_product_list[name]</label><br>\";\n    }\n  ?>\n\n  <button type=\"submit\" name=\"submit\">Purchase</button>\n</form>\n```", "```php\n<?php\n// Connect to database\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"mydatabase\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get order ID from session\n$order_id = $_SESSION['order_id'];\n\n// Display order confirmation message\necho \"Order Confirmation\";\necho \"<br>\";\necho \"Order ID: $order_id\";\necho \"<br>\";\necho \"Customer Name: \" . $_SESSION['customer_name'];\necho \"<br>\";\necho \"Product Name: \" . $_SESSION['product_name'];\necho \"<br>\";\necho \"Total Cost: $\" . $_SESSION['total_cost'];\n?>\n```"]}
