{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a simple purchase functionality using PHP:\n\n**index.php**\n```php\n<?php\n// Database connection settings\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'online_store';\n\n// Connect to the database\n$conn = mysqli_connect($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif (!$conn) {\n    die('Could not connect: ' . mysqli_error());\n}\n\n// Get the product ID from the URL\n$productID = $_GET['product_id'];\n\n// Query the products table for the selected product\n$query = \"SELECT * FROM products WHERE id = '$productID'\";\n$result = mysqli_query($conn, $query);\n\nif (mysqli_num_rows($result) > 0) {\n    // Get the product details\n    $product = mysqli_fetch_assoc($result);\n?>\n\n<!-- Display the product details -->\n<h1><?php echo $product['name']; ?></h1>\n<p>Price: <?php echo $product['price']; ?></p>\n<form action=\"process_purchase.php\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $productID; ?>\">\n    <input type=\"submit\" value=\"Purchase\">\n</form>\n\n<?php\n} else {\n    echo \"Product not found.\";\n}\n?>\n\n<!-- Close the database connection -->\nmysqli_close($conn);\n?>\n```\n\n**process_purchase.php**\n```php\n<?php\n// Get the product ID from the form submission\n$productID = $_POST['product_id'];\n\n// Update the products table to mark the product as sold\n$query = \"UPDATE products SET quantity = quantity - 1 WHERE id = '$productID'\";\nmysqli_query($conn, $query);\n\n// Insert a new order into the orders table\n$query = \"INSERT INTO orders (product_id, user_id) VALUES ('$productID', 'NULL')\";\nmysqli_query($conn, $query);\n\n// Send an email to the user confirming their purchase\n// ...\n\n// Redirect the user back to the products page\nheader('Location: index.php');\nexit;\n?>\n```\n\n**database schema**\n```sql\nCREATE TABLE products (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(255),\n    price DECIMAL(10, 2),\n    quantity INT\n);\n\nCREATE TABLE orders (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    product_id INT,\n    user_id INT,\n    FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\nIn this example, the `index.php` file displays a form that allows the user to purchase a product. When the user submits the form, it redirects them to the `process_purchase.php` file, which updates the products table to mark the product as sold and inserts a new order into the orders table.\n\nNote that in a real-world application, you would want to add error handling and security measures, such as validating user input and preventing SQL injection attacks. You may also want to use a more robust framework or library for database interactions, such as PDO or MySQLi.", "code_blocks": ["```php\n<?php\n// Database connection settings\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'online_store';\n\n// Connect to the database\n$conn = mysqli_connect($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif (!$conn) {\n    die('Could not connect: ' . mysqli_error());\n}\n\n// Get the product ID from the URL\n$productID = $_GET['product_id'];\n\n// Query the products table for the selected product\n$query = \"SELECT * FROM products WHERE id = '$productID'\";\n$result = mysqli_query($conn, $query);\n\nif (mysqli_num_rows($result) > 0) {\n    // Get the product details\n    $product = mysqli_fetch_assoc($result);\n?>\n\n<!-- Display the product details -->\n<h1><?php echo $product['name']; ?></h1>\n<p>Price: <?php echo $product['price']; ?></p>\n<form action=\"process_purchase.php\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $productID; ?>\">\n    <input type=\"submit\" value=\"Purchase\">\n</form>\n\n<?php\n} else {\n    echo \"Product not found.\";\n}\n?>\n\n<!-- Close the database connection -->\nmysqli_close($conn);\n?>\n```", "```php\n<?php\n// Get the product ID from the form submission\n$productID = $_POST['product_id'];\n\n// Update the products table to mark the product as sold\n$query = \"UPDATE products SET quantity = quantity - 1 WHERE id = '$productID'\";\nmysqli_query($conn, $query);\n\n// Insert a new order into the orders table\n$query = \"INSERT INTO orders (product_id, user_id) VALUES ('$productID', 'NULL')\";\nmysqli_query($conn, $query);\n\n// Send an email to the user confirming their purchase\n// ...\n\n// Redirect the user back to the products page\nheader('Location: index.php');\nexit;\n?>\n```", null]}
