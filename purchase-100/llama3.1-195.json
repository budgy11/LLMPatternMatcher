{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality in PHP:\n\n**Database Schema**\n\nFirst, we need to create a database schema for the products and orders. Let's assume we have two tables: `products` and `orders`.\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY,\n  customer_name VARCHAR(255),\n  order_date DATE,\n  total_cost DECIMAL(10,2)\n);\n```\n\n**PHP Code**\n\nNow, let's create the PHP code for the purchase functionality. We'll use a simple form to collect user input and then process the payment.\n\n```php\n// database connection settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// connect to the database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// form data\n$customer_name = $_POST['customer_name'];\n$order_date = date('Y-m-d');\n$total_cost = 0;\n\n// get the selected products\nif (isset($_POST['product_id'])) {\n    foreach ($_POST['product_id'] as $product_id) {\n        $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($query);\n        \n        if ($result->num_rows > 0) {\n            while ($row = $result->fetch_assoc()) {\n                $total_cost += $row['price'];\n            }\n        }\n    }\n}\n\n// insert the order into the database\n$query = \"INSERT INTO orders (customer_name, order_date, total_cost)\n          VALUES ('$customer_name', '$order_date', '$total_cost')\";\n$conn->query($query);\n\n// get the last inserted order id\n$order_id = $conn->insert_id;\n\n// update the product quantities in the products table\nforeach ($_POST['product_id'] as $product_id) {\n    $query = \"UPDATE products SET quantity = quantity - 1 WHERE id = '$product_id'\";\n    $conn->query($query);\n}\n\n// close the database connection\n$conn->close();\n```\n\n**Form**\n\nHere is an example of a simple form that allows users to select products and submit them for purchase:\n\n```php\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase Form</title>\n</head>\n<body>\n    <h1>Purchase Form</h1>\n    \n    <form action=\"purchase.php\" method=\"post\">\n        Customer Name: <input type=\"text\" name=\"customer_name\"><br><br>\n        \n        Products:\n        <?php\n            // get all products from the database\n            $query = \"SELECT * FROM products\";\n            $result = $conn->query($query);\n            \n            if ($result->num_rows > 0) {\n                while ($row = $result->fetch_assoc()) {\n                    echo \"<input type='checkbox' name='product_id[]' value='\" . $row['id'] . \"'>\" . $row['name'] . \" $\" . $row['price'] . \"<br>\";\n                }\n            }\n        ?>\n        \n        <input type=\"submit\" value=\"Purchase\">\n    </form>\n</body>\n</html>\n```\n\nThis is a very basic example and should not be used in production without additional security measures, such as user authentication and input validation.", "code_blocks": [null, "```php\n// database connection settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// connect to the database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// form data\n$customer_name = $_POST['customer_name'];\n$order_date = date('Y-m-d');\n$total_cost = 0;\n\n// get the selected products\nif (isset($_POST['product_id'])) {\n    foreach ($_POST['product_id'] as $product_id) {\n        $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($query);\n        \n        if ($result->num_rows > 0) {\n            while ($row = $result->fetch_assoc()) {\n                $total_cost += $row['price'];\n            }\n        }\n    }\n}\n\n// insert the order into the database\n$query = \"INSERT INTO orders (customer_name, order_date, total_cost)\n          VALUES ('$customer_name', '$order_date', '$total_cost')\";\n$conn->query($query);\n\n// get the last inserted order id\n$order_id = $conn->insert_id;\n\n// update the product quantities in the products table\nforeach ($_POST['product_id'] as $product_id) {\n    $query = \"UPDATE products SET quantity = quantity - 1 WHERE id = '$product_id'\";\n    $conn->query($query);\n}\n\n// close the database connection\n$conn->close();\n```", "```php\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase Form</title>\n</head>\n<body>\n    <h1>Purchase Form</h1>\n    \n    <form action=\"purchase.php\" method=\"post\">\n        Customer Name: <input type=\"text\" name=\"customer_name\"><br><br>\n        \n        Products:\n        <?php\n            // get all products from the database\n            $query = \"SELECT * FROM products\";\n            $result = $conn->query($query);\n            \n            if ($result->num_rows > 0) {\n                while ($row = $result->fetch_assoc()) {\n                    echo \"<input type='checkbox' name='product_id[]' value='\" . $row['id'] . \"'>\" . $row['name'] . \" $\" . $row['price'] . \"<br>\";\n                }\n            }\n        ?>\n        \n        <input type=\"submit\" value=\"Purchase\">\n    </form>\n</body>\n</html>\n```"]}
