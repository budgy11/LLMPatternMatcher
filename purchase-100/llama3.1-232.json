{"prompt": "Create a purchase functionality using php", "llm_output": "**Purchase Functionality using PHP**\n=====================================\n\nIn this example, we will create a basic purchase functionality using PHP. We'll use a simple database to store the products and customer information.\n\n**Database Structure**\n----------------------\n\nWe will use a MySQL database with the following structure:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE customers (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  email VARCHAR(255),\n  password VARCHAR(255)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_id INT,\n  product_id INT,\n  quantity INT,\n  total DECIMAL(10,2),\n  FOREIGN KEY (customer_id) REFERENCES customers(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code**\n------------\n\n### `config.php`\n```php\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'root');\ndefine('DB_PASSWORD', '');\ndefine('DB_NAME', 'mydatabase');\n\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n?>\n```\n\n### `products.php`\n```php\n<?php\nrequire_once 'config.php';\n\n// Get all products from database\n$query = \"SELECT * FROM products\";\n$result = $conn->query($query);\n\n$products = array();\n\nwhile ($row = $result->fetch_assoc()) {\n    $products[] = array(\n        'id' => $row['id'],\n        'name' => $row['name'],\n        'price' => $row['price']\n    );\n}\n\nprint_r(json_encode($products));\n?>\n```\n\n### `orders.php`\n```php\n<?php\nrequire_once 'config.php';\n\n// Insert new order into database\nif (isset($_POST['product_id']) && isset($_POST['customer_id'])) {\n    $customer_id = $_POST['customer_id'];\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if product exists and customer is valid\n    $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            $product_name = $row['name'];\n            $product_price = $row['price'];\n\n            // Calculate total cost\n            $total = $quantity * $product_price;\n\n            // Insert new order into database\n            $query = \"INSERT INTO orders (customer_id, product_id, quantity, total) VALUES ('$customer_id', '$product_id', '$quantity', '$total')\";\n            $conn->query($query);\n\n            echo \"Order placed successfully!\";\n        }\n    } else {\n        echo \"Product not found.\";\n    }\n}\n?>\n```\n\n### `index.php`\n```php\n<?php\nrequire_once 'config.php';\n\n// Display all products and allow customer to select one\n$query = \"SELECT * FROM products\";\n$result = $conn->query($query);\n\n$products = array();\n\nwhile ($row = $result->fetch_assoc()) {\n    $products[] = array(\n        'id' => $row['id'],\n        'name' => $row['name']\n    );\n}\n\n?>\n\n<h1>Products</h1>\n\n<ul>\n    <?php foreach ($products as $product) { ?>\n        <li>\n            <?= $product['name'] ?> (<?= $product['price'] ?>)\n            <form action=\"orders.php\" method=\"post\">\n                <input type=\"hidden\" name=\"customer_id\" value=\"<?= $_SESSION['customer_id'] ?>\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?= $product['id'] ?>\">\n                Quantity: <input type=\"number\" name=\"quantity\">\n                <button type=\"submit\">Buy Now</button>\n            </form>\n        </li>\n    <?php } ?>\n</ul>\n\n<?php\n?>\n```\n\nThis code provides a basic purchase functionality. Customers can select products from the list and submit their order. The order is then inserted into the database.\n\nNote: This is just an example and should not be used in production without proper security measures (e.g., input validation, prepared statements).", "code_blocks": [null, "```php\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'root');\ndefine('DB_PASSWORD', '');\ndefine('DB_NAME', 'mydatabase');\n\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Get all products from database\n$query = \"SELECT * FROM products\";\n$result = $conn->query($query);\n\n$products = array();\n\nwhile ($row = $result->fetch_assoc()) {\n    $products[] = array(\n        'id' => $row['id'],\n        'name' => $row['name'],\n        'price' => $row['price']\n    );\n}\n\nprint_r(json_encode($products));\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Insert new order into database\nif (isset($_POST['product_id']) && isset($_POST['customer_id'])) {\n    $customer_id = $_POST['customer_id'];\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if product exists and customer is valid\n    $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            $product_name = $row['name'];\n            $product_price = $row['price'];\n\n            // Calculate total cost\n            $total = $quantity * $product_price;\n\n            // Insert new order into database\n            $query = \"INSERT INTO orders (customer_id, product_id, quantity, total) VALUES ('$customer_id', '$product_id', '$quantity', '$total')\";\n            $conn->query($query);\n\n            echo \"Order placed successfully!\";\n        }\n    } else {\n        echo \"Product not found.\";\n    }\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Display all products and allow customer to select one\n$query = \"SELECT * FROM products\";\n$result = $conn->query($query);\n\n$products = array();\n\nwhile ($row = $result->fetch_assoc()) {\n    $products[] = array(\n        'id' => $row['id'],\n        'name' => $row['name']\n    );\n}\n\n?>\n\n<h1>Products</h1>\n\n<ul>\n    <?php foreach ($products as $product) { ?>\n        <li>\n            <?= $product['name'] ?> (<?= $product['price'] ?>)\n            <form action=\"orders.php\" method=\"post\">\n                <input type=\"hidden\" name=\"customer_id\" value=\"<?= $_SESSION['customer_id'] ?>\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?= $product['id'] ?>\">\n                Quantity: <input type=\"number\" name=\"quantity\">\n                <button type=\"submit\">Buy Now</button>\n            </form>\n        </li>\n    <?php } ?>\n</ul>\n\n<?php\n?>\n```"]}
