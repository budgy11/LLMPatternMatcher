{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality in PHP. This example will include user registration, login, and purchasing items.\n\n**Note:** This is a simplified example and you should consider implementing proper security measures such as encryption, authentication, and authorization for your production application.\n\n**Database Schema:**\n\nFirstly, we need to define our database schema. We'll use MySQL in this example:\n\n```sql\nCREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(255),\n  email VARCHAR(255) UNIQUE,\n  password VARCHAR(255)\n);\n\nCREATE TABLE products (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(255),\n  description TEXT,\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT,\n  product_id INT,\n  quantity INT,\n  total DECIMAL(10,2),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n\n**PHP Code:**\n\n**`config.php`:**\n\n```php\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'root');\ndefine('DB_PASSWORD', '');\ndefine('DB_NAME', 'database_name');\n\n$connection = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif (!$connection) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n?>\n```\n\n**`register.php`:**\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['name']) && isset($_POST['email']) && isset($_POST['password'])) {\n    $name = $_POST['name'];\n    $email = $_POST['email'];\n    $password = password_hash($_POST['password'], PASSWORD_DEFAULT);\n\n    $query = \"INSERT INTO users (name, email, password) VALUES ('$name', '$email', '$password')\";\n    mysqli_query($connection, $query);\n\n    header('Location: login.php');\n}\n?>\n<form action=\"\" method=\"post\">\n    <label for=\"name\">Name:</label>\n    <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <label for=\"password\">Password:</label>\n    <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Register\">\n</form>\n```\n\n**`login.php`:**\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['email']) && isset($_POST['password'])) {\n    $email = $_POST['email'];\n    $password = $_POST['password'];\n\n    $query = \"SELECT * FROM users WHERE email='$email'\";\n    $result = mysqli_query($connection, $query);\n\n    if ($row = mysqli_fetch_assoc($result)) {\n        if (password_verify($_POST['password'], $row['password'])) {\n            // Login successful\n            session_start();\n            $_SESSION['user_id'] = $row['id'];\n            header('Location: index.php');\n        } else {\n            echo 'Invalid password';\n        }\n    } else {\n        echo 'User not found';\n    }\n}\n?>\n<form action=\"\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <label for=\"password\">Password:</label>\n    <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Login\">\n</form>\n```\n\n**`index.php`:**\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_SESSION['user_id'])) {\n    $query = \"SELECT * FROM products\";\n    $result = mysqli_query($connection, $query);\n\n    echo '<h1>Products:</h1>';\n    while ($row = mysqli_fetch_assoc($result)) {\n        echo '<p>ID: ' . $row['id'] . ', Name: ' . $row['name'] . ', Price: ' . $row['price'] . '</p>';\n\n        if (isset($_POST['buy-' . $row['id']])) {\n            $quantity = $_POST['buy-' . $row['id']];\n            $query2 = \"INSERT INTO orders (user_id, product_id, quantity, total) VALUES ('\" . $_SESSION['user_id'] . \"', '\" . $row['id'] . \"', '$quantity', '\" . $row['price'] * $quantity . \"')\";\n\n            if (mysqli_query($connection, $query2)) {\n                echo 'Item added to cart';\n            } else {\n                echo 'Error adding item to cart';\n            }\n        }\n    }\n\n    echo '<h1>Cart:</h1>';\n    $query3 = \"SELECT * FROM orders WHERE user_id='\" . $_SESSION['user_id'] . \"'\";\n    $result3 = mysqli_query($connection, $query3);\n\n    while ($row3 = mysqli_fetch_assoc($result3)) {\n        echo 'ID: ' . $row3['id'] . ', Product ID: ' . $row3['product_id'] . ', Quantity: ' . $row3['quantity'] . ', Total: ' . $row3['total'];\n    }\n}\n?>\n<form action=\"\" method=\"post\">\n    <?php\n        $query = \"SELECT * FROM products\";\n        $result = mysqli_query($connection, $query);\n\n        while ($row = mysqli_fetch_assoc($result)) {\n            echo '<p>ID: ' . $row['id'] . ', Name: ' . $row['name'] . ', Price: ' . $row['price'];\n            echo '<input type=\"submit\" value=\"Buy\" name=\"buy-' . $row['id'] . '\">';\n        }\n    ?>\n</form>\n```\n\nThis example demonstrates a basic purchase functionality using PHP and MySQL. The user can register, login, view products, add items to cart, and view their cart.\n\n**Note:** This is a simplified example and you should consider implementing proper security measures such as encryption, authentication, and authorization for your production application.", "code_blocks": [null, "```php\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'root');\ndefine('DB_PASSWORD', '');\ndefine('DB_NAME', 'database_name');\n\n$connection = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif (!$connection) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['name']) && isset($_POST['email']) && isset($_POST['password'])) {\n    $name = $_POST['name'];\n    $email = $_POST['email'];\n    $password = password_hash($_POST['password'], PASSWORD_DEFAULT);\n\n    $query = \"INSERT INTO users (name, email, password) VALUES ('$name', '$email', '$password')\";\n    mysqli_query($connection, $query);\n\n    header('Location: login.php');\n}\n?>\n<form action=\"\" method=\"post\">\n    <label for=\"name\">Name:</label>\n    <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <label for=\"password\">Password:</label>\n    <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Register\">\n</form>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['email']) && isset($_POST['password'])) {\n    $email = $_POST['email'];\n    $password = $_POST['password'];\n\n    $query = \"SELECT * FROM users WHERE email='$email'\";\n    $result = mysqli_query($connection, $query);\n\n    if ($row = mysqli_fetch_assoc($result)) {\n        if (password_verify($_POST['password'], $row['password'])) {\n            // Login successful\n            session_start();\n            $_SESSION['user_id'] = $row['id'];\n            header('Location: index.php');\n        } else {\n            echo 'Invalid password';\n        }\n    } else {\n        echo 'User not found';\n    }\n}\n?>\n<form action=\"\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <label for=\"password\">Password:</label>\n    <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Login\">\n</form>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_SESSION['user_id'])) {\n    $query = \"SELECT * FROM products\";\n    $result = mysqli_query($connection, $query);\n\n    echo '<h1>Products:</h1>';\n    while ($row = mysqli_fetch_assoc($result)) {\n        echo '<p>ID: ' . $row['id'] . ', Name: ' . $row['name'] . ', Price: ' . $row['price'] . '</p>';\n\n        if (isset($_POST['buy-' . $row['id']])) {\n            $quantity = $_POST['buy-' . $row['id']];\n            $query2 = \"INSERT INTO orders (user_id, product_id, quantity, total) VALUES ('\" . $_SESSION['user_id'] . \"', '\" . $row['id'] . \"', '$quantity', '\" . $row['price'] * $quantity . \"')\";\n\n            if (mysqli_query($connection, $query2)) {\n                echo 'Item added to cart';\n            } else {\n                echo 'Error adding item to cart';\n            }\n        }\n    }\n\n    echo '<h1>Cart:</h1>';\n    $query3 = \"SELECT * FROM orders WHERE user_id='\" . $_SESSION['user_id'] . \"'\";\n    $result3 = mysqli_query($connection, $query3);\n\n    while ($row3 = mysqli_fetch_assoc($result3)) {\n        echo 'ID: ' . $row3['id'] . ', Product ID: ' . $row3['product_id'] . ', Quantity: ' . $row3['quantity'] . ', Total: ' . $row3['total'];\n    }\n}\n?>\n<form action=\"\" method=\"post\">\n    <?php\n        $query = \"SELECT * FROM products\";\n        $result = mysqli_query($connection, $query);\n\n        while ($row = mysqli_fetch_assoc($result)) {\n            echo '<p>ID: ' . $row['id'] . ', Name: ' . $row['name'] . ', Price: ' . $row['price'];\n            echo '<input type=\"submit\" value=\"Buy\" name=\"buy-' . $row['id'] . '\">';\n        }\n    ?>\n</form>\n```"]}
