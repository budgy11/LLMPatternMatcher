{"prompt": "Create a purchase functionality using php", "llm_output": "**Purchase Functionality in PHP**\n====================================\n\nIn this example, we will create a basic purchase functionality using PHP. We will use a simple database to store the products and orders.\n\n**Database Setup**\n------------------\n\nWe will use MySQL as our database management system. Create a new database named `shop` and add the following tables:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  order_date DATE,\n  total DECIMAL(10,2)\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  order_id INT,\n  product_id INT,\n  quantity INT\n);\n```\n\n**PHP Code**\n-------------\n\nCreate a new PHP file named `purchase.php` and add the following code:\n\n```php\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'shop';\n\n// Database connection\n$conn = new PDO(\"mysql:host=$dbHost;dbname=$dbName\", $dbUsername, $dbPassword);\n\n// Function to get products\nfunction getProducts() {\n  global $conn;\n  $stmt = $conn->prepare('SELECT * FROM products');\n  $stmt->execute();\n  return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\n// Function to add order\nfunction addOrder($customerName, $products) {\n  global $conn;\n  $total = 0;\n  foreach ($products as $product) {\n    $total += $product['price'] * $product['quantity'];\n  }\n  $stmt = $conn->prepare('INSERT INTO orders (customer_name, order_date, total) VALUES (?, NOW(), ?)');\n  $stmt->execute([$customerName, $total]);\n  $orderId = $conn->lastInsertId();\n  return $orderId;\n}\n\n// Function to add order items\nfunction addOrderItems($orderId, $products) {\n  global $conn;\n  foreach ($products as $product) {\n    $stmt = $conn->prepare('INSERT INTO order_items (order_id, product_id, quantity) VALUES (?, ?, ?)');\n    $stmt->execute([$orderId, $product['id'], $product['quantity']]);\n  }\n}\n\n// Function to process purchase\nfunction processPurchase() {\n  if ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get customer name and products from form data\n    $customerName = $_POST['customer_name'];\n    $products = [];\n    foreach ($_POST['products'] as $productId => $quantity) {\n      $product = getProducts()[intval($productId)];\n      if ($product) {\n        $products[] = [\n          'id' => $product['id'],\n          'name' => $product['name'],\n          'price' => $product['price'],\n          'quantity' => intval($quantity)\n        ];\n      }\n    }\n\n    // Add order\n    $orderId = addOrder($customerName, $products);\n\n    // Add order items\n    addOrderItems($orderId, $products);\n\n    // Display success message\n    echo 'Purchase successful!';\n  }\n}\n\n// Call the processPurchase function\nprocessPurchase();\n```\n\n**HTML Form**\n-------------\n\nCreate a new HTML file named `index.html` and add the following code:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Purchase Form</title>\n</head>\n<body>\n  <h1>Purchase Form</h1>\n  <form action=\"purchase.php\" method=\"post\">\n    <label for=\"customer_name\">Customer Name:</label>\n    <input type=\"text\" id=\"customer_name\" name=\"customer_name\"><br><br>\n\n    <?php\n    $products = getProducts();\n    foreach ($products as $product) {\n      ?>\n      <div>\n        <label for=\"<?php echo $product['id']; ?>\"><?php echo $product['name']; ?></label>\n        <input type=\"number\" id=\"<?php echo $product['id']; ?>\" name=\"products[<?php echo $product['id']; ?>]\"><br><br>\n      </div>\n    <?php } ?>\n\n    <button type=\"submit\">Submit</button>\n  </form>\n\n  <?php\n  if (isset($_POST['customer_name'])) {\n    // Display order summary\n    ?>\n    <h2>Order Summary:</h2>\n    <ul>\n      <?php foreach ($products as $product) { ?>\n        <li><?php echo $product['name']; ?> x <?php echo $_POST['products'][$product['id']]; ?></li>\n      <?php } ?>\n    </ul>\n\n    <?php\n  }\n  ?>\n</body>\n</html>\n```\n\n**Usage**\n-----\n\n1. Create a new MySQL database and add the tables mentioned above.\n2. Update the `purchase.php` file with your database credentials.\n3. Open the `index.html` file in a web browser to access the purchase form.\n4. Select products from the dropdown menus and enter customer name, then submit the form.\n5. The order will be processed and a success message will be displayed.\n\nNote: This is a basic implementation and you may want to add additional features such as user authentication, payment gateway integration, etc.", "code_blocks": [null, "```php\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'shop';\n\n// Database connection\n$conn = new PDO(\"mysql:host=$dbHost;dbname=$dbName\", $dbUsername, $dbPassword);\n\n// Function to get products\nfunction getProducts() {\n  global $conn;\n  $stmt = $conn->prepare('SELECT * FROM products');\n  $stmt->execute();\n  return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\n// Function to add order\nfunction addOrder($customerName, $products) {\n  global $conn;\n  $total = 0;\n  foreach ($products as $product) {\n    $total += $product['price'] * $product['quantity'];\n  }\n  $stmt = $conn->prepare('INSERT INTO orders (customer_name, order_date, total) VALUES (?, NOW(), ?)');\n  $stmt->execute([$customerName, $total]);\n  $orderId = $conn->lastInsertId();\n  return $orderId;\n}\n\n// Function to add order items\nfunction addOrderItems($orderId, $products) {\n  global $conn;\n  foreach ($products as $product) {\n    $stmt = $conn->prepare('INSERT INTO order_items (order_id, product_id, quantity) VALUES (?, ?, ?)');\n    $stmt->execute([$orderId, $product['id'], $product['quantity']]);\n  }\n}\n\n// Function to process purchase\nfunction processPurchase() {\n  if ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get customer name and products from form data\n    $customerName = $_POST['customer_name'];\n    $products = [];\n    foreach ($_POST['products'] as $productId => $quantity) {\n      $product = getProducts()[intval($productId)];\n      if ($product) {\n        $products[] = [\n          'id' => $product['id'],\n          'name' => $product['name'],\n          'price' => $product['price'],\n          'quantity' => intval($quantity)\n        ];\n      }\n    }\n\n    // Add order\n    $orderId = addOrder($customerName, $products);\n\n    // Add order items\n    addOrderItems($orderId, $products);\n\n    // Display success message\n    echo 'Purchase successful!';\n  }\n}\n\n// Call the processPurchase function\nprocessPurchase();\n```", null]}
