{"prompt": "Create a purchase functionality using php", "llm_output": "Here's an example of how you can create a basic purchase functionality using PHP, HTML, and MySQL.\n\n**Database Setup**\n\nFirst, let's set up the database. We'll need two tables: `products` and `orders`.\n\n```sql\nCREATE TABLE products (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    price DECIMAL(10,2) NOT NULL\n);\n\nCREATE TABLE orders (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    customer_name VARCHAR(255) NOT NULL,\n    total_cost DECIMAL(10,2) NOT NULL,\n    date DATE NOT NULL DEFAULT CURRENT_DATE,\n    status VARCHAR(255) NOT NULL DEFAULT 'pending'\n);\n```\n\n**PHP Code**\n\nNext, let's create the PHP code for the purchase functionality.\n\n```php\n<?php\n\n// Database connection settings\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"mydatabase\";\n\n// Create a database connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product to cart\nfunction add_product_to_cart() {\n    global $conn;\n    \n    if (isset($_POST['add_to_cart'])) {\n        $product_id = $_POST['product_id'];\n        $quantity = $_POST['quantity'];\n\n        // Get the product details from database\n        $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($query);\n\n        if ($result->num_rows > 0) {\n            $row = $result->fetch_assoc();\n            $product_name = $row['name'];\n            $price = $row['price'];\n\n            // Update the cart with product details\n            $_SESSION['cart'][$product_id]['quantity'] = $quantity;\n            $_SESSION['cart'][$product_id]['price'] = $price;\n\n            header(\"Location: view_cart.php\");\n            exit();\n        } else {\n            echo \"Product not found.\";\n        }\n    }\n}\n\n// Function to view cart\nfunction view_cart() {\n    global $conn;\n    \n    if (isset($_SESSION['cart'])) {\n        // Get the cart details from session\n        foreach ($_SESSION['cart'] as $product_id => $product) {\n            $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n            $result = $conn->query($query);\n\n            if ($result->num_rows > 0) {\n                $row = $result->fetch_assoc();\n                $product_name = $row['name'];\n                $price = $row['price'];\n\n                echo \"Product Name: $product_name <br>\";\n                echo \"Quantity: \" . $_SESSION['cart'][$product_id]['quantity'] . \"<br>\";\n                echo \"Price: $\" . $_SESSION['cart'][$product_id]['price'] . \"<br><hr>\";\n            }\n        }\n\n        // Calculate the total cost\n        $total_cost = 0;\n        foreach ($_SESSION['cart'] as $product_id => $product) {\n            $total_cost += $_SESSION['cart'][$product_id]['price'] * $_SESSION['cart'][$product_id]['quantity'];\n        }\n\n        echo \"Total Cost: $\" . $total_cost . \"<br>\";\n\n        // Create an order\n        if (isset($_POST['place_order'])) {\n            $customer_name = $_POST['customer_name'];\n            $order_status = 'pending';\n\n            // Insert the order details into database\n            $query = \"INSERT INTO orders (customer_name, total_cost, date, status) VALUES ('$customer_name', '$total_cost', NOW(), '$order_status')\";\n            $conn->query($query);\n\n            echo \"Order placed successfully.\";\n        }\n    } else {\n        echo \"Cart is empty.\";\n    }\n}\n\n// Function to remove product from cart\nfunction remove_product_from_cart() {\n    global $conn;\n    \n    if (isset($_POST['remove'])) {\n        $product_id = $_POST['product_id'];\n\n        // Remove the product from session and database\n        unset($_SESSION['cart'][$product_id]);\n\n        header(\"Location: view_cart.php\");\n        exit();\n    }\n}\n\n// Add event listeners to buttons\nif (isset($_POST['add_to_cart'])) {\n    add_product_to_cart();\n} elseif (isset($_POST['place_order'])) {\n    view_cart();\n} elseif (isset($_POST['remove'])) {\n    remove_product_from_cart();\n}\n```\n\n**HTML Code**\n\nFinally, let's create the HTML code for the purchase functionality.\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase Functionality</title>\n</head>\n<body>\n\n<!-- Add product to cart form -->\n<form action=\"\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product_id; ?>\">\n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n    <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n</form>\n\n<!-- View cart -->\n<?php view_cart(); ?>\n\n<!-- Remove product from cart form -->\n<form action=\"\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product_id; ?>\">\n    <button type=\"submit\" name=\"remove\">Remove from Cart</button>\n</form>\n\n</body>\n</html>\n```\n\n**Explanation**\n\nThis code provides a basic purchase functionality with the following features:\n\n1. Add product to cart: The user can add products to their cart by submitting the form.\n2. View cart: The user can view their cart contents and total cost.\n3. Remove product from cart: The user can remove products from their cart.\n\nNote that this is a simplified example and you may want to add additional features such as:\n\n* Authentication and authorization\n* Credit card payment processing\n* Shipping and handling estimates\n* Product reviews and ratings\n\nAlso, make sure to replace the placeholders (`$servername`, `$username`, `$password`, etc.) with your actual database credentials.", "code_blocks": [null, "```php\n<?php\n\n// Database connection settings\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"mydatabase\";\n\n// Create a database connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product to cart\nfunction add_product_to_cart() {\n    global $conn;\n    \n    if (isset($_POST['add_to_cart'])) {\n        $product_id = $_POST['product_id'];\n        $quantity = $_POST['quantity'];\n\n        // Get the product details from database\n        $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($query);\n\n        if ($result->num_rows > 0) {\n            $row = $result->fetch_assoc();\n            $product_name = $row['name'];\n            $price = $row['price'];\n\n            // Update the cart with product details\n            $_SESSION['cart'][$product_id]['quantity'] = $quantity;\n            $_SESSION['cart'][$product_id]['price'] = $price;\n\n            header(\"Location: view_cart.php\");\n            exit();\n        } else {\n            echo \"Product not found.\";\n        }\n    }\n}\n\n// Function to view cart\nfunction view_cart() {\n    global $conn;\n    \n    if (isset($_SESSION['cart'])) {\n        // Get the cart details from session\n        foreach ($_SESSION['cart'] as $product_id => $product) {\n            $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n            $result = $conn->query($query);\n\n            if ($result->num_rows > 0) {\n                $row = $result->fetch_assoc();\n                $product_name = $row['name'];\n                $price = $row['price'];\n\n                echo \"Product Name: $product_name <br>\";\n                echo \"Quantity: \" . $_SESSION['cart'][$product_id]['quantity'] . \"<br>\";\n                echo \"Price: $\" . $_SESSION['cart'][$product_id]['price'] . \"<br><hr>\";\n            }\n        }\n\n        // Calculate the total cost\n        $total_cost = 0;\n        foreach ($_SESSION['cart'] as $product_id => $product) {\n            $total_cost += $_SESSION['cart'][$product_id]['price'] * $_SESSION['cart'][$product_id]['quantity'];\n        }\n\n        echo \"Total Cost: $\" . $total_cost . \"<br>\";\n\n        // Create an order\n        if (isset($_POST['place_order'])) {\n            $customer_name = $_POST['customer_name'];\n            $order_status = 'pending';\n\n            // Insert the order details into database\n            $query = \"INSERT INTO orders (customer_name, total_cost, date, status) VALUES ('$customer_name', '$total_cost', NOW(), '$order_status')\";\n            $conn->query($query);\n\n            echo \"Order placed successfully.\";\n        }\n    } else {\n        echo \"Cart is empty.\";\n    }\n}\n\n// Function to remove product from cart\nfunction remove_product_from_cart() {\n    global $conn;\n    \n    if (isset($_POST['remove'])) {\n        $product_id = $_POST['product_id'];\n\n        // Remove the product from session and database\n        unset($_SESSION['cart'][$product_id]);\n\n        header(\"Location: view_cart.php\");\n        exit();\n    }\n}\n\n// Add event listeners to buttons\nif (isset($_POST['add_to_cart'])) {\n    add_product_to_cart();\n} elseif (isset($_POST['place_order'])) {\n    view_cart();\n} elseif (isset($_POST['remove'])) {\n    remove_product_from_cart();\n}\n```", null]}
