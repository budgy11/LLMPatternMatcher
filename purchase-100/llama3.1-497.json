{"prompt": "Create a purchase functionality using php", "llm_output": "Here's an example of how you can create a basic purchase functionality in PHP. This will include a form to select products, calculate the total price, and process the payment.\n\n**Note:** For demonstration purposes, I'll use simple arrays for the product catalog and payment processing. You should replace these with your actual database or external APIs.\n\n### Database Setup (Optional)\n\nCreate a `products` table in your database:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n```\n\nPopulate the table with some sample data:\n\n```sql\nINSERT INTO products (id, name, price) VALUES\n  (1, 'Product A', 19.99),\n  (2, 'Product B', 9.99),\n  (3, 'Product C', 29.99);\n```\n\n### PHP Code\n\nCreate a `purchase.php` file with the following code:\n\n```php\n<?php\n// Product catalog\n$products = [\n    ['id' => 1, 'name' => 'Product A', 'price' => 19.99],\n    ['id' => 2, 'name' => 'Product B', 'price' => 9.99],\n    ['id' => 3, 'name' => 'Product C', 'price' => 29.99]\n];\n\n// Session variables to store selected products\nif (!isset($_SESSION)) {\n    session_start();\n}\n\n// Process form submission\nif (isset($_POST['submit'])) {\n    // Extract selected products from POST data\n    $selectedProducts = [];\n    foreach ($_POST['products'] as $productId => $isSelected) {\n        if ($isSelected == 'on') {\n            $selectedProducts[] = [\n                'id' => $productId,\n                'name' => $products[$productId - 1]['name'],\n                'price' => $products[$productId - 1]['price']\n            ];\n        }\n    }\n\n    // Calculate total price\n    $totalPrice = array_sum(array_column($selectedProducts, 'price'));\n\n    // Process payment (for demonstration purposes, just echo the result)\n    if ($totalPrice > 0) {\n        echo \"Payment processed successfully!\";\n    } else {\n        echo \"No products selected.\";\n    }\n}\n\n// Display form\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <h2>Product Selection</h2>\n    <?php foreach ($products as $product): ?>\n        <input type=\"checkbox\" name=\"products[<?php echo $product['id']; ?>]\" id=\"product-<?php echo $product['id']; ?>\">\n        <label for=\"product-<?php echo $product['id']; ?>\"><?php echo $product['name']; ?></label><br>\n    <?php endforeach; ?>\n    <button type=\"submit\" name=\"submit\">Proceed to Payment</button>\n    <input type=\"hidden\" name=\"totalPrice\" value=\"<?php echo isset($totalPrice) ? $totalPrice : 0; ?>\">\n</form>\n\n<?php if (isset($_POST['submit'])): ?>\n    <p>Total Price: <?php echo $totalPrice; ?></p>\n<?php endif; ?>\n```\n\n### Explanation\n\n1. The code starts by defining a `$products` array to simulate the product catalog.\n2. It uses session variables to store the selected products when the form is submitted.\n3. When the form is submitted, it extracts the selected products from the `$_POST` data and calculates the total price using the array_sum function.\n4. The payment processing part is currently just an echo statement for demonstration purposes; in a real application, you'd replace this with actual payment processing logic (e.g., using a library like Stripe or PayPal).\n5. Finally, it displays the form to select products and, if submitted, shows the total price.\n\n### Usage\n\n1. Open `purchase.php` in your web browser.\n2. Select one or more products by checking their checkboxes.\n3. Click \"Proceed to Payment\" to submit the form.\n4. The page will display a success message and show the total price.\n5. You can replace the echo statement for payment processing with actual logic as needed.\n\nPlease note that this example is simplified and you may need to adapt it according to your specific requirements, such as integrating it with a database or external APIs.", "code_blocks": [null, null, "```php\n<?php\n// Product catalog\n$products = [\n    ['id' => 1, 'name' => 'Product A', 'price' => 19.99],\n    ['id' => 2, 'name' => 'Product B', 'price' => 9.99],\n    ['id' => 3, 'name' => 'Product C', 'price' => 29.99]\n];\n\n// Session variables to store selected products\nif (!isset($_SESSION)) {\n    session_start();\n}\n\n// Process form submission\nif (isset($_POST['submit'])) {\n    // Extract selected products from POST data\n    $selectedProducts = [];\n    foreach ($_POST['products'] as $productId => $isSelected) {\n        if ($isSelected == 'on') {\n            $selectedProducts[] = [\n                'id' => $productId,\n                'name' => $products[$productId - 1]['name'],\n                'price' => $products[$productId - 1]['price']\n            ];\n        }\n    }\n\n    // Calculate total price\n    $totalPrice = array_sum(array_column($selectedProducts, 'price'));\n\n    // Process payment (for demonstration purposes, just echo the result)\n    if ($totalPrice > 0) {\n        echo \"Payment processed successfully!\";\n    } else {\n        echo \"No products selected.\";\n    }\n}\n\n// Display form\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <h2>Product Selection</h2>\n    <?php foreach ($products as $product): ?>\n        <input type=\"checkbox\" name=\"products[<?php echo $product['id']; ?>]\" id=\"product-<?php echo $product['id']; ?>\">\n        <label for=\"product-<?php echo $product['id']; ?>\"><?php echo $product['name']; ?></label><br>\n    <?php endforeach; ?>\n    <button type=\"submit\" name=\"submit\">Proceed to Payment</button>\n    <input type=\"hidden\" name=\"totalPrice\" value=\"<?php echo isset($totalPrice) ? $totalPrice : 0; ?>\">\n</form>\n\n<?php if (isset($_POST['submit'])): ?>\n    <p>Total Price: <?php echo $totalPrice; ?></p>\n<?php endif; ?>\n```"]}
