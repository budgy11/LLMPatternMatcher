{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple \"Add to Cart\" and \"Checkout\" system in PHP:\n\n**Database Schema:**\n\nWe will need a database with two tables: `products` and `orders`. The `products` table will store information about each product, while the `orders` table will store information about each order.\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  total_price DECIMAL(10,2),\n  status VARCHAR(100) DEFAULT 'pending'\n);\n```\n\n**PHP Code:**\n\nWe will create three files: `index.php` for displaying the products list, `cart.php` for managing the cart, and `checkout.php` for processing the checkout.\n\n```php\n// index.php\n\n<?php\nrequire_once 'dbconfig.php'; // database configuration file\n\n$productList = array();\n$result = mysqli_query($conn, \"SELECT * FROM products\");\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $productList[] = $row;\n}\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Product List</title>\n</head>\n<body>\n\n<h1>Product List</h1>\n\n<ul>\n    <?php foreach ($productList as $product) : ?>\n        <li>\n            <a href=\"?id=<?= $product['id'] ?>\"><?= $product['name'] ?></a>\n            (<?= $product['price'] ?>)\n        </li>\n    <?php endforeach; ?>\n</ul>\n\n<a href=\"cart.php\">Add to Cart</a>\n\n<?php\nif (isset($_GET['id'])) {\n    addToCart();\n}\n?>\n\n</body>\n</html>\n\n<?php\n\nfunction addToCart() {\n    $productId = $_GET['id'];\n    if (!isset($_SESSION['cart'])) {\n        $_SESSION['cart'] = array();\n    }\n    $_SESSION['cart'][$productId] = true;\n}\n\n?>\n```\n\n```php\n// cart.php\n\n<?php\nrequire_once 'dbconfig.php'; // database configuration file\n\nif (!isset($_SESSION['cart'])) {\n    $_SESSION['cart'] = array();\n}\n\n$cartList = array();\n$result = mysqli_query($conn, \"SELECT * FROM products\");\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $cartList[] = $row;\n}\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Cart</title>\n</head>\n<body>\n\n<h1>Cart</h1>\n\n<ul>\n    <?php foreach ($cartList as $product) : ?>\n        <li>\n            <a href=\"?remove=<?= $product['id'] ?>\"><?= $product['name'] ?></a>\n            (<?= $product['price'] ?>)\n            x <?= isset($_SESSION['cart'][$product['id']]) ? '1' : '0' ?>\n        </li>\n    <?php endforeach; ?>\n</ul>\n\n<a href=\"checkout.php\">Checkout</a>\n\n<?php\nif (isset($_GET['remove'])) {\n    removeFromCart();\n}\n?>\n\n<?php\n\nfunction removeFromCart() {\n    $productId = $_GET['remove'];\n    unset($_SESSION['cart'][$productId]);\n}\n\n?>\n```\n\n```php\n// checkout.php\n\n<?php\nrequire_once 'dbconfig.php'; // database configuration file\n\n$orderId = uniqid();\n\n$totalPrice = 0;\nforeach ($_SESSION['cart'] as $product) {\n    $result = mysqli_query($conn, \"SELECT price FROM products WHERE id=\" . (int) $product);\n    if ($row = mysqli_fetch_assoc($result)) {\n        $totalPrice += (float) $row['price'];\n    }\n}\n\nmysqli_query($conn, \"\nINSERT INTO orders (customer_name, total_price)\nVALUES ('\" . $_SESSION['username'] . \"', \" . $totalPrice . \")\n\");\n\nmysqli_query($conn, \"\nUPDATE products\nSET quantity = quantity - 1\nWHERE id IN (\" . implode(',', array_keys($_SESSION['cart'])) . \")\n\");\n\nunset($_SESSION['cart']);\n\necho 'Your order has been successfully placed!';\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Checkout</title>\n</head>\n<body>\n\n<h1>Checkout</h1>\n\n<p>Total Price: <?= $totalPrice ?></p>\n\n<?php\n\nfunction calculateTotal() {\n    global $totalPrice;\n    foreach ($_SESSION['cart'] as $product) {\n        $result = mysqli_query($conn, \"SELECT price FROM products WHERE id=\" . (int) $product);\n        if ($row = mysqli_fetch_assoc($result)) {\n            $totalPrice += (float) $row['price'];\n        }\n    }\n}\n\n?>\n```\n\nThis is a basic example and may need to be adapted to your specific requirements.", "code_blocks": [null, "```php\n// index.php\n\n<?php\nrequire_once 'dbconfig.php'; // database configuration file\n\n$productList = array();\n$result = mysqli_query($conn, \"SELECT * FROM products\");\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $productList[] = $row;\n}\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Product List</title>\n</head>\n<body>\n\n<h1>Product List</h1>\n\n<ul>\n    <?php foreach ($productList as $product) : ?>\n        <li>\n            <a href=\"?id=<?= $product['id'] ?>\"><?= $product['name'] ?></a>\n            (<?= $product['price'] ?>)\n        </li>\n    <?php endforeach; ?>\n</ul>\n\n<a href=\"cart.php\">Add to Cart</a>\n\n<?php\nif (isset($_GET['id'])) {\n    addToCart();\n}\n?>\n\n</body>\n</html>\n\n<?php\n\nfunction addToCart() {\n    $productId = $_GET['id'];\n    if (!isset($_SESSION['cart'])) {\n        $_SESSION['cart'] = array();\n    }\n    $_SESSION['cart'][$productId] = true;\n}\n\n?>\n```", "```php\n// cart.php\n\n<?php\nrequire_once 'dbconfig.php'; // database configuration file\n\nif (!isset($_SESSION['cart'])) {\n    $_SESSION['cart'] = array();\n}\n\n$cartList = array();\n$result = mysqli_query($conn, \"SELECT * FROM products\");\nwhile ($row = mysqli_fetch_assoc($result)) {\n    $cartList[] = $row;\n}\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Cart</title>\n</head>\n<body>\n\n<h1>Cart</h1>\n\n<ul>\n    <?php foreach ($cartList as $product) : ?>\n        <li>\n            <a href=\"?remove=<?= $product['id'] ?>\"><?= $product['name'] ?></a>\n            (<?= $product['price'] ?>)\n            x <?= isset($_SESSION['cart'][$product['id']]) ? '1' : '0' ?>\n        </li>\n    <?php endforeach; ?>\n</ul>\n\n<a href=\"checkout.php\">Checkout</a>\n\n<?php\nif (isset($_GET['remove'])) {\n    removeFromCart();\n}\n?>\n\n<?php\n\nfunction removeFromCart() {\n    $productId = $_GET['remove'];\n    unset($_SESSION['cart'][$productId]);\n}\n\n?>\n```", "```php\n// checkout.php\n\n<?php\nrequire_once 'dbconfig.php'; // database configuration file\n\n$orderId = uniqid();\n\n$totalPrice = 0;\nforeach ($_SESSION['cart'] as $product) {\n    $result = mysqli_query($conn, \"SELECT price FROM products WHERE id=\" . (int) $product);\n    if ($row = mysqli_fetch_assoc($result)) {\n        $totalPrice += (float) $row['price'];\n    }\n}\n\nmysqli_query($conn, \"\nINSERT INTO orders (customer_name, total_price)\nVALUES ('\" . $_SESSION['username'] . \"', \" . $totalPrice . \")\n\");\n\nmysqli_query($conn, \"\nUPDATE products\nSET quantity = quantity - 1\nWHERE id IN (\" . implode(',', array_keys($_SESSION['cart'])) . \")\n\");\n\nunset($_SESSION['cart']);\n\necho 'Your order has been successfully placed!';\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Checkout</title>\n</head>\n<body>\n\n<h1>Checkout</h1>\n\n<p>Total Price: <?= $totalPrice ?></p>\n\n<?php\n\nfunction calculateTotal() {\n    global $totalPrice;\n    foreach ($_SESSION['cart'] as $product) {\n        $result = mysqli_query($conn, \"SELECT price FROM products WHERE id=\" . (int) $product);\n        if ($row = mysqli_fetch_assoc($result)) {\n            $totalPrice += (float) $row['price'];\n        }\n    }\n}\n\n?>\n```"]}
