{"prompt": "Create a purchase cart functionality using php", "llm_output": "Here's an example of how to create a basic purchase cart functionality using PHP. We'll use HTML, CSS, and JavaScript for the UI, and PHP as the backend.\n\n**Database Setup**\n\nFirst, let's set up our database with two tables: `products` and `cart`.\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE cart (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  product_id INT,\n  user_id INT,\n  quantity INT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n\n**Product Table**\n\nWe'll create a PHP file `products.php` to retrieve products from the database and display them on our webpage.\n\n```php\n<?php\n// Connect to the database\n$conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get products from the database\n$sql = \"SELECT * FROM products\";\n$result = $conn->query($sql);\n\n// Display products on the webpage\necho \"<table border='1'>\";\necho \"<tr><th>Product Name</th><th>Price</th></tr>\";\nwhile ($row = $result->fetch_assoc()) {\n    echo \"<tr><td>$row[name]</td><td>$row[price]</td></tr>\";\n}\necho \"</table>\";\n\n// Close the database connection\n$conn->close();\n?>\n```\n\n**Cart Table**\n\nWe'll create a PHP file `cart.php` to handle cart-related functionality, such as adding products to the cart and displaying cart contents.\n\n```php\n<?php\n// Connect to the database\n$conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// If the user is adding a product to their cart...\nif (isset($_POST['add_to_cart'])) {\n    // Get the product ID and quantity from the form data\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if the product already exists in the cart\n    $sql = \"SELECT * FROM cart WHERE user_id = 1 AND product_id = '$product_id'\";\n    $result = $conn->query($sql);\n\n    // If it does, update the quantity; otherwise, insert a new row\n    if ($result->num_rows > 0) {\n        // Update the quantity\n        $sql = \"UPDATE cart SET quantity = quantity + '$quantity' WHERE user_id = 1 AND product_id = '$product_id'\";\n    } else {\n        // Insert a new row into the cart table\n        $sql = \"INSERT INTO cart (user_id, product_id, quantity) VALUES (1, '$product_id', '$quantity')\";\n    }\n\n    // Execute the query\n    if ($conn->query($sql)) {\n        echo \"Product added to cart successfully!\";\n    } else {\n        echo \"Error adding product to cart: \" . $conn->error;\n    }\n}\n\n// Display cart contents on the webpage\n$sql = \"SELECT * FROM cart WHERE user_id = 1\";\n$result = $conn->query($sql);\n\necho \"<h2>Cart Contents:</h2>\";\necho \"<table border='1'>\";\necho \"<tr><th>Product Name</th><th>Quantity</th></tr>\";\nwhile ($row = $result->fetch_assoc()) {\n    // Get the product name from the products table\n    $product_sql = \"SELECT * FROM products WHERE id = '$row[product_id]'\";\n    $product_result = $conn->query($product_sql);\n    $product_row = $product_result->fetch_assoc();\n\n    echo \"<tr><td>$product_row[name]</td><td>$row[quantity]</td></tr>\";\n}\necho \"</table>\";\n\n// Close the database connection\n$conn->close();\n?>\n```\n\n**HTML & JavaScript**\n\nWe'll create an HTML file `index.html` to display the products and handle form submissions.\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Document</title>\n</head>\n<body>\n\n<!-- Display products -->\n<h2>Products:</h2>\n<table border=\"1\">\n    <?php include 'products.php'; ?>\n</table>\n\n<form action=\"cart.php\" method=\"post\">\n    <select name=\"product_id\">\n        <?php\n            // Get product options from the database and display them in the select box\n            $sql = \"SELECT * FROM products\";\n            $result = $conn->query($sql);\n\n            while ($row = $result->fetch_assoc()) {\n                echo \"<option value='$row[id]'>$row[name]</option>\";\n            }\n        ?>\n    </select>\n    <input type=\"number\" name=\"quantity\">\n    <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n</form>\n\n<!-- Display cart contents -->\n<?php include 'cart.php'; ?>\n\n<script src=\"script.js\"></script>\n</body>\n</html>\n```\n\n**Note**: This is a basic example, and you should modify the code to fit your specific needs. Additionally, this code does not handle payment processing or checkout functionality.\n\nThis example demonstrates how to:\n\n1. Display products from the database\n2. Add products to the cart\n3. Display cart contents\n\nTo add more features, such as payment processing, checkout, and user authentication, you'll need to modify the code accordingly.\n\n**Security Note**: This is a simplified example, and in a real-world application, you should use prepared statements to prevent SQL injection attacks. You should also implement proper error handling and logging mechanisms.", "code_blocks": [null, "```php\n<?php\n// Connect to the database\n$conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get products from the database\n$sql = \"SELECT * FROM products\";\n$result = $conn->query($sql);\n\n// Display products on the webpage\necho \"<table border='1'>\";\necho \"<tr><th>Product Name</th><th>Price</th></tr>\";\nwhile ($row = $result->fetch_assoc()) {\n    echo \"<tr><td>$row[name]</td><td>$row[price]</td></tr>\";\n}\necho \"</table>\";\n\n// Close the database connection\n$conn->close();\n?>\n```", "```php\n<?php\n// Connect to the database\n$conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// If the user is adding a product to their cart...\nif (isset($_POST['add_to_cart'])) {\n    // Get the product ID and quantity from the form data\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if the product already exists in the cart\n    $sql = \"SELECT * FROM cart WHERE user_id = 1 AND product_id = '$product_id'\";\n    $result = $conn->query($sql);\n\n    // If it does, update the quantity; otherwise, insert a new row\n    if ($result->num_rows > 0) {\n        // Update the quantity\n        $sql = \"UPDATE cart SET quantity = quantity + '$quantity' WHERE user_id = 1 AND product_id = '$product_id'\";\n    } else {\n        // Insert a new row into the cart table\n        $sql = \"INSERT INTO cart (user_id, product_id, quantity) VALUES (1, '$product_id', '$quantity')\";\n    }\n\n    // Execute the query\n    if ($conn->query($sql)) {\n        echo \"Product added to cart successfully!\";\n    } else {\n        echo \"Error adding product to cart: \" . $conn->error;\n    }\n}\n\n// Display cart contents on the webpage\n$sql = \"SELECT * FROM cart WHERE user_id = 1\";\n$result = $conn->query($sql);\n\necho \"<h2>Cart Contents:</h2>\";\necho \"<table border='1'>\";\necho \"<tr><th>Product Name</th><th>Quantity</th></tr>\";\nwhile ($row = $result->fetch_assoc()) {\n    // Get the product name from the products table\n    $product_sql = \"SELECT * FROM products WHERE id = '$row[product_id]'\";\n    $product_result = $conn->query($product_sql);\n    $product_row = $product_result->fetch_assoc();\n\n    echo \"<tr><td>$product_row[name]</td><td>$row[quantity]</td></tr>\";\n}\necho \"</table>\";\n\n// Close the database connection\n$conn->close();\n?>\n```", null]}
