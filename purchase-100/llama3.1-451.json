{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP:\n\n**Note:** This example assumes you have a basic understanding of PHP and MySQL. It's also worth noting that this is a simplified example and in a real-world scenario, you would want to add more validation, error handling, and security measures.\n\n**database.php**\n```php\n<?php\n\n// Connect to database\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"shop\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n?>\n```\n**products.php**\n```php\n<?php\n\n// Get products from database\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo \"<div>\";\n    echo \"<h2>\" . $row['name'] . \"</h2>\";\n    echo \"<p>Price: $\" . $row['price'] . \"</p>\";\n    echo \"<button>Add to Cart</button>\";\n    echo \"</div>\";\n}\n\n?>\n```\n**cart.php**\n```php\n<?php\n\n// Get products in cart from session\nif (isset($_SESSION['cart'])) {\n    echo \"<h2>Cart:</h2>\";\n    foreach ($_SESSION['cart'] as $product) {\n        echo \"<p>\" . $product['name'] . \" x \" . $product['quantity'] . \"</p>\";\n    }\n}\n\n?>\n```\n**process_purchase.php**\n```php\n<?php\n\n// Process purchase form data\nif (isset($_POST['purchase'])) {\n    // Get product ID from session\n    $product_id = $_SESSION['cart']['product_id'];\n\n    // Get user details from database\n    $query = \"SELECT * FROM users WHERE id = '\" . $_SESSION['user_id'] . \"'\";\n    $result = mysqli_query($conn, $query);\n    $row = mysqli_fetch_assoc($result);\n\n    // Calculate total cost\n    $total_cost = $_SESSION['cart']['quantity'] * $_SESSION['cart']['price'];\n\n    // Update user balance\n    $query = \"UPDATE users SET balance = balance - '$total_cost' WHERE id = '\" . $_SESSION['user_id'] . \"'\";\n    mysqli_query($conn, $query);\n\n    // Insert purchase into database\n    $query = \"INSERT INTO purchases (product_id, user_id, date) VALUES ('\" . $product_id . \"', '\" . $_SESSION['user_id'] . \"', NOW())\";\n    mysqli_query($conn, $query);\n\n    // Clear cart session variable\n    unset($_SESSION['cart']);\n\n    echo \"<p>Purchase successful!</p>\";\n}\n\n?>\n```\n**index.php**\n```php\n<?php\n\n// Initialize session variables\nsession_start();\n\n// Check if user is logged in\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit;\n}\n\n// Get products from database\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo \"<div>\";\n    echo \"<h2>\" . $row['name'] . \"</h2>\";\n    echo \"<p>Price: $\" . $row['price'] . \"</p>\";\n    echo \"<button>Add to Cart</button>\";\n    echo \"</div>\";\n}\n\n?>\n\n<form action=\"process_purchase.php\" method=\"post\">\n    <input type=\"submit\" name=\"purchase\" value=\"Purchase\">\n</form>\n```\nThis example demonstrates a simple purchase functionality using PHP and MySQL. The user adds products to their cart, which is stored in a session variable. When the user clicks the \"Purchase\" button, the `process_purchase.php` script processes the form data, updates the user's balance, inserts a new purchase into the database, and clears the cart session variable.\n\nNote that this example assumes you have already set up your database and have created the necessary tables (e.g. `products`, `users`, `purchases`). You will also need to modify the SQL queries to match your specific database schema.", "code_blocks": ["```php\n<?php\n\n// Connect to database\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"shop\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n?>\n```", "```php\n<?php\n\n// Get products from database\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo \"<div>\";\n    echo \"<h2>\" . $row['name'] . \"</h2>\";\n    echo \"<p>Price: $\" . $row['price'] . \"</p>\";\n    echo \"<button>Add to Cart</button>\";\n    echo \"</div>\";\n}\n\n?>\n```", "```php\n<?php\n\n// Get products in cart from session\nif (isset($_SESSION['cart'])) {\n    echo \"<h2>Cart:</h2>\";\n    foreach ($_SESSION['cart'] as $product) {\n        echo \"<p>\" . $product['name'] . \" x \" . $product['quantity'] . \"</p>\";\n    }\n}\n\n?>\n```", "```php\n<?php\n\n// Process purchase form data\nif (isset($_POST['purchase'])) {\n    // Get product ID from session\n    $product_id = $_SESSION['cart']['product_id'];\n\n    // Get user details from database\n    $query = \"SELECT * FROM users WHERE id = '\" . $_SESSION['user_id'] . \"'\";\n    $result = mysqli_query($conn, $query);\n    $row = mysqli_fetch_assoc($result);\n\n    // Calculate total cost\n    $total_cost = $_SESSION['cart']['quantity'] * $_SESSION['cart']['price'];\n\n    // Update user balance\n    $query = \"UPDATE users SET balance = balance - '$total_cost' WHERE id = '\" . $_SESSION['user_id'] . \"'\";\n    mysqli_query($conn, $query);\n\n    // Insert purchase into database\n    $query = \"INSERT INTO purchases (product_id, user_id, date) VALUES ('\" . $product_id . \"', '\" . $_SESSION['user_id'] . \"', NOW())\";\n    mysqli_query($conn, $query);\n\n    // Clear cart session variable\n    unset($_SESSION['cart']);\n\n    echo \"<p>Purchase successful!</p>\";\n}\n\n?>\n```", "```php\n<?php\n\n// Initialize session variables\nsession_start();\n\n// Check if user is logged in\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit;\n}\n\n// Get products from database\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo \"<div>\";\n    echo \"<h2>\" . $row['name'] . \"</h2>\";\n    echo \"<p>Price: $\" . $row['price'] . \"</p>\";\n    echo \"<button>Add to Cart</button>\";\n    echo \"</div>\";\n}\n\n?>\n\n<form action=\"process_purchase.php\" method=\"post\">\n    <input type=\"submit\" name=\"purchase\" value=\"Purchase\">\n</form>\n```"]}
