{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality in PHP, using a MySQL database to store the products and customers. This will include creating a form for customers to enter their information and select a product to purchase.\n\n**Database Schema**\n\nFirst, let's create the database schema:\n\n```sql\nCREATE TABLE customers (\n    id INT AUTO_INCREMENT,\n    name VARCHAR(255),\n    email VARCHAR(255),\n    address VARCHAR(255),\n    PRIMARY KEY (id)\n);\n\nCREATE TABLE products (\n    id INT AUTO_INCREMENT,\n    name VARCHAR(255),\n    price DECIMAL(10,2),\n    description TEXT,\n    PRIMARY KEY (id)\n);\n\nCREATE TABLE orders (\n    id INT AUTO_INCREMENT,\n    customer_id INT,\n    product_id INT,\n    quantity INT,\n    total_price DECIMAL(10,2),\n    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (customer_id) REFERENCES customers(id),\n    FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code**\n\nNext, we'll create a PHP script to handle the purchase functionality:\n\n```php\n<?php\n\n// Database connection settings\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"store\";\n\n// Create database connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to get all products from database\nfunction getProducts() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n    return $result;\n}\n\n// Function to add a new order to the database\nfunction addOrder($customer_id, $product_id, $quantity) {\n    global $conn;\n    $total_price = getProductIdPrice($product_id) * $quantity;\n    $query = \"INSERT INTO orders (customer_id, product_id, quantity, total_price) VALUES ('$customer_id', '$product_id', '$quantity', '$total_price')\";\n    $result = $conn->query($query);\n    return $result;\n}\n\n// Function to get the price of a specific product\nfunction getProductIdPrice($id) {\n    global $conn;\n    $query = \"SELECT price FROM products WHERE id='$id'\";\n    $result = $conn->query($query);\n    if ($row = $result->fetch_assoc()) {\n        return $row['price'];\n    } else {\n        return 0;\n    }\n}\n\n// Check if the user has submitted the form\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get customer information from form data\n    $name = $_POST['name'];\n    $email = $_POST['email'];\n    $address = $_POST['address'];\n\n    // Add new customer to database\n    $query = \"INSERT INTO customers (name, email, address) VALUES ('$name', '$email', '$address')\";\n    $result = $conn->query($query);\n\n    // Get the ID of the newly added customer\n    $customer_id = $conn->insert_id;\n\n    // Check if a product has been selected for purchase\n    if (isset($_POST['product_id'])) {\n        // Add new order to database\n        addOrder($customer_id, $_POST['product_id'], 1);\n\n        echo \"Thank you for your purchase! Your order ID is: \" . $conn->insert_id;\n    } else {\n        echo \"Please select a product to purchase.\";\n    }\n}\n\n// Get all products from database and display them in the form\n$products = getProducts();\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    Customer Information:\n    <br />\n    Name: <input type=\"text\" name=\"name\" required />\n    Email: <input type=\"email\" name=\"email\" required />\n    Address: <textarea name=\"address\" rows=\"5\" cols=\"30\"></textarea>\n    <br />\n    Select a product to purchase:\n    <select name=\"product_id\">\n        <?php foreach ($products as $row) { ?>\n            <option value=\"<?php echo $row['id']; ?>\"><?php echo $row['name']; ?> - Price: $<?php echo number_format($row['price'], 2); ?></option>\n        <?php } ?>\n    </select>\n    <br />\n    <input type=\"submit\" name=\"submit\" value=\"Purchase\" />\n</form>\n\n<?php\n// Close database connection\n$conn->close();\n?>\n\n</body>\n</html>\n```\n\nThis script creates a simple form where customers can enter their information and select a product to purchase. When the customer submits the form, it checks if they have selected a product, and if so, adds a new order to the database with the customer's ID, product ID, and quantity (in this case, 1). It then displays a thank-you message with the order ID.\n\nPlease note that this is a simplified example and you should consider security measures such as input validation, CSRF protection, and proper error handling in a real-world application.", "code_blocks": [null, "```php\n<?php\n\n// Database connection settings\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"store\";\n\n// Create database connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to get all products from database\nfunction getProducts() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n    return $result;\n}\n\n// Function to add a new order to the database\nfunction addOrder($customer_id, $product_id, $quantity) {\n    global $conn;\n    $total_price = getProductIdPrice($product_id) * $quantity;\n    $query = \"INSERT INTO orders (customer_id, product_id, quantity, total_price) VALUES ('$customer_id', '$product_id', '$quantity', '$total_price')\";\n    $result = $conn->query($query);\n    return $result;\n}\n\n// Function to get the price of a specific product\nfunction getProductIdPrice($id) {\n    global $conn;\n    $query = \"SELECT price FROM products WHERE id='$id'\";\n    $result = $conn->query($query);\n    if ($row = $result->fetch_assoc()) {\n        return $row['price'];\n    } else {\n        return 0;\n    }\n}\n\n// Check if the user has submitted the form\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get customer information from form data\n    $name = $_POST['name'];\n    $email = $_POST['email'];\n    $address = $_POST['address'];\n\n    // Add new customer to database\n    $query = \"INSERT INTO customers (name, email, address) VALUES ('$name', '$email', '$address')\";\n    $result = $conn->query($query);\n\n    // Get the ID of the newly added customer\n    $customer_id = $conn->insert_id;\n\n    // Check if a product has been selected for purchase\n    if (isset($_POST['product_id'])) {\n        // Add new order to database\n        addOrder($customer_id, $_POST['product_id'], 1);\n\n        echo \"Thank you for your purchase! Your order ID is: \" . $conn->insert_id;\n    } else {\n        echo \"Please select a product to purchase.\";\n    }\n}\n\n// Get all products from database and display them in the form\n$products = getProducts();\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    Customer Information:\n    <br />\n    Name: <input type=\"text\" name=\"name\" required />\n    Email: <input type=\"email\" name=\"email\" required />\n    Address: <textarea name=\"address\" rows=\"5\" cols=\"30\"></textarea>\n    <br />\n    Select a product to purchase:\n    <select name=\"product_id\">\n        <?php foreach ($products as $row) { ?>\n            <option value=\"<?php echo $row['id']; ?>\"><?php echo $row['name']; ?> - Price: $<?php echo number_format($row['price'], 2); ?></option>\n        <?php } ?>\n    </select>\n    <br />\n    <input type=\"submit\" name=\"submit\" value=\"Purchase\" />\n</form>\n\n<?php\n// Close database connection\n$conn->close();\n?>\n\n</body>\n</html>\n```"]}
