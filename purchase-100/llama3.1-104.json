{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a basic purchase functionality using PHP:\n\n**purchase.php**\n```php\n<?php\n// Database connection settings\n$servername = \"localhost\";\n$username = \"username\";\n$password = \"password\";\n$dbname = \"store\";\n\n// Create database connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check if the user has submitted the form\nif (isset($_POST['buy'])) {\n    // Get the product ID and quantity from the form data\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Validate the input\n    if ($product_id == \"\" || $quantity == \"\") {\n        echo \"Please enter both product ID and quantity\";\n        exit;\n    }\n\n    // Query to select the product details from the database\n    $sql = \"SELECT * FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $sql);\n\n    // Check if the product exists in the database\n    if (mysqli_num_rows($result) == 0) {\n        echo \"Product not found\";\n        exit;\n    }\n\n    // Get the product details from the query result\n    $row = mysqli_fetch_assoc($result);\n    $product_name = $row['name'];\n    $price = $row['price'];\n\n    // Calculate the total cost\n    $total_cost = $quantity * $price;\n\n    // Query to insert a new order into the database\n    $sql = \"INSERT INTO orders (product_id, quantity, total_cost) VALUES ('$product_id', '$quantity', '$total_cost')\";\n    mysqli_query($conn, $sql);\n\n    // Update the product stock in the database\n    $sql = \"UPDATE products SET stock = stock - '$quantity' WHERE id = '$product_id'\";\n    mysqli_query($conn, $sql);\n\n    // Display a success message to the user\n    echo \"Purchase successful!\";\n}\n?>\n```\n\n**index.php**\n```php\n<?php\n// Include the database connection settings from purchase.php\ninclude 'purchase.php';\n\n// Query to select all products from the database\n$sql = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $sql);\n\n// Display a form for each product in the result set\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo \"\n        <form action='' method='post'>\n            <input type='hidden' name='product_id' value='{$row['id']}' />\n            <label>Product Name:</label>\n            <p>{$row['name']}</p>\n            <label>Price:</label>\n            <p>${$row['price']}</p>\n            <label>Quantity:</label>\n            <input type='number' name='quantity' value='1' min='1' />\n            <button type='submit' name='buy'>Buy</button>\n        </form>\n    \";\n}\n?>\n```\nThis is a basic example and may require modifications to fit your specific use case. Make sure to replace the placeholders (`$servername`, `$username`, etc.) with your actual database credentials.\n\n**How it works:**\n\n1. The user selects a product from the list displayed in `index.php`.\n2. The form for the selected product is submitted, sending the product ID and quantity to the server.\n3. The PHP script on the server side (in `purchase.php`) processes the form data and performs the following actions:\n\t* Validates the input.\n\t* Queries the database to retrieve the product details.\n\t* Checks if the product exists in the database.\n\t* Calculates the total cost of the purchase.\n\t* Inserts a new order into the database.\n\t* Updates the product stock in the database.\n4. The script then displays a success message to the user.\n\nNote that this example does not include any error handling or security measures, such as input validation and sanitization, which should be implemented in a production environment.", "code_blocks": ["```php\n<?php\n// Database connection settings\n$servername = \"localhost\";\n$username = \"username\";\n$password = \"password\";\n$dbname = \"store\";\n\n// Create database connection\n$conn = new mysqli($servername, $username, $password, $dbname);\n\n// Check if the user has submitted the form\nif (isset($_POST['buy'])) {\n    // Get the product ID and quantity from the form data\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Validate the input\n    if ($product_id == \"\" || $quantity == \"\") {\n        echo \"Please enter both product ID and quantity\";\n        exit;\n    }\n\n    // Query to select the product details from the database\n    $sql = \"SELECT * FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $sql);\n\n    // Check if the product exists in the database\n    if (mysqli_num_rows($result) == 0) {\n        echo \"Product not found\";\n        exit;\n    }\n\n    // Get the product details from the query result\n    $row = mysqli_fetch_assoc($result);\n    $product_name = $row['name'];\n    $price = $row['price'];\n\n    // Calculate the total cost\n    $total_cost = $quantity * $price;\n\n    // Query to insert a new order into the database\n    $sql = \"INSERT INTO orders (product_id, quantity, total_cost) VALUES ('$product_id', '$quantity', '$total_cost')\";\n    mysqli_query($conn, $sql);\n\n    // Update the product stock in the database\n    $sql = \"UPDATE products SET stock = stock - '$quantity' WHERE id = '$product_id'\";\n    mysqli_query($conn, $sql);\n\n    // Display a success message to the user\n    echo \"Purchase successful!\";\n}\n?>\n```", "```php\n<?php\n// Include the database connection settings from purchase.php\ninclude 'purchase.php';\n\n// Query to select all products from the database\n$sql = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $sql);\n\n// Display a form for each product in the result set\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo \"\n        <form action='' method='post'>\n            <input type='hidden' name='product_id' value='{$row['id']}' />\n            <label>Product Name:</label>\n            <p>{$row['name']}</p>\n            <label>Price:</label>\n            <p>${$row['price']}</p>\n            <label>Quantity:</label>\n            <input type='number' name='quantity' value='1' min='1' />\n            <button type='submit' name='buy'>Buy</button>\n        </form>\n    \";\n}\n?>\n```"]}
