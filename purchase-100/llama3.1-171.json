{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how to create a basic purchase functionality using PHP. This will include the following features:\n\n1. User login and registration\n2. Product listing and display\n3. Cart functionality\n4. Checkout and payment processing (using PayPal as an example)\n\n**Database Setup**\n\nFirst, let's assume we have a database with the following tables:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  email VARCHAR(255) UNIQUE,\n  password VARCHAR(255)\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  description TEXT,\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE carts (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  product_id INT\n);\n```\n\n**PHP Code**\n\nLet's start with the PHP code.\n\n**`config.php`**\n\nThis file will contain our database connection settings and other configuration options.\n```php\n<?php\n// Database connection settings\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'example';\n\n// Create a new PDO instance\n$conn = new PDO(\"mysql:host=$dbHost;dbname=$dbName\", $dbUsername, $dbPassword);\n?>\n```\n\n**`register.php`**\n\nThis file will handle user registration.\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['register'])) {\n  // Get form data\n  $name = $_POST['name'];\n  $email = $_POST['email'];\n  $password = $_POST['password'];\n\n  // Hash password\n  $hashedPassword = password_hash($password, PASSWORD_DEFAULT);\n\n  // Insert new user into database\n  $stmt = $conn->prepare(\"INSERT INTO users (name, email, password) VALUES (:name, :email, :password)\");\n  $stmt->bindParam(':name', $name);\n  $stmt->bindParam(':email', $email);\n  $stmt->bindParam(':password', $hashedPassword);\n  $stmt->execute();\n\n  // Redirect to login page\n  header('Location: login.php');\n}\n?>\n```\n\n**`login.php`**\n\nThis file will handle user login.\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['login'])) {\n  // Get form data\n  $email = $_POST['email'];\n  $password = $_POST['password'];\n\n  // Query database for matching email and password\n  $stmt = $conn->prepare(\"SELECT * FROM users WHERE email = :email\");\n  $stmt->bindParam(':email', $email);\n  $stmt->execute();\n  $user = $stmt->fetch();\n\n  if ($user && password_verify($password, $user['password'])) {\n    // Login successful\n    $_SESSION['id'] = $user['id'];\n    header('Location: index.php');\n  } else {\n    echo 'Invalid email or password';\n  }\n}\n?>\n```\n\n**`index.php`**\n\nThis file will display the product listing and allow users to add products to their cart.\n```php\n<?php\nrequire_once 'config.php';\n\n// Get all products from database\n$stmt = $conn->prepare(\"SELECT * FROM products\");\n$stmt->execute();\n$products = $stmt->fetchAll();\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Product Listing</title>\n</head>\n<body>\n\n  <?php foreach ($products as $product): ?>\n    <h2><?php echo $product['name']; ?></h2>\n    <p><?php echo $product['description']; ?></p>\n    <p>$<?php echo $product['price']; ?></p>\n    <form action=\"cart.php\" method=\"post\">\n      <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product['id']; ?>\">\n      <button type=\"submit\">Add to Cart</button>\n    </form>\n  <?php endforeach; ?>\n</body>\n</html>\n```\n\n**`cart.php`**\n\nThis file will handle adding products to the cart and displaying the cart contents.\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['add_to_cart'])) {\n  // Get form data\n  $product_id = $_POST['product_id'];\n\n  // Insert new product into cart\n  $stmt = $conn->prepare(\"INSERT INTO carts (user_id, product_id) VALUES (:user_id, :product_id)\");\n  $stmt->bindParam(':user_id', $_SESSION['id']);\n  $stmt->bindParam(':product_id', $product_id);\n  $stmt->execute();\n}\n\n// Get cart contents\n$stmt = $conn->prepare(\"SELECT products.name, products.description, products.price FROM carts INNER JOIN products ON carts.product_id = products.id WHERE carts.user_id = :user_id\");\n$stmt->bindParam(':user_id', $_SESSION['id']);\n$stmt->execute();\n$cart_contents = $stmt->fetchAll();\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Cart Contents</title>\n</head>\n<body>\n\n  <?php foreach ($cart_contents as $item): ?>\n    <h2><?php echo $item['name']; ?></h2>\n    <p><?php echo $item['description']; ?></p>\n    <p>$<?php echo $item['price']; ?></p>\n  <?php endforeach; ?>\n</body>\n</html>\n```\n\n**`checkout.php`**\n\nThis file will handle the checkout process and payment processing using PayPal.\n```php\n<?php\nrequire_once 'config.php';\n\n// Get cart contents\n$stmt = $conn->prepare(\"SELECT products.name, products.description, products.price FROM carts INNER JOIN products ON carts.product_id = products.id WHERE carts.user_id = :user_id\");\n$stmt->bindParam(':user_id', $_SESSION['id']);\n$stmt->execute();\n$cart_contents = $stmt->fetchAll();\n\n// Calculate total cost\n$total_cost = 0;\nforeach ($cart_contents as $item) {\n  $total_cost += $item['price'];\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Checkout</title>\n</head>\n<body>\n\n  <?php foreach ($cart_contents as $item): ?>\n    <h2><?php echo $item['name']; ?></h2>\n    <p><?php echo $item['description']; ?></p>\n    <p>$<?php echo $item['price']; ?></p>\n  <?php endforeach; ?>\n\n  <form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\">\n    <!-- PayPal form fields -->\n    <input type=\"hidden\" name=\"cmd\" value=\"_xclick\">\n    <input type=\"hidden\" name=\"business\" value=\"<?php echo 'your_paypal_email'; ?>\">\n    <input type=\"hidden\" name=\"item_name\" value=\"<?php echo 'Product 1'; ?>\">\n    <input type=\"hidden\" name=\"amount\" value=\"<?php echo $total_cost; ?>\">\n    <button type=\"submit\">Pay with PayPal</button>\n  </form>\n\n</body>\n</html>\n```\n\nThis is a basic example of how to create a purchase functionality using PHP. Note that you will need to modify the code to fit your specific needs and integrate it with your database and payment gateway.\n\nAlso, please note that this is just an example and you should never expose your PayPal email or any other sensitive information in your code. Always keep these details secure and use environment variables or secure storage mechanisms to store them.\n\nYou can also add more functionality like user authentication, product variations, shipping and tax calculations etc according to your requirement.", "code_blocks": [null, "```php\n<?php\n// Database connection settings\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'example';\n\n// Create a new PDO instance\n$conn = new PDO(\"mysql:host=$dbHost;dbname=$dbName\", $dbUsername, $dbPassword);\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['register'])) {\n  // Get form data\n  $name = $_POST['name'];\n  $email = $_POST['email'];\n  $password = $_POST['password'];\n\n  // Hash password\n  $hashedPassword = password_hash($password, PASSWORD_DEFAULT);\n\n  // Insert new user into database\n  $stmt = $conn->prepare(\"INSERT INTO users (name, email, password) VALUES (:name, :email, :password)\");\n  $stmt->bindParam(':name', $name);\n  $stmt->bindParam(':email', $email);\n  $stmt->bindParam(':password', $hashedPassword);\n  $stmt->execute();\n\n  // Redirect to login page\n  header('Location: login.php');\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['login'])) {\n  // Get form data\n  $email = $_POST['email'];\n  $password = $_POST['password'];\n\n  // Query database for matching email and password\n  $stmt = $conn->prepare(\"SELECT * FROM users WHERE email = :email\");\n  $stmt->bindParam(':email', $email);\n  $stmt->execute();\n  $user = $stmt->fetch();\n\n  if ($user && password_verify($password, $user['password'])) {\n    // Login successful\n    $_SESSION['id'] = $user['id'];\n    header('Location: index.php');\n  } else {\n    echo 'Invalid email or password';\n  }\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Get all products from database\n$stmt = $conn->prepare(\"SELECT * FROM products\");\n$stmt->execute();\n$products = $stmt->fetchAll();\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Product Listing</title>\n</head>\n<body>\n\n  <?php foreach ($products as $product): ?>\n    <h2><?php echo $product['name']; ?></h2>\n    <p><?php echo $product['description']; ?></p>\n    <p>$<?php echo $product['price']; ?></p>\n    <form action=\"cart.php\" method=\"post\">\n      <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product['id']; ?>\">\n      <button type=\"submit\">Add to Cart</button>\n    </form>\n  <?php endforeach; ?>\n</body>\n</html>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['add_to_cart'])) {\n  // Get form data\n  $product_id = $_POST['product_id'];\n\n  // Insert new product into cart\n  $stmt = $conn->prepare(\"INSERT INTO carts (user_id, product_id) VALUES (:user_id, :product_id)\");\n  $stmt->bindParam(':user_id', $_SESSION['id']);\n  $stmt->bindParam(':product_id', $product_id);\n  $stmt->execute();\n}\n\n// Get cart contents\n$stmt = $conn->prepare(\"SELECT products.name, products.description, products.price FROM carts INNER JOIN products ON carts.product_id = products.id WHERE carts.user_id = :user_id\");\n$stmt->bindParam(':user_id', $_SESSION['id']);\n$stmt->execute();\n$cart_contents = $stmt->fetchAll();\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Cart Contents</title>\n</head>\n<body>\n\n  <?php foreach ($cart_contents as $item): ?>\n    <h2><?php echo $item['name']; ?></h2>\n    <p><?php echo $item['description']; ?></p>\n    <p>$<?php echo $item['price']; ?></p>\n  <?php endforeach; ?>\n</body>\n</html>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Get cart contents\n$stmt = $conn->prepare(\"SELECT products.name, products.description, products.price FROM carts INNER JOIN products ON carts.product_id = products.id WHERE carts.user_id = :user_id\");\n$stmt->bindParam(':user_id', $_SESSION['id']);\n$stmt->execute();\n$cart_contents = $stmt->fetchAll();\n\n// Calculate total cost\n$total_cost = 0;\nforeach ($cart_contents as $item) {\n  $total_cost += $item['price'];\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Checkout</title>\n</head>\n<body>\n\n  <?php foreach ($cart_contents as $item): ?>\n    <h2><?php echo $item['name']; ?></h2>\n    <p><?php echo $item['description']; ?></p>\n    <p>$<?php echo $item['price']; ?></p>\n  <?php endforeach; ?>\n\n  <form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\">\n    <!-- PayPal form fields -->\n    <input type=\"hidden\" name=\"cmd\" value=\"_xclick\">\n    <input type=\"hidden\" name=\"business\" value=\"<?php echo 'your_paypal_email'; ?>\">\n    <input type=\"hidden\" name=\"item_name\" value=\"<?php echo 'Product 1'; ?>\">\n    <input type=\"hidden\" name=\"amount\" value=\"<?php echo $total_cost; ?>\">\n    <button type=\"submit\">Pay with PayPal</button>\n  </form>\n\n</body>\n</html>\n```"]}
