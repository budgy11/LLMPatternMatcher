{"prompt": "Create a purchase functionality using php", "llm_output": "Here's an example of how you can create a simple purchase functionality using PHP. This example assumes that you have a database set up with the following tables:\n\n**products**\n\n| id | name | price |\n| --- | --- | --- |\n\n**orders**\n\n| id | customer_name | order_date |\n| --- | --- | --- |\n\n**order_items**\n\n| id | order_id | product_id | quantity |\n| --- | --- | --- | --- |\n\nWe'll use a simple HTML form to allow users to select products and add them to their cart. We'll also use PHP sessions to store the products in the user's cart.\n\n**index.php**\n```php\n<?php\nsession_start();\n\n// Connect to database\n$db = new PDO('mysql:host=localhost;dbname=shop', 'username', 'password');\n\n// Get all products from database\n$stmt = $db->prepare('SELECT * FROM products');\n$stmt->execute();\n$products = $stmt->fetchAll();\n\n// Display products\n?>\n<html>\n<head>\n    <title>Shop</title>\n</head>\n<body>\n    <h1>Shop</h1>\n    <?php foreach ($products as $product): ?>\n        <p><?= $product['name'] ?>: <?= $product['price'] ?></p>\n        <form action=\"add_to_cart.php\" method=\"post\">\n            <input type=\"hidden\" name=\"product_id\" value=\"<?= $product['id'] ?>\">\n            <button>Add to cart</button>\n        </form>\n    <?php endforeach; ?>\n</body>\n</html>\n```\n**add_to_cart.php**\n```php\n<?php\nsession_start();\n\n// Get product ID from form data\n$product_id = $_POST['product_id'];\n\n// Add product to user's cart\nif (isset($_SESSION['cart'])) {\n    $cart = $_SESSION['cart'];\n} else {\n    $cart = array();\n}\n$cart[] = array('product_id' => $product_id, 'quantity' => 1);\n$_SESSION['cart'] = $cart;\n\n// Redirect back to index.php\nheader('Location: index.php');\nexit;\n?>\n```\n**view_cart.php**\n```php\n<?php\nsession_start();\n\n// Get products from user's cart\nif (isset($_SESSION['cart'])) {\n    $cart = $_SESSION['cart'];\n} else {\n    $cart = array();\n}\n\n// Display products in cart\n?>\n<html>\n<head>\n    <title>Cart</title>\n</head>\n<body>\n    <h1>Cart</h1>\n    <?php foreach ($cart as $item): ?>\n        <?= $item['product_id'] ?> (<?= $item['quantity'] ?>)\n        <form action=\"remove_from_cart.php\" method=\"post\">\n            <input type=\"hidden\" name=\"product_id\" value=\"<?= $item['product_id'] ?>\">\n            <button>Remove</button>\n        </form>\n    <?php endforeach; ?>\n</body>\n</html>\n```\n**remove_from_cart.php**\n```php\n<?php\nsession_start();\n\n// Get product ID from form data\n$product_id = $_POST['product_id'];\n\n// Remove product from user's cart\nif (isset($_SESSION['cart'])) {\n    $cart = $_SESSION['cart'];\n} else {\n    $cart = array();\n}\n$cart = array_filter($cart, function ($item) use ($product_id) {\n    return $item['product_id'] !== $product_id;\n});\n$_SESSION['cart'] = $cart;\n\n// Redirect back to view_cart.php\nheader('Location: view_cart.php');\nexit;\n?>\n```\n**checkout.php**\n```php\n<?php\nsession_start();\n\n// Get products from user's cart\nif (isset($_SESSION['cart'])) {\n    $cart = $_SESSION['cart'];\n} else {\n    $cart = array();\n}\n\n// Display order form\n?>\n<html>\n<head>\n    <title>Checkout</title>\n</head>\n<body>\n    <h1>Checkout</h1>\n    <?php foreach ($cart as $item): ?>\n        <?= $item['product_id'] ?> (<?= $item['quantity'] ?>)\n    <?php endforeach; ?>\n    <form action=\"place_order.php\" method=\"post\">\n        <input type=\"hidden\" name=\"order_data\" value=\"<?= json_encode($cart) ?>\">\n        <button>Place order</button>\n    </form>\n</body>\n</html>\n```\n**place_order.php**\n```php\n<?php\nsession_start();\n\n// Get order data from form data\n$order_data = $_POST['order_data'];\n\n// Create new order in database\n$db = new PDO('mysql:host=localhost;dbname=shop', 'username', 'password');\n$stmt = $db->prepare('INSERT INTO orders (customer_name, order_date) VALUES (:customer_name, NOW())');\n$stmt->execute(array(':customer_name' => $_SESSION['customer_name']));\n$order_id = $db->lastInsertId();\n\n// Create new order items in database\nforeach ($order_data as $item) {\n    $stmt = $db->prepare('INSERT INTO order_items (order_id, product_id, quantity) VALUES (:order_id, :product_id, :quantity)');\n    $stmt->execute(array(':order_id' => $order_id, ':product_id' => $item['product_id'], ':quantity' => $item['quantity']));\n}\n\n// Clear cart\n$_SESSION['cart'] = array();\n\n// Redirect back to index.php\nheader('Location: index.php');\nexit;\n?>\n```\nThis is a basic example and you should add more functionality to it, such as user authentication, payment processing, and order status updates.", "code_blocks": ["```php\n<?php\nsession_start();\n\n// Connect to database\n$db = new PDO('mysql:host=localhost;dbname=shop', 'username', 'password');\n\n// Get all products from database\n$stmt = $db->prepare('SELECT * FROM products');\n$stmt->execute();\n$products = $stmt->fetchAll();\n\n// Display products\n?>\n<html>\n<head>\n    <title>Shop</title>\n</head>\n<body>\n    <h1>Shop</h1>\n    <?php foreach ($products as $product): ?>\n        <p><?= $product['name'] ?>: <?= $product['price'] ?></p>\n        <form action=\"add_to_cart.php\" method=\"post\">\n            <input type=\"hidden\" name=\"product_id\" value=\"<?= $product['id'] ?>\">\n            <button>Add to cart</button>\n        </form>\n    <?php endforeach; ?>\n</body>\n</html>\n```", "```php\n<?php\nsession_start();\n\n// Get product ID from form data\n$product_id = $_POST['product_id'];\n\n// Add product to user's cart\nif (isset($_SESSION['cart'])) {\n    $cart = $_SESSION['cart'];\n} else {\n    $cart = array();\n}\n$cart[] = array('product_id' => $product_id, 'quantity' => 1);\n$_SESSION['cart'] = $cart;\n\n// Redirect back to index.php\nheader('Location: index.php');\nexit;\n?>\n```", "```php\n<?php\nsession_start();\n\n// Get products from user's cart\nif (isset($_SESSION['cart'])) {\n    $cart = $_SESSION['cart'];\n} else {\n    $cart = array();\n}\n\n// Display products in cart\n?>\n<html>\n<head>\n    <title>Cart</title>\n</head>\n<body>\n    <h1>Cart</h1>\n    <?php foreach ($cart as $item): ?>\n        <?= $item['product_id'] ?> (<?= $item['quantity'] ?>)\n        <form action=\"remove_from_cart.php\" method=\"post\">\n            <input type=\"hidden\" name=\"product_id\" value=\"<?= $item['product_id'] ?>\">\n            <button>Remove</button>\n        </form>\n    <?php endforeach; ?>\n</body>\n</html>\n```", "```php\n<?php\nsession_start();\n\n// Get product ID from form data\n$product_id = $_POST['product_id'];\n\n// Remove product from user's cart\nif (isset($_SESSION['cart'])) {\n    $cart = $_SESSION['cart'];\n} else {\n    $cart = array();\n}\n$cart = array_filter($cart, function ($item) use ($product_id) {\n    return $item['product_id'] !== $product_id;\n});\n$_SESSION['cart'] = $cart;\n\n// Redirect back to view_cart.php\nheader('Location: view_cart.php');\nexit;\n?>\n```", "```php\n<?php\nsession_start();\n\n// Get products from user's cart\nif (isset($_SESSION['cart'])) {\n    $cart = $_SESSION['cart'];\n} else {\n    $cart = array();\n}\n\n// Display order form\n?>\n<html>\n<head>\n    <title>Checkout</title>\n</head>\n<body>\n    <h1>Checkout</h1>\n    <?php foreach ($cart as $item): ?>\n        <?= $item['product_id'] ?> (<?= $item['quantity'] ?>)\n    <?php endforeach; ?>\n    <form action=\"place_order.php\" method=\"post\">\n        <input type=\"hidden\" name=\"order_data\" value=\"<?= json_encode($cart) ?>\">\n        <button>Place order</button>\n    </form>\n</body>\n</html>\n```", "```php\n<?php\nsession_start();\n\n// Get order data from form data\n$order_data = $_POST['order_data'];\n\n// Create new order in database\n$db = new PDO('mysql:host=localhost;dbname=shop', 'username', 'password');\n$stmt = $db->prepare('INSERT INTO orders (customer_name, order_date) VALUES (:customer_name, NOW())');\n$stmt->execute(array(':customer_name' => $_SESSION['customer_name']));\n$order_id = $db->lastInsertId();\n\n// Create new order items in database\nforeach ($order_data as $item) {\n    $stmt = $db->prepare('INSERT INTO order_items (order_id, product_id, quantity) VALUES (:order_id, :product_id, :quantity)');\n    $stmt->execute(array(':order_id' => $order_id, ':product_id' => $item['product_id'], ':quantity' => $item['quantity']));\n}\n\n// Clear cart\n$_SESSION['cart'] = array();\n\n// Redirect back to index.php\nheader('Location: index.php');\nexit;\n?>\n```"]}
