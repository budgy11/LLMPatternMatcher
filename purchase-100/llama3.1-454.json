{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality in PHP, including HTML and CSS for the user interface. This example includes features such as adding products to a cart, viewing the cart contents, applying discounts, and making a payment.\n\n**Note:** This example is simplified and does not include advanced security measures or error handling that you should implement in a real-world application.\n\n### Database Setup\n\nFirst, we need a database schema to store our products and cart items. Let's assume a simple table structure:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE carts (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  total_price DECIMAL(10,2)\n);\n```\n\n### PHP Code\n\n**`index.php`**\n\n```php\n<?php\nrequire_once 'functions.php';\n\n// Get products from database\n$products = getProducts();\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Shopping Cart</title>\n    <link rel=\"stylesheet\" href=\"style.css\">\n</head>\n\n<body>\n    <h1>Shopping Cart</h1>\n\n    <!-- Display products -->\n    <?php foreach ($products as $product) { ?>\n        <div class=\"product\">\n            <h2><?= $product['name'] ?></h2>\n            <p>$<?= $product['price'] ?></p>\n            <button onclick=\"addToCart(<?= $product['id'] ?>)\">Add to Cart</button>\n        </div>\n    <?php } ?>\n\n    <!-- Display cart contents -->\n    <div id=\"cart\">\n        <h2>Cart Contents:</h2>\n\n        <?php\n        // Check if cart is not empty\n        if (!empty($_SESSION['cart'])) {\n            foreach ($_SESSION['cart'] as $product_id => $quantity) {\n                $product = getProduct($product_id);\n                ?>\n                <div class=\"cart-item\">\n                    <p><?= $product['name'] ?></p>\n                    <p>x<?= $quantity ?></p>\n                    <p>$<?= getPrice($product_id, $quantity) ?></p>\n                </div>\n            <?php\n            }\n        } else {\n            echo \"<p>Cart is empty.</p>\";\n        }\n        ?>\n\n        <!-- Apply discount -->\n        <label for=\"discount\">Discount (%):</label>\n        <input type=\"number\" id=\"discount\" value=\"10\">\n        <button onclick=\"applyDiscount()\">Apply Discount</button>\n\n        <!-- Checkout button -->\n        <button onclick=\"checkout()\">Checkout</button>\n    </div>\n\n    <script src=\"script.js\"></script>\n</body>\n</html>\n```\n\n**`functions.php`**\n\n```php\n<?php\n\n// Database connection (replace with your own database)\n$db = new PDO('mysql:host=localhost;dbname=shopping_cart', 'username', 'password');\n\nfunction getProducts() {\n    global $db;\n    $stmt = $db->prepare(\"SELECT * FROM products\");\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction getProduct($id) {\n    global $db;\n    $stmt = $db->prepare(\"SELECT * FROM products WHERE id = ?\");\n    $stmt->execute([$id]);\n    return $stmt->fetch(PDO::FETCH_ASSOC);\n}\n\nfunction getPrice($product_id, $quantity) {\n    // Retrieve product price and multiply by quantity\n    $price = getProduct($product_id)['price'];\n    return number_format($price * $quantity, 2);\n}\n?>\n```\n\n**`script.js`**\n\n```javascript\n// Add to cart functionality\nfunction addToCart(productId) {\n    if (!isset($_SESSION['cart'])) {\n        $_SESSION['cart'] = array();\n    }\n\n    // Check if product is already in cart\n    if (isset($_SESSION['cart'][$productId])) {\n        $_SESSION['cart'][$productId]++;\n    } else {\n        $_SESSION['cart'][$productId] = 1;\n    }\n}\n\n// Apply discount functionality\nfunction applyDiscount() {\n    const discountPercentage = document.getElementById('discount').value;\n\n    // Calculate total price with discount applied\n    let totalPrice = 0;\n    for (const productId in $_SESSION['cart']) {\n        totalPrice += getPrice(productId, $_SESSION['cart'][productId]);\n    }\n    totalPrice *= (1 - discountPercentage / 100);\n\n    alert(`Total Price: $${totalPrice}`);\n}\n\n// Checkout functionality\nfunction checkout() {\n    // Simulate payment processing here...\n    alert(\"Payment processed successfully!\");\n}\n```\n\n**`style.css`**\n\n```css\nbody {\n    font-family: Arial, sans-serif;\n}\n\n.product {\n    margin-bottom: 10px;\n}\n\n.cart-item {\n    border-bottom: 1px solid #ccc;\n    padding-bottom: 5px;\n}\n\n#cart {\n    margin-top: 20px;\n}\n```\n\nThis example demonstrates a basic purchase functionality in PHP. However, please note that this is a simplified version and does not include advanced security measures or error handling that you should implement in a real-world application.\n\nYou can expand upon this example by adding features such as user authentication, product variations (e.g., colors, sizes), payment gateways, order tracking, and more.", "code_blocks": [null, "```php\n<?php\nrequire_once 'functions.php';\n\n// Get products from database\n$products = getProducts();\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Shopping Cart</title>\n    <link rel=\"stylesheet\" href=\"style.css\">\n</head>\n\n<body>\n    <h1>Shopping Cart</h1>\n\n    <!-- Display products -->\n    <?php foreach ($products as $product) { ?>\n        <div class=\"product\">\n            <h2><?= $product['name'] ?></h2>\n            <p>$<?= $product['price'] ?></p>\n            <button onclick=\"addToCart(<?= $product['id'] ?>)\">Add to Cart</button>\n        </div>\n    <?php } ?>\n\n    <!-- Display cart contents -->\n    <div id=\"cart\">\n        <h2>Cart Contents:</h2>\n\n        <?php\n        // Check if cart is not empty\n        if (!empty($_SESSION['cart'])) {\n            foreach ($_SESSION['cart'] as $product_id => $quantity) {\n                $product = getProduct($product_id);\n                ?>\n                <div class=\"cart-item\">\n                    <p><?= $product['name'] ?></p>\n                    <p>x<?= $quantity ?></p>\n                    <p>$<?= getPrice($product_id, $quantity) ?></p>\n                </div>\n            <?php\n            }\n        } else {\n            echo \"<p>Cart is empty.</p>\";\n        }\n        ?>\n\n        <!-- Apply discount -->\n        <label for=\"discount\">Discount (%):</label>\n        <input type=\"number\" id=\"discount\" value=\"10\">\n        <button onclick=\"applyDiscount()\">Apply Discount</button>\n\n        <!-- Checkout button -->\n        <button onclick=\"checkout()\">Checkout</button>\n    </div>\n\n    <script src=\"script.js\"></script>\n</body>\n</html>\n```", "```php\n<?php\n\n// Database connection (replace with your own database)\n$db = new PDO('mysql:host=localhost;dbname=shopping_cart', 'username', 'password');\n\nfunction getProducts() {\n    global $db;\n    $stmt = $db->prepare(\"SELECT * FROM products\");\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction getProduct($id) {\n    global $db;\n    $stmt = $db->prepare(\"SELECT * FROM products WHERE id = ?\");\n    $stmt->execute([$id]);\n    return $stmt->fetch(PDO::FETCH_ASSOC);\n}\n\nfunction getPrice($product_id, $quantity) {\n    // Retrieve product price and multiply by quantity\n    $price = getProduct($product_id)['price'];\n    return number_format($price * $quantity, 2);\n}\n?>\n```", null, null]}
