{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP:\n\n**database.sql**\n```sql\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  customer_email VARCHAR(255),\n  order_date DATE,\n  total DECIMAL(10,2)\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  order_id INT,\n  product_name VARCHAR(255),\n  quantity INT,\n  price DECIMAL(10,2),\n  FOREIGN KEY (order_id) REFERENCES orders(id)\n);\n```\n**config.php**\n```php\n<?php\n\n// Database connection settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'root');\ndefine('DB_PASSWORD', '');\ndefine('DB_NAME', 'store');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n?>\n```\n**products.php**\n```php\n<?php\n\nrequire_once 'config.php';\n\n// Get all products from database\n$query = \"SELECT * FROM products\";\n$result = $conn->query($query);\n\n$products = array();\n\nwhile ($row = $result->fetch_assoc()) {\n    $products[] = array(\n        'id' => $row['id'],\n        'name' => $row['name'],\n        'price' => $row['price']\n    );\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Products</title>\n</head>\n<body>\n\n<h1>Products</h1>\n\n<ul>\n    <?php foreach ($products as $product) { ?>\n        <li><?php echo $product['name']; ?> - <?php echo '$' . number_format($product['price'], 2); ?></li>\n    <?php } ?>\n</ul>\n\n<form action=\"cart.php\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['id']; ?>\">\n    <button type=\"submit\">Add to Cart</button>\n</form>\n\n<?php\n// Add product to cart if submit button is pressed\nif (isset($_POST['product_id'])) {\n    // Get customer data from session\n    $customer_name = $_SESSION['customer_name'];\n    $customer_email = $_SESSION['customer_email'];\n\n    // Insert order into database\n    $query = \"INSERT INTO orders (customer_name, customer_email, order_date, total) VALUES (?, ?, NOW(), ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"sss\", $customer_name, $customer_email, '0.00');\n    $stmt->execute();\n\n    // Get order ID\n    $order_id = $conn->insert_id;\n\n    // Insert order item into database\n    $query = \"INSERT INTO order_items (order_id, product_name, quantity, price) VALUES (?, ?, 1, ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"iss\", $order_id, $_POST['product_id'], '0.00');\n    $stmt->execute();\n}\n?>\n</body>\n</html>\n```\n**cart.php**\n```php\n<?php\n\nrequire_once 'config.php';\n\n// Get customer data from session\n$customer_name = $_SESSION['customer_name'];\n$customer_email = $_SESSION['customer_email'];\n\n// Get order ID from session\n$order_id = $_SESSION['order_id'];\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Cart</title>\n</head>\n<body>\n\n<h1>Cart</h1>\n\n<ul>\n    <?php\n    // Get order items from database\n    $query = \"SELECT * FROM order_items WHERE order_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $order_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    while ($row = $result->fetch_assoc()) {\n        echo '<li>' . $row['product_name'] . ' - x' . $row['quantity'] . '</li>';\n    }\n    ?>\n</ul>\n\n<p>Total: <?php echo number_format($_SESSION['total'], 2); ?></p>\n\n<form action=\"checkout.php\" method=\"post\">\n    <button type=\"submit\">Checkout</button>\n</form>\n\n<?php\n// Update total in session if order item is added or removed\nif (isset($_POST['action']) && $_POST['action'] == 'add') {\n    // Get product ID from post data\n    $product_id = $_POST['product_id'];\n\n    // Insert new order item into database\n    $query = \"INSERT INTO order_items (order_id, product_name, quantity, price) VALUES (?, ?, 1, ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"iss\", $order_id, $product_id, '0.00');\n    $stmt->execute();\n\n    // Update total in session\n    $_SESSION['total'] += '0.00';\n} elseif (isset($_POST['action']) && $_POST['action'] == 'remove') {\n    // Get order item ID from post data\n    $order_item_id = $_POST['order_item_id'];\n\n    // Delete order item from database\n    $query = \"DELETE FROM order_items WHERE id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $order_item_id);\n    $stmt->execute();\n\n    // Update total in session\n    $_SESSION['total'] -= '0.00';\n}\n?>\n</body>\n</html>\n```\n**checkout.php**\n```php\n<?php\n\nrequire_once 'config.php';\n\n// Get customer data from session\n$customer_name = $_SESSION['customer_name'];\n$customer_email = $_SESSION['customer_email'];\n\n// Get order ID from session\n$order_id = $_SESSION['order_id'];\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Checkout</title>\n</head>\n<body>\n\n<h1>Checkout</h1>\n\n<ul>\n    <?php\n    // Get order items from database\n    $query = \"SELECT * FROM order_items WHERE order_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $order_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    while ($row = $result->fetch_assoc()) {\n        echo '<li>' . $row['product_name'] . ' - x' . $row['quantity'] . '</li>';\n    }\n    ?>\n</ul>\n\n<p>Total: <?php echo number_format($_SESSION['total'], 2); ?></p>\n\n<form action=\"payment.php\" method=\"post\">\n    <button type=\"submit\">Pay with PayPal</button>\n</form>\n\n<?php\n// Process payment using PayPal API (not included in this example)\n?>\n```\n**Note:** This is a very basic example and does not include any error handling, security measures or advanced features like payment processing. You should always use prepared statements to prevent SQL injection attacks.\n\nAlso, you will need to replace the `DB_HOST`, `DB_USERNAME`, `DB_PASSWORD` and `DB_NAME` constants in the `config.php` file with your actual database credentials.\n\nPlease keep in mind that this is a simplified example and you should never store sensitive information like credit card numbers or passwords in plain text. Always use secure methods to handle payment processing and user authentication.", "code_blocks": [null, "```php\n<?php\n\n// Database connection settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'root');\ndefine('DB_PASSWORD', '');\ndefine('DB_NAME', 'store');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n?>\n```", "```php\n<?php\n\nrequire_once 'config.php';\n\n// Get all products from database\n$query = \"SELECT * FROM products\";\n$result = $conn->query($query);\n\n$products = array();\n\nwhile ($row = $result->fetch_assoc()) {\n    $products[] = array(\n        'id' => $row['id'],\n        'name' => $row['name'],\n        'price' => $row['price']\n    );\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Products</title>\n</head>\n<body>\n\n<h1>Products</h1>\n\n<ul>\n    <?php foreach ($products as $product) { ?>\n        <li><?php echo $product['name']; ?> - <?php echo '$' . number_format($product['price'], 2); ?></li>\n    <?php } ?>\n</ul>\n\n<form action=\"cart.php\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['id']; ?>\">\n    <button type=\"submit\">Add to Cart</button>\n</form>\n\n<?php\n// Add product to cart if submit button is pressed\nif (isset($_POST['product_id'])) {\n    // Get customer data from session\n    $customer_name = $_SESSION['customer_name'];\n    $customer_email = $_SESSION['customer_email'];\n\n    // Insert order into database\n    $query = \"INSERT INTO orders (customer_name, customer_email, order_date, total) VALUES (?, ?, NOW(), ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"sss\", $customer_name, $customer_email, '0.00');\n    $stmt->execute();\n\n    // Get order ID\n    $order_id = $conn->insert_id;\n\n    // Insert order item into database\n    $query = \"INSERT INTO order_items (order_id, product_name, quantity, price) VALUES (?, ?, 1, ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"iss\", $order_id, $_POST['product_id'], '0.00');\n    $stmt->execute();\n}\n?>\n</body>\n</html>\n```", "```php\n<?php\n\nrequire_once 'config.php';\n\n// Get customer data from session\n$customer_name = $_SESSION['customer_name'];\n$customer_email = $_SESSION['customer_email'];\n\n// Get order ID from session\n$order_id = $_SESSION['order_id'];\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Cart</title>\n</head>\n<body>\n\n<h1>Cart</h1>\n\n<ul>\n    <?php\n    // Get order items from database\n    $query = \"SELECT * FROM order_items WHERE order_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $order_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    while ($row = $result->fetch_assoc()) {\n        echo '<li>' . $row['product_name'] . ' - x' . $row['quantity'] . '</li>';\n    }\n    ?>\n</ul>\n\n<p>Total: <?php echo number_format($_SESSION['total'], 2); ?></p>\n\n<form action=\"checkout.php\" method=\"post\">\n    <button type=\"submit\">Checkout</button>\n</form>\n\n<?php\n// Update total in session if order item is added or removed\nif (isset($_POST['action']) && $_POST['action'] == 'add') {\n    // Get product ID from post data\n    $product_id = $_POST['product_id'];\n\n    // Insert new order item into database\n    $query = \"INSERT INTO order_items (order_id, product_name, quantity, price) VALUES (?, ?, 1, ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"iss\", $order_id, $product_id, '0.00');\n    $stmt->execute();\n\n    // Update total in session\n    $_SESSION['total'] += '0.00';\n} elseif (isset($_POST['action']) && $_POST['action'] == 'remove') {\n    // Get order item ID from post data\n    $order_item_id = $_POST['order_item_id'];\n\n    // Delete order item from database\n    $query = \"DELETE FROM order_items WHERE id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $order_item_id);\n    $stmt->execute();\n\n    // Update total in session\n    $_SESSION['total'] -= '0.00';\n}\n?>\n</body>\n</html>\n```", "```php\n<?php\n\nrequire_once 'config.php';\n\n// Get customer data from session\n$customer_name = $_SESSION['customer_name'];\n$customer_email = $_SESSION['customer_email'];\n\n// Get order ID from session\n$order_id = $_SESSION['order_id'];\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Checkout</title>\n</head>\n<body>\n\n<h1>Checkout</h1>\n\n<ul>\n    <?php\n    // Get order items from database\n    $query = \"SELECT * FROM order_items WHERE order_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $order_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    while ($row = $result->fetch_assoc()) {\n        echo '<li>' . $row['product_name'] . ' - x' . $row['quantity'] . '</li>';\n    }\n    ?>\n</ul>\n\n<p>Total: <?php echo number_format($_SESSION['total'], 2); ?></p>\n\n<form action=\"payment.php\" method=\"post\">\n    <button type=\"submit\">Pay with PayPal</button>\n</form>\n\n<?php\n// Process payment using PayPal API (not included in this example)\n?>\n```"]}
