{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP. This example assumes you have a MySQL database set up with the necessary tables to store products and orders.\n\n**Database Schema:**\n\nWe'll need two tables for this example:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  order_date DATE\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  order_id INT,\n  product_id INT,\n  quantity INT,\n  FOREIGN KEY (order_id) REFERENCES orders(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code:**\n\nWe'll create a `purchase.php` file with the following code:\n\n```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction add_product_to_order($order_id, $product_id, $quantity) {\n    global $conn;\n    $stmt = $conn->prepare(\"INSERT INTO order_items (order_id, product_id, quantity) VALUES (?, ?, ?)\");\n    $stmt->bind_param(\"iis\", $order_id, $product_id, $quantity);\n    $stmt->execute();\n}\n\nfunction get_product_info($product_id) {\n    global $conn;\n    $stmt = $conn->prepare(\"SELECT name, price FROM products WHERE id = ?\");\n    $stmt->bind_param(\"i\", $product_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n    return $result->fetch_assoc();\n}\n\nfunction place_order() {\n    global $conn;\n    $customer_name = $_POST['customer_name'];\n    $order_date = date('Y-m-d');\n    $stmt = $conn->prepare(\"INSERT INTO orders (customer_name, order_date) VALUES (?, ?)\");\n    $stmt->bind_param(\"ss\", $customer_name, $order_date);\n    $stmt->execute();\n    \n    // Get the ID of the newly created order\n    $new_order_id = $conn->insert_id;\n    \n    foreach ($_POST['products'] as $product_id => $quantity) {\n        add_product_to_order($new_order_id, $product_id, $quantity);\n    }\n}\n\nif (isset($_POST['place_order'])) {\n    place_order();\n} else {\n?>\n<html>\n<head>\n    <title>Product Purchase</title>\n</head>\n<body>\n<form method=\"post\">\n    Customer Name: <input type=\"text\" name=\"customer_name\"><br><br>\n    <h2>Products:</h2>\n    <?php\n    $stmt = $conn->prepare(\"SELECT id, name, price FROM products\");\n    $stmt->execute();\n    $result = $stmt->get_result();\n    \n    while ($product = $result->fetch_assoc()) {\n        echo \"<input type='checkbox' name='products[$product[id]]'> $product[name] - \\$\" . number_format($product['price'], 2) . \" <br>\";\n    }\n?>\n<br>\n<input type=\"submit\" value=\"Place Order\" name=\"place_order\">\n</form>\n\n<?php\n}\n?>\n\n</body>\n</html>\n```\n\n**How it works:**\n\n1. The user submits a form with their customer name and the products they want to purchase.\n2. When the \"Place Order\" button is clicked, the `place_order()` function is called, which inserts a new order into the database with the customer's name and current date.\n3. For each product selected by the user, the `add_product_to_order()` function is called, which adds an entry to the `order_items` table with the corresponding order ID, product ID, and quantity.\n4. The `get_product_info()` function is used to retrieve the price of each product from the database.\n\nNote that this is a basic example and you may want to add additional functionality such as user authentication, payment processing, or email notifications for completed orders.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction add_product_to_order($order_id, $product_id, $quantity) {\n    global $conn;\n    $stmt = $conn->prepare(\"INSERT INTO order_items (order_id, product_id, quantity) VALUES (?, ?, ?)\");\n    $stmt->bind_param(\"iis\", $order_id, $product_id, $quantity);\n    $stmt->execute();\n}\n\nfunction get_product_info($product_id) {\n    global $conn;\n    $stmt = $conn->prepare(\"SELECT name, price FROM products WHERE id = ?\");\n    $stmt->bind_param(\"i\", $product_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n    return $result->fetch_assoc();\n}\n\nfunction place_order() {\n    global $conn;\n    $customer_name = $_POST['customer_name'];\n    $order_date = date('Y-m-d');\n    $stmt = $conn->prepare(\"INSERT INTO orders (customer_name, order_date) VALUES (?, ?)\");\n    $stmt->bind_param(\"ss\", $customer_name, $order_date);\n    $stmt->execute();\n    \n    // Get the ID of the newly created order\n    $new_order_id = $conn->insert_id;\n    \n    foreach ($_POST['products'] as $product_id => $quantity) {\n        add_product_to_order($new_order_id, $product_id, $quantity);\n    }\n}\n\nif (isset($_POST['place_order'])) {\n    place_order();\n} else {\n?>\n<html>\n<head>\n    <title>Product Purchase</title>\n</head>\n<body>\n<form method=\"post\">\n    Customer Name: <input type=\"text\" name=\"customer_name\"><br><br>\n    <h2>Products:</h2>\n    <?php\n    $stmt = $conn->prepare(\"SELECT id, name, price FROM products\");\n    $stmt->execute();\n    $result = $stmt->get_result();\n    \n    while ($product = $result->fetch_assoc()) {\n        echo \"<input type='checkbox' name='products[$product[id]]'> $product[name] - \\$\" . number_format($product['price'], 2) . \" <br>\";\n    }\n?>\n<br>\n<input type=\"submit\" value=\"Place Order\" name=\"place_order\">\n</form>\n\n<?php\n}\n?>\n\n</body>\n</html>\n```"]}
