{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality in PHP:\n\n**purchase.php**\n```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to display products\nfunction display_products() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        echo \"<table>\";\n        while ($row = $result->fetch_assoc()) {\n            echo \"<tr>\";\n            echo \"<td>\" . $row['product_name'] . \"</td>\";\n            echo \"<td>\" . $row['price'] . \"</td>\";\n            echo \"<td><a href='buy.php?product_id=\" . $row['id'] . \"'>Buy</a></td>\";\n            echo \"</tr>\";\n        }\n        echo \"</table>\";\n    } else {\n        echo \"No products found\";\n    }\n}\n\n// Function to process purchase\nfunction process_purchase($product_id) {\n    global $conn;\n    $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        $row = $result->fetch_assoc();\n        $customer_name = $_POST['name'];\n        $customer_email = $_POST['email'];\n        $customer_address = $_POST['address'];\n\n        // Insert into orders table\n        $query = \"INSERT INTO orders (product_id, customer_name, customer_email, customer_address) VALUES ('$product_id', '$customer_name', '$customer_email', '$customer_address')\";\n        $conn->query($query);\n\n        // Update stock\n        $query = \"UPDATE products SET quantity = quantity - 1 WHERE id = '$product_id'\";\n        $conn->query($query);\n\n        echo \"Order successful!\";\n    } else {\n        echo \"Product not found\";\n    }\n}\n\n// Display products\ndisplay_products();\n\n?>\n```\n\n**buy.php**\n```php\n<?php\n\nrequire 'purchase.php';\n\nif (isset($_GET['product_id'])) {\n    $product_id = $_GET['product_id'];\n    process_purchase($product_id);\n} else {\n    echo \"Invalid product ID\";\n}\n\n?>\n```\nThis code assumes you have a `products` table with columns `id`, `product_name`, `price`, and `quantity`. It also assumes you have an `orders` table with columns `product_id`, `customer_name`, `customer_email`, and `customer_address`.\n\n**Usage:**\n\n1. Create a new product by inserting into the `products` table.\n2. Go to `buy.php?product_id=[insert_product_id_here]`.\n3. Fill out the form with your customer information.\n4. Click \"Buy\" to process the purchase.\n\nNote that this is a basic example and does not include any error checking or validation. You should add this in a production environment. Additionally, you may want to consider using a more secure way of storing and transmitting sensitive data, such as encrypting passwords and credit card numbers.", "code_blocks": ["```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to display products\nfunction display_products() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        echo \"<table>\";\n        while ($row = $result->fetch_assoc()) {\n            echo \"<tr>\";\n            echo \"<td>\" . $row['product_name'] . \"</td>\";\n            echo \"<td>\" . $row['price'] . \"</td>\";\n            echo \"<td><a href='buy.php?product_id=\" . $row['id'] . \"'>Buy</a></td>\";\n            echo \"</tr>\";\n        }\n        echo \"</table>\";\n    } else {\n        echo \"No products found\";\n    }\n}\n\n// Function to process purchase\nfunction process_purchase($product_id) {\n    global $conn;\n    $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        $row = $result->fetch_assoc();\n        $customer_name = $_POST['name'];\n        $customer_email = $_POST['email'];\n        $customer_address = $_POST['address'];\n\n        // Insert into orders table\n        $query = \"INSERT INTO orders (product_id, customer_name, customer_email, customer_address) VALUES ('$product_id', '$customer_name', '$customer_email', '$customer_address')\";\n        $conn->query($query);\n\n        // Update stock\n        $query = \"UPDATE products SET quantity = quantity - 1 WHERE id = '$product_id'\";\n        $conn->query($query);\n\n        echo \"Order successful!\";\n    } else {\n        echo \"Product not found\";\n    }\n}\n\n// Display products\ndisplay_products();\n\n?>\n```", "```php\n<?php\n\nrequire 'purchase.php';\n\nif (isset($_GET['product_id'])) {\n    $product_id = $_GET['product_id'];\n    process_purchase($product_id);\n} else {\n    echo \"Invalid product ID\";\n}\n\n?>\n```"]}
