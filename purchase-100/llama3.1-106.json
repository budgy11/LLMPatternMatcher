{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality in PHP:\n\n**cart.php**\n```php\n<?php\n// Check if the cart is empty\nif (empty($_SESSION['cart'])) {\n    echo \"Your cart is empty.\";\n} else {\n    // Display cart contents\n    echo \"<h2>Your Cart</h2>\";\n    $total = 0;\n    foreach ($_SESSION['cart'] as $item) {\n        $product_name = $item['name'];\n        $quantity = $item['quantity'];\n        $price = $item['price'];\n        echo \"$product_name x $quantity = \\$$price<br>\";\n        $total += ($price * $quantity);\n    }\n    echo \"Total: \\$$total\";\n}\n?>\n```\n**add_to_cart.php**\n```php\n<?php\n// Get the product ID and quantity from the form data\n$product_id = $_POST['product_id'];\n$quantity = $_POST['quantity'];\n\n// Check if the product exists in the database\n$result = mysql_query(\"SELECT * FROM products WHERE id='$product_id'\");\nif (mysql_num_rows($result) > 0) {\n    // Get the product details from the database\n    $row = mysql_fetch_array($result);\n    $product_name = $row['name'];\n    $price = $row['price'];\n\n    // Check if the quantity is valid\n    if ($quantity <= 0) {\n        echo \"Invalid quantity.\";\n    } else {\n        // Add the product to the cart\n        $_SESSION['cart'][] = array('name' => $product_name, 'quantity' => $quantity, 'price' => $price);\n\n        // Redirect back to the cart page\n        header(\"Location: cart.php\");\n        exit;\n    }\n} else {\n    echo \"Product not found.\";\n}\n?>\n```\n**remove_from_cart.php**\n```php\n<?php\n// Get the product ID from the form data\n$product_id = $_POST['product_id'];\n\n// Check if the product exists in the cart\nforeach ($_SESSION['cart'] as $key => $item) {\n    if ($item['id'] == $product_id) {\n        // Remove the product from the cart\n        unset($_SESSION['cart'][$key]);\n        break;\n    }\n}\n\n// Redirect back to the cart page\nheader(\"Location: cart.php\");\nexit;\n?>\n```\n**checkout.php**\n```php\n<?php\n// Get the customer details from the form data\n$customer_name = $_POST['customer_name'];\n$customer_email = $_POST['customer_email'];\n\n// Check if the customer details are valid\nif (!empty($customer_name) && !empty($customer_email)) {\n    // Process the payment (e.g. using PayPal)\n    $payment_status = \"paid\";\n\n    // Update the order status in the database\n    mysql_query(\"INSERT INTO orders (customer_name, customer_email, total_amount, status) VALUES ('$customer_name', '$customer_email', '$total', '$payment_status')\");\n\n    // Clear the cart and redirect to a success page\n    unset($_SESSION['cart']);\n    header(\"Location: success.php\");\n} else {\n    echo \"Invalid customer details.\";\n}\n?>\n```\nThis code assumes you have the following database tables:\n\n* `products`: stores product information (id, name, price)\n* `orders`: stores order information (id, customer_name, customer_email, total_amount, status)\n\nNote that this is a simplified example and you should consider adding security measures such as authentication and authorization to protect your code. Additionally, this example assumes a simple payment processing system where the payment status is set to \"paid\" after the payment is processed. In a real-world scenario, you would need to integrate with a payment gateway such as PayPal or Stripe.\n\nTo use this code, simply include it in your PHP file and follow these steps:\n\n1. Create a cart page (`cart.php`) that displays the contents of the cart.\n2. Add a button to each product page (e.g. `product_details.php`) that adds the product to the cart when clicked.\n3. Use the `add_to_cart.php` script to add products to the cart.\n4. Use the `remove_from_cart.php` script to remove products from the cart.\n5. Create a checkout page (`checkout.php`) that processes the payment and updates the order status in the database.\n\nRemember to modify the code to fit your specific requirements and to test it thoroughly before deploying it in production.", "code_blocks": ["```php\n<?php\n// Check if the cart is empty\nif (empty($_SESSION['cart'])) {\n    echo \"Your cart is empty.\";\n} else {\n    // Display cart contents\n    echo \"<h2>Your Cart</h2>\";\n    $total = 0;\n    foreach ($_SESSION['cart'] as $item) {\n        $product_name = $item['name'];\n        $quantity = $item['quantity'];\n        $price = $item['price'];\n        echo \"$product_name x $quantity = \\$$price<br>\";\n        $total += ($price * $quantity);\n    }\n    echo \"Total: \\$$total\";\n}\n?>\n```", "```php\n<?php\n// Get the product ID and quantity from the form data\n$product_id = $_POST['product_id'];\n$quantity = $_POST['quantity'];\n\n// Check if the product exists in the database\n$result = mysql_query(\"SELECT * FROM products WHERE id='$product_id'\");\nif (mysql_num_rows($result) > 0) {\n    // Get the product details from the database\n    $row = mysql_fetch_array($result);\n    $product_name = $row['name'];\n    $price = $row['price'];\n\n    // Check if the quantity is valid\n    if ($quantity <= 0) {\n        echo \"Invalid quantity.\";\n    } else {\n        // Add the product to the cart\n        $_SESSION['cart'][] = array('name' => $product_name, 'quantity' => $quantity, 'price' => $price);\n\n        // Redirect back to the cart page\n        header(\"Location: cart.php\");\n        exit;\n    }\n} else {\n    echo \"Product not found.\";\n}\n?>\n```", "```php\n<?php\n// Get the product ID from the form data\n$product_id = $_POST['product_id'];\n\n// Check if the product exists in the cart\nforeach ($_SESSION['cart'] as $key => $item) {\n    if ($item['id'] == $product_id) {\n        // Remove the product from the cart\n        unset($_SESSION['cart'][$key]);\n        break;\n    }\n}\n\n// Redirect back to the cart page\nheader(\"Location: cart.php\");\nexit;\n?>\n```", "```php\n<?php\n// Get the customer details from the form data\n$customer_name = $_POST['customer_name'];\n$customer_email = $_POST['customer_email'];\n\n// Check if the customer details are valid\nif (!empty($customer_name) && !empty($customer_email)) {\n    // Process the payment (e.g. using PayPal)\n    $payment_status = \"paid\";\n\n    // Update the order status in the database\n    mysql_query(\"INSERT INTO orders (customer_name, customer_email, total_amount, status) VALUES ('$customer_name', '$customer_email', '$total', '$payment_status')\");\n\n    // Clear the cart and redirect to a success page\n    unset($_SESSION['cart']);\n    header(\"Location: success.php\");\n} else {\n    echo \"Invalid customer details.\";\n}\n?>\n```"]}
