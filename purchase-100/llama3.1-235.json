{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP, HTML, and MySQL. This will include a form to add items to the cart, calculate total cost, and process the payment.\n\n**Database Schema**\n\nFirst, let's create a simple database schema for storing products and orders:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE carts (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  product_id INT,\n  quantity INT\n);\n```\n\n**PHP Code**\n\nNow, let's create the PHP code for handling the purchase functionality.\n\n```php\n// config.php (database configuration file)\n<?php\n$host = 'localhost';\n$dbname = 'your_database_name';\n$username = 'your_username';\n$password = 'your_password';\n\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n?>\n```\n\n```php\n// cart.php (cart management functionality)\n<?php\nrequire_once 'config.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'GET') {\n  // Display products in the cart\n  if (isset($_SESSION['user_id'])) {\n    $stmt = $conn->prepare('SELECT * FROM carts WHERE user_id = :user_id');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->execute();\n    $cart_items = $stmt->fetchAll();\n\n    // Calculate total cost\n    $total_cost = 0;\n    foreach ($cart_items as $item) {\n      $total_cost += $item['price'] * $item['quantity'];\n    }\n  } else {\n    $total_cost = 0; // User is not logged in, so cart is empty\n  }\n\n  include 'cart_display.php'; // Include template to display cart contents\n}\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Add item to the cart\n  if (isset($_SESSION['user_id'])) {\n    $stmt = $conn->prepare('INSERT INTO carts SET user_id = :user_id, product_id = :product_id, quantity = :quantity');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->bindParam(':product_id', $_POST['product_id']);\n    $stmt->bindParam(':quantity', $_POST['quantity']);\n    $stmt->execute();\n  }\n}\n?>\n```\n\n```php\n// checkout.php (checkout functionality)\n<?php\nrequire_once 'config.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'GET') {\n  // Display order summary and payment options\n  if (isset($_SESSION['user_id'])) {\n    $stmt = $conn->prepare('SELECT * FROM carts WHERE user_id = :user_id');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->execute();\n    $cart_items = $stmt->fetchAll();\n\n    // Calculate total cost\n    $total_cost = 0;\n    foreach ($cart_items as $item) {\n      $total_cost += $item['price'] * $item['quantity'];\n    }\n  } else {\n    $total_cost = 0; // User is not logged in, so cart is empty\n  }\n\n  include 'checkout_display.php'; // Include template to display order summary and payment options\n}\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Process payment (e.g., PayPal)\n  if (isset($_SESSION['user_id'])) {\n    // Update database with order details\n    $stmt = $conn->prepare('INSERT INTO orders SET user_id = :user_id, total_cost = :total_cost');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->bindParam(':total_cost', $_POST['total_cost']);\n    $stmt->execute();\n\n    // Clear cart\n    $stmt = $conn->prepare('DELETE FROM carts WHERE user_id = :user_id');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->execute();\n  }\n}\n?>\n```\n\n**HTML Templates**\n\nCreate the following HTML templates to display the cart contents and checkout summary:\n\n```html\n<!-- cart_display.php -->\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Cart Contents</title>\n</head>\n<body>\n  <h1>Cart Contents:</h1>\n  <?php foreach ($cart_items as $item): ?>\n    <p><?= $item['name'] ?> (x<?= $item['quantity'] ?>) = <?= number_format($item['price'] * $item['quantity'], 2) ?></p>\n  <?php endforeach; ?>\n  <p>Total: <?= number_format($total_cost, 2) ?></p>\n</body>\n</html>\n```\n\n```html\n<!-- checkout_display.php -->\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Checkout Summary</title>\n</head>\n<body>\n  <h1>Order Summary:</h1>\n  <?php foreach ($cart_items as $item): ?>\n    <p><?= $item['name'] ?> (x<?= $item['quantity'] ?>) = <?= number_format($item['price'] * $item['quantity'], 2) ?></p>\n  <?php endforeach; ?>\n  <p>Total: <?= number_format($total_cost, 2) ?></p>\n</body>\n</html>\n```\n\n**Notes**\n\n* This is a basic example to illustrate the purchase functionality.\n* You should implement proper security measures, such as validating user input and using prepared statements to prevent SQL injection attacks.\n* You may want to add additional features, such as handling failed payments, displaying order history, etc.\n\nRemember that this is just a starting point, and you'll need to adapt it to your specific use case and requirements.", "code_blocks": [null, "```php\n// config.php (database configuration file)\n<?php\n$host = 'localhost';\n$dbname = 'your_database_name';\n$username = 'your_username';\n$password = 'your_password';\n\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n?>\n```", "```php\n// cart.php (cart management functionality)\n<?php\nrequire_once 'config.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'GET') {\n  // Display products in the cart\n  if (isset($_SESSION['user_id'])) {\n    $stmt = $conn->prepare('SELECT * FROM carts WHERE user_id = :user_id');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->execute();\n    $cart_items = $stmt->fetchAll();\n\n    // Calculate total cost\n    $total_cost = 0;\n    foreach ($cart_items as $item) {\n      $total_cost += $item['price'] * $item['quantity'];\n    }\n  } else {\n    $total_cost = 0; // User is not logged in, so cart is empty\n  }\n\n  include 'cart_display.php'; // Include template to display cart contents\n}\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Add item to the cart\n  if (isset($_SESSION['user_id'])) {\n    $stmt = $conn->prepare('INSERT INTO carts SET user_id = :user_id, product_id = :product_id, quantity = :quantity');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->bindParam(':product_id', $_POST['product_id']);\n    $stmt->bindParam(':quantity', $_POST['quantity']);\n    $stmt->execute();\n  }\n}\n?>\n```", "```php\n// checkout.php (checkout functionality)\n<?php\nrequire_once 'config.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'GET') {\n  // Display order summary and payment options\n  if (isset($_SESSION['user_id'])) {\n    $stmt = $conn->prepare('SELECT * FROM carts WHERE user_id = :user_id');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->execute();\n    $cart_items = $stmt->fetchAll();\n\n    // Calculate total cost\n    $total_cost = 0;\n    foreach ($cart_items as $item) {\n      $total_cost += $item['price'] * $item['quantity'];\n    }\n  } else {\n    $total_cost = 0; // User is not logged in, so cart is empty\n  }\n\n  include 'checkout_display.php'; // Include template to display order summary and payment options\n}\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Process payment (e.g., PayPal)\n  if (isset($_SESSION['user_id'])) {\n    // Update database with order details\n    $stmt = $conn->prepare('INSERT INTO orders SET user_id = :user_id, total_cost = :total_cost');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->bindParam(':total_cost', $_POST['total_cost']);\n    $stmt->execute();\n\n    // Clear cart\n    $stmt = $conn->prepare('DELETE FROM carts WHERE user_id = :user_id');\n    $stmt->bindParam(':user_id', $_SESSION['user_id']);\n    $stmt->execute();\n  }\n}\n?>\n```", null, null]}
