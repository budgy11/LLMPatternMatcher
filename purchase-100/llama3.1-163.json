{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP. This example assumes you have a database setup to store user information and product details.\n\n**Database Schema:**\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255),\n  password VARCHAR(255)\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  description TEXT,\n  price DECIMAL(10,2)\n);\n```\n\n**PHP Code:**\n\nCreate a file named `purchase.php` and add the following code:\n\n```php\n<?php\n\n// Configuration\nrequire_once 'config.php';\n\n// Connect to database\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to display products\nfunction displayProducts() {\n    global $conn;\n    $sql = \"SELECT * FROM products\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        echo \"<table>\";\n        while($row = $result->fetch_assoc()) {\n            echo \"<tr><td>\" . $row[\"name\"] . \"</td><td>\" . $row[\"price\"] . \"</td></tr>\";\n        }\n        echo \"</table>\";\n    } else {\n        echo \"0 results\";\n    }\n\n    $conn->close();\n}\n\n// Function to add product to cart\nfunction addToCart($product_id) {\n    global $conn;\n    session_start();\n\n    if (isset($_SESSION[\"cart\"])) {\n        array_push($_SESSION[\"cart\"], $product_id);\n    } else {\n        $_SESSION[\"cart\"] = array($product_id);\n    }\n\n    header(\"Location: \" . $_SERVER['REQUEST_URI']);\n}\n\n// Function to checkout\nfunction checkout() {\n    global $conn;\n    session_start();\n\n    if (!isset($_SESSION[\"cart\"])) {\n        echo \"Cart is empty.\";\n        return;\n    }\n\n    // Calculate total cost\n    $total = 0;\n    foreach ($_SESSION[\"cart\"] as $product_id) {\n        $sql = \"SELECT price FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($sql);\n        if ($result->num_rows > 0) {\n            while($row = $result->fetch_assoc()) {\n                $total += $row[\"price\"];\n            }\n        }\n    }\n\n    // Insert order into database\n    $sql = \"INSERT INTO orders (user_id, total) VALUES ('$_SESSION[user_id]', '$total')\";\n    if ($conn->query($sql)) {\n        echo \"Order placed successfully.\";\n    } else {\n        echo \"Error: \" . $conn->error;\n    }\n\n    // Clear cart\n    unset($_SESSION[\"cart\"]);\n}\n\n?>\n```\n\n**Form Code:**\n\nCreate a file named `index.php` and add the following code:\n\n```php\n<?php\n\n// Start session\nsession_start();\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Purchase Functionality</title>\n</head>\n<body>\n\n    <?php displayProducts(); ?>\n\n    <form action=\"\" method=\"post\">\n        <input type=\"hidden\" name=\"product_id\" value=\"\">\n        <button type=\"submit\">Add to Cart</button>\n    </form>\n\n    <a href=\"?checkout=true\">Checkout</a>\n\n<?php\nif (isset($_GET[\"checkout\"])) {\n    checkout();\n}\n?>\n</body>\n</html>\n```\n\n**Usage:**\n\n1. Open `index.php` in your browser.\n2. Click on \"Add to Cart\" button next to a product to add it to cart.\n3. When you are ready to checkout, click on the \"Checkout\" link.\n4. The system will calculate total cost and insert an order into database.\n\nNote: This is a basic example and does not include any validation or security measures. In a real-world application, you should always validate user input and implement proper security measures to prevent SQL injection attacks.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\nrequire_once 'config.php';\n\n// Connect to database\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to display products\nfunction displayProducts() {\n    global $conn;\n    $sql = \"SELECT * FROM products\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        echo \"<table>\";\n        while($row = $result->fetch_assoc()) {\n            echo \"<tr><td>\" . $row[\"name\"] . \"</td><td>\" . $row[\"price\"] . \"</td></tr>\";\n        }\n        echo \"</table>\";\n    } else {\n        echo \"0 results\";\n    }\n\n    $conn->close();\n}\n\n// Function to add product to cart\nfunction addToCart($product_id) {\n    global $conn;\n    session_start();\n\n    if (isset($_SESSION[\"cart\"])) {\n        array_push($_SESSION[\"cart\"], $product_id);\n    } else {\n        $_SESSION[\"cart\"] = array($product_id);\n    }\n\n    header(\"Location: \" . $_SERVER['REQUEST_URI']);\n}\n\n// Function to checkout\nfunction checkout() {\n    global $conn;\n    session_start();\n\n    if (!isset($_SESSION[\"cart\"])) {\n        echo \"Cart is empty.\";\n        return;\n    }\n\n    // Calculate total cost\n    $total = 0;\n    foreach ($_SESSION[\"cart\"] as $product_id) {\n        $sql = \"SELECT price FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($sql);\n        if ($result->num_rows > 0) {\n            while($row = $result->fetch_assoc()) {\n                $total += $row[\"price\"];\n            }\n        }\n    }\n\n    // Insert order into database\n    $sql = \"INSERT INTO orders (user_id, total) VALUES ('$_SESSION[user_id]', '$total')\";\n    if ($conn->query($sql)) {\n        echo \"Order placed successfully.\";\n    } else {\n        echo \"Error: \" . $conn->error;\n    }\n\n    // Clear cart\n    unset($_SESSION[\"cart\"]);\n}\n\n?>\n```", "```php\n<?php\n\n// Start session\nsession_start();\n\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Purchase Functionality</title>\n</head>\n<body>\n\n    <?php displayProducts(); ?>\n\n    <form action=\"\" method=\"post\">\n        <input type=\"hidden\" name=\"product_id\" value=\"\">\n        <button type=\"submit\">Add to Cart</button>\n    </form>\n\n    <a href=\"?checkout=true\">Checkout</a>\n\n<?php\nif (isset($_GET[\"checkout\"])) {\n    checkout();\n}\n?>\n</body>\n</html>\n```"]}
