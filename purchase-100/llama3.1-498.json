{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP:\n\n**Database Schema**\n\nWe will assume that we have a database table `orders` with the following columns:\n\n| Column Name | Data Type | Description |\n| --- | --- | --- |\n| id | int | Unique order ID |\n| user_id | int | Foreign key referencing the user who made the order |\n| product_id | int | Foreign key referencing the product purchased |\n| quantity | int | Quantity of products purchased |\n| total_cost | decimal(10, 2) | Total cost of the order |\n\n**PHP Code**\n\n```php\n// database connection settings\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"ecommerce\";\n\n// connect to database\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// function to purchase a product\nfunction purchaseProduct() {\n    global $conn;\n\n    // get user ID and product ID from session or URL parameters\n    if (isset($_SESSION['user_id'])) {\n        $user_id = $_SESSION['user_id'];\n    } elseif (isset($_GET['user_id'])) {\n        $user_id = $_GET['user_id'];\n    } else {\n        echo \"Error: User ID not found.\";\n        return false;\n    }\n\n    if (isset($_SESSION['product_id'])) {\n        $product_id = $_SESSION['product_id'];\n    } elseif (isset($_GET['product_id'])) {\n        $product_id = $_GET['product_id'];\n    } else {\n        echo \"Error: Product ID not found.\";\n        return false;\n    }\n\n    // retrieve product price from database\n    $query = \"SELECT price FROM products WHERE id = '$product_id'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            $price = $row['price'];\n        }\n    } else {\n        echo \"Error: Product not found.\";\n        return false;\n    }\n\n    // calculate total cost\n    $quantity = isset($_SESSION['quantity']) ? $_SESSION['quantity'] : 1;\n    $total_cost = $price * $quantity;\n\n    // insert order into database\n    $query = \"INSERT INTO orders (user_id, product_id, quantity, total_cost) VALUES ('$user_id', '$product_id', '$quantity', '$total_cost')\";\n    $conn->query($query);\n\n    // update inventory and customer balance (if applicable)\n    // ...\n\n    return true;\n}\n\n// call the purchaseProduct function\nif (isset($_POST['purchase'])) {\n    if (purchaseProduct()) {\n        echo \"Order placed successfully!\";\n    } else {\n        echo \"Error: Unable to place order.\";\n    }\n}\n```\n\n**HTML Form**\n\n```html\n<form action=\"\" method=\"post\">\n    <input type=\"hidden\" name=\"user_id\" value=\"<?php echo $_SESSION['user_id']; ?>\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_SESSION['product_id']; ?>\">\n\n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\" value=\"<?php echo isset($_SESSION['quantity']) ? $_SESSION['quantity'] : 1; ?>\">\n\n    <button type=\"submit\" name=\"purchase\">Purchase</button>\n</form>\n```\n\nThis code assumes that the user's ID and product ID are stored in session variables, which can be set using `$_SESSION` or by passing them as URL parameters. The `purchaseProduct` function retrieves the product price from the database, calculates the total cost, and inserts a new order into the database if successful.\n\nNote: This is a basic example and does not include error handling, security measures (e.g., SQL injection protection), or advanced features like inventory management and customer balance updates.", "code_blocks": ["```php\n// database connection settings\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"ecommerce\";\n\n// connect to database\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// function to purchase a product\nfunction purchaseProduct() {\n    global $conn;\n\n    // get user ID and product ID from session or URL parameters\n    if (isset($_SESSION['user_id'])) {\n        $user_id = $_SESSION['user_id'];\n    } elseif (isset($_GET['user_id'])) {\n        $user_id = $_GET['user_id'];\n    } else {\n        echo \"Error: User ID not found.\";\n        return false;\n    }\n\n    if (isset($_SESSION['product_id'])) {\n        $product_id = $_SESSION['product_id'];\n    } elseif (isset($_GET['product_id'])) {\n        $product_id = $_GET['product_id'];\n    } else {\n        echo \"Error: Product ID not found.\";\n        return false;\n    }\n\n    // retrieve product price from database\n    $query = \"SELECT price FROM products WHERE id = '$product_id'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            $price = $row['price'];\n        }\n    } else {\n        echo \"Error: Product not found.\";\n        return false;\n    }\n\n    // calculate total cost\n    $quantity = isset($_SESSION['quantity']) ? $_SESSION['quantity'] : 1;\n    $total_cost = $price * $quantity;\n\n    // insert order into database\n    $query = \"INSERT INTO orders (user_id, product_id, quantity, total_cost) VALUES ('$user_id', '$product_id', '$quantity', '$total_cost')\";\n    $conn->query($query);\n\n    // update inventory and customer balance (if applicable)\n    // ...\n\n    return true;\n}\n\n// call the purchaseProduct function\nif (isset($_POST['purchase'])) {\n    if (purchaseProduct()) {\n        echo \"Order placed successfully!\";\n    } else {\n        echo \"Error: Unable to place order.\";\n    }\n}\n```", null]}
