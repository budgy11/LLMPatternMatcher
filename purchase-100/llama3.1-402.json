{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP, including HTML and CSS for layout. This code creates a basic system where users can add items to their cart, view the cart, and checkout.\n\n**Please note that this is a simplified example and should not be used in production without proper security measures (e.g., SQL injection protection).**\n\n### Database Setup\n\nFirst, create a database schema with two tables:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  total DECIMAL(10,2),\n  status VARCHAR(50) DEFAULT 'pending'\n);\n```\n\n### PHP Code\n\n```php\n<?php\nrequire_once 'db.php'; // database connection settings (e.g., username, password)\n\n// function to get all products\nfunction getProducts() {\n    global $conn;\n    $sql = \"SELECT * FROM products\";\n    return mysqli_query($conn, $sql);\n}\n\n// function to add item to cart\nfunction addItemToCart($user_id, $product_id) {\n    global $conn;\n    $sql = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES (NULL, '$product_id', 1)\";\n    return mysqli_query($conn, $sql);\n}\n\n// function to get all items in cart\nfunction getCartItems() {\n    global $conn;\n    $sql = \"SELECT * FROM orders WHERE user_id = '\".$_SESSION['user_id'].\"' AND status='pending'\";\n    $result = mysqli_query($conn, $sql);\n    return $result;\n}\n\n// function to checkout and update order status\nfunction checkout($order_id) {\n    global $conn;\n    $sql = \"UPDATE orders SET status='complete' WHERE id='$order_id'\";\n    return mysqli_query($conn, $sql);\n}\n?>\n```\n\n### HTML/PHP Code for Adding Items to Cart\n\n```php\n<?php require_once 'db.php'; ?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Purchase Functionality</title>\n    <link rel=\"stylesheet\" href=\"style.css\">\n</head>\n\n<body>\n    <h1>Add Item to Cart</h1>\n    <?php\n        $products = getProducts();\n    ?>\n    <form action=\"\" method=\"post\">\n        <?php while ($product = mysqli_fetch_assoc($products)) { ?>\n            <div class=\"product\">\n                <input type=\"checkbox\" name=\"items[]\" value=\"<?php echo $product['id']; ?>\">\n                <img src=\"<?php echo 'image/'.$product['image']; ?>\" alt=\"<?php echo $product['name']; ?>\">\n                <p><?php echo $product['name']; ?></p>\n                <p>Price: <?php echo $product['price']; ?></p>\n            </div>\n        <?php } ?>\n        <button type=\"submit\">Add to Cart</button>\n    </form>\n\n    <?php\n        if (isset($_POST['items'])) {\n            foreach ($_POST['items'] as $item) {\n                addItemToCart($_SESSION['user_id'], $item);\n            }\n        }\n    ?>\n    \n    <h1>View Cart</h1>\n    <?php\n        $cartItems = getCartItems();\n        if (mysqli_num_rows($cartItems) > 0) { \n    ?>\n        <table>\n            <thead>\n                <tr>\n                    <th>Product Name</th>\n                    <th>Price</th>\n                </tr>\n            </thead>\n            <tbody>\n                <?php\n                    while ($row = mysqli_fetch_assoc($cartItems)) {\n                        $product = get_product_by_id($conn, $row['product_id']);\n                        echo \"<tr><td>\".$product['name'].\"</td><td>$\".$product['price'].\"</td></tr>\";\n                    }\n                ?>\n            </tbody>\n        </table>\n    <?php } else { ?>\n        <p>No items in cart.</p>\n    <?php } ?>\n\n    <h1>Checkout</h1>\n    <form action=\"\" method=\"post\">\n        <button type=\"submit\" name=\"checkout\">Checkout</button>\n    </form>\n\n    <?php\n        if (isset($_POST['checkout'])) {\n            $order_id = mysqli_insert_id($conn);\n            checkout($order_id);\n            echo \"Order Complete!\";\n        }\n    ?>\n</body>\n</html>\n```\n\n**Remember to create a `db.php` file with your database connection settings and modify the SQL queries as necessary. This example assumes that you have already established a session for the user and are storing their user ID in `$_SESSION['user_id']`.**\n\nThis is a basic implementation, and there's much more to consider when creating a real-world e-commerce system (e.g., security, payment processing, order management).", "code_blocks": [null, "```php\n<?php\nrequire_once 'db.php'; // database connection settings (e.g., username, password)\n\n// function to get all products\nfunction getProducts() {\n    global $conn;\n    $sql = \"SELECT * FROM products\";\n    return mysqli_query($conn, $sql);\n}\n\n// function to add item to cart\nfunction addItemToCart($user_id, $product_id) {\n    global $conn;\n    $sql = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES (NULL, '$product_id', 1)\";\n    return mysqli_query($conn, $sql);\n}\n\n// function to get all items in cart\nfunction getCartItems() {\n    global $conn;\n    $sql = \"SELECT * FROM orders WHERE user_id = '\".$_SESSION['user_id'].\"' AND status='pending'\";\n    $result = mysqli_query($conn, $sql);\n    return $result;\n}\n\n// function to checkout and update order status\nfunction checkout($order_id) {\n    global $conn;\n    $sql = \"UPDATE orders SET status='complete' WHERE id='$order_id'\";\n    return mysqli_query($conn, $sql);\n}\n?>\n```", "```php\n<?php require_once 'db.php'; ?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Purchase Functionality</title>\n    <link rel=\"stylesheet\" href=\"style.css\">\n</head>\n\n<body>\n    <h1>Add Item to Cart</h1>\n    <?php\n        $products = getProducts();\n    ?>\n    <form action=\"\" method=\"post\">\n        <?php while ($product = mysqli_fetch_assoc($products)) { ?>\n            <div class=\"product\">\n                <input type=\"checkbox\" name=\"items[]\" value=\"<?php echo $product['id']; ?>\">\n                <img src=\"<?php echo 'image/'.$product['image']; ?>\" alt=\"<?php echo $product['name']; ?>\">\n                <p><?php echo $product['name']; ?></p>\n                <p>Price: <?php echo $product['price']; ?></p>\n            </div>\n        <?php } ?>\n        <button type=\"submit\">Add to Cart</button>\n    </form>\n\n    <?php\n        if (isset($_POST['items'])) {\n            foreach ($_POST['items'] as $item) {\n                addItemToCart($_SESSION['user_id'], $item);\n            }\n        }\n    ?>\n    \n    <h1>View Cart</h1>\n    <?php\n        $cartItems = getCartItems();\n        if (mysqli_num_rows($cartItems) > 0) { \n    ?>\n        <table>\n            <thead>\n                <tr>\n                    <th>Product Name</th>\n                    <th>Price</th>\n                </tr>\n            </thead>\n            <tbody>\n                <?php\n                    while ($row = mysqli_fetch_assoc($cartItems)) {\n                        $product = get_product_by_id($conn, $row['product_id']);\n                        echo \"<tr><td>\".$product['name'].\"</td><td>$\".$product['price'].\"</td></tr>\";\n                    }\n                ?>\n            </tbody>\n        </table>\n    <?php } else { ?>\n        <p>No items in cart.</p>\n    <?php } ?>\n\n    <h1>Checkout</h1>\n    <form action=\"\" method=\"post\">\n        <button type=\"submit\" name=\"checkout\">Checkout</button>\n    </form>\n\n    <?php\n        if (isset($_POST['checkout'])) {\n            $order_id = mysqli_insert_id($conn);\n            checkout($order_id);\n            echo \"Order Complete!\";\n        }\n    ?>\n</body>\n</html>\n```"]}
