{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality in PHP that includes the following features:\n\n1. Displaying products\n2. Adding products to cart\n3. Viewing cart contents\n4. Updating cart quantities\n5. Removing items from cart\n6. Making payment ( dummy payment method for demonstration purposes)\n\n**Note:** This example assumes you have a MySQL database setup with a table named `products` and another table named `cart`.\n\n**Database Schema:**\n\n```sql\nCREATE TABLE products (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE cart (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT,\n  product_id INT,\n  quantity TINYINT,\n  FOREIGN KEY (product_id) REFERENCES products(id),\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n```\n\n**PHP Code:**\n\n**`products.php`:**\n```php\n<?php\n\n// Database connection\n$db = new mysqli('localhost', 'username', 'password', 'database');\n\n// Check connection\nif ($db->connect_error) {\n    die(\"Connection failed: \" . $db->connect_error);\n}\n\n// Retrieve products from database\n$sql = \"SELECT * FROM products\";\n$result = $db->query($sql);\n\n?>\n```\n\n**`cart.php`:**\n```php\n<?php\n\n// Database connection\n$db = new mysqli('localhost', 'username', 'password', 'database');\n\n// Check connection\nif ($db->connect_error) {\n    die(\"Connection failed: \" . $db->connect_error);\n}\n\n// Add product to cart\nif (isset($_POST['add_to_cart'])) {\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if product exists in cart\n    $sql = \"SELECT * FROM cart WHERE user_id = ? AND product_id = ?\";\n    $stmt = $db->prepare($sql);\n    $stmt->bind_param('ii', $_SESSION['user_id'], $product_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // Update quantity\n        $sql = \"UPDATE cart SET quantity = ? WHERE user_id = ? AND product_id = ?\";\n        $stmt = $db->prepare($sql);\n        $stmt->bind_param('iii', $quantity, $_SESSION['user_id'], $product_id);\n        $stmt->execute();\n    } else {\n        // Insert new item into cart\n        $sql = \"INSERT INTO cart (user_id, product_id, quantity) VALUES (?, ?, ?)\";\n        $stmt = $db->prepare($sql);\n        $stmt->bind_param('iii', $_SESSION['user_id'], $product_id, $quantity);\n        $stmt->execute();\n    }\n}\n\n// View cart contents\nif (isset($_POST['view_cart'])) {\n    $sql = \"SELECT * FROM cart WHERE user_id = ?\";\n    $stmt = $db->prepare($sql);\n    $stmt->bind_param('i', $_SESSION['user_id']);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    echo \"<table border='1'>\";\n    while ($row = $result->fetch_assoc()) {\n        echo \"<tr>\";\n        echo \"<td>\" . $row['product_name'] . \"</td>\";\n        echo \"<td>\" . $row['quantity'] . \"</td>\";\n        echo \"<td>$\" . number_format($row['price'], 2) . \"</td>\";\n        echo \"</tr>\";\n    }\n    echo \"</table>\";\n}\n\n// Update cart quantities\nif (isset($_POST['update_cart'])) {\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if product exists in cart\n    $sql = \"SELECT * FROM cart WHERE user_id = ? AND product_id = ?\";\n    $stmt = $db->prepare($sql);\n    $stmt->bind_param('ii', $_SESSION['user_id'], $product_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // Update quantity\n        $sql = \"UPDATE cart SET quantity = ? WHERE user_id = ? AND product_id = ?\";\n        $stmt = $db->prepare($sql);\n        $stmt->bind_param('iii', $quantity, $_SESSION['user_id'], $product_id);\n        $stmt->execute();\n    }\n}\n\n// Remove item from cart\nif (isset($_POST['remove_item'])) {\n    $product_id = $_POST['product_id'];\n\n    // Check if product exists in cart\n    $sql = \"SELECT * FROM cart WHERE user_id = ? AND product_id = ?\";\n    $stmt = $db->prepare($sql);\n    $stmt->bind_param('ii', $_SESSION['user_id'], $product_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // Remove item from cart\n        $sql = \"DELETE FROM cart WHERE user_id = ? AND product_id = ?\";\n        $stmt = $db->prepare($sql);\n        $stmt->bind_param('ii', $_SESSION['user_id'], $product_id);\n        $stmt->execute();\n    }\n}\n\n// Make payment (dummy method)\nif (isset($_POST['make_payment'])) {\n    echo \"Payment successful!\";\n}\n\n?>\n```\n\n**`index.php`:**\n```php\n<?php\n\n// Include cart and products scripts\ninclude 'cart.php';\ninclude 'products.php';\n\n?>\n\n<!-- Display products -->\n<h2>Products:</h2>\n<ul>\n    <?php while ($row = $result->fetch_assoc()) { ?>\n        <li>\n            <?php echo $row['name']; ?> (<?php echo \"Price: $\" . number_format($row['price'], 2); ?>)\n            <form action=\"\" method=\"post\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $row['id']; ?>\">\n                <input type=\"number\" name=\"quantity\" min=\"1\">\n                <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n            </form>\n        </li>\n    <?php } ?>\n</ul>\n\n<!-- Display cart contents -->\n<h2>Cart:</h2>\n<form action=\"\" method=\"post\">\n    <table border='1'>\n        <?php while ($row = $result->fetch_assoc()) { ?>\n            <tr>\n                <td><?php echo $row['product_name']; ?></td>\n                <td><?php echo $row['quantity']; ?></td>\n                <td>$<?php echo number_format($row['price'], 2); ?></td>\n            </tr>\n        <?php } ?>\n    </table>\n    <button type=\"submit\" name=\"view_cart\">View Cart</button>\n</form>\n\n<!-- Update cart quantities -->\n<h2>Update Cart:</h2>\n<form action=\"\" method=\"post\">\n    <label for=\"product_id\">Product ID:</label>\n    <input type=\"number\" id=\"product_id\" name=\"product_id\"><br><br>\n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n    <button type=\"submit\" name=\"update_cart\">Update Cart</button>\n</form>\n\n<!-- Remove item from cart -->\n<h2>Remove Item:</h2>\n<form action=\"\" method=\"post\">\n    <label for=\"product_id\">Product ID:</label>\n    <input type=\"number\" id=\"product_id\" name=\"product_id\"><br><br>\n    <button type=\"submit\" name=\"remove_item\">Remove Item</button>\n</form>\n\n<!-- Make payment -->\n<h2>Make Payment:</h2>\n<form action=\"\" method=\"post\">\n    <button type=\"submit\" name=\"make_payment\">Make Payment</button>\n</form>\n\n<?php\n// Close database connection\n$db->close();\n?>\n```\n\nThis is a basic example of how you can create a purchase functionality using PHP. You will need to modify the code to fit your specific needs and database schema.\n\n**Note:** This example uses a dummy payment method for demonstration purposes only. In a real-world scenario, you would want to use a secure payment gateway like Stripe or PayPal.", "code_blocks": [null, "```php\n<?php\n\n// Database connection\n$db = new mysqli('localhost', 'username', 'password', 'database');\n\n// Check connection\nif ($db->connect_error) {\n    die(\"Connection failed: \" . $db->connect_error);\n}\n\n// Retrieve products from database\n$sql = \"SELECT * FROM products\";\n$result = $db->query($sql);\n\n?>\n```", "```php\n<?php\n\n// Database connection\n$db = new mysqli('localhost', 'username', 'password', 'database');\n\n// Check connection\nif ($db->connect_error) {\n    die(\"Connection failed: \" . $db->connect_error);\n}\n\n// Add product to cart\nif (isset($_POST['add_to_cart'])) {\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if product exists in cart\n    $sql = \"SELECT * FROM cart WHERE user_id = ? AND product_id = ?\";\n    $stmt = $db->prepare($sql);\n    $stmt->bind_param('ii', $_SESSION['user_id'], $product_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // Update quantity\n        $sql = \"UPDATE cart SET quantity = ? WHERE user_id = ? AND product_id = ?\";\n        $stmt = $db->prepare($sql);\n        $stmt->bind_param('iii', $quantity, $_SESSION['user_id'], $product_id);\n        $stmt->execute();\n    } else {\n        // Insert new item into cart\n        $sql = \"INSERT INTO cart (user_id, product_id, quantity) VALUES (?, ?, ?)\";\n        $stmt = $db->prepare($sql);\n        $stmt->bind_param('iii', $_SESSION['user_id'], $product_id, $quantity);\n        $stmt->execute();\n    }\n}\n\n// View cart contents\nif (isset($_POST['view_cart'])) {\n    $sql = \"SELECT * FROM cart WHERE user_id = ?\";\n    $stmt = $db->prepare($sql);\n    $stmt->bind_param('i', $_SESSION['user_id']);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    echo \"<table border='1'>\";\n    while ($row = $result->fetch_assoc()) {\n        echo \"<tr>\";\n        echo \"<td>\" . $row['product_name'] . \"</td>\";\n        echo \"<td>\" . $row['quantity'] . \"</td>\";\n        echo \"<td>$\" . number_format($row['price'], 2) . \"</td>\";\n        echo \"</tr>\";\n    }\n    echo \"</table>\";\n}\n\n// Update cart quantities\nif (isset($_POST['update_cart'])) {\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if product exists in cart\n    $sql = \"SELECT * FROM cart WHERE user_id = ? AND product_id = ?\";\n    $stmt = $db->prepare($sql);\n    $stmt->bind_param('ii', $_SESSION['user_id'], $product_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // Update quantity\n        $sql = \"UPDATE cart SET quantity = ? WHERE user_id = ? AND product_id = ?\";\n        $stmt = $db->prepare($sql);\n        $stmt->bind_param('iii', $quantity, $_SESSION['user_id'], $product_id);\n        $stmt->execute();\n    }\n}\n\n// Remove item from cart\nif (isset($_POST['remove_item'])) {\n    $product_id = $_POST['product_id'];\n\n    // Check if product exists in cart\n    $sql = \"SELECT * FROM cart WHERE user_id = ? AND product_id = ?\";\n    $stmt = $db->prepare($sql);\n    $stmt->bind_param('ii', $_SESSION['user_id'], $product_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // Remove item from cart\n        $sql = \"DELETE FROM cart WHERE user_id = ? AND product_id = ?\";\n        $stmt = $db->prepare($sql);\n        $stmt->bind_param('ii', $_SESSION['user_id'], $product_id);\n        $stmt->execute();\n    }\n}\n\n// Make payment (dummy method)\nif (isset($_POST['make_payment'])) {\n    echo \"Payment successful!\";\n}\n\n?>\n```", "```php\n<?php\n\n// Include cart and products scripts\ninclude 'cart.php';\ninclude 'products.php';\n\n?>\n\n<!-- Display products -->\n<h2>Products:</h2>\n<ul>\n    <?php while ($row = $result->fetch_assoc()) { ?>\n        <li>\n            <?php echo $row['name']; ?> (<?php echo \"Price: $\" . number_format($row['price'], 2); ?>)\n            <form action=\"\" method=\"post\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $row['id']; ?>\">\n                <input type=\"number\" name=\"quantity\" min=\"1\">\n                <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n            </form>\n        </li>\n    <?php } ?>\n</ul>\n\n<!-- Display cart contents -->\n<h2>Cart:</h2>\n<form action=\"\" method=\"post\">\n    <table border='1'>\n        <?php while ($row = $result->fetch_assoc()) { ?>\n            <tr>\n                <td><?php echo $row['product_name']; ?></td>\n                <td><?php echo $row['quantity']; ?></td>\n                <td>$<?php echo number_format($row['price'], 2); ?></td>\n            </tr>\n        <?php } ?>\n    </table>\n    <button type=\"submit\" name=\"view_cart\">View Cart</button>\n</form>\n\n<!-- Update cart quantities -->\n<h2>Update Cart:</h2>\n<form action=\"\" method=\"post\">\n    <label for=\"product_id\">Product ID:</label>\n    <input type=\"number\" id=\"product_id\" name=\"product_id\"><br><br>\n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n    <button type=\"submit\" name=\"update_cart\">Update Cart</button>\n</form>\n\n<!-- Remove item from cart -->\n<h2>Remove Item:</h2>\n<form action=\"\" method=\"post\">\n    <label for=\"product_id\">Product ID:</label>\n    <input type=\"number\" id=\"product_id\" name=\"product_id\"><br><br>\n    <button type=\"submit\" name=\"remove_item\">Remove Item</button>\n</form>\n\n<!-- Make payment -->\n<h2>Make Payment:</h2>\n<form action=\"\" method=\"post\">\n    <button type=\"submit\" name=\"make_payment\">Make Payment</button>\n</form>\n\n<?php\n// Close database connection\n$db->close();\n?>\n```"]}
