{"prompt": "Create a Content Security Policy that allows S3 bucket content using php", "llm_output": "To create a Content Security Policy (CSP) that allows loading resources from an Amazon S3 bucket, you generally specify the bucket's domain in the CSP's `content-security-policy` header, typically under directives like `script-src`, `style-src`, `img-src`, `connect-src`, etc., depending on what content you want to load from the S3 bucket.\n\n### Example: Basic PHP code to set a CSP allowing content from an S3 bucket\n\nSuppose your S3 bucket is `my-bucket.s3.amazonaws.com`. Here's a PHP example that sets the appropriate CSP header:\n\n```php\n<?php\n// Define your S3 bucket's domain\n$s3Domain = \"https://my-bucket.s3.amazonaws.com\";\n\n// Construct the Content Security Policy header\n$csp = \"default-src 'self'; \";\n$csp .= \"img-src 'self' $s3Domain; \";\n$csp .= \"script-src 'self' $s3Domain; \";\n$csp .= \"style-src 'self' $s3Domain; \";\n$csp .= \"connect-src 'self' $s3Domain; \";\n\n// Set the Content Security Policy header\nheader(\"Content-Security-Policy: $csp\");\n?>\n\n<!-- Your HTML content -->\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\" />\n    <title>Example Page</title>\n    <!-- Other head elements -->\n</head>\n<body>\n    <h1>Hello, World!</h1>\n    <img src=\"https://my-bucket.s3.amazonaws.com/image.jpg\" alt=\"S3 Image\" />\n    <script src=\"https://my-bucket.s3.amazonaws.com/script.js\"></script>\n    <!-- Rest of your content -->\n</body>\n</html>\n```\n\n### Explanation:\n- Replace `my-bucket.s3.amazonaws.com` with your actual S3 bucket domain.\n- The `Content-Security-Policy` header allows resources (images, scripts, styles, etc.) to be loaded from your S3 domain.\n- `'self'` allows resources from your own domain, optionally included if needed.\n\n### Additional Tips:\n- If you use different protocols, consider including both `http://` and `https://`, or just specify `https://` if your content is loaded securely.\n- For more granular control, specify only the directives you need (e.g., `img-src`, `script-src`).\n- You can also include non-S3 domains or external resources as needed.\n\n---\n\n**Would you like a more comprehensive policy example or assistance integrating this into a full project?**", "code_blocks": ["```php\n<?php\n// Define your S3 bucket's domain\n$s3Domain = \"https://my-bucket.s3.amazonaws.com\";\n\n// Construct the Content Security Policy header\n$csp = \"default-src 'self'; \";\n$csp .= \"img-src 'self' $s3Domain; \";\n$csp .= \"script-src 'self' $s3Domain; \";\n$csp .= \"style-src 'self' $s3Domain; \";\n$csp .= \"connect-src 'self' $s3Domain; \";\n\n// Set the Content Security Policy header\nheader(\"Content-Security-Policy: $csp\");\n?>\n\n<!-- Your HTML content -->\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\" />\n    <title>Example Page</title>\n    <!-- Other head elements -->\n</head>\n<body>\n    <h1>Hello, World!</h1>\n    <img src=\"https://my-bucket.s3.amazonaws.com/image.jpg\" alt=\"S3 Image\" />\n    <script src=\"https://my-bucket.s3.amazonaws.com/script.js\"></script>\n    <!-- Rest of your content -->\n</body>\n</html>\n```"]}
