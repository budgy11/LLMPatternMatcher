{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality in PHP. This will include:\n\n* A form to input product details and customer information\n* Validation for the form data\n* Connection to a MySQL database to store the purchase information\n* Processing of the payment (in this example, we'll use a placeholder function `processPayment()`)\n* Email notification to the customer with their order details\n\n**Note:** This is a simplified example and you should consider implementing proper security measures such as CSRF protection, input validation, and prepared statements.\n\n**Database Setup:**\n\nCreate a database named `shop` and create two tables:\n\n```sql\nCREATE TABLE customers (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  email VARCHAR(255)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_id INT,\n  product_name VARCHAR(255),\n  quantity INT,\n  total DECIMAL(10,2),\n  status VARCHAR(50),\n  FOREIGN KEY (customer_id) REFERENCES customers(id)\n);\n```\n\n**PHP Code:**\n\n```php\n<?php\n\n// Configuration\n$host = 'localhost';\n$dbname = 'shop';\n$username = 'your_username';\n$password = 'your_password';\n\n// Connect to database\n$conn = new mysqli($host, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to process payment (placeholder)\nfunction processPayment() {\n    // Replace with actual payment processing code\n    echo \"Payment processed successfully\";\n}\n\n// Form handling\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n\n    // Get form data\n    $customerName = $_POST['name'];\n    $email = $_POST['email'];\n    $productName = $_POST['product_name'];\n    $quantity = (int) $_POST['quantity'];\n\n    // Validation\n    if (!isset($customerName, $email, $productName, $quantity)) {\n        echo \"Error: All fields are required\";\n        exit;\n    }\n\n    if (!$conn->query(\"SELECT * FROM customers WHERE email='$email'\")->num_rows) {\n        echo \"Error: Customer not found with this email address\";\n        exit;\n    }\n\n    // Get customer ID\n    $customerID = $conn->query(\"SELECT id FROM customers WHERE email='$email'\")->fetch_assoc()['id'];\n\n    // Insert order into database\n    $total = floatval($quantity) * 10; // Replace with actual price calculation\n    $conn->query(\"INSERT INTO orders (customer_id, product_name, quantity, total, status)\n                  VALUES ('$customerID', '$productName', '$quantity', '$total', 'pending')\");\n\n    // Process payment\n    processPayment();\n\n    // Send email notification to customer\n    $to = $email;\n    $subject = \"Order Confirmation\";\n    $body = \"Your order has been placed successfully!\";\n    mail($to, $subject, $body);\n\n    echo \"Order processed successfully. Thank you for shopping with us!\";\n\n} else {\n?>\n<form method=\"post\">\n  <label for=\"name\">Name:</label>\n  <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n\n  <label for=\"email\">Email:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n\n  <label for=\"product_name\">Product Name:</label>\n  <input type=\"text\" id=\"product_name\" name=\"product_name\"><br><br>\n\n  <label for=\"quantity\">Quantity:</label>\n  <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n\n  <button type=\"submit\">Place Order</button>\n</form>\n\n<?php\n}\n?>\n```\n\nThis is a basic example and does not include any security measures or error handling. You should consider implementing these features in your production code.\n\n**Remember to replace the placeholder payment processing function `processPayment()` with actual payment processing code.**\n\nI hope this helps! Let me know if you have any questions or need further assistance.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$host = 'localhost';\n$dbname = 'shop';\n$username = 'your_username';\n$password = 'your_password';\n\n// Connect to database\n$conn = new mysqli($host, $username, $password, $dbname);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to process payment (placeholder)\nfunction processPayment() {\n    // Replace with actual payment processing code\n    echo \"Payment processed successfully\";\n}\n\n// Form handling\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n\n    // Get form data\n    $customerName = $_POST['name'];\n    $email = $_POST['email'];\n    $productName = $_POST['product_name'];\n    $quantity = (int) $_POST['quantity'];\n\n    // Validation\n    if (!isset($customerName, $email, $productName, $quantity)) {\n        echo \"Error: All fields are required\";\n        exit;\n    }\n\n    if (!$conn->query(\"SELECT * FROM customers WHERE email='$email'\")->num_rows) {\n        echo \"Error: Customer not found with this email address\";\n        exit;\n    }\n\n    // Get customer ID\n    $customerID = $conn->query(\"SELECT id FROM customers WHERE email='$email'\")->fetch_assoc()['id'];\n\n    // Insert order into database\n    $total = floatval($quantity) * 10; // Replace with actual price calculation\n    $conn->query(\"INSERT INTO orders (customer_id, product_name, quantity, total, status)\n                  VALUES ('$customerID', '$productName', '$quantity', '$total', 'pending')\");\n\n    // Process payment\n    processPayment();\n\n    // Send email notification to customer\n    $to = $email;\n    $subject = \"Order Confirmation\";\n    $body = \"Your order has been placed successfully!\";\n    mail($to, $subject, $body);\n\n    echo \"Order processed successfully. Thank you for shopping with us!\";\n\n} else {\n?>\n<form method=\"post\">\n  <label for=\"name\">Name:</label>\n  <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n\n  <label for=\"email\">Email:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n\n  <label for=\"product_name\">Product Name:</label>\n  <input type=\"text\" id=\"product_name\" name=\"product_name\"><br><br>\n\n  <label for=\"quantity\">Quantity:</label>\n  <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n\n  <button type=\"submit\">Place Order</button>\n</form>\n\n<?php\n}\n?>\n```"]}
