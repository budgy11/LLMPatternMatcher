{"prompt": "Create a purchase functionality using php", "llm_output": "**Purchase Functionality in PHP**\n\nHere's an example of a basic purchase functionality in PHP, including user registration, login, and checkout. This will cover creating a product list, adding products to the cart, and processing the payment.\n\n### Database Setup\n\nFirst, create a database with two tables: `users` and `products`. The `users` table stores user information, while the `products` table stores product details.\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255) NOT NULL,\n  price DECIMAL(10,2) NOT NULL\n);\n```\n\n### PHP Code\n\n**config.php**\n\n```php\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_NAME', 'database_name');\ndefine('DB_USER', 'username');\ndefine('DB_PASSWORD', 'password');\n\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n?>\n```\n\n**register.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['submit'])) {\n  $username = $_POST['username'];\n  $email = $_POST['email'];\n  $password = password_hash($_POST['password'], PASSWORD_DEFAULT);\n\n  $query = \"INSERT INTO users (username, email, password) VALUES ('$username', '$email', '$password')\";\n  mysqli_query($mysqli, $query);\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Register</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"username\">Username:</label><br>\n  <input type=\"text\" id=\"username\" name=\"username\"><br>\n  <label for=\"email\">Email:</label><br>\n  <input type=\"email\" id=\"email\" name=\"email\"><br>\n  <label for=\"password\">Password:</label><br>\n  <input type=\"password\" id=\"password\" name=\"password\"><br>\n  <input type=\"submit\" name=\"submit\" value=\"Register\">\n</form>\n\n</body>\n</html>\n```\n\n**login.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['login'])) {\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  $query = \"SELECT * FROM users WHERE username = '$username' AND password = '$password'\";\n  $result = mysqli_query($mysqli, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    header('Location: index.php');\n    exit;\n  } else {\n    echo 'Invalid credentials';\n  }\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Login</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"username\">Username:</label><br>\n  <input type=\"text\" id=\"username\" name=\"username\"><br>\n  <label for=\"password\">Password:</label><br>\n  <input type=\"password\" id=\"password\" name=\"password\"><br>\n  <input type=\"submit\" name=\"login\" value=\"Login\">\n</form>\n\n</body>\n</html>\n```\n\n**index.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($mysqli, $query);\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Products</title>\n</head>\n<body>\n\n<h1>Products</h1>\n\n<ul>\n  <?php while ($row = mysqli_fetch_assoc($result)) { ?>\n    <li><?php echo $row['name']; ?> - <?php echo $row['price']; ?></li>\n  <?php } ?>\n</ul>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <input type=\"hidden\" name=\"product_id\" value=\"\">\n  <input type=\"submit\" name=\"add_to_cart\" value=\"Add to Cart\">\n</form>\n\n<?php\nif (isset($_POST['add_to_cart'])) {\n  $product_id = $_POST['product_id'];\n  // Add product to cart logic here\n}\n\n?>\n\n</body>\n</html>\n```\n\n**cart.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($mysqli, $query);\n\n$products_in_cart = array();\n\nif (isset($_SESSION['cart'])) {\n  $products_in_cart = $_SESSION['cart'];\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Cart</title>\n</head>\n<body>\n\n<h1>Cart</h1>\n\n<ul>\n  <?php while ($row = mysqli_fetch_assoc($result)) { ?>\n    <li><?php echo $row['name']; ?> - <?php echo $row['price']; ?></li>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n      <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $row['id']; ?>\">\n      <input type=\"submit\" name=\"add_to_cart\" value=\"Add to Cart\">\n    </form>\n  <?php } ?>\n</ul>\n\n<?php\nif (isset($_POST['add_to_cart'])) {\n  $product_id = $_POST['product_id'];\n  if (!in_array($product_id, $products_in_cart)) {\n    array_push($products_in_cart, $product_id);\n    $_SESSION['cart'] = $products_in_cart;\n  }\n}\n\n?>\n\n</body>\n</html>\n```\n\n**checkout.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['checkout'])) {\n  // Process payment logic here\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Checkout</title>\n</head>\n<body>\n\n<h1>Checkout</h1>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <input type=\"submit\" name=\"checkout\" value=\"Checkout\">\n</form>\n\n<?php\nif (isset($_POST['checkout'])) {\n  // Process payment logic here\n}\n\n?>\n\n</body>\n</html>\n```\n\nThis example provides a basic purchase functionality, including user registration and login, product listing, adding products to cart, and checkout. However, the actual payment processing is not implemented in this example.\n\n**Note:** This code does not handle security concerns such as SQL injection and cross-site scripting (XSS). Always ensure proper validation and sanitization of input data when building a production-ready application.", "code_blocks": [null, "```php\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_NAME', 'database_name');\ndefine('DB_USER', 'username');\ndefine('DB_PASSWORD', 'password');\n\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['submit'])) {\n  $username = $_POST['username'];\n  $email = $_POST['email'];\n  $password = password_hash($_POST['password'], PASSWORD_DEFAULT);\n\n  $query = \"INSERT INTO users (username, email, password) VALUES ('$username', '$email', '$password')\";\n  mysqli_query($mysqli, $query);\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Register</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"username\">Username:</label><br>\n  <input type=\"text\" id=\"username\" name=\"username\"><br>\n  <label for=\"email\">Email:</label><br>\n  <input type=\"email\" id=\"email\" name=\"email\"><br>\n  <label for=\"password\">Password:</label><br>\n  <input type=\"password\" id=\"password\" name=\"password\"><br>\n  <input type=\"submit\" name=\"submit\" value=\"Register\">\n</form>\n\n</body>\n</html>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['login'])) {\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  $query = \"SELECT * FROM users WHERE username = '$username' AND password = '$password'\";\n  $result = mysqli_query($mysqli, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    header('Location: index.php');\n    exit;\n  } else {\n    echo 'Invalid credentials';\n  }\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Login</title>\n</head>\n<body>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"username\">Username:</label><br>\n  <input type=\"text\" id=\"username\" name=\"username\"><br>\n  <label for=\"password\">Password:</label><br>\n  <input type=\"password\" id=\"password\" name=\"password\"><br>\n  <input type=\"submit\" name=\"login\" value=\"Login\">\n</form>\n\n</body>\n</html>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($mysqli, $query);\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Products</title>\n</head>\n<body>\n\n<h1>Products</h1>\n\n<ul>\n  <?php while ($row = mysqli_fetch_assoc($result)) { ?>\n    <li><?php echo $row['name']; ?> - <?php echo $row['price']; ?></li>\n  <?php } ?>\n</ul>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <input type=\"hidden\" name=\"product_id\" value=\"\">\n  <input type=\"submit\" name=\"add_to_cart\" value=\"Add to Cart\">\n</form>\n\n<?php\nif (isset($_POST['add_to_cart'])) {\n  $product_id = $_POST['product_id'];\n  // Add product to cart logic here\n}\n\n?>\n\n</body>\n</html>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($mysqli, $query);\n\n$products_in_cart = array();\n\nif (isset($_SESSION['cart'])) {\n  $products_in_cart = $_SESSION['cart'];\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Cart</title>\n</head>\n<body>\n\n<h1>Cart</h1>\n\n<ul>\n  <?php while ($row = mysqli_fetch_assoc($result)) { ?>\n    <li><?php echo $row['name']; ?> - <?php echo $row['price']; ?></li>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n      <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $row['id']; ?>\">\n      <input type=\"submit\" name=\"add_to_cart\" value=\"Add to Cart\">\n    </form>\n  <?php } ?>\n</ul>\n\n<?php\nif (isset($_POST['add_to_cart'])) {\n  $product_id = $_POST['product_id'];\n  if (!in_array($product_id, $products_in_cart)) {\n    array_push($products_in_cart, $product_id);\n    $_SESSION['cart'] = $products_in_cart;\n  }\n}\n\n?>\n\n</body>\n</html>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['checkout'])) {\n  // Process payment logic here\n}\n\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Checkout</title>\n</head>\n<body>\n\n<h1>Checkout</h1>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <input type=\"submit\" name=\"checkout\" value=\"Checkout\">\n</form>\n\n<?php\nif (isset($_POST['checkout'])) {\n  // Process payment logic here\n}\n\n?>\n\n</body>\n</html>\n```"]}
