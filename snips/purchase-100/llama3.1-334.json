{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP, HTML, and MySQL:\n\n**Database Schema**\n\nFirst, let's assume we have a database schema with the following tables:\n\n`products`\n\n| Field | Type | Description |\n| --- | --- | --- |\n| id | int | Unique product ID |\n| name | varchar(255) | Product name |\n| price | decimal(10,2) | Product price |\n\n`orders`\n\n| Field | Type | Description |\n| --- | --- | --- |\n| id | int | Unique order ID |\n| customer_name | varchar(255) | Customer's name |\n| total_cost | decimal(10,2) | Total cost of the order |\n| status | enum('pending', 'shipped', 'delivered') | Order status |\n\n**PHP Code**\n\nCreate a new file named `purchase.php` and add the following code:\n```php\n<?php\n\n// Configuration\n$host = 'localhost';\n$username = 'your_username';\n$password = 'your_password';\n$dbname = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($host, $username, $password, $dbname);\n\nif (!$conn) {\n    die('Could not connect: ' . mysqli_error($conn));\n}\n\n// Function to add product to cart\nfunction add_product_to_cart($product_id, $quantity) {\n    // Get current session data (assuming it's stored in a file)\n    $session_data = $_SESSION['cart'];\n\n    if (!isset($session_data[$product_id])) {\n        $session_data[$product_id] = array('quantity' => 0);\n    }\n\n    $session_data[$product_id]['quantity'] += $quantity;\n\n    // Save updated session data\n    $_SESSION['cart'] = $session_data;\n}\n\n// Function to place order\nfunction place_order() {\n    // Get current session data (assuming it's stored in a file)\n    $session_data = $_SESSION['cart'];\n\n    // Calculate total cost\n    $total_cost = 0;\n    foreach ($session_data as $product_id => $item) {\n        $product_info = get_product_info($product_id);\n        $total_cost += $item['quantity'] * $product_info['price'];\n    }\n\n    // Insert new order into database\n    $order_data = array(\n        'customer_name' => $_POST['customer_name'],\n        'total_cost' => $total_cost,\n        'status' => 'pending'\n    );\n    mysqli_query($conn, \"INSERT INTO orders SET customer_name = '\" . $order_data['customer_name'] . \"', total_cost = \" . $order_data['total_cost'] . \", status = 'pending'\");\n\n    // Get new order ID\n    $order_id = mysqli_insert_id($conn);\n\n    // Insert order items into database\n    foreach ($session_data as $product_id => $item) {\n        $product_info = get_product_info($product_id);\n        mysqli_query($conn, \"INSERT INTO order_items SET order_id = \" . $order_id . \", product_id = '\" . $product_id . \"', quantity = \" . $item['quantity']);\n    }\n\n    // Clear cart session data\n    $_SESSION['cart'] = array();\n}\n\n// Function to get product info\nfunction get_product_info($product_id) {\n    $result = mysqli_query($conn, \"SELECT * FROM products WHERE id = '\" . $product_id . \"'\");\n    return mysqli_fetch_array($result);\n}\n\n?>\n```\n**HTML Code**\n\nCreate a new file named `index.html` and add the following code:\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase Functionality</title>\n</head>\n<body>\n    <h1>Purchase Functionality</h1>\n\n    <!-- Product list -->\n    <?php\n        $result = mysqli_query($conn, \"SELECT * FROM products\");\n        while ($row = mysqli_fetch_array($result)) {\n            echo '<div>';\n            echo '<p>' . $row['name'] . '</p>';\n            echo '<p>Price: ' . $row['price'] . '</p>';\n            echo '<button onclick=\"add_to_cart(' . $row['id'] . ')\">Add to cart</button>';\n            echo '</div>';\n        }\n    ?>\n\n    <!-- Cart -->\n    <?php\n        if (isset($_SESSION['cart'])) {\n            echo '<h2>Cart:</h2>';\n            foreach ($_SESSION['cart'] as $product_id => $item) {\n                $product_info = get_product_info($product_id);\n                echo '<p>' . $product_info['name'] . ' x' . $item['quantity'] . '</p>';\n            }\n        }\n    ?>\n\n    <!-- Order form -->\n    <?php\n        if (isset($_SESSION['cart'])) {\n            echo '<h2>Order:</h2>';\n            echo '<form method=\"post\">';\n            echo '<input type=\"text\" name=\"customer_name\" placeholder=\"Customer name\">';\n            echo '<button onclick=\"place_order()\">Place order</button>';\n            echo '</form>';\n        }\n    ?>\n</body>\n</html>\n```\n**JavaScript Code**\n\nCreate a new file named `script.js` and add the following code:\n```javascript\nfunction add_to_cart(product_id) {\n    var quantity = prompt(\"Enter quantity:\");\n    add_product_to_cart(product_id, parseInt(quantity));\n}\n\nfunction place_order() {\n    // Submit order form using AJAX or JavaScript\n}\n```\n**Usage**\n\n1. Create a new MySQL database and import the schema.\n2. Update the `purchase.php` file to match your database credentials.\n3. Run the `index.html` file in a web browser.\n4. Add products to cart by clicking on the \"Add to cart\" button.\n5. Place order by filling out the order form and clicking on the \"Place order\" button.\n\nNote: This is a basic example and you should consider implementing security measures such as user authentication, input validation, and error handling. Additionally, this code assumes that you have already set up a MySQL database with the specified schema.", "code_blocks": ["```php\n<?php\n\n// Configuration\n$host = 'localhost';\n$username = 'your_username';\n$password = 'your_password';\n$dbname = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($host, $username, $password, $dbname);\n\nif (!$conn) {\n    die('Could not connect: ' . mysqli_error($conn));\n}\n\n// Function to add product to cart\nfunction add_product_to_cart($product_id, $quantity) {\n    // Get current session data (assuming it's stored in a file)\n    $session_data = $_SESSION['cart'];\n\n    if (!isset($session_data[$product_id])) {\n        $session_data[$product_id] = array('quantity' => 0);\n    }\n\n    $session_data[$product_id]['quantity'] += $quantity;\n\n    // Save updated session data\n    $_SESSION['cart'] = $session_data;\n}\n\n// Function to place order\nfunction place_order() {\n    // Get current session data (assuming it's stored in a file)\n    $session_data = $_SESSION['cart'];\n\n    // Calculate total cost\n    $total_cost = 0;\n    foreach ($session_data as $product_id => $item) {\n        $product_info = get_product_info($product_id);\n        $total_cost += $item['quantity'] * $product_info['price'];\n    }\n\n    // Insert new order into database\n    $order_data = array(\n        'customer_name' => $_POST['customer_name'],\n        'total_cost' => $total_cost,\n        'status' => 'pending'\n    );\n    mysqli_query($conn, \"INSERT INTO orders SET customer_name = '\" . $order_data['customer_name'] . \"', total_cost = \" . $order_data['total_cost'] . \", status = 'pending'\");\n\n    // Get new order ID\n    $order_id = mysqli_insert_id($conn);\n\n    // Insert order items into database\n    foreach ($session_data as $product_id => $item) {\n        $product_info = get_product_info($product_id);\n        mysqli_query($conn, \"INSERT INTO order_items SET order_id = \" . $order_id . \", product_id = '\" . $product_id . \"', quantity = \" . $item['quantity']);\n    }\n\n    // Clear cart session data\n    $_SESSION['cart'] = array();\n}\n\n// Function to get product info\nfunction get_product_info($product_id) {\n    $result = mysqli_query($conn, \"SELECT * FROM products WHERE id = '\" . $product_id . \"'\");\n    return mysqli_fetch_array($result);\n}\n\n?>\n```", null, null]}
