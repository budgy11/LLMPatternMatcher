{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP:\n\n**purchase.php**\n```php\n<?php\n\n// Configuration settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product to cart\nfunction add_to_cart($product_id, $user_id) {\n    global $conn;\n    \n    // Check if product already exists in cart\n    $query = \"SELECT * FROM cart WHERE user_id = '$user_id' AND product_id = '$product_id'\";\n    $result = $conn->query($query);\n    \n    if ($result->num_rows > 0) {\n        return false; // Product already exists in cart\n    }\n    \n    // Add product to cart\n    $query = \"INSERT INTO cart (user_id, product_id, quantity) VALUES ('$user_id', '$product_id', '1')\";\n    $conn->query($query);\n    \n    return true;\n}\n\n// Function to update product quantity in cart\nfunction update_cart($product_id, $quantity, $user_id) {\n    global $conn;\n    \n    // Update product quantity\n    $query = \"UPDATE cart SET quantity = '$quantity' WHERE user_id = '$user_id' AND product_id = '$product_id'\";\n    $conn->query($query);\n}\n\n// Function to remove product from cart\nfunction remove_from_cart($product_id, $user_id) {\n    global $conn;\n    \n    // Remove product from cart\n    $query = \"DELETE FROM cart WHERE user_id = '$user_id' AND product_id = '$product_id'\";\n    $conn->query($query);\n}\n\n// Function to get cart contents\nfunction get_cart_contents($user_id) {\n    global $conn;\n    \n    // Get cart contents\n    $query = \"SELECT * FROM cart WHERE user_id = '$user_id'\";\n    $result = $conn->query($query);\n    \n    return $result;\n}\n\n// Function to calculate total cost of cart\nfunction calculate_total($cart_contents) {\n    $total = 0;\n    \n    foreach ($cart_contents as $item) {\n        $price = get_product_price($item['product_id']);\n        \n        // Calculate subtotal for each item\n        $subtotal = $item['quantity'] * $price;\n        \n        // Add to total\n        $total += $subtotal;\n    }\n    \n    return $total;\n}\n\n// Function to process payment (simplified example)\nfunction process_payment($cart_contents, $total) {\n    echo \"Payment processing...<br>\";\n    // Simulate payment processing...\n    sleep(2);\n    echo \"Payment processed successfully!<br>\";\n}\n\n?>\n```\n**index.php**\n```php\n<?php\n\n// Include purchase functionality file\nrequire_once 'purchase.php';\n\n// Initialize variables\n$user_id = $_SESSION['user_id'];\n$product_id = $_POST['product_id'];\n\n// Add product to cart\nif (add_to_cart($product_id, $user_id)) {\n    echo \"Product added to cart!<br>\";\n} else {\n    echo \"Product already exists in cart.<br>\";\n}\n\n// Get cart contents\n$cart_contents = get_cart_contents($user_id);\n\n// Calculate total cost of cart\n$total = calculate_total($cart_contents);\n\n// Display cart contents and total cost\necho \"Cart Contents:<br>\";\nforeach ($cart_contents as $item) {\n    echo \"Product: \" . $item['product_id'] . \"<br>\";\n}\n\necho \"Total Cost: $\" . $total . \"<br>\";\n\n?>\n```\n**checkout.php**\n```php\n<?php\n\n// Include purchase functionality file\nrequire_once 'purchase.php';\n\n// Initialize variables\n$user_id = $_SESSION['user_id'];\n\n// Get cart contents\n$cart_contents = get_cart_contents($user_id);\n\n// Calculate total cost of cart\n$total = calculate_total($cart_contents);\n\n// Process payment (simplified example)\nprocess_payment($cart_contents, $total);\n\n?>\n```\nNote that this is a very basic implementation and you should consider implementing additional security measures such as:\n\n* Validating user input\n* Sanitizing database queries\n* Implementing secure payment processing\n\nThis code assumes that the `get_product_price` function is defined elsewhere in your application. You will also need to modify the database schema to match the expected table structures.\n\nI hope this helps! Let me know if you have any questions or need further clarification.", "code_blocks": ["```php\n<?php\n\n// Configuration settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product to cart\nfunction add_to_cart($product_id, $user_id) {\n    global $conn;\n    \n    // Check if product already exists in cart\n    $query = \"SELECT * FROM cart WHERE user_id = '$user_id' AND product_id = '$product_id'\";\n    $result = $conn->query($query);\n    \n    if ($result->num_rows > 0) {\n        return false; // Product already exists in cart\n    }\n    \n    // Add product to cart\n    $query = \"INSERT INTO cart (user_id, product_id, quantity) VALUES ('$user_id', '$product_id', '1')\";\n    $conn->query($query);\n    \n    return true;\n}\n\n// Function to update product quantity in cart\nfunction update_cart($product_id, $quantity, $user_id) {\n    global $conn;\n    \n    // Update product quantity\n    $query = \"UPDATE cart SET quantity = '$quantity' WHERE user_id = '$user_id' AND product_id = '$product_id'\";\n    $conn->query($query);\n}\n\n// Function to remove product from cart\nfunction remove_from_cart($product_id, $user_id) {\n    global $conn;\n    \n    // Remove product from cart\n    $query = \"DELETE FROM cart WHERE user_id = '$user_id' AND product_id = '$product_id'\";\n    $conn->query($query);\n}\n\n// Function to get cart contents\nfunction get_cart_contents($user_id) {\n    global $conn;\n    \n    // Get cart contents\n    $query = \"SELECT * FROM cart WHERE user_id = '$user_id'\";\n    $result = $conn->query($query);\n    \n    return $result;\n}\n\n// Function to calculate total cost of cart\nfunction calculate_total($cart_contents) {\n    $total = 0;\n    \n    foreach ($cart_contents as $item) {\n        $price = get_product_price($item['product_id']);\n        \n        // Calculate subtotal for each item\n        $subtotal = $item['quantity'] * $price;\n        \n        // Add to total\n        $total += $subtotal;\n    }\n    \n    return $total;\n}\n\n// Function to process payment (simplified example)\nfunction process_payment($cart_contents, $total) {\n    echo \"Payment processing...<br>\";\n    // Simulate payment processing...\n    sleep(2);\n    echo \"Payment processed successfully!<br>\";\n}\n\n?>\n```", "```php\n<?php\n\n// Include purchase functionality file\nrequire_once 'purchase.php';\n\n// Initialize variables\n$user_id = $_SESSION['user_id'];\n$product_id = $_POST['product_id'];\n\n// Add product to cart\nif (add_to_cart($product_id, $user_id)) {\n    echo \"Product added to cart!<br>\";\n} else {\n    echo \"Product already exists in cart.<br>\";\n}\n\n// Get cart contents\n$cart_contents = get_cart_contents($user_id);\n\n// Calculate total cost of cart\n$total = calculate_total($cart_contents);\n\n// Display cart contents and total cost\necho \"Cart Contents:<br>\";\nforeach ($cart_contents as $item) {\n    echo \"Product: \" . $item['product_id'] . \"<br>\";\n}\n\necho \"Total Cost: $\" . $total . \"<br>\";\n\n?>\n```", "```php\n<?php\n\n// Include purchase functionality file\nrequire_once 'purchase.php';\n\n// Initialize variables\n$user_id = $_SESSION['user_id'];\n\n// Get cart contents\n$cart_contents = get_cart_contents($user_id);\n\n// Calculate total cost of cart\n$total = calculate_total($cart_contents);\n\n// Process payment (simplified example)\nprocess_payment($cart_contents, $total);\n\n?>\n```"]}
