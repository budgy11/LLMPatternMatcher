{"prompt": "Create a purchase cart functionality using php", "llm_output": "<think>\nOkay, I need to create a purchase cart functionality using PHP. Let me think about how to approach this.\n\nFirst, I know that a shopping cart allows users to add items, view them, and checkout. So, I'll need pages for each of these actions: adding items, viewing the cart, and checking out.\n\nI'll start by setting up the database. I'll create two tables: products and orders. The products table will store item details like ID, name, price, and description. The orders table will track each order with an ID, product ID, user ID, quantity, and purchase date.\n\nNext, I need to handle adding items to the cart. When a user clicks \"Add to Cart,\" it should add the product to their session. So, I'll use PHP sessions to store the cart data. Each time an item is added, I'll check if it's already in the session; if so, increment the quantity, else add it as new.\n\nFor viewing the cart, I'll display all items stored in the session. I'll loop through each item, show its details, and provide options to remove items or proceed to checkout.\n\nThe checkout page needs a form for user details like name and email. When submitted, I'll capture this information along with the cart contents. I'll insert each order into the database, linking it to the user's details. After saving, I'll clear the session to reset the cart.\n\nI should also ensure security by sanitizing inputs and using prepared statements to prevent SQL injection. Error handling is important too; if something goes wrong during submission, users should be informed.\n\nFinally, testing each part step by step will help catch any issues early. Starting with connecting to the database, then adding products, ensuring items are added correctly to the cart, and successfully processing orders.\n\nI might have missed some details, like displaying error messages or handling cases where a product isn't found. But overall, this approach should cover the main functionality needed for a basic shopping cart.\n</think>\n\nTo create a purchase cart functionality using PHP, we'll follow these steps:\n\n1. **Set Up Database**: Create tables for products and orders.\n2. **Display Products**: Show available items to users.\n3. **Add Items to Cart**: Store selected items in the session.\n4. **View Cart**: Display items added to the cart.\n5. **Checkout Process**: Capture user details and finalize the purchase.\n\n### Step 1: Set Up Database\n\nCreate a database named `shopping_cart` with two tables:\n\n**products Table**\n```sql\nCREATE TABLE products (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    price DECIMAL(10, 2) NOT NULL,\n    description TEXT\n);\n```\n\n**orders Table**\n```sql\nCREATE TABLE orders (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    product_id INT NOT NULL,\n    user_name VARCHAR(255),\n    user_email VARCHAR(255),\n    quantity INT NOT NULL,\n    purchase_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n### Step 2: Connect to Database\n\nCreate a `config.php` file:\n\n```php\n<?php\n$host = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"shopping_cart\";\n\n$conn = mysqli_connect($host, $username, $password, $dbname);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n?>\n```\n\n### Step 3: Display Products\n\nCreate `index.php`:\n\n```php\n<?php include 'config.php'; ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Shopping Cart</title>\n    <style>\n        /* Add your CSS styles here */\n    </style>\n</head>\n<body>\n    <h1>Welcome to Our Store</h1>\n    \n    <?php\n    $sql = \"SELECT * FROM products\";\n    $result = mysqli_query($conn, $sql);\n    \n    if (mysqli_num_rows($result) > 0) {\n        while ($row = mysqli_fetch_assoc($result)) {\n            echo \"<div class='product'>\";\n            echo \"<h2>\" . $row['name'] . \"</h2>\";\n            echo \"<p>Price: $\" . number_format($row['price'], 2) . \"</p>\";\n            echo \"<p>Description: \" . $row['description'] . \"</p>\";\n            echo \"<form action='add_to_cart.php' method='post'>\";\n            echo \"<input type='hidden' name='product_id' value='\" . $row['id'] . \"'>\";\n            echo \"<button type='submit'>Add to Cart</button>\";\n            echo \"</form>\";\n            echo \"</div>\";\n        }\n    } else {\n        echo \"No products available.\";\n    }\n    ?>\n\n    <p><a href=\"view_cart.php\">View Cart</a></p>\n</body>\n</html>\n```\n\n### Step 4: Add Items to Cart\n\nCreate `add_to_cart.php`:\n\n```php\n<?php\nsession_start();\ninclude 'config.php';\n\nif (isset($_POST['product_id'])) {\n    $product_id = $_POST['product_id'];\n    \n    // Check if product exists\n    $sql = \"SELECT * FROM products WHERE id = ?\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"i\", $product_id);\n    mysqli_stmt_execute($stmt);\n    $result = mysqli_stmt_get_result($stmt);\n    \n    if (mysqli_num_rows($result) == 1) {\n        $product = mysqli_fetch_assoc($result);\n        \n        // Add to cart\n        if (!isset($_SESSION['cart'][$product_id])) {\n            $_SESSION['cart'][$product_id] = array(\n                'name' => $product['name'],\n                'price' => $product['price'],\n                'quantity' => 1\n            );\n        } else {\n            $_SESSION['cart'][$product_id]['quantity']++;\n        }\n    }\n}\n\nheader(\"Location: index.php\");\nexit();\n?>\n```\n\n### Step 5: View Cart\n\nCreate `view_cart.php`:\n\n```php\n<?php session_start(); ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Shopping Cart</title>\n</head>\n<body>\n    <h1>Your Shopping Cart</h1>\n    \n    <?php if (!empty($_SESSION['cart'])): ?>\n        <table border=\"1\">\n            <tr>\n                <th>Item Name</th>\n                <th>Price</th>\n                <th>Quantity</th>\n                <th>Total</th>\n                <th>Action</th>\n            </tr>\n            \n            <?php\n            $total = 0;\n            foreach ($_SESSION['cart'] as $id => $item): \n                $total += $item['price'] * $item['quantity'];\n            ?>\n                <tr>\n                    <td><?php echo $item['name']; ?></td>\n                    <td>$<?php echo number_format($item['price'], 2); ?></td>\n                    <td><?php echo $item['quantity']; ?></td>\n                    <td>$<?php echo number_format($item['price'] * $item['quantity'], 2); ?></td>\n                    <td><a href=\"remove_from_cart.php?id=<?php echo $id; ?>\">Remove</a></td>\n                </tr>\n            <?php endforeach; ?>\n        </table>\n        \n        <h3>Total: $<?php echo number_format($total, 2); ?></h3>\n        <form action=\"checkout.php\" method=\"post\">\n            <p>Proceed to Checkout</p>\n            <button type=\"submit\">Checkout</button>\n        </form>\n    <?php else: ?>\n        <p>Your cart is empty.</p>\n        <a href=\"index.php\">Go back to shopping</a>\n    <?php endif; ?>\n\n    <p><a href=\"index.php\">Continue Shopping</a></p>\n</body>\n</html>\n```\n\n### Step 6: Remove Items from Cart\n\nCreate `remove_from_cart.php`:\n\n```php\n<?php\nsession_start();\n\nif (isset($_GET['id'])) {\n    $product_id = $_GET['id'];\n    \n    if (!empty($_SESSION['cart'][$product_id])) {\n        unset($_SESSION['cart'][$product_id]);\n    }\n}\n\nheader(\"Location: view_cart.php\");\nexit();\n?>\n```\n\n### Step 7: Checkout Process\n\nCreate `checkout.php`:\n\n```php\n<?php session_start(); include 'config.php'; ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Checkout</title>\n</head>\n<body>\n    <?php if (!empty($_SESSION['cart'])): ?>\n        <h1>Checkout</h1>\n        \n        <form action=\"process_order.php\" method=\"post\">\n            <p><label>Your Name:</label><br>\n            <input type=\"text\" name=\"name\" required></p>\n            \n            <p><label>Email:</label><br>\n            <input type=\"email\" name=\"email\" required></p>\n            \n            <button type=\"submit\">Place Order</button>\n        </form>\n    <?php else: ?>\n        <p>Your cart is empty.</p>\n        <a href=\"index.php\">Go back to shopping</a>\n    <?php endif; ?>\n</body>\n</html>\n```\n\n### Step 8: Process Order\n\nCreate `process_order.php`:\n\n```php\n<?php session_start(); include 'config.php'; ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Order Confirmation</title>\n</head>\n<body>\n    <?php if (!empty($_SESSION['cart'])):\n        $name = $_POST['name'];\n        $email = $_POST['email'];\n\n        foreach ($_SESSION['cart'] as $id => $item):\n            $sql = \"INSERT INTO orders (product_id, user_name, user_email, quantity) \n                    VALUES (?, ?, ?, ?)\";\n            \n            $stmt = mysqli_prepare($conn, $sql);\n            mysqli_stmt_bind_param($stmt, \"isss\", $id, $name, $email, $item['quantity']);\n            mysqli_stmt_execute($stmt);\n        endforeach;\n\n        unset($_SESSION['cart']);\n    ?>\n\n        <h2>Thank you for your order!</h2>\n        <p>Your order has been received and will be processed shortly.</p>\n        <a href=\"index.php\">Continue Shopping</a>\n\n    <?php else: ?>\n        <p>Your cart is empty.</p>\n        <a href=\"index.php\">Go back to shopping</a>\n    <?php endif; ?>\n\n<?php mysqli_close($conn); ?>\n</body>\n</html>\n```\n\n### Usage Instructions\n\n1. **Add Products**: Insert products into the `products` table.\n2. **Run Application**: Start from `index.php`.\n3. **Test Features**:\n   - Add items to cart.\n   - View cart contents.\n   - Remove items.\n   - Proceed to checkout and submit order.\n\nThis implementation provides a basic shopping cart functionality with essential features. You can enhance it by adding user authentication, payment integration, and more styling.", "code_blocks": [null, null, "```php\n<?php\n$host = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"shopping_cart\";\n\n$conn = mysqli_connect($host, $username, $password, $dbname);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n?>\n```", "```php\n<?php include 'config.php'; ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Shopping Cart</title>\n    <style>\n        /* Add your CSS styles here */\n    </style>\n</head>\n<body>\n    <h1>Welcome to Our Store</h1>\n    \n    <?php\n    $sql = \"SELECT * FROM products\";\n    $result = mysqli_query($conn, $sql);\n    \n    if (mysqli_num_rows($result) > 0) {\n        while ($row = mysqli_fetch_assoc($result)) {\n            echo \"<div class='product'>\";\n            echo \"<h2>\" . $row['name'] . \"</h2>\";\n            echo \"<p>Price: $\" . number_format($row['price'], 2) . \"</p>\";\n            echo \"<p>Description: \" . $row['description'] . \"</p>\";\n            echo \"<form action='add_to_cart.php' method='post'>\";\n            echo \"<input type='hidden' name='product_id' value='\" . $row['id'] . \"'>\";\n            echo \"<button type='submit'>Add to Cart</button>\";\n            echo \"</form>\";\n            echo \"</div>\";\n        }\n    } else {\n        echo \"No products available.\";\n    }\n    ?>\n\n    <p><a href=\"view_cart.php\">View Cart</a></p>\n</body>\n</html>\n```", "```php\n<?php\nsession_start();\ninclude 'config.php';\n\nif (isset($_POST['product_id'])) {\n    $product_id = $_POST['product_id'];\n    \n    // Check if product exists\n    $sql = \"SELECT * FROM products WHERE id = ?\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"i\", $product_id);\n    mysqli_stmt_execute($stmt);\n    $result = mysqli_stmt_get_result($stmt);\n    \n    if (mysqli_num_rows($result) == 1) {\n        $product = mysqli_fetch_assoc($result);\n        \n        // Add to cart\n        if (!isset($_SESSION['cart'][$product_id])) {\n            $_SESSION['cart'][$product_id] = array(\n                'name' => $product['name'],\n                'price' => $product['price'],\n                'quantity' => 1\n            );\n        } else {\n            $_SESSION['cart'][$product_id]['quantity']++;\n        }\n    }\n}\n\nheader(\"Location: index.php\");\nexit();\n?>\n```", "```php\n<?php session_start(); ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Shopping Cart</title>\n</head>\n<body>\n    <h1>Your Shopping Cart</h1>\n    \n    <?php if (!empty($_SESSION['cart'])): ?>\n        <table border=\"1\">\n            <tr>\n                <th>Item Name</th>\n                <th>Price</th>\n                <th>Quantity</th>\n                <th>Total</th>\n                <th>Action</th>\n            </tr>\n            \n            <?php\n            $total = 0;\n            foreach ($_SESSION['cart'] as $id => $item): \n                $total += $item['price'] * $item['quantity'];\n            ?>\n                <tr>\n                    <td><?php echo $item['name']; ?></td>\n                    <td>$<?php echo number_format($item['price'], 2); ?></td>\n                    <td><?php echo $item['quantity']; ?></td>\n                    <td>$<?php echo number_format($item['price'] * $item['quantity'], 2); ?></td>\n                    <td><a href=\"remove_from_cart.php?id=<?php echo $id; ?>\">Remove</a></td>\n                </tr>\n            <?php endforeach; ?>\n        </table>\n        \n        <h3>Total: $<?php echo number_format($total, 2); ?></h3>\n        <form action=\"checkout.php\" method=\"post\">\n            <p>Proceed to Checkout</p>\n            <button type=\"submit\">Checkout</button>\n        </form>\n    <?php else: ?>\n        <p>Your cart is empty.</p>\n        <a href=\"index.php\">Go back to shopping</a>\n    <?php endif; ?>\n\n    <p><a href=\"index.php\">Continue Shopping</a></p>\n</body>\n</html>\n```", "```php\n<?php\nsession_start();\n\nif (isset($_GET['id'])) {\n    $product_id = $_GET['id'];\n    \n    if (!empty($_SESSION['cart'][$product_id])) {\n        unset($_SESSION['cart'][$product_id]);\n    }\n}\n\nheader(\"Location: view_cart.php\");\nexit();\n?>\n```", "```php\n<?php session_start(); include 'config.php'; ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Checkout</title>\n</head>\n<body>\n    <?php if (!empty($_SESSION['cart'])): ?>\n        <h1>Checkout</h1>\n        \n        <form action=\"process_order.php\" method=\"post\">\n            <p><label>Your Name:</label><br>\n            <input type=\"text\" name=\"name\" required></p>\n            \n            <p><label>Email:</label><br>\n            <input type=\"email\" name=\"email\" required></p>\n            \n            <button type=\"submit\">Place Order</button>\n        </form>\n    <?php else: ?>\n        <p>Your cart is empty.</p>\n        <a href=\"index.php\">Go back to shopping</a>\n    <?php endif; ?>\n</body>\n</html>\n```", "```php\n<?php session_start(); include 'config.php'; ?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Order Confirmation</title>\n</head>\n<body>\n    <?php if (!empty($_SESSION['cart'])):\n        $name = $_POST['name'];\n        $email = $_POST['email'];\n\n        foreach ($_SESSION['cart'] as $id => $item):\n            $sql = \"INSERT INTO orders (product_id, user_name, user_email, quantity) \n                    VALUES (?, ?, ?, ?)\";\n            \n            $stmt = mysqli_prepare($conn, $sql);\n            mysqli_stmt_bind_param($stmt, \"isss\", $id, $name, $email, $item['quantity']);\n            mysqli_stmt_execute($stmt);\n        endforeach;\n\n        unset($_SESSION['cart']);\n    ?>\n\n        <h2>Thank you for your order!</h2>\n        <p>Your order has been received and will be processed shortly.</p>\n        <a href=\"index.php\">Continue Shopping</a>\n\n    <?php else: ?>\n        <p>Your cart is empty.</p>\n        <a href=\"index.php\">Go back to shopping</a>\n    <?php endif; ?>\n\n<?php mysqli_close($conn); ?>\n</body>\n</html>\n```"]}
