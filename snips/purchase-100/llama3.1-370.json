{"prompt": "Create a purchase functionality using php", "llm_output": "Here's an example of how you can create a simple purchase functionality in PHP, including user authentication and database interactions. This will include:\n\n1. User registration\n2. User login\n3. Product listing\n4. Adding products to cart\n5. Checking out (purchase)\n\nFor this example, we'll use the following technologies:\n\n* PHP 7.x for server-side scripting\n* MySQL for storing data\n* HTML/CSS for user interface\n\n**Database Schema**\n\nWe need a database schema to store users, products, and orders.\n\n```sql\nCREATE TABLE Users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    username VARCHAR(50) NOT NULL,\n    email VARCHAR(100) NOT NULL,\n    password VARCHAR(255) NOT NULL\n);\n\nCREATE TABLE Products (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(100) NOT NULL,\n    description TEXT,\n    price DECIMAL(10,2)\n);\n\nCREATE TABLE Cart (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    user_id INT,\n    product_id INT,\n    quantity INT,\n    FOREIGN KEY (user_id) REFERENCES Users(id),\n    FOREIGN KEY (product_id) REFERENCES Products(id)\n);\n\nCREATE TABLE Orders (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    user_id INT,\n    order_date DATE,\n    total DECIMAL(10,2),\n    FOREIGN KEY (user_id) REFERENCES Users(id)\n);\n```\n\n**PHP Code**\n\nWe'll create the following PHP files:\n\n* `register.php`: User registration\n* `login.php`: User login\n* `product_list.php`: Product listing\n* `cart.php`: Cart functionality\n* `checkout.php`: Purchase functionality\n\n### register.php\n```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['submit'])) {\n    $username = $_POST['username'];\n    $email = $_POST['email'];\n    $password = $_POST['password'];\n\n    // Hash password for security\n    $hashedPassword = hash('sha256', $password);\n\n    $sql = \"INSERT INTO Users (username, email, password) VALUES ('$username', '$email', '$hashedPassword')\";\n    mysqli_query($conn, $sql);\n\n    echo 'User created successfully!';\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"POST\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Email:</label>\n    <input type=\"email\" name=\"email\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <button type=\"submit\" name=\"submit\">Register</button>\n</form>\n```\n\n### login.php\n```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['login'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Hash password for security\n    $hashedPassword = hash('sha256', $password);\n\n    $sql = \"SELECT * FROM Users WHERE username='$username' AND password='$hashedPassword'\";\n    $result = mysqli_query($conn, $sql);\n\n    if (mysqli_num_rows($result) > 0) {\n        while ($row = mysqli_fetch_assoc($result)) {\n            $_SESSION['user_id'] = $row['id'];\n        }\n        echo 'Logged in successfully!';\n    } else {\n        echo 'Invalid credentials';\n    }\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"POST\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <button type=\"submit\" name=\"login\">Login</button>\n</form>\n```\n\n### product_list.php\n```php\n<?php\nrequire_once 'dbconnect.php';\n\n$sql = \"SELECT * FROM Products\";\n$result = mysqli_query($conn, $sql);\n\n?>\n\n<table>\n    <?php while ($row = mysqli_fetch_assoc($result)) { ?>\n        <tr>\n            <td><?php echo $row['name']; ?></td>\n            <td><?php echo $row['price']; ?></td>\n            <td><button>Add to Cart</button></td>\n        </tr>\n    <?php } ?>\n</table>\n```\n\n### cart.php\n```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['add_to_cart'])) {\n    $product_id = $_POST['product_id'];\n    $user_id = $_SESSION['user_id'];\n\n    $sql = \"INSERT INTO Cart (user_id, product_id) VALUES ('$user_id', '$product_id')\";\n    mysqli_query($conn, $sql);\n\n    echo 'Product added to cart!';\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"POST\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['id']; ?>\">\n    <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n</form>\n\n<table>\n    <?php\n    $sql = \"SELECT * FROM Cart WHERE user_id=\".$_SESSION['user_id'];\n    $result = mysqli_query($conn, $sql);\n    while ($row = mysqli_fetch_assoc($result)) {\n        ?>\n        <tr>\n            <td><?php echo $row['product_id']; ?></td>\n            <td><button>Remove from Cart</button></td>\n        </tr>\n    <?php } ?>\n</table>\n```\n\n### checkout.php\n```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['checkout'])) {\n    $user_id = $_SESSION['user_id'];\n    $total = 0;\n\n    // Calculate total cost of items in cart\n    $sql = \"SELECT * FROM Cart WHERE user_id='$user_id'\";\n    $result = mysqli_query($conn, $sql);\n\n    while ($row = mysqli_fetch_assoc($result)) {\n        $product_id = $row['product_id'];\n        $quantity = 1;\n\n        // Calculate cost of each item\n        $sql2 = \"SELECT price FROM Products WHERE id='$product_id'\";\n        $result2 = mysqli_query($conn, $sql2);\n        while ($row2 = mysqli_fetch_assoc($result2)) {\n            $price = $row2['price'];\n            $total += $price * $quantity;\n        }\n    }\n\n    // Insert order into database\n    $sql3 = \"INSERT INTO Orders (user_id, total) VALUES ('$user_id', '$total')\";\n    mysqli_query($conn, $sql3);\n\n    echo 'Order placed successfully!';\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"POST\">\n    <button type=\"submit\" name=\"checkout\">Checkout</button>\n</form>\n\n<p>Total: <?php echo $total; ?></p>\n```\n\nThis is a basic example of how you can create a purchase functionality using PHP and MySQL. This code includes user registration, login, product listing, cart functionality, and checkout process.\n\nNote that this code does not include any error handling or security measures, such as validating form inputs and preventing SQL injection attacks. You should always follow best practices for coding and ensure the security of your database.\n\nAlso, please make sure to replace `dbconnect.php` with your actual database connection script.", "code_blocks": [null, "```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['submit'])) {\n    $username = $_POST['username'];\n    $email = $_POST['email'];\n    $password = $_POST['password'];\n\n    // Hash password for security\n    $hashedPassword = hash('sha256', $password);\n\n    $sql = \"INSERT INTO Users (username, email, password) VALUES ('$username', '$email', '$hashedPassword')\";\n    mysqli_query($conn, $sql);\n\n    echo 'User created successfully!';\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"POST\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Email:</label>\n    <input type=\"email\" name=\"email\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <button type=\"submit\" name=\"submit\">Register</button>\n</form>\n```", "```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['login'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Hash password for security\n    $hashedPassword = hash('sha256', $password);\n\n    $sql = \"SELECT * FROM Users WHERE username='$username' AND password='$hashedPassword'\";\n    $result = mysqli_query($conn, $sql);\n\n    if (mysqli_num_rows($result) > 0) {\n        while ($row = mysqli_fetch_assoc($result)) {\n            $_SESSION['user_id'] = $row['id'];\n        }\n        echo 'Logged in successfully!';\n    } else {\n        echo 'Invalid credentials';\n    }\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"POST\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <button type=\"submit\" name=\"login\">Login</button>\n</form>\n```", "```php\n<?php\nrequire_once 'dbconnect.php';\n\n$sql = \"SELECT * FROM Products\";\n$result = mysqli_query($conn, $sql);\n\n?>\n\n<table>\n    <?php while ($row = mysqli_fetch_assoc($result)) { ?>\n        <tr>\n            <td><?php echo $row['name']; ?></td>\n            <td><?php echo $row['price']; ?></td>\n            <td><button>Add to Cart</button></td>\n        </tr>\n    <?php } ?>\n</table>\n```", "```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['add_to_cart'])) {\n    $product_id = $_POST['product_id'];\n    $user_id = $_SESSION['user_id'];\n\n    $sql = \"INSERT INTO Cart (user_id, product_id) VALUES ('$user_id', '$product_id')\";\n    mysqli_query($conn, $sql);\n\n    echo 'Product added to cart!';\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"POST\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['id']; ?>\">\n    <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n</form>\n\n<table>\n    <?php\n    $sql = \"SELECT * FROM Cart WHERE user_id=\".$_SESSION['user_id'];\n    $result = mysqli_query($conn, $sql);\n    while ($row = mysqli_fetch_assoc($result)) {\n        ?>\n        <tr>\n            <td><?php echo $row['product_id']; ?></td>\n            <td><button>Remove from Cart</button></td>\n        </tr>\n    <?php } ?>\n</table>\n```", "```php\n<?php\nrequire_once 'dbconnect.php';\n\nif (isset($_POST['checkout'])) {\n    $user_id = $_SESSION['user_id'];\n    $total = 0;\n\n    // Calculate total cost of items in cart\n    $sql = \"SELECT * FROM Cart WHERE user_id='$user_id'\";\n    $result = mysqli_query($conn, $sql);\n\n    while ($row = mysqli_fetch_assoc($result)) {\n        $product_id = $row['product_id'];\n        $quantity = 1;\n\n        // Calculate cost of each item\n        $sql2 = \"SELECT price FROM Products WHERE id='$product_id'\";\n        $result2 = mysqli_query($conn, $sql2);\n        while ($row2 = mysqli_fetch_assoc($result2)) {\n            $price = $row2['price'];\n            $total += $price * $quantity;\n        }\n    }\n\n    // Insert order into database\n    $sql3 = \"INSERT INTO Orders (user_id, total) VALUES ('$user_id', '$total')\";\n    mysqli_query($conn, $sql3);\n\n    echo 'Order placed successfully!';\n}\n\n?>\n\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"POST\">\n    <button type=\"submit\" name=\"checkout\">Checkout</button>\n</form>\n\n<p>Total: <?php echo $total; ?></p>\n```"]}
