{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a simple \"add to cart\" and \"checkout\" functionality using PHP. This will be based on a basic e-commerce concept where users can add products to their cart and then checkout.\n\n**Database Schema:**\n\nFor this example, we'll assume that you have the following tables in your database:\n\n1. `products` table:\n\t* `id`: product ID\n\t* `name`: product name\n\t* `price`: product price\n2. `cart` table:\n\t* `id`: cart ID\n\t* `user_id`: user ID (assuming you have a separate `users` table)\n\t* `product_id`: product ID\n\t* `quantity`: quantity of the product in the cart\n\n**PHP Code:**\n\n**1. Configuration and Database Connection**\n```php\n// config.php\n\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n```\n**2. Product Display and Add to Cart**\n```php\n// products.php\n\nrequire_once 'config.php';\n\n// Retrieve products from database\n$query = \"SELECT * FROM products\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    while($row = $result->fetch_assoc()) {\n        echo \"\n            <div>\n                <h2>\" . $row[\"name\"] . \"</h2>\n                <p>Price: $\" . $row[\"price\"] . \"</p>\n                <button id='add-to-cart' data-id='\" . $row[\"id\"] . \"'>Add to Cart</button>\n            </div>\n        \";\n    }\n} else {\n    echo \"No products found.\";\n}\n\n// Add event listener for add to cart button\n$(document).ready(function() {\n    $('#add-to-cart').on('click', function() {\n        var productId = $(this).data('id');\n        var quantity = 1;\n        \n        // Insert product into cart table\n        $query = \"INSERT INTO cart (user_id, product_id, quantity) VALUES (1, ?, ?)\";\n        $stmt = $conn->prepare($query);\n        $stmt->bind_param(\"ii\", productId, quantity);\n        $stmt->execute();\n        \n        echo \"Product added to cart!\";\n    });\n});\n```\n**3. Cart Display and Checkout**\n```php\n// cart.php\n\nrequire_once 'config.php';\n\n// Retrieve products from cart table\n$query = \"SELECT * FROM cart WHERE user_id = 1\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    while($row = $result->fetch_assoc()) {\n        echo \"\n            <div>\n                <h2>\" . $row[\"product_name\"] . \"</h2>\n                <p>Quantity: \" . $row[\"quantity\"] . \"</p>\n                <button id='remove-from-cart' data-id='\" . $row[\"id\"] . \"'>Remove from Cart</button>\n            </div>\n        \";\n    }\n} else {\n    echo \"No products in cart.\";\n}\n\n// Add event listener for remove from cart button\n$(document).ready(function() {\n    $('#remove-from-cart').on('click', function() {\n        var cartId = $(this).data('id');\n        \n        // Delete product from cart table\n        $query = \"DELETE FROM cart WHERE id = ?\";\n        $stmt = $conn->prepare($query);\n        $stmt->bind_param(\"i\", cartId);\n        $stmt->execute();\n        \n        echo \"Product removed from cart!\";\n    });\n});\n\n// Checkout button\necho \"\n    <button id='checkout'>Checkout</button>\n\";\n\n$(document).ready(function() {\n    $('#checkout').on('click', function() {\n        // Retrieve all products in cart and calculate total price\n        $query = \"SELECT product_id, quantity FROM cart WHERE user_id = 1\";\n        $result = $conn->query($query);\n        \n        $totalPrice = 0;\n        while($row = $result->fetch_assoc()) {\n            $priceQuery = \"SELECT price FROM products WHERE id = ?\";\n            $priceResult = $conn->prepare($priceQuery);\n            $priceResult->bind_param(\"i\", $row[\"product_id\"]);\n            $priceResult->execute();\n            $priceRow = $priceResult->get_result()->fetch_assoc();\n            $totalPrice += ($priceRow[\"price\"] * $row[\"quantity\"]);\n        }\n        \n        // Display total price and confirm checkout\n        echo \"\n            <p>Total Price: $\" . $totalPrice . \"</p>\n            <button id='confirm-checkout'>Confirm Checkout</button>\n        \";\n    });\n});\n```\nThis is a basic example of how you can implement a purchase functionality using PHP. Please note that this is just a starting point and you should consider implementing additional features, such as user authentication, payment processing, and error handling.\n\n**Example Use Cases:**\n\n1. User adds product to cart by clicking \"Add to Cart\" button.\n2. User views products in their cart by visiting the cart page.\n3. User removes product from cart by clicking \"Remove from Cart\" button.\n4. User checks out by clicking \"Checkout\" button, which calculates total price and displays it for confirmation.\n\n**Commit Messages:**\n\n* `feat: add purchase functionality`\n* `fix: update database schema to include cart table`\n\nNote that this is a simplified example and you should consider implementing additional features and security measures to ensure a robust and secure e-commerce application.", "code_blocks": ["```php\n// config.php\n\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n```", "```php\n// products.php\n\nrequire_once 'config.php';\n\n// Retrieve products from database\n$query = \"SELECT * FROM products\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    while($row = $result->fetch_assoc()) {\n        echo \"\n            <div>\n                <h2>\" . $row[\"name\"] . \"</h2>\n                <p>Price: $\" . $row[\"price\"] . \"</p>\n                <button id='add-to-cart' data-id='\" . $row[\"id\"] . \"'>Add to Cart</button>\n            </div>\n        \";\n    }\n} else {\n    echo \"No products found.\";\n}\n\n// Add event listener for add to cart button\n$(document).ready(function() {\n    $('#add-to-cart').on('click', function() {\n        var productId = $(this).data('id');\n        var quantity = 1;\n        \n        // Insert product into cart table\n        $query = \"INSERT INTO cart (user_id, product_id, quantity) VALUES (1, ?, ?)\";\n        $stmt = $conn->prepare($query);\n        $stmt->bind_param(\"ii\", productId, quantity);\n        $stmt->execute();\n        \n        echo \"Product added to cart!\";\n    });\n});\n```", "```php\n// cart.php\n\nrequire_once 'config.php';\n\n// Retrieve products from cart table\n$query = \"SELECT * FROM cart WHERE user_id = 1\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    while($row = $result->fetch_assoc()) {\n        echo \"\n            <div>\n                <h2>\" . $row[\"product_name\"] . \"</h2>\n                <p>Quantity: \" . $row[\"quantity\"] . \"</p>\n                <button id='remove-from-cart' data-id='\" . $row[\"id\"] . \"'>Remove from Cart</button>\n            </div>\n        \";\n    }\n} else {\n    echo \"No products in cart.\";\n}\n\n// Add event listener for remove from cart button\n$(document).ready(function() {\n    $('#remove-from-cart').on('click', function() {\n        var cartId = $(this).data('id');\n        \n        // Delete product from cart table\n        $query = \"DELETE FROM cart WHERE id = ?\";\n        $stmt = $conn->prepare($query);\n        $stmt->bind_param(\"i\", cartId);\n        $stmt->execute();\n        \n        echo \"Product removed from cart!\";\n    });\n});\n\n// Checkout button\necho \"\n    <button id='checkout'>Checkout</button>\n\";\n\n$(document).ready(function() {\n    $('#checkout').on('click', function() {\n        // Retrieve all products in cart and calculate total price\n        $query = \"SELECT product_id, quantity FROM cart WHERE user_id = 1\";\n        $result = $conn->query($query);\n        \n        $totalPrice = 0;\n        while($row = $result->fetch_assoc()) {\n            $priceQuery = \"SELECT price FROM products WHERE id = ?\";\n            $priceResult = $conn->prepare($priceQuery);\n            $priceResult->bind_param(\"i\", $row[\"product_id\"]);\n            $priceResult->execute();\n            $priceRow = $priceResult->get_result()->fetch_assoc();\n            $totalPrice += ($priceRow[\"price\"] * $row[\"quantity\"]);\n        }\n        \n        // Display total price and confirm checkout\n        echo \"\n            <p>Total Price: $\" . $totalPrice . \"</p>\n            <button id='confirm-checkout'>Confirm Checkout</button>\n        \";\n    });\n});\n```"]}
