{"prompt": "Create a purchase functionality using php", "llm_output": "Here's an example of how you can create a basic purchase functionality in PHP. This will include creating a form for the user to input their details, validating the data, and then inserting it into a database.\n\n**Note:** This is just a simplified version and does not cover all potential edge cases. You should always validate and sanitize any user input before processing it.\n\n### Database Setup\n\nFirstly, you need to create a database table for purchases. Here's an example SQL query:\n\n```sql\nCREATE TABLE purchases (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(255),\n    email VARCHAR(255),\n    product_name VARCHAR(255),\n    quantity INT,\n    price DECIMAL(10, 2)\n);\n```\n\n### PHP Code\n\nLet's assume we have a file named `purchase.php` in our project directory. Here's the code:\n\n```php\n<?php\n\n// Configuration for database connection\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Check if form has been submitted\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n\n    // Get posted data\n    $name = $_POST['name'];\n    $email = $_POST['email'];\n    $product_name = $_POST['product_name'];\n    $quantity = $_POST['quantity'];\n    $price = $_POST['price'];\n\n    // Validate input\n    if (empty($name) || empty($email) || empty($product_name) || empty($quantity) || empty($price)) {\n        echo \"Please fill out all fields.\";\n    } elseif (!is_numeric($quantity)) {\n        echo \"Invalid quantity.\";\n    } elseif (!is_numeric($price)) {\n        echo \"Invalid price.\";\n    } else {\n\n        // Insert data into database\n        $query = \"INSERT INTO purchases (name, email, product_name, quantity, price)\n                  VALUES ('$name', '$email', '$product_name', '$quantity', '$price')\";\n        if ($conn->query($query) === TRUE) {\n            echo \"Purchase successful!\";\n        } else {\n            echo \"Error: \" . $conn->error;\n        }\n    }\n\n    // Close database connection\n    $conn->close();\n}\n\n?>\n\n<!-- Form for user input -->\n<form action=\"\" method=\"post\">\n    <label for=\"name\">Name:</label>\n    <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n\n    <label for=\"product_name\">Product Name:</label>\n    <input type=\"text\" id=\"product_name\" name=\"product_name\"><br><br>\n\n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n\n    <label for=\"price\">Price:</label>\n    <input type=\"number\" id=\"price\" name=\"price\"><br><br>\n\n    <input type=\"submit\" value=\"Purchase\">\n</form>\n```\n\nThis code establishes a connection to the database, validates user input from the form, and inserts it into the `purchases` table. If there's an error with the database query, it will display the error message.\n\n### Example Use Case\n\nWhen you open the `purchase.php` file in your web browser, you should see a form for the user to input their details. After filling out the form and submitting it, if everything is valid, it should insert the data into the database with a success message.", "code_blocks": [null, "```php\n<?php\n\n// Configuration for database connection\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Check if form has been submitted\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n\n    // Get posted data\n    $name = $_POST['name'];\n    $email = $_POST['email'];\n    $product_name = $_POST['product_name'];\n    $quantity = $_POST['quantity'];\n    $price = $_POST['price'];\n\n    // Validate input\n    if (empty($name) || empty($email) || empty($product_name) || empty($quantity) || empty($price)) {\n        echo \"Please fill out all fields.\";\n    } elseif (!is_numeric($quantity)) {\n        echo \"Invalid quantity.\";\n    } elseif (!is_numeric($price)) {\n        echo \"Invalid price.\";\n    } else {\n\n        // Insert data into database\n        $query = \"INSERT INTO purchases (name, email, product_name, quantity, price)\n                  VALUES ('$name', '$email', '$product_name', '$quantity', '$price')\";\n        if ($conn->query($query) === TRUE) {\n            echo \"Purchase successful!\";\n        } else {\n            echo \"Error: \" . $conn->error;\n        }\n    }\n\n    // Close database connection\n    $conn->close();\n}\n\n?>\n\n<!-- Form for user input -->\n<form action=\"\" method=\"post\">\n    <label for=\"name\">Name:</label>\n    <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n\n    <label for=\"product_name\">Product Name:</label>\n    <input type=\"text\" id=\"product_name\" name=\"product_name\"><br><br>\n\n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n\n    <label for=\"price\">Price:</label>\n    <input type=\"number\" id=\"price\" name=\"price\"><br><br>\n\n    <input type=\"submit\" value=\"Purchase\">\n</form>\n```"]}
