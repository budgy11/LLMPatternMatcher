{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP:\n\n**index.php**\n```php\n<?php\n  // Database connection settings\n  $host = 'localhost';\n  $db = 'eshop';\n  $user = 'root';\n  $pass = '';\n\n  // Create database connection\n  $conn = new PDO(\"mysql:host=$host;dbname=$db\", $user, $pass);\n\n  // Check if user is logged in\n  if (!isset($_SESSION['username'])) {\n    header('Location: login.php');\n    exit;\n  }\n\n  // Get products from database\n  $stmt = $conn->prepare('SELECT * FROM products');\n  $stmt->execute();\n  $products = $stmt->fetchAll();\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Purchase</title>\n</head>\n<body>\n  <h1>Purchase</h1>\n  <form action=\"purchase.php\" method=\"post\">\n    <?php foreach ($products as $product) { ?>\n      <p>\n        <input type=\"checkbox\" name=\"products[]\" value=\"<?php echo $product['id']; ?>\">\n        <?php echo $product['name'] . ' (' . $product['price'] . ')' ?>\n      </p>\n    <?php } ?>\n    <button type=\"submit\">Purchase</button>\n  </form>\n</body>\n</html>\n```\n**purchase.php**\n```php\n<?php\n  // Database connection settings\n  $host = 'localhost';\n  $db = 'eshop';\n  $user = 'root';\n  $pass = '';\n\n  // Create database connection\n  $conn = new PDO(\"mysql:host=$host;dbname=$db\", $user, $pass);\n\n  // Check if form was submitted\n  if (isset($_POST['products'])) {\n    // Get products from session\n    $_SESSION['products'] = $_POST['products'];\n\n    // Update stock in database\n    foreach ($_SESSION['products'] as $product_id) {\n      $stmt = $conn->prepare('UPDATE products SET stock = stock - 1 WHERE id = :id');\n      $stmt->bindParam(':id', $product_id);\n      $stmt->execute();\n    }\n\n    // Calculate total price\n    $total_price = 0;\n    foreach ($_SESSION['products'] as $product_id) {\n      $stmt = $conn->prepare('SELECT price FROM products WHERE id = :id');\n      $stmt->bindParam(':id', $product_id);\n      $stmt->execute();\n      $price = $stmt->fetchColumn();\n      $total_price += $price;\n    }\n\n    // Process payment (for example, using Stripe API)\n    // ...\n\n    // Update order in database\n    $stmt = $conn->prepare('INSERT INTO orders (customer_id, total_price) VALUES (:customer_id, :total_price)');\n    $stmt->bindParam(':customer_id', $_SESSION['username']);\n    $stmt->bindParam(':total_price', $total_price);\n    $stmt->execute();\n\n    // Clear session\n    unset($_SESSION['products']);\n\n    header('Location: thanks.php');\n  }\n?>\n```\n**thanks.php**\n```php\n<?php\n  // Database connection settings\n  $host = 'localhost';\n  $db = 'eshop';\n  $user = 'root';\n  $pass = '';\n\n  // Create database connection\n  $conn = new PDO(\"mysql:host=$host;dbname=$db\", $user, $pass);\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Thanks</title>\n</head>\n<body>\n  <h1>Thank you for your purchase!</h1>\n  <p>Your order has been successfully processed.</p>\n</body>\n</html>\n```\nThis example assumes that you have a database table `products` with the following structure:\n\n| Field | Type | Description |\n| --- | --- | --- |\n| id | int | Unique product ID |\n| name | varchar(255) | Product name |\n| price | decimal(10,2) | Product price |\n\nAnd another table `orders` with the following structure:\n\n| Field | Type | Description |\n| --- | --- | --- |\n| id | int | Unique order ID |\n| customer_id | varchar(255) | Customer username |\n| total_price | decimal(10,2) | Total price of the order |\n\nNote that this is a very basic example and you should consider adding more functionality, such as:\n\n* User authentication and authorization\n* Product filtering and sorting\n* Payment processing (using Stripe API or other payment gateways)\n* Order tracking and management\n* etc.\n\nAlso, please keep in mind that this is just an example code, and you should adapt it to your specific use case and requirements.", "code_blocks": ["```php\n<?php\n  // Database connection settings\n  $host = 'localhost';\n  $db = 'eshop';\n  $user = 'root';\n  $pass = '';\n\n  // Create database connection\n  $conn = new PDO(\"mysql:host=$host;dbname=$db\", $user, $pass);\n\n  // Check if user is logged in\n  if (!isset($_SESSION['username'])) {\n    header('Location: login.php');\n    exit;\n  }\n\n  // Get products from database\n  $stmt = $conn->prepare('SELECT * FROM products');\n  $stmt->execute();\n  $products = $stmt->fetchAll();\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Purchase</title>\n</head>\n<body>\n  <h1>Purchase</h1>\n  <form action=\"purchase.php\" method=\"post\">\n    <?php foreach ($products as $product) { ?>\n      <p>\n        <input type=\"checkbox\" name=\"products[]\" value=\"<?php echo $product['id']; ?>\">\n        <?php echo $product['name'] . ' (' . $product['price'] . ')' ?>\n      </p>\n    <?php } ?>\n    <button type=\"submit\">Purchase</button>\n  </form>\n</body>\n</html>\n```", "```php\n<?php\n  // Database connection settings\n  $host = 'localhost';\n  $db = 'eshop';\n  $user = 'root';\n  $pass = '';\n\n  // Create database connection\n  $conn = new PDO(\"mysql:host=$host;dbname=$db\", $user, $pass);\n\n  // Check if form was submitted\n  if (isset($_POST['products'])) {\n    // Get products from session\n    $_SESSION['products'] = $_POST['products'];\n\n    // Update stock in database\n    foreach ($_SESSION['products'] as $product_id) {\n      $stmt = $conn->prepare('UPDATE products SET stock = stock - 1 WHERE id = :id');\n      $stmt->bindParam(':id', $product_id);\n      $stmt->execute();\n    }\n\n    // Calculate total price\n    $total_price = 0;\n    foreach ($_SESSION['products'] as $product_id) {\n      $stmt = $conn->prepare('SELECT price FROM products WHERE id = :id');\n      $stmt->bindParam(':id', $product_id);\n      $stmt->execute();\n      $price = $stmt->fetchColumn();\n      $total_price += $price;\n    }\n\n    // Process payment (for example, using Stripe API)\n    // ...\n\n    // Update order in database\n    $stmt = $conn->prepare('INSERT INTO orders (customer_id, total_price) VALUES (:customer_id, :total_price)');\n    $stmt->bindParam(':customer_id', $_SESSION['username']);\n    $stmt->bindParam(':total_price', $total_price);\n    $stmt->execute();\n\n    // Clear session\n    unset($_SESSION['products']);\n\n    header('Location: thanks.php');\n  }\n?>\n```", "```php\n<?php\n  // Database connection settings\n  $host = 'localhost';\n  $db = 'eshop';\n  $user = 'root';\n  $pass = '';\n\n  // Create database connection\n  $conn = new PDO(\"mysql:host=$host;dbname=$db\", $user, $pass);\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Thanks</title>\n</head>\n<body>\n  <h1>Thank you for your purchase!</h1>\n  <p>Your order has been successfully processed.</p>\n</body>\n</html>\n```"]}
