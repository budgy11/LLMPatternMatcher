{"prompt": "Create a purchase functionality using php", "llm_output": "Here's an example of how you can create a basic purchase functionality using PHP:\n\n**Database Schema**\n\nFirst, let's assume we have the following database schema:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  order_date DATE\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  order_id INT,\n  product_id INT,\n  quantity INT,\n  FOREIGN KEY (order_id) REFERENCES orders(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code**\n\nNow, let's create a simple PHP script to handle purchases:\n\n```php\n// Connect to the database\n$servername = \"localhost\";\n$username = \"username\";\n$password = \"password\";\n$dbname = \"database\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add a product to the cart\nfunction add_product_to_cart() {\n    global $conn;\n    \n    if (isset($_POST[\"product_id\"]) && isset($_POST[\"quantity\"])) {\n        $product_id = $_POST[\"product_id\"];\n        $quantity = $_POST[\"quantity\"];\n        \n        // Check if product exists in database\n        $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($query);\n        \n        if ($result->num_rows > 0) {\n            while ($row = $result->fetch_assoc()) {\n                $product_name = $row[\"name\"];\n                $product_price = $row[\"price\"];\n                \n                // Add product to order items table\n                $query = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES ('', '$product_id', '$quantity')\";\n                $conn->query($query);\n            }\n        } else {\n            echo \"Product not found\";\n        }\n    }\n}\n\n// Function to place an order\nfunction place_order() {\n    global $conn;\n    \n    if (isset($_POST[\"customer_name\"]) && isset($_POST[\"order_date\"])) {\n        $customer_name = $_POST[\"customer_name\"];\n        $order_date = $_POST[\"order_date\"];\n        \n        // Add order to orders table\n        $query = \"INSERT INTO orders (customer_name, order_date) VALUES ('$customer_name', '$order_date')\";\n        $conn->query($query);\n        \n        // Update order id in order items table\n        $query = \"UPDATE order_items SET order_id = LAST_INSERT_ID() WHERE order_id IS NULL\";\n        $conn->query($query);\n    }\n}\n\n// Handle add product to cart form submission\nif (isset($_POST[\"add_product\"])) {\n    add_product_to_cart();\n}\n\n// Handle place order form submission\nif (isset($_POST[\"place_order\"])) {\n    place_order();\n}\n```\n\n**HTML Form**\n\nNow, let's create a simple HTML form to interact with our PHP script:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Purchase Functionality</title>\n</head>\n<body>\n\n<form action=\"\" method=\"post\">\n    <input type=\"hidden\" name=\"add_product\" value=\"1\">\n\n    <select name=\"product_id\">\n        <?php\n            // Display products in dropdown\n            $query = \"SELECT * FROM products\";\n            $result = $conn->query($query);\n            \n            while ($row = $result->fetch_assoc()) {\n                echo \"<option value='\" . $row[\"id\"] . \"'>\" . $row[\"name\"] . \"</option>\";\n            }\n        ?>\n    </select>\n\n    <input type=\"number\" name=\"quantity\">\n\n    <button type=\"submit\">Add to Cart</button>\n</form>\n\n<form action=\"\" method=\"post\">\n    <input type=\"hidden\" name=\"place_order\" value=\"1\">\n\n    <label for=\"customer_name\">Customer Name:</label>\n    <input type=\"text\" id=\"customer_name\" name=\"customer_name\"><br><br>\n\n    <label for=\"order_date\">Order Date:</label>\n    <input type=\"date\" id=\"order_date\" name=\"order_date\"><br><br>\n\n    <button type=\"submit\">Place Order</button>\n</form>\n\n</body>\n</html>\n```\n\nThis code provides a basic purchase functionality where users can add products to their cart and place orders. However, please note that this is a simplified example and may require modifications to suit your specific needs.\n\n**Example Use Case**\n\n1. User selects a product from the dropdown.\n2. User enters the quantity they want to purchase.\n3. User clicks \"Add to Cart\" button.\n4. Product is added to order items table with corresponding order id.\n5. User fills out customer name and order date fields.\n6. User clicks \"Place Order\" button.\n7. Order is added to orders table, and order id is updated in order items table.\n\nPlease ensure you replace `localhost`, `username`, `password`, and `database` placeholders with your actual database credentials. Also, this code assumes that the products table has a unique id column named `id`. Adjust accordingly if your schema differs.", "code_blocks": [null, "```php\n// Connect to the database\n$servername = \"localhost\";\n$username = \"username\";\n$password = \"password\";\n$dbname = \"database\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add a product to the cart\nfunction add_product_to_cart() {\n    global $conn;\n    \n    if (isset($_POST[\"product_id\"]) && isset($_POST[\"quantity\"])) {\n        $product_id = $_POST[\"product_id\"];\n        $quantity = $_POST[\"quantity\"];\n        \n        // Check if product exists in database\n        $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($query);\n        \n        if ($result->num_rows > 0) {\n            while ($row = $result->fetch_assoc()) {\n                $product_name = $row[\"name\"];\n                $product_price = $row[\"price\"];\n                \n                // Add product to order items table\n                $query = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES ('', '$product_id', '$quantity')\";\n                $conn->query($query);\n            }\n        } else {\n            echo \"Product not found\";\n        }\n    }\n}\n\n// Function to place an order\nfunction place_order() {\n    global $conn;\n    \n    if (isset($_POST[\"customer_name\"]) && isset($_POST[\"order_date\"])) {\n        $customer_name = $_POST[\"customer_name\"];\n        $order_date = $_POST[\"order_date\"];\n        \n        // Add order to orders table\n        $query = \"INSERT INTO orders (customer_name, order_date) VALUES ('$customer_name', '$order_date')\";\n        $conn->query($query);\n        \n        // Update order id in order items table\n        $query = \"UPDATE order_items SET order_id = LAST_INSERT_ID() WHERE order_id IS NULL\";\n        $conn->query($query);\n    }\n}\n\n// Handle add product to cart form submission\nif (isset($_POST[\"add_product\"])) {\n    add_product_to_cart();\n}\n\n// Handle place order form submission\nif (isset($_POST[\"place_order\"])) {\n    place_order();\n}\n```", null]}
