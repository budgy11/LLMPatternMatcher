{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP, HTML, and MySQL:\n\n**Database Setup**\n\nFirst, let's create the database table to store purchases. Create a new file called `db_setup.php` with the following code:\n```php\n<?php\n// Database connection settings\n$host = 'localhost';\n$dbname = 'mydatabase';\n$username = 'myuser';\n$password = 'mypassword';\n\n// Connect to the database\n$conn = new mysqli($host, $username, $password, $dbname);\n\n// Create table if it doesn't exist\n$sql = \"CREATE TABLE IF NOT EXISTS purchases (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_id INT,\n  product_id INT,\n  quantity INT,\n  amount DECIMAL(10,2)\n)\";\n$conn->query($sql);\n\n// Close connection\n$conn->close();\n?>\n```\n**Purchase Functionality**\n\nCreate a new file called `purchase.php` with the following code:\n```php\n<?php\n// Include database setup file\nrequire_once 'db_setup.php';\n\n// Process purchase form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Extract form data\n  $customer_id = $_POST['customer_id'];\n  $product_id = $_POST['product_id'];\n  $quantity = $_POST['quantity'];\n\n  // Validate input data\n  if (!isset($customer_id) || !isset($product_id) || !isset($quantity)) {\n    echo 'Error: Missing form data.';\n    exit;\n  }\n\n  // Get product price from database (assuming we have a products table)\n  $conn = new mysqli($host, $username, $password, $dbname);\n  $sql = \"SELECT price FROM products WHERE id = '$product_id'\";\n  $result = $conn->query($sql);\n  if ($row = $result->fetch_assoc()) {\n    $price = $row['price'];\n  } else {\n    echo 'Error: Product not found.';\n    exit;\n  }\n\n  // Calculate total amount\n  $amount = $quantity * $price;\n\n  // Insert purchase data into database\n  $sql = \"INSERT INTO purchases (customer_id, product_id, quantity, amount) VALUES ('$customer_id', '$product_id', '$quantity', '$amount')\";\n  if ($conn->query($sql)) {\n    echo 'Purchase successful!';\n  } else {\n    echo 'Error: Failed to insert purchase data.';\n  }\n\n  // Close connection\n  $conn->close();\n} else {\n  // Display purchase form\n?>\n  <h1>Purchase Form</h1>\n  <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"customer_id\">Customer ID:</label>\n    <input type=\"text\" id=\"customer_id\" name=\"customer_id\"><br><br>\n    <label for=\"product_id\">Product ID:</label>\n    <input type=\"text\" id=\"product_id\" name=\"product_id\"><br><br>\n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n    <input type=\"submit\" value=\"Purchase\">\n  </form>\n<?php } ?>\n```\n**Explanation**\n\nThis code assumes you have a `products` table with a `price` column, and a `purchases` table with columns for customer ID, product ID, quantity, and amount.\n\nThe purchase form is displayed if the page is accessed without submitting any data. When the form is submitted, the script extracts the input data, validates it, calculates the total amount, and inserts the purchase data into the database.\n\nNote that this is a basic example and you should consider adding error handling, security measures (e.g., input sanitization), and possibly using a more robust ORM (Object-Relational Mapping) system for your database interactions.", "code_blocks": ["```php\n<?php\n// Database connection settings\n$host = 'localhost';\n$dbname = 'mydatabase';\n$username = 'myuser';\n$password = 'mypassword';\n\n// Connect to the database\n$conn = new mysqli($host, $username, $password, $dbname);\n\n// Create table if it doesn't exist\n$sql = \"CREATE TABLE IF NOT EXISTS purchases (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_id INT,\n  product_id INT,\n  quantity INT,\n  amount DECIMAL(10,2)\n)\";\n$conn->query($sql);\n\n// Close connection\n$conn->close();\n?>\n```", "```php\n<?php\n// Include database setup file\nrequire_once 'db_setup.php';\n\n// Process purchase form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Extract form data\n  $customer_id = $_POST['customer_id'];\n  $product_id = $_POST['product_id'];\n  $quantity = $_POST['quantity'];\n\n  // Validate input data\n  if (!isset($customer_id) || !isset($product_id) || !isset($quantity)) {\n    echo 'Error: Missing form data.';\n    exit;\n  }\n\n  // Get product price from database (assuming we have a products table)\n  $conn = new mysqli($host, $username, $password, $dbname);\n  $sql = \"SELECT price FROM products WHERE id = '$product_id'\";\n  $result = $conn->query($sql);\n  if ($row = $result->fetch_assoc()) {\n    $price = $row['price'];\n  } else {\n    echo 'Error: Product not found.';\n    exit;\n  }\n\n  // Calculate total amount\n  $amount = $quantity * $price;\n\n  // Insert purchase data into database\n  $sql = \"INSERT INTO purchases (customer_id, product_id, quantity, amount) VALUES ('$customer_id', '$product_id', '$quantity', '$amount')\";\n  if ($conn->query($sql)) {\n    echo 'Purchase successful!';\n  } else {\n    echo 'Error: Failed to insert purchase data.';\n  }\n\n  // Close connection\n  $conn->close();\n} else {\n  // Display purchase form\n?>\n  <h1>Purchase Form</h1>\n  <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"customer_id\">Customer ID:</label>\n    <input type=\"text\" id=\"customer_id\" name=\"customer_id\"><br><br>\n    <label for=\"product_id\">Product ID:</label>\n    <input type=\"text\" id=\"product_id\" name=\"product_id\"><br><br>\n    <label for=\"quantity\">Quantity:</label>\n    <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n    <input type=\"submit\" value=\"Purchase\">\n  </form>\n<?php } ?>\n```"]}
