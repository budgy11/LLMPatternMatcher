{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a simple purchase functionality in PHP. This will include:\n\n1. User Registration\n2. User Login\n3. Product Listing\n4. Add to Cart\n5. Checkout\n\n**Note:** For simplicity, we'll be using a flat file database instead of a full-fledged relational database.\n\n**Database (flat file):**\n\n* `users.txt`: stores user information (username, password)\n* `products.txt`: stores product information (product id, name, price)\n* `cart.txt`: stores cart information (user id, products)\n\n**PHP Code:**\n\n**1. Database Connection**\n\n```php\n// database.php\n\nclass Database {\n    private $db;\n\n    public function __construct() {\n        $this->db = array();\n        if (!file_exists('data')) {\n            mkdir('data', 0777, true);\n        }\n        $this->loadDatabase();\n    }\n\n    private function loadDatabase() {\n        foreach (glob('data/*.txt') as $filename) {\n            $content = file_get_contents($filename);\n            $lines = explode(\"\\n\", $content);\n            foreach ($lines as $line) {\n                list($key, $value) = explode(\":\", $line);\n                $this->db[$key] = trim($value);\n            }\n        }\n    }\n\n    public function saveDatabase() {\n        foreach ($this->db as $key => $value) {\n            file_put_contents('data/' . $key . '.txt', $key . ':' . $value . \"\\n\");\n        }\n    }\n}\n```\n\n**2. User Registration**\n\n```php\n// register.php\n\nrequire_once 'database.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if ($username && $password) {\n        $db = new Database();\n        $user_id = uniqid();\n        $users = array();\n        if (file_exists('data/users.txt')) {\n            $content = file_get_contents('data/users.txt');\n            $lines = explode(\"\\n\", $content);\n            foreach ($lines as $line) {\n                list($key, $value) = explode(\":\", $line);\n                $users[$key] = trim($value);\n            }\n        }\n\n        if (!isset($users['user_id_' . $username])) {\n            $users['user_id_' . $username] = $password;\n            file_put_contents('data/users.txt', serialize($users) . \"\\n\");\n            echo \"User created successfully!\";\n        } else {\n            echo \"Username already exists!\";\n        }\n    } else {\n        echo \"Please enter username and password!\";\n    }\n}\n```\n\n**3. User Login**\n\n```php\n// login.php\n\nrequire_once 'database.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if ($username && $password) {\n        $db = new Database();\n        $users = array();\n        if (file_exists('data/users.txt')) {\n            $content = file_get_contents('data/users.txt');\n            $lines = explode(\"\\n\", $content);\n            foreach ($lines as $line) {\n                list($key, $value) = explode(\":\", $line);\n                $users[$key] = trim($value);\n            }\n        }\n\n        if (isset($users['user_id_' . $username]) && $users['user_id_' . $username] == $password) {\n            session_start();\n            $_SESSION['user_id'] = $username;\n            echo \"Logged in successfully!\";\n        } else {\n            echo \"Invalid username or password!\";\n        }\n    } else {\n        echo \"Please enter username and password!\";\n    }\n}\n```\n\n**4. Product Listing**\n\n```php\n// products.php\n\nrequire_once 'database.php';\n\n$db = new Database();\n$products = array();\n\nif (file_exists('data/products.txt')) {\n    $content = file_get_contents('data/products.txt');\n    $lines = explode(\"\\n\", $content);\n    foreach ($lines as $line) {\n        list($key, $value) = explode(\":\", $line);\n        $products[$key] = trim($value);\n    }\n}\n\necho \"<h1>Products</h1>\";\nforeach ($products as $product_id => $product_info) {\n    list($name, $price) = explode(\",\", $product_info);\n    echo \"<p>ID: $product_id, Name: $name, Price: \\$\" . number_format($price) . \"</p>\";\n}\n```\n\n**5. Add to Cart**\n\n```php\n// cart.php\n\nrequire_once 'database.php';\n\n$db = new Database();\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $user_id = $_SESSION['user_id'];\n    $product_id = $_POST['product_id'];\n\n    if ($user_id && $product_id) {\n        $cart = array();\n        if (file_exists('data/cart.txt')) {\n            $content = file_get_contents('data/cart.txt');\n            $lines = explode(\"\\n\", $content);\n            foreach ($lines as $line) {\n                list($key, $value) = explode(\":\", $line);\n                $cart[$key] = trim($value);\n            }\n        }\n\n        if (!isset($cart['product_id_' . $product_id])) {\n            $cart['product_id_' . $product_id] = '1';\n            file_put_contents('data/cart.txt', serialize($cart) . \"\\n\");\n            echo \"Added to cart successfully!\";\n        } else {\n            echo \"Product already in cart!\";\n        }\n    } else {\n        echo \"Please log in and select a product!\";\n    }\n}\n```\n\n**6. Checkout**\n\n```php\n// checkout.php\n\nrequire_once 'database.php';\n\n$db = new Database();\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $user_id = $_SESSION['user_id'];\n    $cart = array();\n    if (file_exists('data/cart.txt')) {\n        $content = file_get_contents('data/cart.txt');\n        $lines = explode(\"\\n\", $content);\n        foreach ($lines as $line) {\n            list($key, $value) = explode(\":\", $line);\n            $cart[$key] = trim($value);\n        }\n    }\n\n    if (isset($user_id)) {\n        echo \"<h1>Checkout</h1>\";\n        echo \"<p>Total: \\$\" . number_format(array_sum(explode(',', implode(',', $cart)))) . \"</p>\";\n\n        // process payment\n        // ...\n\n        // clear cart\n        file_put_contents('data/cart.txt', '');\n        echo \"Thank you for your purchase!\";\n    } else {\n        echo \"Please log in to checkout!\";\n    }\n}\n```\n\nThis is a basic example of how to create a simple purchase functionality using PHP. In a real-world scenario, you would want to use a full-fledged relational database, implement security measures (e.g., password hashing), and add more features (e.g., payment processing, order management).", "code_blocks": ["```php\n// database.php\n\nclass Database {\n    private $db;\n\n    public function __construct() {\n        $this->db = array();\n        if (!file_exists('data')) {\n            mkdir('data', 0777, true);\n        }\n        $this->loadDatabase();\n    }\n\n    private function loadDatabase() {\n        foreach (glob('data/*.txt') as $filename) {\n            $content = file_get_contents($filename);\n            $lines = explode(\"\\n\", $content);\n            foreach ($lines as $line) {\n                list($key, $value) = explode(\":\", $line);\n                $this->db[$key] = trim($value);\n            }\n        }\n    }\n\n    public function saveDatabase() {\n        foreach ($this->db as $key => $value) {\n            file_put_contents('data/' . $key . '.txt', $key . ':' . $value . \"\\n\");\n        }\n    }\n}\n```", "```php\n// register.php\n\nrequire_once 'database.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if ($username && $password) {\n        $db = new Database();\n        $user_id = uniqid();\n        $users = array();\n        if (file_exists('data/users.txt')) {\n            $content = file_get_contents('data/users.txt');\n            $lines = explode(\"\\n\", $content);\n            foreach ($lines as $line) {\n                list($key, $value) = explode(\":\", $line);\n                $users[$key] = trim($value);\n            }\n        }\n\n        if (!isset($users['user_id_' . $username])) {\n            $users['user_id_' . $username] = $password;\n            file_put_contents('data/users.txt', serialize($users) . \"\\n\");\n            echo \"User created successfully!\";\n        } else {\n            echo \"Username already exists!\";\n        }\n    } else {\n        echo \"Please enter username and password!\";\n    }\n}\n```", "```php\n// login.php\n\nrequire_once 'database.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if ($username && $password) {\n        $db = new Database();\n        $users = array();\n        if (file_exists('data/users.txt')) {\n            $content = file_get_contents('data/users.txt');\n            $lines = explode(\"\\n\", $content);\n            foreach ($lines as $line) {\n                list($key, $value) = explode(\":\", $line);\n                $users[$key] = trim($value);\n            }\n        }\n\n        if (isset($users['user_id_' . $username]) && $users['user_id_' . $username] == $password) {\n            session_start();\n            $_SESSION['user_id'] = $username;\n            echo \"Logged in successfully!\";\n        } else {\n            echo \"Invalid username or password!\";\n        }\n    } else {\n        echo \"Please enter username and password!\";\n    }\n}\n```", "```php\n// products.php\n\nrequire_once 'database.php';\n\n$db = new Database();\n$products = array();\n\nif (file_exists('data/products.txt')) {\n    $content = file_get_contents('data/products.txt');\n    $lines = explode(\"\\n\", $content);\n    foreach ($lines as $line) {\n        list($key, $value) = explode(\":\", $line);\n        $products[$key] = trim($value);\n    }\n}\n\necho \"<h1>Products</h1>\";\nforeach ($products as $product_id => $product_info) {\n    list($name, $price) = explode(\",\", $product_info);\n    echo \"<p>ID: $product_id, Name: $name, Price: \\$\" . number_format($price) . \"</p>\";\n}\n```", "```php\n// cart.php\n\nrequire_once 'database.php';\n\n$db = new Database();\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $user_id = $_SESSION['user_id'];\n    $product_id = $_POST['product_id'];\n\n    if ($user_id && $product_id) {\n        $cart = array();\n        if (file_exists('data/cart.txt')) {\n            $content = file_get_contents('data/cart.txt');\n            $lines = explode(\"\\n\", $content);\n            foreach ($lines as $line) {\n                list($key, $value) = explode(\":\", $line);\n                $cart[$key] = trim($value);\n            }\n        }\n\n        if (!isset($cart['product_id_' . $product_id])) {\n            $cart['product_id_' . $product_id] = '1';\n            file_put_contents('data/cart.txt', serialize($cart) . \"\\n\");\n            echo \"Added to cart successfully!\";\n        } else {\n            echo \"Product already in cart!\";\n        }\n    } else {\n        echo \"Please log in and select a product!\";\n    }\n}\n```", "```php\n// checkout.php\n\nrequire_once 'database.php';\n\n$db = new Database();\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $user_id = $_SESSION['user_id'];\n    $cart = array();\n    if (file_exists('data/cart.txt')) {\n        $content = file_get_contents('data/cart.txt');\n        $lines = explode(\"\\n\", $content);\n        foreach ($lines as $line) {\n            list($key, $value) = explode(\":\", $line);\n            $cart[$key] = trim($value);\n        }\n    }\n\n    if (isset($user_id)) {\n        echo \"<h1>Checkout</h1>\";\n        echo \"<p>Total: \\$\" . number_format(array_sum(explode(',', implode(',', $cart)))) . \"</p>\";\n\n        // process payment\n        // ...\n\n        // clear cart\n        file_put_contents('data/cart.txt', '');\n        echo \"Thank you for your purchase!\";\n    } else {\n        echo \"Please log in to checkout!\";\n    }\n}\n```"]}
