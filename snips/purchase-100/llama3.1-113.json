{"prompt": "Create a purchase functionality using php", "llm_output": "Here's an example of how you can create a simple purchase functionality in PHP. This will include features like user login, adding products to cart, and checkout.\n\n**Please note that this is a basic implementation and does not cover security measures or database connections for production use.**\n\n### Database Schema\n\nCreate the following tables in your MySQL database:\n\n```sql\nCREATE TABLE users (\n    id INT AUTO_INCREMENT,\n    name VARCHAR(255),\n    email VARCHAR(255) UNIQUE,\n    password VARCHAR(255),\n    PRIMARY KEY (id)\n);\n\nCREATE TABLE products (\n    id INT AUTO_INCREMENT,\n    name VARCHAR(255),\n    price DECIMAL(10, 2),\n    description TEXT,\n    PRIMARY KEY (id)\n);\n\nCREATE TABLE carts (\n    id INT AUTO_INCREMENT,\n    user_id INT,\n    product_id INT,\n    quantity INT,\n    PRIMARY KEY (id)\n);\n```\n\n### PHP Code\n\n**config.php**\n\n```php\n<?php\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'root';\n$db_password = '';\n$db_name = 'store';\n\n// Set the error reporting level to E_ALL for debugging purposes\nerror_reporting(E_ALL);\n\n?>\n```\n\n**login.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\n// Check if user is already logged in\nif (isset($_SESSION['user_id'])) {\n    header('Location: index.php');\n}\n\n// Handle login form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Query database for user with matching username and password\n    $sql = \"SELECT * FROM users WHERE email = '$username' AND password = md5('$password')\";\n    $result = mysqli_query($conn, $sql);\n\n    if (mysqli_num_rows($result) == 1) {\n        // Set session variables on successful login\n        $row = mysqli_fetch_assoc($result);\n        $_SESSION['user_id'] = $row['id'];\n        header('Location: index.php');\n    } else {\n        echo 'Invalid username or password';\n    }\n}\n?>\n```\n\n**index.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\n// Check if user is logged in\nif (!isset($_SESSION['user_id'])) {\n    header('Location: login.php');\n}\n\n// Retrieve user ID from session variable\n$user_id = $_SESSION['user_id'];\n?>\n\n<!-- Display products table -->\n<table>\n    <tr>\n        <th>Product Name</th>\n        <th>Price</th>\n        <th>Add to Cart</th>\n    </tr>\n\n    <?php\n    $sql = \"SELECT * FROM products\";\n    $result = mysqli_query($conn, $sql);\n\n    while ($row = mysqli_fetch_assoc($result)) {\n        ?>\n        <tr>\n            <td><?php echo $row['name']; ?></td>\n            <td><?php echo $row['price']; ?></td>\n            <td><a href=\"cart.php?product_id=<?php echo $row['id']; ?>\">Add to Cart</a></td>\n        </tr>\n\n    <?php\n}\n\n?>\n</table>\n```\n\n**cart.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\n// Retrieve user ID from session variable\n$user_id = $_SESSION['user_id'];\n\n// Handle form submission to add product to cart\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Insert new row into carts table with user ID, product ID, and quantity\n    $sql = \"INSERT INTO carts (user_id, product_id, quantity) VALUES ('$user_id', '$product_id', '$quantity')\";\n    mysqli_query($conn, $sql);\n}\n\n// Retrieve list of products in cart for current user\n$sql = \"SELECT * FROM carts WHERE user_id = '$user_id'\";\n$result = mysqli_query($conn, $sql);\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    // Display product information with quantity and price\n    echo \"Product Name: $row[product_name] | Price: $\" . $row['price'] . \" x $row[quantity]\" . \"\\n\";\n}\n?>\n```\n\n**checkout.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\n// Retrieve list of products in cart for current user\n$user_id = $_SESSION['user_id'];\n$sql = \"SELECT * FROM carts WHERE user_id = '$user_id'\";\n$result = mysqli_query($conn, $sql);\n\n$total_price = 0;\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    // Calculate total price by summing prices of all products in cart\n    $total_price += $row['price'] * $row['quantity'];\n}\n\n// Display final checkout page with total price and shopping summary\necho \"Total Price: $\" . $total_price;\n?>\n```\n\n**Please note that this example is a simplified illustration of how you can create a purchase functionality using PHP. In production environments, it's crucial to follow proper security guidelines for protecting sensitive user data. This includes implementing measures like password hashing and validating user input to prevent SQL injection attacks.**\n\nAlso, as you can see from the above code snippets, database connections are used directly in this example but usually we would use an abstraction layer or library such as PDO for this purpose.\n\nThis should give a basic idea on how to implement a purchase functionality in PHP.", "code_blocks": [null, "```php\n<?php\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'root';\n$db_password = '';\n$db_name = 'store';\n\n// Set the error reporting level to E_ALL for debugging purposes\nerror_reporting(E_ALL);\n\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Check if user is already logged in\nif (isset($_SESSION['user_id'])) {\n    header('Location: index.php');\n}\n\n// Handle login form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Query database for user with matching username and password\n    $sql = \"SELECT * FROM users WHERE email = '$username' AND password = md5('$password')\";\n    $result = mysqli_query($conn, $sql);\n\n    if (mysqli_num_rows($result) == 1) {\n        // Set session variables on successful login\n        $row = mysqli_fetch_assoc($result);\n        $_SESSION['user_id'] = $row['id'];\n        header('Location: index.php');\n    } else {\n        echo 'Invalid username or password';\n    }\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Check if user is logged in\nif (!isset($_SESSION['user_id'])) {\n    header('Location: login.php');\n}\n\n// Retrieve user ID from session variable\n$user_id = $_SESSION['user_id'];\n?>\n\n<!-- Display products table -->\n<table>\n    <tr>\n        <th>Product Name</th>\n        <th>Price</th>\n        <th>Add to Cart</th>\n    </tr>\n\n    <?php\n    $sql = \"SELECT * FROM products\";\n    $result = mysqli_query($conn, $sql);\n\n    while ($row = mysqli_fetch_assoc($result)) {\n        ?>\n        <tr>\n            <td><?php echo $row['name']; ?></td>\n            <td><?php echo $row['price']; ?></td>\n            <td><a href=\"cart.php?product_id=<?php echo $row['id']; ?>\">Add to Cart</a></td>\n        </tr>\n\n    <?php\n}\n\n?>\n</table>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Retrieve user ID from session variable\n$user_id = $_SESSION['user_id'];\n\n// Handle form submission to add product to cart\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Insert new row into carts table with user ID, product ID, and quantity\n    $sql = \"INSERT INTO carts (user_id, product_id, quantity) VALUES ('$user_id', '$product_id', '$quantity')\";\n    mysqli_query($conn, $sql);\n}\n\n// Retrieve list of products in cart for current user\n$sql = \"SELECT * FROM carts WHERE user_id = '$user_id'\";\n$result = mysqli_query($conn, $sql);\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    // Display product information with quantity and price\n    echo \"Product Name: $row[product_name] | Price: $\" . $row['price'] . \" x $row[quantity]\" . \"\\n\";\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Retrieve list of products in cart for current user\n$user_id = $_SESSION['user_id'];\n$sql = \"SELECT * FROM carts WHERE user_id = '$user_id'\";\n$result = mysqli_query($conn, $sql);\n\n$total_price = 0;\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    // Calculate total price by summing prices of all products in cart\n    $total_price += $row['price'] * $row['quantity'];\n}\n\n// Display final checkout page with total price and shopping summary\necho \"Total Price: $\" . $total_price;\n?>\n```"]}
