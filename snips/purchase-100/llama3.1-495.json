{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a simple purchase functionality using PHP:\n\n**purchase.php**\n```php\n<?php\n\n// Database connection settings\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'online_store';\n\n// Connect to the database\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to display products\nfunction displayProducts() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        echo \"<table>\";\n        while ($row = $result->fetch_assoc()) {\n            echo \"<tr>\";\n            echo \"<td>\" . $row[\"id\"] . \"</td>\";\n            echo \"<td>\" . $row[\"name\"] . \"</td>\";\n            echo \"<td>\" . $row[\"price\"] . \"</td>\";\n            echo \"<td><button id='\" . $row[\"id\"] . \"' class='buy-button'>Buy Now</button></td>\";\n            echo \"</tr>\";\n        }\n        echo \"</table>\";\n    } else {\n        echo \"No products available.\";\n    }\n}\n\n// Function to add product to cart\nfunction addToCart($productId) {\n    global $conn;\n    $query = \"INSERT INTO cart (product_id, user_id) VALUES ('$productId', '$_SESSION[user_id]')\";\n    if ($conn->query($query)) {\n        echo \"Product added to cart.\";\n    } else {\n        echo \"Error adding product to cart.\";\n    }\n}\n\n// Function to checkout\nfunction checkout() {\n    global $conn;\n    // Get the products in the cart\n    $query = \"SELECT * FROM cart WHERE user_id = '$_SESSION[user_id]'\";\n    $result = $conn->query($query);\n    if ($result->num_rows > 0) {\n        echo \"<table>\";\n        while ($row = $result->fetch_assoc()) {\n            echo \"<tr>\";\n            echo \"<td>\" . $row[\"product_id\"] . \"</td>\";\n            echo \"<td>\" . getProductDetails($row[\"product_id\"])[\"name\"] . \"</td>\";\n            echo \"<td>\" . getProductDetails($row[\"product_id\"])[\"price\"] . \"</td>\";\n            echo \"</tr>\";\n        }\n        echo \"</table>\";\n\n        // Calculate the total cost\n        $totalCost = 0;\n        while ($row = $result->fetch_assoc()) {\n            $totalCost += getProductDetails($row[\"product_id\"])[\"price\"];\n        }\n\n        // Display the checkout form\n        echo \"<form action='' method='post'>\";\n        echo \"<input type='hidden' name='total_cost' value='\" . $totalCost . \"'>\";\n        echo \"<button type='submit'>Checkout</button>\";\n        echo \"</form>\";\n\n        if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n            // Process the checkout form\n            processCheckout();\n        }\n    } else {\n        echo \"Cart is empty.\";\n    }\n}\n\n// Function to get product details\nfunction getProductDetails($productId) {\n    global $conn;\n    $query = \"SELECT * FROM products WHERE id = '$productId'\";\n    $result = $conn->query($query);\n    return $result->fetch_assoc();\n}\n\n// Function to process checkout\nfunction processCheckout() {\n    global $conn;\n    // Get the total cost from the form\n    $totalCost = $_POST[\"total_cost\"];\n\n    // Update the cart with the purchased products\n    $query = \"UPDATE cart SET purchased = '1' WHERE user_id = '$_SESSION[user_id]'\";\n    if ($conn->query($query)) {\n        echo \"Checkout successful.\";\n    } else {\n        echo \"Error processing checkout.\";\n    }\n}\n\n// Display the page\ndisplayProducts();\n\n?>\n```\n**index.php**\n```php\n<?php\n\n// Include the database connection settings\nrequire_once 'purchase.php';\n\n// Start the session\nsession_start();\n\n// Check if the user is logged in\nif (!isset($_SESSION[\"user_id\"])) {\n    echo \"Please log in to access this feature.\";\n} else {\n    // Display the checkout button\n    echo \"<button id='checkout-button'>Checkout</button>\";\n\n    // Add event listener to the checkout button\n    addEventListener(\"click\", \"#checkout-button\", function() {\n        checkout();\n    });\n}\n?>\n```\n**script.js**\n```javascript\n// Function to add event listener\nfunction addEventListener(event, selector, callback) {\n    document.addEventListener(event, function() {\n        var element = document.querySelector(selector);\n        if (element) {\n            callback(element);\n        }\n    });\n}\n```\nThis code creates a simple purchase functionality with the following features:\n\n* Displays a list of products on the page\n* Allows users to add products to their cart by clicking the \"Buy Now\" button next to each product\n* Displays the contents of the user's cart and allows them to checkout\n* Processes the checkout form and updates the cart with the purchased products\n\nNote that this is just an example code and you should adapt it to your specific requirements and database schema. Additionally, this code does not include any error handling or security measures, so you should add those as needed.", "code_blocks": ["```php\n<?php\n\n// Database connection settings\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'online_store';\n\n// Connect to the database\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to display products\nfunction displayProducts() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        echo \"<table>\";\n        while ($row = $result->fetch_assoc()) {\n            echo \"<tr>\";\n            echo \"<td>\" . $row[\"id\"] . \"</td>\";\n            echo \"<td>\" . $row[\"name\"] . \"</td>\";\n            echo \"<td>\" . $row[\"price\"] . \"</td>\";\n            echo \"<td><button id='\" . $row[\"id\"] . \"' class='buy-button'>Buy Now</button></td>\";\n            echo \"</tr>\";\n        }\n        echo \"</table>\";\n    } else {\n        echo \"No products available.\";\n    }\n}\n\n// Function to add product to cart\nfunction addToCart($productId) {\n    global $conn;\n    $query = \"INSERT INTO cart (product_id, user_id) VALUES ('$productId', '$_SESSION[user_id]')\";\n    if ($conn->query($query)) {\n        echo \"Product added to cart.\";\n    } else {\n        echo \"Error adding product to cart.\";\n    }\n}\n\n// Function to checkout\nfunction checkout() {\n    global $conn;\n    // Get the products in the cart\n    $query = \"SELECT * FROM cart WHERE user_id = '$_SESSION[user_id]'\";\n    $result = $conn->query($query);\n    if ($result->num_rows > 0) {\n        echo \"<table>\";\n        while ($row = $result->fetch_assoc()) {\n            echo \"<tr>\";\n            echo \"<td>\" . $row[\"product_id\"] . \"</td>\";\n            echo \"<td>\" . getProductDetails($row[\"product_id\"])[\"name\"] . \"</td>\";\n            echo \"<td>\" . getProductDetails($row[\"product_id\"])[\"price\"] . \"</td>\";\n            echo \"</tr>\";\n        }\n        echo \"</table>\";\n\n        // Calculate the total cost\n        $totalCost = 0;\n        while ($row = $result->fetch_assoc()) {\n            $totalCost += getProductDetails($row[\"product_id\"])[\"price\"];\n        }\n\n        // Display the checkout form\n        echo \"<form action='' method='post'>\";\n        echo \"<input type='hidden' name='total_cost' value='\" . $totalCost . \"'>\";\n        echo \"<button type='submit'>Checkout</button>\";\n        echo \"</form>\";\n\n        if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n            // Process the checkout form\n            processCheckout();\n        }\n    } else {\n        echo \"Cart is empty.\";\n    }\n}\n\n// Function to get product details\nfunction getProductDetails($productId) {\n    global $conn;\n    $query = \"SELECT * FROM products WHERE id = '$productId'\";\n    $result = $conn->query($query);\n    return $result->fetch_assoc();\n}\n\n// Function to process checkout\nfunction processCheckout() {\n    global $conn;\n    // Get the total cost from the form\n    $totalCost = $_POST[\"total_cost\"];\n\n    // Update the cart with the purchased products\n    $query = \"UPDATE cart SET purchased = '1' WHERE user_id = '$_SESSION[user_id]'\";\n    if ($conn->query($query)) {\n        echo \"Checkout successful.\";\n    } else {\n        echo \"Error processing checkout.\";\n    }\n}\n\n// Display the page\ndisplayProducts();\n\n?>\n```", "```php\n<?php\n\n// Include the database connection settings\nrequire_once 'purchase.php';\n\n// Start the session\nsession_start();\n\n// Check if the user is logged in\nif (!isset($_SESSION[\"user_id\"])) {\n    echo \"Please log in to access this feature.\";\n} else {\n    // Display the checkout button\n    echo \"<button id='checkout-button'>Checkout</button>\";\n\n    // Add event listener to the checkout button\n    addEventListener(\"click\", \"#checkout-button\", function() {\n        checkout();\n    });\n}\n?>\n```", null]}
