{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a simple purchase functionality using PHP:\n\n**Note:** This is a basic example and does not include any error handling or security measures. In a real-world application, you should add proper validation, authorization, and other security features.\n\n### Database Schema\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  order_date DATE\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  order_id INT,\n  product_id INT,\n  quantity INT,\n  FOREIGN KEY (order_id) REFERENCES orders(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n### PHP Code\n\n**index.php**\n```php\n<?php\nrequire_once 'config.php';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_user, $db_pass, $db_name);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get products from database\n$sql = \"SELECT * FROM products\";\n$result = $conn->query($sql);\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase</title>\n</head>\n<body>\n    <h1>Products:</h1>\n    <ul>\n        <?php while ($row = $result->fetch_assoc()) { ?>\n            <li>\n                <a href=\"purchase.php?product_id=<?php echo $row['id']; ?>\"><?php echo $row['name']; ?></a>\n                ($<?php echo number_format($row['price'], 2); ?>)\n            </li>\n        <?php } ?>\n    </ul>\n\n    <form action=\"purchase_process.php\" method=\"post\">\n        <input type=\"submit\" value=\"Make Purchase\">\n    </form>\n\n</body>\n</html>\n```\n**purchase_process.php**\n```php\n<?php\nrequire_once 'config.php';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_user, $db_pass, $db_name);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get product ID from URL\n$product_id = $_GET['product_id'];\n\n// Add item to order\n$sql = \"INSERT INTO order_items (order_id, product_id, quantity)\n        VALUES ('NULL', '$product_id', '1')\";\n\nif ($conn->query($sql) === TRUE) {\n    echo \"Item added to cart.\";\n} else {\n    echo \"Error: \" . $conn->error;\n}\n\n// Redirect back to index page\nheader(\"Location: index.php\");\n?>\n```\n**config.php**\n```php\n<?php\n$db_host = 'localhost';\n$db_user = 'root';\n$db_pass = '';\n$db_name = 'store';\n\n?>\n```\n### Explanation\n\nThis example consists of three files:\n\n1. **index.php**: Displays a list of products and provides a form to submit a purchase.\n2. **purchase_process.php**: Handles the form submission, adds an item to the cart, and redirects back to the index page.\n3. **config.php**: Contains database connection settings.\n\nThe example uses a simple table structure with three tables: `products`, `orders`, and `order_items`. The `orders` table stores information about each order, while the `order_items` table stores information about each item in an order.\n\nWhen a user clicks on a product link in **index.php**, it directs them to **purchase_process.php** with the product ID as a GET parameter. The code then adds an item to the cart by inserting a new row into the `order_items` table.\n\nNote that this is a basic example and does not include any error handling or security measures, such as validation of user input or protection against SQL injection attacks. In a real-world application, you should add proper validation, authorization, and other security features to ensure secure and reliable functionality.", "code_blocks": [null, "```php\n<?php\nrequire_once 'config.php';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_user, $db_pass, $db_name);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get products from database\n$sql = \"SELECT * FROM products\";\n$result = $conn->query($sql);\n\n?>\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase</title>\n</head>\n<body>\n    <h1>Products:</h1>\n    <ul>\n        <?php while ($row = $result->fetch_assoc()) { ?>\n            <li>\n                <a href=\"purchase.php?product_id=<?php echo $row['id']; ?>\"><?php echo $row['name']; ?></a>\n                ($<?php echo number_format($row['price'], 2); ?>)\n            </li>\n        <?php } ?>\n    </ul>\n\n    <form action=\"purchase_process.php\" method=\"post\">\n        <input type=\"submit\" value=\"Make Purchase\">\n    </form>\n\n</body>\n</html>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_user, $db_pass, $db_name);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get product ID from URL\n$product_id = $_GET['product_id'];\n\n// Add item to order\n$sql = \"INSERT INTO order_items (order_id, product_id, quantity)\n        VALUES ('NULL', '$product_id', '1')\";\n\nif ($conn->query($sql) === TRUE) {\n    echo \"Item added to cart.\";\n} else {\n    echo \"Error: \" . $conn->error;\n}\n\n// Redirect back to index page\nheader(\"Location: index.php\");\n?>\n```", "```php\n<?php\n$db_host = 'localhost';\n$db_user = 'root';\n$db_pass = '';\n$db_name = 'store';\n\n?>\n```"]}
