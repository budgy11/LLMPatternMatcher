{"prompt": "Create a purchase functionality using php", "llm_output": "**Purchase Functionality in PHP**\n=====================================\n\nThis is an example of how you can implement a simple purchase functionality using PHP. This example includes the following features:\n\n* User registration and login\n* Product listing with prices\n* Purchase functionality with payment processing (simulated)\n\n**Database Setup**\n------------------\n\nCreate a MySQL database and add the following tables:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(50),\n  email VARCHAR(100),\n  password VARCHAR(255)\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(100),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  total DECIMAL(10,2),\n  status VARCHAR(50),\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n```\n\n**PHP Code**\n-------------\n\n### `config.php` - database connection settings\n\n```php\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n?>\n```\n\n### `register.php` - user registration\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['register'])) {\n  $username = $_POST['username'];\n  $email = $_POST['email'];\n  $password = $_POST['password'];\n\n  $query = \"INSERT INTO users (username, email, password) VALUES ('$username', '$email', '$password')\";\n  if ($mysqli->query($query)) {\n    echo 'Registration successful!';\n  } else {\n    echo 'Error: ' . $mysqli->error;\n  }\n}\n?>\n```\n\n### `login.php` - user login\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['login'])) {\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  $query = \"SELECT * FROM users WHERE username = '$username' AND password = '$password'\";\n  $result = $mysqli->query($query);\n  if ($result->num_rows > 0) {\n    echo 'Login successful!';\n  } else {\n    echo 'Error: invalid username or password';\n  }\n}\n?>\n```\n\n### `products.php` - product listing\n\n```php\n<?php\nrequire_once 'config.php';\n\n$query = \"SELECT * FROM products\";\n$result = $mysqli->query($query);\n?>\n\n<table>\n  <tr>\n    <th>Name</th>\n    <th>Price</th>\n  </tr>\n  <?php while ($product = $result->fetch_assoc()) { ?>\n    <tr>\n      <td><?php echo $product['name']; ?></td>\n      <td><?php echo $product['price']; ?></td>\n    </tr>\n  <?php } ?>\n</table>\n```\n\n### `purchase.php` - purchase functionality\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['buy'])) {\n  $user_id = $_SESSION['user_id'];\n  $product_id = $_POST['product_id'];\n  $quantity = $_POST['quantity'];\n\n  // simulate payment processing\n  $total = $_POST['price'] * $quantity;\n  $query = \"INSERT INTO orders (user_id, total, status) VALUES ('$user_id', '$total', 'pending')\";\n  if ($mysqli->query($query)) {\n    echo 'Purchase successful!';\n  } else {\n    echo 'Error: ' . $mysqli->error;\n  }\n}\n?>\n```\n\n**Example Use Case**\n--------------------\n\n1. User registers for an account using `register.php`.\n2. User logs in using `login.php`.\n3. User views the product listing on `products.php` and selects a product to purchase.\n4. User clicks \"Buy\" button, which redirects them to `purchase.php`.\n5. User enters quantity and clicks \"Purchase\" button.\n\nNote: This is a simplified example and you should consider implementing proper payment processing using a secure gateway like Stripe or PayPal. Additionally, this code does not include error handling or security measures like CSRF protection.", "code_blocks": [null, "```php\n<?php\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['register'])) {\n  $username = $_POST['username'];\n  $email = $_POST['email'];\n  $password = $_POST['password'];\n\n  $query = \"INSERT INTO users (username, email, password) VALUES ('$username', '$email', '$password')\";\n  if ($mysqli->query($query)) {\n    echo 'Registration successful!';\n  } else {\n    echo 'Error: ' . $mysqli->error;\n  }\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['login'])) {\n  $username = $_POST['username'];\n  $password = $_POST['password'];\n\n  $query = \"SELECT * FROM users WHERE username = '$username' AND password = '$password'\";\n  $result = $mysqli->query($query);\n  if ($result->num_rows > 0) {\n    echo 'Login successful!';\n  } else {\n    echo 'Error: invalid username or password';\n  }\n}\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\n$query = \"SELECT * FROM products\";\n$result = $mysqli->query($query);\n?>\n\n<table>\n  <tr>\n    <th>Name</th>\n    <th>Price</th>\n  </tr>\n  <?php while ($product = $result->fetch_assoc()) { ?>\n    <tr>\n      <td><?php echo $product['name']; ?></td>\n      <td><?php echo $product['price']; ?></td>\n    </tr>\n  <?php } ?>\n</table>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['buy'])) {\n  $user_id = $_SESSION['user_id'];\n  $product_id = $_POST['product_id'];\n  $quantity = $_POST['quantity'];\n\n  // simulate payment processing\n  $total = $_POST['price'] * $quantity;\n  $query = \"INSERT INTO orders (user_id, total, status) VALUES ('$user_id', '$total', 'pending')\";\n  if ($mysqli->query($query)) {\n    echo 'Purchase successful!';\n  } else {\n    echo 'Error: ' . $mysqli->error;\n  }\n}\n?>\n```"]}
