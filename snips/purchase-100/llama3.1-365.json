{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP:\n\n**database.php**\n```php\n<?php\n  $servername = \"localhost\";\n  $username = \"root\";\n  $password = \"\";\n  $dbname = \"shopping_cart\";\n\n  // Create connection\n  $conn = new mysqli($servername, $username, $password, $dbname);\n\n  if ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n  }\n?>\n```\n\n**product.php**\n```php\n<?php\n  require_once 'database.php';\n\n  function getProducts() {\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n      while($row = $result->fetch_assoc()) {\n        echo '<div class=\"product\">';\n        echo '<h2>' . $row['name'] . '</h2>';\n        echo '<p>Price: ' . $row['price'] . '</p>';\n        echo '<p>Description: ' . $row['description'] . '</p>';\n        echo '<button>Add to Cart</button>';\n        echo '</div>';\n      }\n    } else {\n      echo \"No products available\";\n    }\n  }\n\n  getProducts();\n?>\n```\n\n**cart.php**\n```php\n<?php\n  require_once 'database.php';\n\n  function getCartItems() {\n    $query = \"SELECT * FROM cart WHERE user_id = '$userId'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n      while($row = $result->fetch_assoc()) {\n        echo '<div class=\"cart-item\">';\n        echo '<h2>' . $row['name'] . '</h2>';\n        echo '<p>Quantity: ' . $row['quantity'] . '</p>';\n        echo '<button>Remove from Cart</button>';\n        echo '</div>';\n      }\n    } else {\n      echo \"No cart items available\";\n    }\n  }\n\n  function updateCart($productId, $quantity) {\n    $query = \"UPDATE cart SET quantity = '$quantity' WHERE product_id = '$productId'\";\n    $conn->query($query);\n  }\n\n  getCartItems();\n?>\n```\n\n**checkout.php**\n```php\n<?php\n  require_once 'database.php';\n\n  function checkout() {\n    if (isset($_POST['checkout'])) {\n      $userId = $_SESSION['user_id'];\n      $totalCost = 0;\n      foreach ($_POST as $key => $value) {\n        if ($key == \"submit\") continue;\n        $productQuantity = $value;\n        $productId = explode(\"_\", $key)[1];\n        $query = \"SELECT price FROM products WHERE id = '$productId'\";\n        $result = $conn->query($query);\n        $row = $result->fetch_assoc();\n        $totalCost += $row['price'] * $productQuantity;\n\n        $updateCartQuery = \"UPDATE cart SET quantity = '$productQuantity' WHERE user_id = '$userId' AND product_id = '$productId'\";\n        $conn->query($updateCartQuery);\n      }\n\n      $orderSql = \"INSERT INTO orders (user_id, total_cost) VALUES ('$userId', '$totalCost')\";\n      $conn->query($orderSql);\n\n      header('Location: thankyou.php');\n    }\n  }\n\n  checkout();\n?>\n```\n\n**index.php**\n```php\n<?php\n  require_once 'database.php';\n\n  if (!isset($_SESSION['user_id'])) {\n    echo \"You must be logged in to view this page\";\n    exit;\n  }\n\n  $userId = $_SESSION['user_id'];\n\n  if (isset($_POST['add_to_cart'])) {\n    $productId = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n    updateCart($productId, $quantity);\n  }\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Purchase Functionality</title>\n</head>\n<body>\n\n  <?php include 'product.php'; ?>\n\n  <?php include 'cart.php'; ?>\n\n  <?php if (isset($_POST['add_to_cart'])) { ?>\n    <button>Checkout</button>\n  <?php } else { ?>\n    <form action=\"\" method=\"post\">\n      <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $productId; ?>\">\n      <input type=\"number\" name=\"quantity\" min=\"1\" max=\"<?php echo $stockQuantity; ?>\">\n      <button type=\"submit\">Add to Cart</button>\n    </form>\n  <?php } ?>\n\n  <?php include 'checkout.php'; ?>\n</body>\n</html>\n```\n\nThis code demonstrates a basic purchase functionality using PHP and MySQL. The `database.php` file connects to the database, while the other files interact with it.\n\nThe `product.php` file retrieves all products from the database and displays them on the page.\n\nThe `cart.php` file retrieves all cart items for the current user and displays them on the page. It also includes a button to remove an item from the cart.\n\nThe `checkout.php` file handles the checkout process, updating the quantity of each product in the cart and inserting a new order into the database.\n\nThe `index.php` file serves as the main entry point for the application, displaying the products on the page and handling user input (e.g., adding to cart).\n\nThis is just a basic example and may require additional functionality depending on your specific needs.", "code_blocks": ["```php\n<?php\n  $servername = \"localhost\";\n  $username = \"root\";\n  $password = \"\";\n  $dbname = \"shopping_cart\";\n\n  // Create connection\n  $conn = new mysqli($servername, $username, $password, $dbname);\n\n  if ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n  }\n?>\n```", "```php\n<?php\n  require_once 'database.php';\n\n  function getProducts() {\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n      while($row = $result->fetch_assoc()) {\n        echo '<div class=\"product\">';\n        echo '<h2>' . $row['name'] . '</h2>';\n        echo '<p>Price: ' . $row['price'] . '</p>';\n        echo '<p>Description: ' . $row['description'] . '</p>';\n        echo '<button>Add to Cart</button>';\n        echo '</div>';\n      }\n    } else {\n      echo \"No products available\";\n    }\n  }\n\n  getProducts();\n?>\n```", "```php\n<?php\n  require_once 'database.php';\n\n  function getCartItems() {\n    $query = \"SELECT * FROM cart WHERE user_id = '$userId'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n      while($row = $result->fetch_assoc()) {\n        echo '<div class=\"cart-item\">';\n        echo '<h2>' . $row['name'] . '</h2>';\n        echo '<p>Quantity: ' . $row['quantity'] . '</p>';\n        echo '<button>Remove from Cart</button>';\n        echo '</div>';\n      }\n    } else {\n      echo \"No cart items available\";\n    }\n  }\n\n  function updateCart($productId, $quantity) {\n    $query = \"UPDATE cart SET quantity = '$quantity' WHERE product_id = '$productId'\";\n    $conn->query($query);\n  }\n\n  getCartItems();\n?>\n```", "```php\n<?php\n  require_once 'database.php';\n\n  function checkout() {\n    if (isset($_POST['checkout'])) {\n      $userId = $_SESSION['user_id'];\n      $totalCost = 0;\n      foreach ($_POST as $key => $value) {\n        if ($key == \"submit\") continue;\n        $productQuantity = $value;\n        $productId = explode(\"_\", $key)[1];\n        $query = \"SELECT price FROM products WHERE id = '$productId'\";\n        $result = $conn->query($query);\n        $row = $result->fetch_assoc();\n        $totalCost += $row['price'] * $productQuantity;\n\n        $updateCartQuery = \"UPDATE cart SET quantity = '$productQuantity' WHERE user_id = '$userId' AND product_id = '$productId'\";\n        $conn->query($updateCartQuery);\n      }\n\n      $orderSql = \"INSERT INTO orders (user_id, total_cost) VALUES ('$userId', '$totalCost')\";\n      $conn->query($orderSql);\n\n      header('Location: thankyou.php');\n    }\n  }\n\n  checkout();\n?>\n```", "```php\n<?php\n  require_once 'database.php';\n\n  if (!isset($_SESSION['user_id'])) {\n    echo \"You must be logged in to view this page\";\n    exit;\n  }\n\n  $userId = $_SESSION['user_id'];\n\n  if (isset($_POST['add_to_cart'])) {\n    $productId = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n    updateCart($productId, $quantity);\n  }\n?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Purchase Functionality</title>\n</head>\n<body>\n\n  <?php include 'product.php'; ?>\n\n  <?php include 'cart.php'; ?>\n\n  <?php if (isset($_POST['add_to_cart'])) { ?>\n    <button>Checkout</button>\n  <?php } else { ?>\n    <form action=\"\" method=\"post\">\n      <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $productId; ?>\">\n      <input type=\"number\" name=\"quantity\" min=\"1\" max=\"<?php echo $stockQuantity; ?>\">\n      <button type=\"submit\">Add to Cart</button>\n    </form>\n  <?php } ?>\n\n  <?php include 'checkout.php'; ?>\n</body>\n</html>\n```"]}
