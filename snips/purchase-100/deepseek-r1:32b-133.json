{"prompt": "Create a purchase functionality using php", "llm_output": "<think>\nOkay, I need to help the user create a purchase functionality using PHP. Let me think about how to approach this.\n\nFirst, I should outline what a basic purchase system entails. It needs a product listing, user authentication, adding items to a cart, and processing the payment.\n\nI'll start by creating a simple HTML page for displaying products. Each product should have an image, name, price, description, and an \"Add to Cart\" button. Using Bootstrap will make it look nice without too much effort.\n\nNext, I need a login system because users should only access their carts after logging in. I'll set up a login form with email and password fields, handling the authentication on the server side using PHP sessions.\n\nThen, the shopping cart functionality. When a user adds an item to the cart, it should be stored either in the session or a database. For simplicity, using sessions is easier. I'll create functions to add, remove, and update items in the cart, which will handle these actions when the user interacts with their cart.\n\nAfter that, moving on to the checkout process. The user needs to enter shipping details, so I'll create a form for that. Then, process the payment information, maybe using a simulated payment method since integrating an actual service like Stripe might be beyond the scope here. I'll include order confirmation after the payment is processed.\n\nOrder management is important too. I'll set up an orders table in the database to store each transaction. After processing the payment, insert the order details into this table so users can view their past purchases.\n\nFinally, display all previous orders for the user. This will involve querying the orders table and listing each order with its date, status, and a link to view more details.\n\nI should also make sure to include security measures like prepared statements to prevent SQL injection and proper session management to keep user data safe.\n\nPutting it all together, I'll structure the code into separate PHP files for each part\u2014login, cart functions, checkout, order processing, and viewing orders. Using include_once will help manage these files without duplication.\n\nI think that covers the main components needed. Now, I can present this as a step-by-step guide, making sure each part is clear and includes necessary code snippets.\n</think>\n\nHere's an example of how to create a purchase functionality using PHP:\n\n**Step 1: Create a simple product listing page**\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Product List</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n\n<?php\n// Connect to database\n$host = \"localhost\";\n$dbname = \"your_database_name\";\n$username = \"root\"; // Replace with your DB username\n$password = \"\"; // Replace with your DB password\n\ntry {\n    $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n} catch(PDOException $e) {\n    die(\"Connection failed: \" . $e->getMessage());\n}\n\n// Query products\n$stmt = $conn->query(\"SELECT * FROM products\");\n$products = $stmt->fetchAll();\n\n?>\n\n<div class=\"container mt-4\">\n    <h2>Products</h2>\n    <div class=\"row\">\n        <?php foreach ($products as $product): ?>\n            <div class=\"col-md-3 mb-4\">\n                <div class=\"card\">\n                    <img src=\"<?php echo $product['image']; ?>\" alt=\"<?php echo $product['name']; ?>\" style=\"width:100%; height:200px; object-fit:cover;\">\n                    <div class=\"card-body\">\n                        <h5 class=\"card-title\"><?php echo $product['name']; ?></h5>\n                        <p class=\"card-text\">Price: <?php echo \"$\" . number_format($product['price'], 2); ?></p>\n                        <p class=\"card-text\"><?php echo $product['description']; ?></p>\n                        <a href=\"#\" class=\"btn btn-primary\">Add to Cart</a>\n                    </div>\n                </div>\n            </div>\n        <?php endforeach; ?>\n    </div>\n</div>\n\n<!-- Bootstrap JS -->\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n```\n\n**Step 2: Create a login system**\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Login</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n\n<?php\nsession_start();\n\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    $email = $_POST['email'];\n    $password = $_POST['password'];\n\n    // Validate user credentials against database\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE email = ?\");\n    $stmt->execute([$email]);\n    $user = $stmt->fetch();\n\n    if ($user && password_verify($password, $user['password'])) {\n        $_SESSION['user_id'] = $user['id'];\n        header(\"Location: index.php\");\n        exit();\n    } else {\n        echo \"<div class='alert alert-danger'>Invalid email or password</div>\";\n    }\n}\n?>\n\n<div class=\"container mt-4\">\n    <h2>Login</h2>\n    <form method=\"post\" action=\"<?php echo htmlspecialchars($_SERVER[\"PHP_SELF\"]); ?>\">\n        <div class=\"mb-3\">\n            <label for=\"email\">Email:</label>\n            <input type=\"email\" name=\"email\" id=\"email\" required class=\"form-control\">\n        </div>\n        <div class=\"mb-3\">\n            <label for=\"password\">Password:</label>\n            <input type=\"password\" name=\"password\" id=\"password\" required class=\"form-control\">\n        </div>\n        <button type=\"submit\" class=\"btn btn-primary\">Login</button>\n    </form>\n</div>\n\n<!-- Bootstrap JS -->\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n```\n\n**Step 3: Create a shopping cart functionality**\n\nCreate a new file `cart.php`:\n\n```php\n<?php\nsession_start();\n\nif (!isset($_SESSION['cart'])) {\n    $_SESSION['cart'] = array();\n}\n\n// Add item to cart\nfunction add_to_cart($product_id, $quantity) {\n    if (isset($_SESSION['cart'][$product_id])) {\n        $_SESSION['cart'][$product_id] += $quantity;\n    } else {\n        $_SESSION['cart'][$product_id] = $quantity;\n    }\n}\n\n// Remove item from cart\nfunction remove_from_cart($product_id) {\n    unset($_SESSION['cart'][$product_id]);\n}\n\n// Update quantity of item in cart\nfunction update_cart($product_id, $quantity) {\n    if ($quantity > 0) {\n        $_SESSION['cart'][$product_id] = $quantity;\n    } else {\n        remove_from_cart($product_id);\n    }\n}\n?>\n```\n\n**Step 4: Create a checkout page**\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Checkout</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n\n<?php\ninclude_once(\"cart.php\");\n\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Get cart items from session\n$cart = $_SESSION['cart'];\n?>\n\n<div class=\"container mt-4\">\n    <h2>Checkout</h2>\n    \n    <!-- Shipping Details Form -->\n    <form method=\"post\" action=\"process_order.php\">\n        <div class=\"mb-3\">\n            <label for=\"name\">Name:</label>\n            <input type=\"text\" name=\"name\" id=\"name\" required class=\"form-control\">\n        </div>\n        <div class=\"mb-3\">\n            <label for=\"address\">Address:</label>\n            <textarea name=\"address\" id=\"address\" required class=\"form-control\"></textarea>\n        </div>\n        <div class=\"mb-3\">\n            <label for=\"city\">City:</label>\n            <input type=\"text\" name=\"city\" id=\"city\" required class=\"form-control\">\n        </div>\n        <div class=\"mb-3\">\n            <label for=\"state\">State:</label>\n            <input type=\"text\" name=\"state\" id=\"state\" required class=\"form-control\">\n        </div>\n        <div class=\"mb-3\">\n            <label for=\"zip_code\">Zip Code:</label>\n            <input type=\"text\" name=\"zip_code\" id=\"zip_code\" required class=\"form-control\">\n        </div>\n        \n        <!-- Payment Information -->\n        <h4>Payment Information</h4>\n        <div class=\"mb-3\">\n            <label for=\"card_number\">Card Number:</label>\n            <input type=\"text\" name=\"card_number\" id=\"card_number\" required class=\"form-control\">\n        </div>\n        <div class=\"mb-3\">\n            <label for=\"cvv\">CVV:</label>\n            <input type=\"text\" name=\"cvv\" id=\"cvv\" required class=\"form-control\">\n        </div>\n        \n        <button type=\"submit\" class=\"btn btn-primary\">Place Order</button>\n    </form>\n</div>\n\n<!-- Bootstrap JS -->\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n```\n\n**Step 5: Create order processing functionality**\n\nCreate a new file `process_order.php`:\n\n```php\n<?php\nsession_start();\n\n// Verify if user is logged in\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Database connection\ntry {\n    $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n} catch(PDOException $e) {\n    die(\"Connection failed: \" . $e->getMessage());\n}\n\n// Get cart items from session\n$cart = $_SESSION['cart'];\n\n// Check if cart is empty\nif (empty($cart)) {\n    header(\"Location: index.php\");\n    exit();\n}\n\n// Insert order into database\n$stmt = $conn->prepare(\"\n    INSERT INTO orders \n    SET user_id = ?,\n        total_amount = ?,\n        status = 'pending',\n        created_at = NOW()\n\");\n\n$total_amount = 0;\nforeach ($cart as $product_id => $quantity) {\n    // Get product price from database\n    $prod_stmt = $conn->prepare(\"SELECT price FROM products WHERE id = ?\");\n    $prod_stmt->execute([$product_id]);\n    $price = $prod_stmt->fetchColumn();\n    \n    $total_amount += $price * $quantity;\n}\n\n$stmt->execute([$_SESSION['user_id'], $total_amount]);\n\n// Get the order ID\n$order_id = $conn->lastInsertId();\n\n// Insert order details into database\nforeach ($cart as $product_id => $quantity) {\n    $details_stmt = $conn->prepare(\"\n        INSERT INTO order_details \n        SET order_id = ?,\n            product_id = ?,\n            quantity = ?,\n            created_at = NOW()\n    \");\n    $details_stmt->execute([$order_id, $product_id, $quantity]);\n}\n\n// Clear the cart\nunset($_SESSION['cart']);\n\n// Redirect to thank you page\nheader(\"Location: order_confirmation.php\");\nexit();\n?>\n```\n\n**Step 6: Create an order confirmation page**\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Order Confirmation</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n\n<div class=\"container mt-4\">\n    <h2>Thank You for Your Order!</h2>\n    <p>Your order has been successfully processed.</p>\n    <a href=\"index.php\" class=\"btn btn-primary\">Continue Shopping</a>\n</div>\n\n<!-- Bootstrap JS -->\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n```\n\n**Step 7: Create an order management system**\n\nCreate a new file `orders.php`:\n\n```php\n<?php\nsession_start();\n\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Database connection\ntry {\n    $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n} catch(PDOException $e) {\n    die(\"Connection failed: \" . $e->getMessage());\n}\n\n// Get all orders for current user\n$stmt = $conn->prepare(\"SELECT * FROM orders WHERE user_id = ? ORDER BY created_at DESC\");\n$stmt->execute([$_SESSION['user_id']]);\n$orders = $stmt->fetchAll();\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Order History</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n\n<div class=\"container mt-4\">\n    <h2>Your Order History</h2>\n    <?php if (!empty($orders)): ?>\n        <table class=\"table table-striped\">\n            <thead>\n                <tr>\n                    <th>Order ID</th>\n                    <th>Date</th>\n                    <th>Total Amount</th>\n                    <th>Status</th>\n                    <th>Action</th>\n                </tr>\n            </thead>\n            <tbody>\n                <?php foreach ($orders as $order): ?>\n                    <tr>\n                        <td><?php echo $order['id']; ?></td>\n                        <td><?php echo date('Y-m-d H:i:s', strtotime($order['created_at'])); ?></td>\n                        <td><?php echo \"$\" . number_format($order['total_amount'], 2); ?></td>\n                        <td><?php echo $order['status']; ?></td>\n                        <td><a href=\"view_order.php?id=<?php echo $order['id']; ?>\" class=\"btn btn-primary\">View Details</a></td>\n                    </tr>\n                <?php endforeach; ?>\n            </tbody>\n        </table>\n    <?php else: ?>\n        <p>No orders found.</p>\n    <?php endif; ?>\n</div>\n\n<!-- Bootstrap JS -->\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n```\n\n**Step 8: Create a view order details page**\n\nCreate a new file `view_order.php`:\n\n```php\n<?php\nsession_start();\n\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Get order ID from URL\n$order_id = isset($_GET['id']) ? intval($_GET['id']) : 0;\n\n// Database connection\ntry {\n    $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n} catch(PDOException $e) {\n    die(\"Connection failed: \" . $e->getMessage());\n}\n\n// Get order details\n$stmt = $conn->prepare(\"\n    SELECT \n        orders.*, \n        users.name as customer_name,\n        SUM(order_details.quantity * products.price) AS total_amount\n    FROM orders \n    LEFT JOIN users ON orders.user_id = users.id \n    LEFT JOIN order_details ON orders.id = order_details.order_id \n    LEFT JOIN products ON order_details.product_id = products.id \n    WHERE orders.id = ?\n\");\n$stmt->execute([$order_id]);\n$order = $stmt->fetch();\n\n// Get all items in the order\n$items_stmt = $conn->prepare(\"\n    SELECT \n        products.*,\n        order_details.quantity\n    FROM order_details \n    LEFT JOIN products ON order_details.product_id = products.id \n    WHERE order_details.order_id = ?\n\");\n$items_stmt->execute([$order_id]);\n$items = $items_stmt->fetchAll();\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Order Details</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n\n<div class=\"container mt-4\">\n    <h2>Order #<?php echo $order['id']; ?></h2>\n    \n    <div class=\"row\">\n        <div class=\"col-md-6\">\n            <h5>Customer Information:</h5>\n            <p>Name: <?php echo $order['customer_name']; ?></p>\n            <p>Email: <?php echo $order['email']; ?></p>\n            <p>Order Date: <?php echo date('Y-m-d H:i:s', strtotime($order['created_at'])); ?></p>\n            <p>Status: <?php echo $order['status']; ?></p>\n        </div>\n        \n        <div class=\"col-md-6\">\n            <h5>Order Summary:</h5>\n            <table class=\"table table-striped\">\n                <thead>\n                    <tr>\n                        <th>Product</th>\n                        <th>Quantity</th>\n                        <th>Price</th>\n                        <th>Total</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach ($items as $item): ?>\n                        <tr>\n                            <td><?php echo $item['name']; ?></td>\n                            <td><?php echo $item['quantity']; ?></td>\n                            <td><?php echo \"$\" . number_format($item['price'], 2); ?></td>\n                            <td><?php echo \"$\" . number_format($item['price'] * $item['quantity'], 2); ?></td>\n                        </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n    </div>\n</div>\n\n<!-- Bootstrap JS -->\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n```\n\n**Database Setup**\n\nMake sure you have the following tables in your database:\n\n```sql\n-- Table structure for products\nCREATE TABLE `products` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(255) NOT NULL,\n  `price` decimal(10,2) NOT NULL,\n  `description` text NOT NULL,\n  `image` varchar(255) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n);\n\n-- Table structure for users\nCREATE TABLE `users` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(255) NOT NULL,\n  `email` varchar(255) NOT NULL UNIQUE,\n  `password` varchar(255) NOT NULL,\n  PRIMARY KEY (`id`)\n);\n\n-- Table structure for orders\nCREATE TABLE `orders` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `user_id` int(11) NOT NULL,\n  `total_amount` decimal(10,2) NOT NULL,\n  `status` varchar(50) NOT NULL DEFAULT 'pending',\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n);\n\n-- Table structure for order_details\nCREATE TABLE `order_details` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `order_id` int(11) NOT NULL,\n  `product_id` int(11) NOT NULL,\n  `quantity` int(11) NOT NULL,\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`)\n);\n```\n\n**Features**\n\nThis e-commerce system includes:\n\n- Product management\n- User registration and login\n- Shopping cart functionality\n- Order processing and confirmation\n- Order history tracking\n- Detailed order viewing\n- Secure payment integration (you'll need to add this based on your requirements)\n- Front-end using Bootstrap for responsive design\n\n**Security Notes**\n\n- Passwords should be hashed before storing in the database.\n- Implement CSRF protection for forms.\n- Sanitize all user inputs to prevent SQL injection and XSS attacks.\n- Use HTTPS for secure transactions.\n- Regularly backup your database.\n\n**Customization**\n\nYou can customize this basic e-commerce system by:\n\n- Adding more product attributes\n- Implementing different payment methods\n- Adding shipping options and costs\n- Creating an admin panel for managing products, users, and orders\n- Adding reviews and ratings system\n- Including a search functionality\n- Integrating social media features\n- Adding wishlist functionality\n\nRemember to adjust the database connection details (host, dbname, username, password) in all your PHP files according to your actual database setup.\n\n**Note**: This is a basic implementation. In a production environment, you would need to add more security measures, error handling, and possibly implement an MVC framework for better structure.", "code_blocks": [null, null, "```php\n<?php\nsession_start();\n\nif (!isset($_SESSION['cart'])) {\n    $_SESSION['cart'] = array();\n}\n\n// Add item to cart\nfunction add_to_cart($product_id, $quantity) {\n    if (isset($_SESSION['cart'][$product_id])) {\n        $_SESSION['cart'][$product_id] += $quantity;\n    } else {\n        $_SESSION['cart'][$product_id] = $quantity;\n    }\n}\n\n// Remove item from cart\nfunction remove_from_cart($product_id) {\n    unset($_SESSION['cart'][$product_id]);\n}\n\n// Update quantity of item in cart\nfunction update_cart($product_id, $quantity) {\n    if ($quantity > 0) {\n        $_SESSION['cart'][$product_id] = $quantity;\n    } else {\n        remove_from_cart($product_id);\n    }\n}\n?>\n```", null, "```php\n<?php\nsession_start();\n\n// Verify if user is logged in\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Database connection\ntry {\n    $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n} catch(PDOException $e) {\n    die(\"Connection failed: \" . $e->getMessage());\n}\n\n// Get cart items from session\n$cart = $_SESSION['cart'];\n\n// Check if cart is empty\nif (empty($cart)) {\n    header(\"Location: index.php\");\n    exit();\n}\n\n// Insert order into database\n$stmt = $conn->prepare(\"\n    INSERT INTO orders \n    SET user_id = ?,\n        total_amount = ?,\n        status = 'pending',\n        created_at = NOW()\n\");\n\n$total_amount = 0;\nforeach ($cart as $product_id => $quantity) {\n    // Get product price from database\n    $prod_stmt = $conn->prepare(\"SELECT price FROM products WHERE id = ?\");\n    $prod_stmt->execute([$product_id]);\n    $price = $prod_stmt->fetchColumn();\n    \n    $total_amount += $price * $quantity;\n}\n\n$stmt->execute([$_SESSION['user_id'], $total_amount]);\n\n// Get the order ID\n$order_id = $conn->lastInsertId();\n\n// Insert order details into database\nforeach ($cart as $product_id => $quantity) {\n    $details_stmt = $conn->prepare(\"\n        INSERT INTO order_details \n        SET order_id = ?,\n            product_id = ?,\n            quantity = ?,\n            created_at = NOW()\n    \");\n    $details_stmt->execute([$order_id, $product_id, $quantity]);\n}\n\n// Clear the cart\nunset($_SESSION['cart']);\n\n// Redirect to thank you page\nheader(\"Location: order_confirmation.php\");\nexit();\n?>\n```", null, "```php\n<?php\nsession_start();\n\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Database connection\ntry {\n    $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n} catch(PDOException $e) {\n    die(\"Connection failed: \" . $e->getMessage());\n}\n\n// Get all orders for current user\n$stmt = $conn->prepare(\"SELECT * FROM orders WHERE user_id = ? ORDER BY created_at DESC\");\n$stmt->execute([$_SESSION['user_id']]);\n$orders = $stmt->fetchAll();\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Order History</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n\n<div class=\"container mt-4\">\n    <h2>Your Order History</h2>\n    <?php if (!empty($orders)): ?>\n        <table class=\"table table-striped\">\n            <thead>\n                <tr>\n                    <th>Order ID</th>\n                    <th>Date</th>\n                    <th>Total Amount</th>\n                    <th>Status</th>\n                    <th>Action</th>\n                </tr>\n            </thead>\n            <tbody>\n                <?php foreach ($orders as $order): ?>\n                    <tr>\n                        <td><?php echo $order['id']; ?></td>\n                        <td><?php echo date('Y-m-d H:i:s', strtotime($order['created_at'])); ?></td>\n                        <td><?php echo \"$\" . number_format($order['total_amount'], 2); ?></td>\n                        <td><?php echo $order['status']; ?></td>\n                        <td><a href=\"view_order.php?id=<?php echo $order['id']; ?>\" class=\"btn btn-primary\">View Details</a></td>\n                    </tr>\n                <?php endforeach; ?>\n            </tbody>\n        </table>\n    <?php else: ?>\n        <p>No orders found.</p>\n    <?php endif; ?>\n</div>\n\n<!-- Bootstrap JS -->\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n```", "```php\n<?php\nsession_start();\n\nif (!isset($_SESSION['user_id'])) {\n    header(\"Location: login.php\");\n    exit();\n}\n\n// Get order ID from URL\n$order_id = isset($_GET['id']) ? intval($_GET['id']) : 0;\n\n// Database connection\ntry {\n    $conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n} catch(PDOException $e) {\n    die(\"Connection failed: \" . $e->getMessage());\n}\n\n// Get order details\n$stmt = $conn->prepare(\"\n    SELECT \n        orders.*, \n        users.name as customer_name,\n        SUM(order_details.quantity * products.price) AS total_amount\n    FROM orders \n    LEFT JOIN users ON orders.user_id = users.id \n    LEFT JOIN order_details ON orders.id = order_details.order_id \n    LEFT JOIN products ON order_details.product_id = products.id \n    WHERE orders.id = ?\n\");\n$stmt->execute([$order_id]);\n$order = $stmt->fetch();\n\n// Get all items in the order\n$items_stmt = $conn->prepare(\"\n    SELECT \n        products.*,\n        order_details.quantity\n    FROM order_details \n    LEFT JOIN products ON order_details.product_id = products.id \n    WHERE order_details.order_id = ?\n\");\n$items_stmt->execute([$order_id]);\n$items = $items_stmt->fetchAll();\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Order Details</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n</head>\n<body>\n\n<div class=\"container mt-4\">\n    <h2>Order #<?php echo $order['id']; ?></h2>\n    \n    <div class=\"row\">\n        <div class=\"col-md-6\">\n            <h5>Customer Information:</h5>\n            <p>Name: <?php echo $order['customer_name']; ?></p>\n            <p>Email: <?php echo $order['email']; ?></p>\n            <p>Order Date: <?php echo date('Y-m-d H:i:s', strtotime($order['created_at'])); ?></p>\n            <p>Status: <?php echo $order['status']; ?></p>\n        </div>\n        \n        <div class=\"col-md-6\">\n            <h5>Order Summary:</h5>\n            <table class=\"table table-striped\">\n                <thead>\n                    <tr>\n                        <th>Product</th>\n                        <th>Quantity</th>\n                        <th>Price</th>\n                        <th>Total</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <?php foreach ($items as $item): ?>\n                        <tr>\n                            <td><?php echo $item['name']; ?></td>\n                            <td><?php echo $item['quantity']; ?></td>\n                            <td><?php echo \"$\" . number_format($item['price'], 2); ?></td>\n                            <td><?php echo \"$\" . number_format($item['price'] * $item['quantity'], 2); ?></td>\n                        </tr>\n                    <?php endforeach; ?>\n                </tbody>\n            </table>\n        </div>\n    </div>\n</div>\n\n<!-- Bootstrap JS -->\n<script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js\"></script>\n</body>\n</html>\n```", null]}
