{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP. This example includes user registration, login, and purchasing products.\n\n**Database Schema:**\nWe will be using MySQL for our database. The schema should include the following tables:\n\n*   `users`: stores information about users\n*   `products`: stores information about available products\n*   `orders`: stores information about purchased orders\n\n```sql\nCREATE TABLE users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(255),\n    email VARCHAR(255) UNIQUE,\n    password VARCHAR(255)\n);\n\nCREATE TABLE products (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    product_name VARCHAR(255),\n    price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    user_id INT,\n    product_id INT,\n    purchase_date DATE,\n    FOREIGN KEY (user_id) REFERENCES users(id),\n    FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code:**\n\n```php\n<?php\n\n// Configuration File\nrequire_once 'config.php';\n\n// Functions for User Management\nfunction registerUser($name, $email, $password) {\n    global $db;\n    \n    $query = \"INSERT INTO users (name, email, password) VALUES ('$name', '$email', '$password')\";\n    mysqli_query($db, $query);\n}\n\nfunction loginUser($email, $password) {\n    global $db;\n    \n    $query = \"SELECT * FROM users WHERE email='$email' AND password='$password'\";\n    $result = mysqli_query($db, $query);\n    \n    if (mysqli_num_rows($result) > 0) {\n        return true; // Login successful\n    } else {\n        return false; // Login failed\n    }\n}\n\n// Functions for Product Management\nfunction addProduct($product_name, $price) {\n    global $db;\n    \n    $query = \"INSERT INTO products (product_name, price) VALUES ('$product_name', '$price')\";\n    mysqli_query($db, $query);\n}\n\nfunction removeProduct($id) {\n    global $db;\n    \n    $query = \"DELETE FROM products WHERE id='$id'\";\n    mysqli_query($db, $query);\n}\n\n// Functions for Purchase Management\nfunction addOrder($user_id, $product_id) {\n    global $db;\n    \n    $query = \"INSERT INTO orders (user_id, product_id, purchase_date) VALUES ('$user_id', '$product_id', NOW())\";\n    mysqli_query($db, $query);\n}\n\nfunction viewOrders() {\n    global $db;\n    \n    $query = \"SELECT * FROM orders JOIN users ON orders.user_id=users.id JOIN products ON orders.product_id=products.id\";\n    $result = mysqli_query($db, $query);\n    \n    return mysqli_fetch_all($result);\n}\n\n// Product Page\nif (isset($_POST['add_product'])) {\n    $product_name = $_POST['product_name'];\n    $price = $_POST['price'];\n    \n    addProduct($product_name, $price);\n}\n\n// Purchase Page\nif (isset($_POST['buy_product'])) {\n    $user_id = $_SESSION['user_id'];\n    $product_id = $_GET['id'];\n    \n    addOrder($user_id, $product_id);\n}\n\n// User Registration Page\nif (isset($_POST['register_user'])) {\n    $name = $_POST['name'];\n    $email = $_POST['email'];\n    $password = md5($_POST['password']);\n    \n    registerUser($name, $email, $password);\n}\n\n?>\n```\n\n**index.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_SESSION['user_id'])) {\n    echo \"<h1>Logged in as \" . $_SESSION['name'] . \"</h1>\";\n} else {\n    echo '<a href=\"login.php\">Login</a>';\n}\n\necho '<form action=\"\" method=\"POST\">';\necho '<label for=\"product_name\">Product Name:</label><br>';\necho '<input type=\"text\" id=\"product_name\" name=\"product_name\"><br>';\necho '<label for=\"price\">Price:</label><br>';\necho '<input type=\"number\" id=\"price\" name=\"price\"><br>';\necho '<input type=\"submit\" value=\"Add Product\" name=\"add_product\">';\necho '</form>';\n\necho '<h1>Products</h1>';\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($db, $query);\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo '<a href=\"?id=' . $row['id'] . '\">Buy ' . $row['product_name'] . '</a><br>';\n}\n\necho '<form action=\"\" method=\"POST\">';\necho '<label for=\"name\">Name:</label><br>';\necho '<input type=\"text\" id=\"name\" name=\"name\"><br>';\necho '<label for=\"email\">Email:</label><br>';\necho '<input type=\"email\" id=\"email\" name=\"email\"><br>';\necho '<label for=\"password\">Password:</label><br>';\necho '<input type=\"password\" id=\"password\" name=\"password\"><br>';\necho '<input type=\"submit\" value=\"Register User\" name=\"register_user\">';\necho '</form>';\n\n?>\n```\n\n**login.php**\n\n```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['login'])) {\n    $email = $_POST['email'];\n    $password = md5($_POST['password']);\n    \n    if (loginUser($email, $password)) {\n        $query = \"SELECT * FROM users WHERE email='$email'\";\n        $result = mysqli_query($db, $query);\n        \n        $row = mysqli_fetch_assoc($result);\n        $_SESSION['user_id'] = $row['id'];\n        $_SESSION['name'] = $row['name'];\n    } else {\n        echo 'Invalid credentials';\n    }\n}\n\n?>\n```\n\nThis code creates a basic system for user registration, login, and purchasing products. The `registerUser` function adds new users to the database, while `loginUser` checks if a user exists in the database with matching email and password. The `addProduct` function allows administrators to add new products, and the `buy_product` function adds orders when a product is purchased.\n\nThe code includes links for users to buy products, as well as forms for adding products and registering users. The login form checks if a user's credentials are valid before logging them in.\n\nThis example assumes that you have already set up a MySQL database with the necessary tables (users, products, orders) and populated it with some initial data.", "code_blocks": [null, "```php\n<?php\n\n// Configuration File\nrequire_once 'config.php';\n\n// Functions for User Management\nfunction registerUser($name, $email, $password) {\n    global $db;\n    \n    $query = \"INSERT INTO users (name, email, password) VALUES ('$name', '$email', '$password')\";\n    mysqli_query($db, $query);\n}\n\nfunction loginUser($email, $password) {\n    global $db;\n    \n    $query = \"SELECT * FROM users WHERE email='$email' AND password='$password'\";\n    $result = mysqli_query($db, $query);\n    \n    if (mysqli_num_rows($result) > 0) {\n        return true; // Login successful\n    } else {\n        return false; // Login failed\n    }\n}\n\n// Functions for Product Management\nfunction addProduct($product_name, $price) {\n    global $db;\n    \n    $query = \"INSERT INTO products (product_name, price) VALUES ('$product_name', '$price')\";\n    mysqli_query($db, $query);\n}\n\nfunction removeProduct($id) {\n    global $db;\n    \n    $query = \"DELETE FROM products WHERE id='$id'\";\n    mysqli_query($db, $query);\n}\n\n// Functions for Purchase Management\nfunction addOrder($user_id, $product_id) {\n    global $db;\n    \n    $query = \"INSERT INTO orders (user_id, product_id, purchase_date) VALUES ('$user_id', '$product_id', NOW())\";\n    mysqli_query($db, $query);\n}\n\nfunction viewOrders() {\n    global $db;\n    \n    $query = \"SELECT * FROM orders JOIN users ON orders.user_id=users.id JOIN products ON orders.product_id=products.id\";\n    $result = mysqli_query($db, $query);\n    \n    return mysqli_fetch_all($result);\n}\n\n// Product Page\nif (isset($_POST['add_product'])) {\n    $product_name = $_POST['product_name'];\n    $price = $_POST['price'];\n    \n    addProduct($product_name, $price);\n}\n\n// Purchase Page\nif (isset($_POST['buy_product'])) {\n    $user_id = $_SESSION['user_id'];\n    $product_id = $_GET['id'];\n    \n    addOrder($user_id, $product_id);\n}\n\n// User Registration Page\nif (isset($_POST['register_user'])) {\n    $name = $_POST['name'];\n    $email = $_POST['email'];\n    $password = md5($_POST['password']);\n    \n    registerUser($name, $email, $password);\n}\n\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_SESSION['user_id'])) {\n    echo \"<h1>Logged in as \" . $_SESSION['name'] . \"</h1>\";\n} else {\n    echo '<a href=\"login.php\">Login</a>';\n}\n\necho '<form action=\"\" method=\"POST\">';\necho '<label for=\"product_name\">Product Name:</label><br>';\necho '<input type=\"text\" id=\"product_name\" name=\"product_name\"><br>';\necho '<label for=\"price\">Price:</label><br>';\necho '<input type=\"number\" id=\"price\" name=\"price\"><br>';\necho '<input type=\"submit\" value=\"Add Product\" name=\"add_product\">';\necho '</form>';\n\necho '<h1>Products</h1>';\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($db, $query);\n\nwhile ($row = mysqli_fetch_assoc($result)) {\n    echo '<a href=\"?id=' . $row['id'] . '\">Buy ' . $row['product_name'] . '</a><br>';\n}\n\necho '<form action=\"\" method=\"POST\">';\necho '<label for=\"name\">Name:</label><br>';\necho '<input type=\"text\" id=\"name\" name=\"name\"><br>';\necho '<label for=\"email\">Email:</label><br>';\necho '<input type=\"email\" id=\"email\" name=\"email\"><br>';\necho '<label for=\"password\">Password:</label><br>';\necho '<input type=\"password\" id=\"password\" name=\"password\"><br>';\necho '<input type=\"submit\" value=\"Register User\" name=\"register_user\">';\necho '</form>';\n\n?>\n```", "```php\n<?php\nrequire_once 'config.php';\n\nif (isset($_POST['login'])) {\n    $email = $_POST['email'];\n    $password = md5($_POST['password']);\n    \n    if (loginUser($email, $password)) {\n        $query = \"SELECT * FROM users WHERE email='$email'\";\n        $result = mysqli_query($db, $query);\n        \n        $row = mysqli_fetch_assoc($result);\n        $_SESSION['user_id'] = $row['id'];\n        $_SESSION['name'] = $row['name'];\n    } else {\n        echo 'Invalid credentials';\n    }\n}\n\n?>\n```"]}
