{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP, HTML, and MySQL. This example includes user registration, login, and purchasing products.\n\n**Database Setup**\n\nCreate a database named `store` with the following tables:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255),\n  password VARCHAR(255)\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  product_id INT,\n  quantity INT\n);\n```\n\n**PHP Code**\n\nCreate a new file named `store.php` and add the following code:\n\n```php\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'store';\n\n// Connect to database\n$conn = mysqli_connect($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\nfunction registerUser() {\n  global $conn;\n  \n  if (isset($_POST['register'])) {\n    $username = $_POST['username'];\n    $password = password_hash($_POST['password'], PASSWORD_DEFAULT);\n    \n    // Validate user input\n    if (empty($username) || empty($password)) {\n      echo 'Please fill in all fields';\n      return;\n    }\n    \n    // Insert new user into database\n    $query = \"INSERT INTO users (username, password) VALUES ('$username', '$password')\";\n    mysqli_query($conn, $query);\n  }\n}\n\nfunction loginUser() {\n  global $conn;\n  \n  if (isset($_POST['login'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n    \n    // Validate user input\n    if (empty($username) || empty($password)) {\n      echo 'Please fill in all fields';\n      return;\n    }\n    \n    // Check existing username and password in database\n    $query = \"SELECT * FROM users WHERE username='$username' AND password='$password'\";\n    $result = mysqli_query($conn, $query);\n    \n    if (mysqli_num_rows($result) > 0) {\n      $_SESSION['loggedIn'] = true;\n    } else {\n      echo 'Invalid username or password';\n    }\n  }\n}\n\nfunction purchaseProduct() {\n  global $conn;\n  \n  if (isset($_POST['purchase'])) {\n    $productId = $_POST['product'];\n    $quantity = $_POST['quantity'];\n    \n    // Validate user input\n    if (empty($productId) || empty($quantity)) {\n      echo 'Please fill in all fields';\n      return;\n    }\n    \n    // Insert new order into database\n    $query = \"INSERT INTO orders (user_id, product_id, quantity) VALUES ('$_SESSION[user_id]', '$productId', '$quantity')\";\n    mysqli_query($conn, $query);\n  }\n}\n\n// Check if user is logged in\nif (!isset($_SESSION['loggedIn'])) {\n  echo 'Please login or register to purchase a product';\n} else {\n  // Display products for sale\n  $query = \"SELECT * FROM products\";\n  $result = mysqli_query($conn, $query);\n  \n  while ($row = mysqli_fetch_assoc($result)) {\n    echo '<h2>' . $row['name'] . '</h2>';\n    echo 'Price: $' . $row['price'];\n    \n    // Display purchase form\n    echo '<form action=\"\" method=\"post\">';\n    echo '<input type=\"hidden\" name=\"product\" value=\"' . $row['id'] . '\">';\n    echo '<label>Quantity:</label>';\n    echo '<input type=\"number\" name=\"quantity\"><br><br>';\n    echo '<button type=\"submit\" name=\"purchase\">Purchase</button>';\n    echo '</form>';\n  }\n}\n\n// Check if user has clicked register button\nif (isset($_POST['register'])) {\n  registerUser();\n}\n\n// Check if user has clicked login button\nif (isset($_POST['login'])) {\n  loginUser();\n}\n\n// Check if user has clicked purchase button\nif (isset($_POST['purchase'])) {\n  purchaseProduct();\n}\n```\n\n**HTML Code**\n\nCreate a new file named `index.html` and add the following code:\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Store</title>\n</head>\n<body>\n  \n  <!-- Register form -->\n  <h2>Register</h2>\n  <form action=\"\" method=\"post\">\n    <label>Username:</label><br>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label><br>\n    <input type=\"password\" name=\"password\"><br><br>\n    <button type=\"submit\" name=\"register\">Register</button>\n  </form>\n  \n  <!-- Login form -->\n  <h2>Login</h2>\n  <form action=\"\" method=\"post\">\n    <label>Username:</label><br>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label><br>\n    <input type=\"password\" name=\"password\"><br><br>\n    <button type=\"submit\" name=\"login\">Login</button>\n  </form>\n  \n  <!-- Purchase form -->\n  <?php if (isset($_SESSION['loggedIn'])) { ?>\n  <h2>Purchase Products</h2>\n  <?php } else { ?>\n  <p>Please login or register to purchase a product</p>\n  <?php } ?>\n</body>\n</html>\n```\n\nThis code provides a simple registration and login system, as well as the ability for users to purchase products. The `registerUser` function inserts new users into the database when the user clicks the \"Register\" button. The `loginUser` function checks existing usernames and passwords in the database when the user clicks the \"Login\" button. The `purchaseProduct` function inserts new orders into the database when the user clicks the \"Purchase\" button.\n\nNote: This is a basic example and you should not use this code as-is for production purposes. You should consider implementing proper security measures to protect your users' data, such as validating and sanitizing user input, using prepared statements, and hashing passwords securely.", "code_blocks": [null, "```php\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'store';\n\n// Connect to database\n$conn = mysqli_connect($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\nfunction registerUser() {\n  global $conn;\n  \n  if (isset($_POST['register'])) {\n    $username = $_POST['username'];\n    $password = password_hash($_POST['password'], PASSWORD_DEFAULT);\n    \n    // Validate user input\n    if (empty($username) || empty($password)) {\n      echo 'Please fill in all fields';\n      return;\n    }\n    \n    // Insert new user into database\n    $query = \"INSERT INTO users (username, password) VALUES ('$username', '$password')\";\n    mysqli_query($conn, $query);\n  }\n}\n\nfunction loginUser() {\n  global $conn;\n  \n  if (isset($_POST['login'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n    \n    // Validate user input\n    if (empty($username) || empty($password)) {\n      echo 'Please fill in all fields';\n      return;\n    }\n    \n    // Check existing username and password in database\n    $query = \"SELECT * FROM users WHERE username='$username' AND password='$password'\";\n    $result = mysqli_query($conn, $query);\n    \n    if (mysqli_num_rows($result) > 0) {\n      $_SESSION['loggedIn'] = true;\n    } else {\n      echo 'Invalid username or password';\n    }\n  }\n}\n\nfunction purchaseProduct() {\n  global $conn;\n  \n  if (isset($_POST['purchase'])) {\n    $productId = $_POST['product'];\n    $quantity = $_POST['quantity'];\n    \n    // Validate user input\n    if (empty($productId) || empty($quantity)) {\n      echo 'Please fill in all fields';\n      return;\n    }\n    \n    // Insert new order into database\n    $query = \"INSERT INTO orders (user_id, product_id, quantity) VALUES ('$_SESSION[user_id]', '$productId', '$quantity')\";\n    mysqli_query($conn, $query);\n  }\n}\n\n// Check if user is logged in\nif (!isset($_SESSION['loggedIn'])) {\n  echo 'Please login or register to purchase a product';\n} else {\n  // Display products for sale\n  $query = \"SELECT * FROM products\";\n  $result = mysqli_query($conn, $query);\n  \n  while ($row = mysqli_fetch_assoc($result)) {\n    echo '<h2>' . $row['name'] . '</h2>';\n    echo 'Price: $' . $row['price'];\n    \n    // Display purchase form\n    echo '<form action=\"\" method=\"post\">';\n    echo '<input type=\"hidden\" name=\"product\" value=\"' . $row['id'] . '\">';\n    echo '<label>Quantity:</label>';\n    echo '<input type=\"number\" name=\"quantity\"><br><br>';\n    echo '<button type=\"submit\" name=\"purchase\">Purchase</button>';\n    echo '</form>';\n  }\n}\n\n// Check if user has clicked register button\nif (isset($_POST['register'])) {\n  registerUser();\n}\n\n// Check if user has clicked login button\nif (isset($_POST['login'])) {\n  loginUser();\n}\n\n// Check if user has clicked purchase button\nif (isset($_POST['purchase'])) {\n  purchaseProduct();\n}\n```", null]}
