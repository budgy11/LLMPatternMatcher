{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP:\n\n**purchase.php**\n```php\n<?php\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'username';\n$db_password = 'password';\n$db_name = 'shop';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to get products from database\nfunction getProducts() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n    return $result->fetch_all(MYSQLI_ASSOC);\n}\n\n// Function to add product to cart\nfunction addToCart($product_id, $quantity) {\n    global $conn;\n    $query = \"INSERT INTO cart (product_id, quantity) VALUES ('$product_id', '$quantity')\";\n    $conn->query($query);\n}\n\n// Function to remove product from cart\nfunction removeFromCart($product_id) {\n    global $conn;\n    $query = \"DELETE FROM cart WHERE product_id = '$product_id'\";\n    $conn->query($query);\n}\n\n// Function to calculate total cost of items in cart\nfunction calculateTotalCost() {\n    global $conn;\n    $query = \"SELECT SUM(quantity * price) as total_cost FROM products JOIN cart ON products.id = cart.product_id\";\n    $result = $conn->query($query);\n    return $result->fetch_assoc()['total_cost'];\n}\n\n// Function to place order\nfunction placeOrder() {\n    global $conn;\n    // Get current date and time\n    $current_date = date('Y-m-d H:i:s');\n    \n    // Insert new order into database\n    $query = \"INSERT INTO orders (date, total_cost) VALUES ('$current_date', '\" . calculateTotalCost() . \"')\";\n    $conn->query($query);\n    \n    // Delete items from cart after successful payment\n    $query = \"TRUNCATE TABLE cart\";\n    $conn->query($query);\n}\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get product id and quantity\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n    \n    // Add product to cart\n    addToCart($product_id, $quantity);\n    \n    // Redirect user to cart page\n    header('Location: cart.php');\n    exit;\n}\n\n// Display products on page\n$products = getProducts();\n\n?>\n\n<html>\n<head>\n    <title>Shop</title>\n</head>\n<body>\n    <h1>Shop</h1>\n    \n    <?php foreach ($products as $product) { ?>\n        <p>\n            <?php echo $product['name']; ?> (<?php echo $product['price']; ?>)\n            <form action=\"\" method=\"post\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product['id']; ?>\">\n                <input type=\"number\" name=\"quantity\" value=\"1\">\n                <button type=\"submit\">Add to Cart</button>\n            </form>\n        </p>\n    <?php } ?>\n    \n    <a href=\"cart.php\">View Cart</a>\n    \n    <?php if (isset($_POST['place_order'])) { ?>\n        <p>Total Cost: <?php echo calculateTotalCost(); ?></p>\n        <form action=\"\" method=\"post\">\n            <button type=\"submit\" name=\"place_order\">Place Order</button>\n        </form>\n    <?php } ?>\n    \n</body>\n</html>\n\n<?php\n// Close database connection\n$conn->close();\n?>\n```\nThis code creates a simple shop with products that can be added to cart. When the user submits the form, it adds the product to the cart and redirects them to the cart page. The total cost of items in the cart is calculated using the `calculateTotalCost()` function.\n\nTo place an order, the user must submit the \"Place Order\" button on the cart page. This will delete all items from the cart and insert a new order into the database with the current date and time.\n\nPlease note that this is a basic example and you should consider implementing security measures such as validation and sanitization of user input to prevent SQL injection attacks.\n\n**cart.php**\n```php\n<?php\n\n// Include purchase.php file\nrequire_once 'purchase.php';\n\n?>\n\n<html>\n<head>\n    <title>Cart</title>\n</head>\n<body>\n    <h1>Cart</h1>\n    \n    <?php $cart_products = getProductsFromCart(); ?>\n    \n    <?php foreach ($cart_products as $product) { ?>\n        <p>\n            <?php echo $product['name']; ?> (<?php echo $product['price']; ?>)\n            <form action=\"\" method=\"post\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product['id']; ?>\">\n                <button type=\"submit\">Remove from Cart</button>\n            </form>\n        </p>\n    <?php } ?>\n    \n    <a href=\"index.php\">Back to Shop</a>\n    \n    <?php if (isset($_POST['place_order'])) { ?>\n        <p>Total Cost: <?php echo calculateTotalCost(); ?></p>\n        <form action=\"\" method=\"post\">\n            <button type=\"submit\" name=\"place_order\">Place Order</button>\n        </form>\n    <?php } ?>\n    \n</body>\n</html>\n\n<?php\n// Function to get products from cart\nfunction getProductsFromCart() {\n    global $conn;\n    $query = \"SELECT * FROM products JOIN cart ON products.id = cart.product_id\";\n    return $conn->query($query)->fetch_all(MYSQLI_ASSOC);\n}\n\n?>\n```\nThis code includes the `purchase.php` file and displays the products in the cart. The user can remove items from the cart by submitting the form.\n\n**order.php**\n```php\n<?php\n\n// Include purchase.php file\nrequire_once 'purchase.php';\n\n?>\n\n<html>\n<head>\n    <title>Order</title>\n</head>\n<body>\n    <h1>Order</h1>\n    \n    <?php $orders = getOrders(); ?>\n    \n    <?php foreach ($orders as $order) { ?>\n        <p>\n            Date: <?php echo $order['date']; ?> - Total Cost: <?php echo $order['total_cost']; ?>\n        </p>\n    <?php } ?>\n    \n</body>\n</html>\n\n<?php\n// Function to get orders\nfunction getOrders() {\n    global $conn;\n    $query = \"SELECT * FROM orders\";\n    return $conn->query($query)->fetch_all(MYSQLI_ASSOC);\n}\n\n?>\n```\nThis code includes the `purchase.php` file and displays the orders.\n\nNote: This is a basic example and you should consider implementing security measures such as validation and sanitization of user input to prevent SQL injection attacks.", "code_blocks": ["```php\n<?php\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'username';\n$db_password = 'password';\n$db_name = 'shop';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to get products from database\nfunction getProducts() {\n    global $conn;\n    $query = \"SELECT * FROM products\";\n    $result = $conn->query($query);\n    return $result->fetch_all(MYSQLI_ASSOC);\n}\n\n// Function to add product to cart\nfunction addToCart($product_id, $quantity) {\n    global $conn;\n    $query = \"INSERT INTO cart (product_id, quantity) VALUES ('$product_id', '$quantity')\";\n    $conn->query($query);\n}\n\n// Function to remove product from cart\nfunction removeFromCart($product_id) {\n    global $conn;\n    $query = \"DELETE FROM cart WHERE product_id = '$product_id'\";\n    $conn->query($query);\n}\n\n// Function to calculate total cost of items in cart\nfunction calculateTotalCost() {\n    global $conn;\n    $query = \"SELECT SUM(quantity * price) as total_cost FROM products JOIN cart ON products.id = cart.product_id\";\n    $result = $conn->query($query);\n    return $result->fetch_assoc()['total_cost'];\n}\n\n// Function to place order\nfunction placeOrder() {\n    global $conn;\n    // Get current date and time\n    $current_date = date('Y-m-d H:i:s');\n    \n    // Insert new order into database\n    $query = \"INSERT INTO orders (date, total_cost) VALUES ('$current_date', '\" . calculateTotalCost() . \"')\";\n    $conn->query($query);\n    \n    // Delete items from cart after successful payment\n    $query = \"TRUNCATE TABLE cart\";\n    $conn->query($query);\n}\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get product id and quantity\n    $product_id = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n    \n    // Add product to cart\n    addToCart($product_id, $quantity);\n    \n    // Redirect user to cart page\n    header('Location: cart.php');\n    exit;\n}\n\n// Display products on page\n$products = getProducts();\n\n?>\n\n<html>\n<head>\n    <title>Shop</title>\n</head>\n<body>\n    <h1>Shop</h1>\n    \n    <?php foreach ($products as $product) { ?>\n        <p>\n            <?php echo $product['name']; ?> (<?php echo $product['price']; ?>)\n            <form action=\"\" method=\"post\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product['id']; ?>\">\n                <input type=\"number\" name=\"quantity\" value=\"1\">\n                <button type=\"submit\">Add to Cart</button>\n            </form>\n        </p>\n    <?php } ?>\n    \n    <a href=\"cart.php\">View Cart</a>\n    \n    <?php if (isset($_POST['place_order'])) { ?>\n        <p>Total Cost: <?php echo calculateTotalCost(); ?></p>\n        <form action=\"\" method=\"post\">\n            <button type=\"submit\" name=\"place_order\">Place Order</button>\n        </form>\n    <?php } ?>\n    \n</body>\n</html>\n\n<?php\n// Close database connection\n$conn->close();\n?>\n```", "```php\n<?php\n\n// Include purchase.php file\nrequire_once 'purchase.php';\n\n?>\n\n<html>\n<head>\n    <title>Cart</title>\n</head>\n<body>\n    <h1>Cart</h1>\n    \n    <?php $cart_products = getProductsFromCart(); ?>\n    \n    <?php foreach ($cart_products as $product) { ?>\n        <p>\n            <?php echo $product['name']; ?> (<?php echo $product['price']; ?>)\n            <form action=\"\" method=\"post\">\n                <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product['id']; ?>\">\n                <button type=\"submit\">Remove from Cart</button>\n            </form>\n        </p>\n    <?php } ?>\n    \n    <a href=\"index.php\">Back to Shop</a>\n    \n    <?php if (isset($_POST['place_order'])) { ?>\n        <p>Total Cost: <?php echo calculateTotalCost(); ?></p>\n        <form action=\"\" method=\"post\">\n            <button type=\"submit\" name=\"place_order\">Place Order</button>\n        </form>\n    <?php } ?>\n    \n</body>\n</html>\n\n<?php\n// Function to get products from cart\nfunction getProductsFromCart() {\n    global $conn;\n    $query = \"SELECT * FROM products JOIN cart ON products.id = cart.product_id\";\n    return $conn->query($query)->fetch_all(MYSQLI_ASSOC);\n}\n\n?>\n```", "```php\n<?php\n\n// Include purchase.php file\nrequire_once 'purchase.php';\n\n?>\n\n<html>\n<head>\n    <title>Order</title>\n</head>\n<body>\n    <h1>Order</h1>\n    \n    <?php $orders = getOrders(); ?>\n    \n    <?php foreach ($orders as $order) { ?>\n        <p>\n            Date: <?php echo $order['date']; ?> - Total Cost: <?php echo $order['total_cost']; ?>\n        </p>\n    <?php } ?>\n    \n</body>\n</html>\n\n<?php\n// Function to get orders\nfunction getOrders() {\n    global $conn;\n    $query = \"SELECT * FROM orders\";\n    return $conn->query($query)->fetch_all(MYSQLI_ASSOC);\n}\n\n?>\n```"]}
