{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP:\n\n**Step 1: User Selects Product**\n\nLet's assume we have a simple product table with the following columns:\n\n| id | name | price |\n| --- | --- | --- |\n| 1  | iPhone | 1000.00 |\n| 2  | Samsung TV | 800.00 |\n\nIn our PHP code, we'll create a form to allow users to select a product:\n```php\n// products.php\n\n<?php\n\n// Connect to database (e.g. MySQL)\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Select all products from table\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n\n?>\n\n<html>\n<head>\n  <title>Products</title>\n</head>\n<body>\n\n<form action=\"purchase.php\" method=\"post\">\n  <select name=\"product_id\">\n    <?php while ($row = mysqli_fetch_assoc($result)) { ?>\n      <option value=\"<?php echo $row['id']; ?>\"><?php echo $row['name']; ?></option>\n    <?php } ?>\n  </select>\n\n  <input type=\"submit\" value=\"Add to Cart\">\n</form>\n\n</body>\n</html>\n```\n**Step 2: User Adds Product to Cart**\n\nIn `purchase.php`, we'll retrieve the selected product ID and add it to a session variable:\n```php\n// purchase.php\n\n<?php\n\n// Connect to database (e.g. MySQL)\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Retrieve selected product ID from form\n$product_id = $_POST['product_id'];\n\n// Add product to session variable\n$_SESSION['cart'][] = array('id' => $product_id);\n\n?>\n\n<html>\n<head>\n  <title>Cart</title>\n</head>\n<body>\n\n<h2>Your Cart:</h2>\n\n<ul>\n  <?php foreach ($_SESSION['cart'] as $item) { ?>\n    <li><?php echo get_product_name($conn, $item['id']); ?></li>\n  <?php } ?>\n</ul>\n\n<form action=\"checkout.php\" method=\"post\">\n  <input type=\"submit\" value=\"Checkout\">\n</form>\n\n<?php\nfunction get_product_name($conn, $product_id) {\n    // Retrieve product name from database\n    $query = \"SELECT name FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_assoc($result)['name'];\n}\n?>\n</body>\n</html>\n```\n**Step 3: User Checks Out**\n\nIn `checkout.php`, we'll retrieve the cart contents and process the payment:\n```php\n// checkout.php\n\n<?php\n\n// Connect to database (e.g. MySQL)\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Retrieve cart contents from session variable\n$cart = $_SESSION['cart'];\n\n// Process payment using Stripe or other payment gateway (omitted for brevity)\n\n// Update database with order information\n$query = \"INSERT INTO orders (product_id, quantity) VALUES \";\nforeach ($cart as $item) {\n    $query .= \"('\".$item['id'].\"', 1),\";\n}\n$query = rtrim($query, ',');\nmysqli_query($conn, $query);\n\n?>\n\n<html>\n<head>\n  <title>Thank You</title>\n</head>\n<body>\n\n<h2>Order Placed Successfully!</h2>\n\n<p>Order #<?php echo mysqli_insert_id($conn); ?>:</p>\n\n<ul>\n  <?php foreach ($cart as $item) { ?>\n    <li><?php echo get_product_name($conn, $item['id']); ?></li>\n  <?php } ?>\n</ul>\n\n</body>\n</html>\n\n<?php\nfunction get_product_name($conn, $product_id) {\n    // Retrieve product name from database\n    $query = \"SELECT name FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_assoc($result)['name'];\n}\n?>\n```\nNote that this is a highly simplified example and you should not use it in production without proper security measures (e.g., sanitizing user input, using prepared statements). Additionally, you'll need to set up a payment gateway like Stripe or PayPal to handle the checkout process.", "code_blocks": ["```php\n// products.php\n\n<?php\n\n// Connect to database (e.g. MySQL)\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Select all products from table\n$query = \"SELECT * FROM products\";\n$result = mysqli_query($conn, $query);\n\n?>\n\n<html>\n<head>\n  <title>Products</title>\n</head>\n<body>\n\n<form action=\"purchase.php\" method=\"post\">\n  <select name=\"product_id\">\n    <?php while ($row = mysqli_fetch_assoc($result)) { ?>\n      <option value=\"<?php echo $row['id']; ?>\"><?php echo $row['name']; ?></option>\n    <?php } ?>\n  </select>\n\n  <input type=\"submit\" value=\"Add to Cart\">\n</form>\n\n</body>\n</html>\n```", "```php\n// purchase.php\n\n<?php\n\n// Connect to database (e.g. MySQL)\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Retrieve selected product ID from form\n$product_id = $_POST['product_id'];\n\n// Add product to session variable\n$_SESSION['cart'][] = array('id' => $product_id);\n\n?>\n\n<html>\n<head>\n  <title>Cart</title>\n</head>\n<body>\n\n<h2>Your Cart:</h2>\n\n<ul>\n  <?php foreach ($_SESSION['cart'] as $item) { ?>\n    <li><?php echo get_product_name($conn, $item['id']); ?></li>\n  <?php } ?>\n</ul>\n\n<form action=\"checkout.php\" method=\"post\">\n  <input type=\"submit\" value=\"Checkout\">\n</form>\n\n<?php\nfunction get_product_name($conn, $product_id) {\n    // Retrieve product name from database\n    $query = \"SELECT name FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_assoc($result)['name'];\n}\n?>\n</body>\n</html>\n```", "```php\n// checkout.php\n\n<?php\n\n// Connect to database (e.g. MySQL)\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check connection\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Retrieve cart contents from session variable\n$cart = $_SESSION['cart'];\n\n// Process payment using Stripe or other payment gateway (omitted for brevity)\n\n// Update database with order information\n$query = \"INSERT INTO orders (product_id, quantity) VALUES \";\nforeach ($cart as $item) {\n    $query .= \"('\".$item['id'].\"', 1),\";\n}\n$query = rtrim($query, ',');\nmysqli_query($conn, $query);\n\n?>\n\n<html>\n<head>\n  <title>Thank You</title>\n</head>\n<body>\n\n<h2>Order Placed Successfully!</h2>\n\n<p>Order #<?php echo mysqli_insert_id($conn); ?>:</p>\n\n<ul>\n  <?php foreach ($cart as $item) { ?>\n    <li><?php echo get_product_name($conn, $item['id']); ?></li>\n  <?php } ?>\n</ul>\n\n</body>\n</html>\n\n<?php\nfunction get_product_name($conn, $product_id) {\n    // Retrieve product name from database\n    $query = \"SELECT name FROM products WHERE id = '$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_assoc($result)['name'];\n}\n?>\n```"]}
