{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of how you can create a simple purchase functionality in PHP:\n\n**Note:** This is a simplified example and does not include any security measures such as user authentication, payment processing, or database error handling.\n\n**Database Schema:**\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY,\n  customer_name VARCHAR(255),\n  order_date DATE,\n  total_cost DECIMAL(10,2)\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY,\n  order_id INT,\n  product_id INT,\n  quantity INT\n);\n```\n**PHP Code:**\n\n**`cart.php`:**\n```php\n<?php\n\n// Get the products from the database\n$products = getProducts();\n\n?>\n\n<!-- Display the cart contents -->\n<h1>Cart Contents</h1>\n<ul>\n  <?php foreach ($products as $product) { ?>\n    <li><?= $product['name'] ?> (<?= $product['price'] ?>)</li>\n  <?php } ?>\n</ul>\n\n<form action=\"checkout.php\" method=\"post\">\n  <button type=\"submit\">Checkout</button>\n</form>\n\n<?php\nfunction getProducts() {\n  // Connect to the database\n  $conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n  // Query the products table\n  $query = \"SELECT * FROM products\";\n  $result = mysqli_query($conn, $query);\n\n  // Fetch the results\n  $products = array();\n  while ($row = mysqli_fetch_assoc($result)) {\n    $products[] = $row;\n  }\n\n  // Close the database connection\n  mysqli_close($conn);\n\n  return $products;\n}\n```\n\n**`checkout.php`:**\n```php\n<?php\n\n// Get the products from the cart\n$cart = $_SESSION['cart'] ?? array();\n\n// Calculate the total cost\n$total_cost = calculateTotalCost($cart);\n\n?>\n\n<!-- Display the order form -->\n<h1>Checkout</h1>\n<form action=\"process_order.php\" method=\"post\">\n  <label for=\"customer_name\">Customer Name:</label>\n  <input type=\"text\" id=\"customer_name\" name=\"customer_name\"><br><br>\n\n  <label for=\"order_date\">Order Date:</label>\n  <input type=\"date\" id=\"order_date\" name=\"order_date\"><br><br>\n\n  <button type=\"submit\">Place Order</button>\n</form>\n\n<?php\nfunction calculateTotalCost($cart) {\n  // Connect to the database\n  $conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n  // Query the products table for the product prices\n  $query = \"SELECT * FROM products\";\n  $result = mysqli_query($conn, $query);\n\n  // Fetch the results\n  while ($row = mysqli_fetch_assoc($result)) {\n    if (isset($cart[$row['id']])) {\n      $total_cost += $row['price'] * $cart[$row['id']];\n    }\n  }\n\n  // Close the database connection\n  mysqli_close($conn);\n\n  return $total_cost;\n}\n```\n\n**`process_order.php`:**\n```php\n<?php\n\n// Get the order data from the request\n$customer_name = $_POST['customer_name'];\n$order_date = $_POST['order_date'];\n\n// Calculate the total cost again (just in case)\n$total_cost = calculateTotalCost($_SESSION['cart'] ?? array());\n\n// Insert a new order into the database\n$query = \"INSERT INTO orders (customer_name, order_date, total_cost) VALUES (?, ?, ?)\";\n$stmt = mysqli_prepare($conn, $query);\nmysqli_stmt_bind_param($stmt, 'sss', $customer_name, $order_date, $total_cost);\n\n// Execute the query and close the database connection\nmysqli_stmt_execute($stmt);\nmysqli_close($conn);\n\n// Redirect to a success page\nheader(\"Location: success.php\");\nexit;\n\n?>\n```\n\n**`success.php`:**\n```php\n<?php\n\n?>\n\n<!-- Display a success message -->\n<h1>Order Placed Successfully!</h1>\n\n<p>Your order has been placed successfully. A confirmation email will be sent to you shortly.</p>\n```\nThis code assumes that the cart is stored in the session, and that the user can add products to their cart by clicking on them. When the user clicks the \"Checkout\" button, they are redirected to a form where they can enter their customer name and order date. The total cost of the order is calculated again (just in case) before inserting a new order into the database.\n\nNote that this code does not include any error handling or security measures, such as user authentication or payment processing. In a real-world application, you would want to add these features to prevent abuse and ensure that your users' data is secure.", "code_blocks": [null, "```php\n<?php\n\n// Get the products from the database\n$products = getProducts();\n\n?>\n\n<!-- Display the cart contents -->\n<h1>Cart Contents</h1>\n<ul>\n  <?php foreach ($products as $product) { ?>\n    <li><?= $product['name'] ?> (<?= $product['price'] ?>)</li>\n  <?php } ?>\n</ul>\n\n<form action=\"checkout.php\" method=\"post\">\n  <button type=\"submit\">Checkout</button>\n</form>\n\n<?php\nfunction getProducts() {\n  // Connect to the database\n  $conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n  // Query the products table\n  $query = \"SELECT * FROM products\";\n  $result = mysqli_query($conn, $query);\n\n  // Fetch the results\n  $products = array();\n  while ($row = mysqli_fetch_assoc($result)) {\n    $products[] = $row;\n  }\n\n  // Close the database connection\n  mysqli_close($conn);\n\n  return $products;\n}\n```", "```php\n<?php\n\n// Get the products from the cart\n$cart = $_SESSION['cart'] ?? array();\n\n// Calculate the total cost\n$total_cost = calculateTotalCost($cart);\n\n?>\n\n<!-- Display the order form -->\n<h1>Checkout</h1>\n<form action=\"process_order.php\" method=\"post\">\n  <label for=\"customer_name\">Customer Name:</label>\n  <input type=\"text\" id=\"customer_name\" name=\"customer_name\"><br><br>\n\n  <label for=\"order_date\">Order Date:</label>\n  <input type=\"date\" id=\"order_date\" name=\"order_date\"><br><br>\n\n  <button type=\"submit\">Place Order</button>\n</form>\n\n<?php\nfunction calculateTotalCost($cart) {\n  // Connect to the database\n  $conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n  // Query the products table for the product prices\n  $query = \"SELECT * FROM products\";\n  $result = mysqli_query($conn, $query);\n\n  // Fetch the results\n  while ($row = mysqli_fetch_assoc($result)) {\n    if (isset($cart[$row['id']])) {\n      $total_cost += $row['price'] * $cart[$row['id']];\n    }\n  }\n\n  // Close the database connection\n  mysqli_close($conn);\n\n  return $total_cost;\n}\n```", "```php\n<?php\n\n// Get the order data from the request\n$customer_name = $_POST['customer_name'];\n$order_date = $_POST['order_date'];\n\n// Calculate the total cost again (just in case)\n$total_cost = calculateTotalCost($_SESSION['cart'] ?? array());\n\n// Insert a new order into the database\n$query = \"INSERT INTO orders (customer_name, order_date, total_cost) VALUES (?, ?, ?)\";\n$stmt = mysqli_prepare($conn, $query);\nmysqli_stmt_bind_param($stmt, 'sss', $customer_name, $order_date, $total_cost);\n\n// Execute the query and close the database connection\nmysqli_stmt_execute($stmt);\nmysqli_close($conn);\n\n// Redirect to a success page\nheader(\"Location: success.php\");\nexit;\n\n?>\n```", "```php\n<?php\n\n?>\n\n<!-- Display a success message -->\n<h1>Order Placed Successfully!</h1>\n\n<p>Your order has been placed successfully. A confirmation email will be sent to you shortly.</p>\n```"]}
