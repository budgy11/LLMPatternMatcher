{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a simple purchase functionality using PHP, HTML, and CSS. This example assumes you have a basic understanding of these technologies.\n\n**Database Structure**\n\nFor this example, we will need two tables: `products` and `orders`. The `products` table stores information about the products available for sale, while the `orders` table stores information about each purchase made by customers.\n\n```sql\nCREATE TABLE products (\n  id INT AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  product_id INT,\n  quantity INT,\n  total_price DECIMAL(10,2),\n  PRIMARY KEY (id)\n);\n```\n\n**PHP Code**\n\nCreate a new file called `purchase.php` and add the following code:\n\n```php\n<?php\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Get product ID from URL or session\n  $productId = $_GET['product_id'] ?? $_SESSION['selected_product'];\n\n  // Get product details from database\n  $product = mysqli_query($conn, \"SELECT * FROM products WHERE id = '$productId'\");\n\n  if ($product->num_rows > 0) {\n    $row = $product->fetch_assoc();\n\n    // Validate form data\n    if (isset($_POST['quantity']) && is_numeric($_POST['quantity'])) {\n      $quantity = $_POST['quantity'];\n\n      // Calculate total price\n      $totalPrice = $row['price'] * $quantity;\n\n      // Insert order into database\n      mysqli_query($conn, \"INSERT INTO orders (customer_name, product_id, quantity, total_price) VALUES ('\".$_SESSION['username'].\"', '$productId', '$quantity', '$totalPrice')\");\n\n      // Redirect to confirmation page\n      header('Location: purchase-confirmation.php');\n      exit();\n    } else {\n      echo '<p>Error: Invalid quantity.</p>';\n    }\n  } else {\n    echo '<p>Error: Product not found.</p>';\n  }\n}\n\n?>\n\n<!-- HTML Form -->\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"quantity\">Quantity:</label>\n  <input type=\"number\" id=\"quantity\" name=\"quantity\" min=\"1\"><br><br>\n  <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $productId; ?>\">\n  <button type=\"submit\">Purchase</button>\n</form>\n```\n\n**Explanation**\n\nThis code assumes that you have a basic understanding of PHP and MySQL. Here's what it does:\n\n1. It checks if the form has been submitted by checking the `REQUEST_METHOD` variable.\n2. If the form has been submitted, it gets the product ID from either the URL (`$_GET`) or the session (`$_SESSION`).\n3. It queries the database to retrieve the product details based on the product ID.\n4. If a product is found, it validates the quantity input by the user and calculates the total price.\n5. If the quantity is valid, it inserts an order into the `orders` table with the customer's name (stored in session), product ID, quantity, and total price.\n6. Finally, it redirects the user to a confirmation page.\n\n**HTML Form**\n\nCreate a new file called `purchase-form.html` and add the following code:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Purchase Product</title>\n</head>\n<body>\n  <?php include 'purchase.php'; ?>\n</body>\n</html>\n```\n\n**CSS (optional)**\n\nYou can add some basic styling to your form using CSS:\n\n```css\n/* purchase-form.css */\nform {\n  width: 50%;\n  margin: auto;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 10px;\n}\n\ninput[type=\"number\"] {\n  padding: 10px;\n  border: none;\n  border-radius: 5px;\n}\n```\n\nThis is a basic example of a purchase functionality using PHP. You can improve it by adding more features, such as user authentication, payment processing, and order tracking.", "code_blocks": [null, "```php\n<?php\n\n// Check if form has been submitted\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  // Get product ID from URL or session\n  $productId = $_GET['product_id'] ?? $_SESSION['selected_product'];\n\n  // Get product details from database\n  $product = mysqli_query($conn, \"SELECT * FROM products WHERE id = '$productId'\");\n\n  if ($product->num_rows > 0) {\n    $row = $product->fetch_assoc();\n\n    // Validate form data\n    if (isset($_POST['quantity']) && is_numeric($_POST['quantity'])) {\n      $quantity = $_POST['quantity'];\n\n      // Calculate total price\n      $totalPrice = $row['price'] * $quantity;\n\n      // Insert order into database\n      mysqli_query($conn, \"INSERT INTO orders (customer_name, product_id, quantity, total_price) VALUES ('\".$_SESSION['username'].\"', '$productId', '$quantity', '$totalPrice')\");\n\n      // Redirect to confirmation page\n      header('Location: purchase-confirmation.php');\n      exit();\n    } else {\n      echo '<p>Error: Invalid quantity.</p>';\n    }\n  } else {\n    echo '<p>Error: Product not found.</p>';\n  }\n}\n\n?>\n\n<!-- HTML Form -->\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"quantity\">Quantity:</label>\n  <input type=\"number\" id=\"quantity\" name=\"quantity\" min=\"1\"><br><br>\n  <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $productId; ?>\">\n  <button type=\"submit\">Purchase</button>\n</form>\n```", null, null]}
