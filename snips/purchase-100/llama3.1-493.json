{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality in PHP:\n\n**Note:** This is a simplified example and does not include any error handling or security measures that would be necessary for a real-world application.\n\n**`purchase.php`**\n```php\n<?php\n// Database connection settings\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'shop';\n\n// Connect to database\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to get products from database\nfunction getProducts() {\n    global $conn;\n    $sql = \"SELECT * FROM products\";\n    $result = $conn->query($sql);\n    return $result;\n}\n\n// Function to add product to cart\nfunction addToCart($productId, $quantity) {\n    global $conn;\n    $cartId = $_SESSION['cart_id'];\n    if (!$cartId) {\n        // Create new cart\n        $sql = \"INSERT INTO carts (customer_id) VALUES ('\".$_SESSION['customer_id'].\"')\";\n        $result = $conn->query($sql);\n        $cartId = $conn->insert_id;\n    }\n    $sql = \"INSERT INTO cart_items (cart_id, product_id, quantity) VALUES ('$cartId', '$productId', '$quantity')\";\n    return $conn->query($sql);\n}\n\n// Function to purchase products\nfunction purchaseProducts() {\n    global $conn;\n    // Get cart items\n    $cartItems = $_SESSION['cart'];\n    \n    // Calculate total cost\n    $totalCost = 0;\n    foreach ($cartItems as $item) {\n        $product = get_product($item['product_id']);\n        $totalCost += $product['price'] * $item['quantity'];\n    }\n    \n    // Create order\n    $sql = \"INSERT INTO orders (customer_id, total_cost) VALUES ('\".$_SESSION['customer_id'].\"', '$totalCost')\";\n    return $conn->query($sql);\n}\n\n// Function to get product details\nfunction get_product($productId) {\n    global $conn;\n    $sql = \"SELECT * FROM products WHERE id = '$productId'\";\n    return $conn->query($sql)->fetch_assoc();\n}\n?>\n```\n**`index.php`**\n```php\n<?php\nsession_start();\n\n// Include purchase functionality file\ninclude 'purchase.php';\n\n// Get all products from database\n$products = getProducts();\n\n// Display product list\nforeach ($products as $product) {\n    echo \"<div>\";\n    echo \"<h2>\" . $product['name'] . \"</h2>\";\n    echo \"<p>Price: $\" . $product['price'] . \"</p>\";\n    echo \"<form action='add_to_cart.php' method='post'>\";\n    echo \"<input type='hidden' name='product_id' value='\" . $product['id'] . \"'>\";\n    echo \"<button type='submit'>Add to Cart</button>\";\n    echo \"</form>\";\n    echo \"</div>\";\n}\n\n// Check if user is logged in\nif (isset($_SESSION['customer_id'])) {\n    // Display cart contents\n    echo \"<h2>Your Cart:</h2>\";\n    foreach ($_SESSION['cart'] as $item) {\n        echo \"<p>\" . get_product($item['product_id'])['name'] . \" x \" . $item['quantity'] . \"</p>\";\n    }\n    \n    // Create purchase button\n    echo \"<form action='purchase.php' method='post'>\";\n    echo \"<button type='submit'>Purchase</button>\";\n    echo \"</form>\";\n} else {\n    echo \"<p>Please log in to view your cart.</p>\";\n}\n?>\n```\n**`add_to_cart.php`**\n```php\n<?php\n// Include purchase functionality file\ninclude 'purchase.php';\n\n// Get product ID and quantity from form data\n$productId = $_POST['product_id'];\n$quantity = $_POST['quantity'];\n\n// Add product to cart\naddToCart($productId, $quantity);\n\n// Redirect back to index page\nheader(\"Location: index.php\");\nexit;\n?>\n```\n**`purchase.php` (updated)**\n```php\n<?php\n// ...\n\n// Function to purchase products\nfunction purchaseProducts() {\n    global $conn;\n    // Get cart items\n    $cartItems = $_SESSION['cart'];\n    \n    // Calculate total cost\n    $totalCost = 0;\n    foreach ($cartItems as $item) {\n        $product = get_product($item['product_id']);\n        $totalCost += $product['price'] * $item['quantity'];\n    }\n    \n    // Create order\n    $sql = \"INSERT INTO orders (customer_id, total_cost) VALUES ('\".$_SESSION['customer_id'].\"', '$totalCost')\";\n    return $conn->query($sql);\n}\n\n// ...\n?>\n```\nThis code creates a basic e-commerce system with the following functionality:\n\n1. Users can view a list of products and add them to their cart.\n2. Users can view their cart contents and purchase the products in their cart.\n\nNote that this is a simplified example and you will need to add additional functionality, such as user authentication, payment processing, and order tracking, to create a fully functional e-commerce system.", "code_blocks": ["```php\n<?php\n// Database connection settings\n$dbHost = 'localhost';\n$dbUsername = 'root';\n$dbPassword = '';\n$dbName = 'shop';\n\n// Connect to database\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to get products from database\nfunction getProducts() {\n    global $conn;\n    $sql = \"SELECT * FROM products\";\n    $result = $conn->query($sql);\n    return $result;\n}\n\n// Function to add product to cart\nfunction addToCart($productId, $quantity) {\n    global $conn;\n    $cartId = $_SESSION['cart_id'];\n    if (!$cartId) {\n        // Create new cart\n        $sql = \"INSERT INTO carts (customer_id) VALUES ('\".$_SESSION['customer_id'].\"')\";\n        $result = $conn->query($sql);\n        $cartId = $conn->insert_id;\n    }\n    $sql = \"INSERT INTO cart_items (cart_id, product_id, quantity) VALUES ('$cartId', '$productId', '$quantity')\";\n    return $conn->query($sql);\n}\n\n// Function to purchase products\nfunction purchaseProducts() {\n    global $conn;\n    // Get cart items\n    $cartItems = $_SESSION['cart'];\n    \n    // Calculate total cost\n    $totalCost = 0;\n    foreach ($cartItems as $item) {\n        $product = get_product($item['product_id']);\n        $totalCost += $product['price'] * $item['quantity'];\n    }\n    \n    // Create order\n    $sql = \"INSERT INTO orders (customer_id, total_cost) VALUES ('\".$_SESSION['customer_id'].\"', '$totalCost')\";\n    return $conn->query($sql);\n}\n\n// Function to get product details\nfunction get_product($productId) {\n    global $conn;\n    $sql = \"SELECT * FROM products WHERE id = '$productId'\";\n    return $conn->query($sql)->fetch_assoc();\n}\n?>\n```", "```php\n<?php\nsession_start();\n\n// Include purchase functionality file\ninclude 'purchase.php';\n\n// Get all products from database\n$products = getProducts();\n\n// Display product list\nforeach ($products as $product) {\n    echo \"<div>\";\n    echo \"<h2>\" . $product['name'] . \"</h2>\";\n    echo \"<p>Price: $\" . $product['price'] . \"</p>\";\n    echo \"<form action='add_to_cart.php' method='post'>\";\n    echo \"<input type='hidden' name='product_id' value='\" . $product['id'] . \"'>\";\n    echo \"<button type='submit'>Add to Cart</button>\";\n    echo \"</form>\";\n    echo \"</div>\";\n}\n\n// Check if user is logged in\nif (isset($_SESSION['customer_id'])) {\n    // Display cart contents\n    echo \"<h2>Your Cart:</h2>\";\n    foreach ($_SESSION['cart'] as $item) {\n        echo \"<p>\" . get_product($item['product_id'])['name'] . \" x \" . $item['quantity'] . \"</p>\";\n    }\n    \n    // Create purchase button\n    echo \"<form action='purchase.php' method='post'>\";\n    echo \"<button type='submit'>Purchase</button>\";\n    echo \"</form>\";\n} else {\n    echo \"<p>Please log in to view your cart.</p>\";\n}\n?>\n```", "```php\n<?php\n// Include purchase functionality file\ninclude 'purchase.php';\n\n// Get product ID and quantity from form data\n$productId = $_POST['product_id'];\n$quantity = $_POST['quantity'];\n\n// Add product to cart\naddToCart($productId, $quantity);\n\n// Redirect back to index page\nheader(\"Location: index.php\");\nexit;\n?>\n```", "```php\n<?php\n// ...\n\n// Function to purchase products\nfunction purchaseProducts() {\n    global $conn;\n    // Get cart items\n    $cartItems = $_SESSION['cart'];\n    \n    // Calculate total cost\n    $totalCost = 0;\n    foreach ($cartItems as $item) {\n        $product = get_product($item['product_id']);\n        $totalCost += $product['price'] * $item['quantity'];\n    }\n    \n    // Create order\n    $sql = \"INSERT INTO orders (customer_id, total_cost) VALUES ('\".$_SESSION['customer_id'].\"', '$totalCost')\";\n    return $conn->query($sql);\n}\n\n// ...\n?>\n```"]}
