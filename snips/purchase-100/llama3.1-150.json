{"prompt": "Create a purchase functionality using php", "llm_output": "**Purchase Functionality in PHP**\n=====================================\n\nIn this example, we'll create a simple purchase functionality that allows users to buy items from an online store. We'll use PHP as the server-side language and assume a basic understanding of MySQL for database interactions.\n\n### Database Schema\n\nFirst, let's define the database schema for our online store:\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  total DECIMAL(10,2),\n  status ENUM('pending', 'shipped', 'delivered')\n);\n```\n### PHP Code\n\nNow, let's create the PHP code for our purchase functionality:\n```php\n// config.php (database connection settings)\n$dbHost = 'localhost';\n$dbUser = 'your_username';\n$dbPass = 'your_password';\n$dbName = 'online_store';\n\n// connect to database\n$conn = new mysqli($dbHost, $dbUser, $dbPass, $dbName);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// function to add product to cart\nfunction addToCart() {\n    global $conn;\n    $productId = $_POST['product_id'];\n    $userId = $_POST['user_id'];\n\n    // check if user has items in cart already\n    $query = \"SELECT * FROM orders WHERE user_id = '$userId' AND status = 'pending'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // update existing order\n        $orderData = $result->fetch_assoc();\n        $total = $orderData['total'] + $_POST['price'];\n        $query = \"UPDATE orders SET total = '$total' WHERE id = '\" . $orderData['id'] . \"'\";\n        $conn->query($query);\n    } else {\n        // create new order\n        $query = \"INSERT INTO orders (user_id, total) VALUES ('$userId', '\".$_POST['price'].\"')\";\n        $conn->query($query);\n    }\n\n    return true;\n}\n\n// function to checkout and place order\nfunction checkout() {\n    global $conn;\n    $orderId = $_POST['order_id'];\n    $paymentMethod = $_POST['payment_method'];\n\n    // update order status\n    $query = \"UPDATE orders SET status = 'shipped' WHERE id = '$orderId'\";\n    $conn->query($query);\n\n    return true;\n}\n\n// function to display products and cart contents\nfunction displayProducts() {\n    global $conn;\n    $userId = $_POST['user_id'];\n\n    // retrieve user's cart contents\n    $query = \"SELECT * FROM orders WHERE user_id = '$userId' AND status = 'pending'\";\n    $result = $conn->query($query);\n\n    while ($row = $result->fetch_assoc()) {\n        echo \"<p>Order ID: \" . $row['id'] . \"</p>\";\n        echo \"<p>Total: $\" . number_format($row['total'], 2) . \"</p>\";\n    }\n}\n```\n### Usage Example\n\nTo use this code, create an HTML form with the following fields:\n\n* `product_id`: The ID of the product being purchased\n* `user_id`: The ID of the user making the purchase\n* `price`: The price of the product being purchased\n* `order_id`: The ID of the order being checked out\n\n```html\n<form action=\"process_purchase.php\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $productId; ?>\">\n    <input type=\"hidden\" name=\"user_id\" value=\"<?php echo $userId; ?>\">\n    <input type=\"hidden\" name=\"price\" value=\"<?php echo $_POST['price']; ?>\">\n    <button type=\"submit\">Add to Cart</button>\n</form>\n\n<form action=\"process_checkout.php\" method=\"post\">\n    <input type=\"hidden\" name=\"order_id\" value=\"<?php echo $orderId; ?>\">\n    <select name=\"payment_method\">\n        <option value=\"credit_card\">Credit Card</option>\n        <option value=\"paypal\">PayPal</option>\n    </select>\n    <button type=\"submit\">Checkout</button>\n</form>\n```\nRemember to replace `process_purchase.php` and `process_checkout.php` with the actual PHP files that will handle the form submissions.", "code_blocks": [null, "```php\n// config.php (database connection settings)\n$dbHost = 'localhost';\n$dbUser = 'your_username';\n$dbPass = 'your_password';\n$dbName = 'online_store';\n\n// connect to database\n$conn = new mysqli($dbHost, $dbUser, $dbPass, $dbName);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// function to add product to cart\nfunction addToCart() {\n    global $conn;\n    $productId = $_POST['product_id'];\n    $userId = $_POST['user_id'];\n\n    // check if user has items in cart already\n    $query = \"SELECT * FROM orders WHERE user_id = '$userId' AND status = 'pending'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // update existing order\n        $orderData = $result->fetch_assoc();\n        $total = $orderData['total'] + $_POST['price'];\n        $query = \"UPDATE orders SET total = '$total' WHERE id = '\" . $orderData['id'] . \"'\";\n        $conn->query($query);\n    } else {\n        // create new order\n        $query = \"INSERT INTO orders (user_id, total) VALUES ('$userId', '\".$_POST['price'].\"')\";\n        $conn->query($query);\n    }\n\n    return true;\n}\n\n// function to checkout and place order\nfunction checkout() {\n    global $conn;\n    $orderId = $_POST['order_id'];\n    $paymentMethod = $_POST['payment_method'];\n\n    // update order status\n    $query = \"UPDATE orders SET status = 'shipped' WHERE id = '$orderId'\";\n    $conn->query($query);\n\n    return true;\n}\n\n// function to display products and cart contents\nfunction displayProducts() {\n    global $conn;\n    $userId = $_POST['user_id'];\n\n    // retrieve user's cart contents\n    $query = \"SELECT * FROM orders WHERE user_id = '$userId' AND status = 'pending'\";\n    $result = $conn->query($query);\n\n    while ($row = $result->fetch_assoc()) {\n        echo \"<p>Order ID: \" . $row['id'] . \"</p>\";\n        echo \"<p>Total: $\" . number_format($row['total'], 2) . \"</p>\";\n    }\n}\n```", null]}
