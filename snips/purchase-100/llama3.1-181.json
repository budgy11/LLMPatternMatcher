{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality in PHP:\n\n**Database Schema:**\n\nFor this example, we'll assume you have the following database schema:\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_name VARCHAR(255),\n  order_date DATE\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  order_id INT,\n  product_id INT,\n  quantity INT,\n  FOREIGN KEY (order_id) REFERENCES orders(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code:**\n\n```php\n<?php\n\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'username';\n$dbPassword = 'password';\n$dbName = 'database';\n\n// Create connection\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product to cart\nfunction addProductToCart() {\n  global $conn;\n\n  // Get product ID and quantity from request\n  if (isset($_POST['product_id']) && isset($_POST['quantity'])) {\n    $productId = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if product exists\n    $query = \"SELECT * FROM products WHERE id = '$productId'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n      while ($row = $result->fetch_assoc()) {\n        $productPrice = $row['price'];\n\n        // Insert product into order_items table\n        $insertQuery = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES (NULL, '$productId', '$quantity')\";\n        $conn->query($insertQuery);\n\n        echo \"Product added to cart successfully!\";\n      }\n    } else {\n      echo \"Product not found.\";\n    }\n  }\n}\n\n// Function to process payment\nfunction processPayment() {\n  global $conn;\n\n  // Get order ID and total from request\n  if (isset($_POST['order_id']) && isset($_POST['total'])) {\n    $orderId = $_POST['order_id'];\n    $total = $_POST['total'];\n\n    // Insert order into orders table\n    $insertQuery = \"INSERT INTO orders (customer_name, order_date) VALUES ('Customer Name', NOW())\";\n    $conn->query($insertQuery);\n\n    // Update order ID in order_items table\n    $updateQuery = \"UPDATE order_items SET order_id = '$orderId' WHERE order_id IS NULL\";\n    $conn->query($updateQuery);\n\n    echo \"Order processed successfully!\";\n  }\n}\n\n// Check if user is adding product to cart\nif (isset($_POST['action']) && $_POST['action'] == 'addProduct') {\n  addProductToCart();\n} elseif (isset($_POST['action']) && $_POST['action'] == 'processPayment') {\n  processPayment();\n}\n\n// Close connection\n$conn->close();\n\n?>\n```\n\n**HTML/JS Code:**\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Purchase Functionality</title>\n    <style>\n        /* Add some basic styling for the form */\n        form {\n            width: 50%;\n            margin: 40px auto;\n            padding: 20px;\n            border: 1px solid #ccc;\n            border-radius: 10px;\n            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n        }\n    </style>\n</head>\n<body>\n    <h1>Purchase Functionality</h1>\n\n    <!-- Form to add product to cart -->\n    <form id=\"addProductForm\" method=\"post\">\n        <label for=\"product_id\">Product ID:</label>\n        <input type=\"text\" id=\"product_id\" name=\"product_id\"><br><br>\n        <label for=\"quantity\">Quantity:</label>\n        <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n        <button type=\"submit\" name=\"action\" value=\"addProduct\">Add to Cart</button>\n    </form>\n\n    <!-- Form to process payment -->\n    <form id=\"processPaymentForm\" method=\"post\">\n        <label for=\"order_id\">Order ID:</label>\n        <input type=\"text\" id=\"order_id\" name=\"order_id\"><br><br>\n        <label for=\"total\">Total:</label>\n        <input type=\"number\" id=\"total\" name=\"total\"><br><br>\n        <button type=\"submit\" name=\"action\" value=\"processPayment\">Process Payment</button>\n    </form>\n\n    <!-- Script to handle form submission -->\n    <script src=\"https://code.jquery.com/jquery-3.5.1.min.js\"></script>\n    <script>\n        $(document).ready(function() {\n            $('#addProductForm').submit(function(e) {\n                e.preventDefault();\n                $.ajax({\n                    type: 'POST',\n                    url: '',\n                    data: $(this).serialize(),\n                    success: function(data) {\n                        console.log(data);\n                        alert('Product added to cart successfully!');\n                    },\n                    error: function(xhr, status, error) {\n                        console.error(error);\n                        alert('Error adding product to cart!');\n                    }\n                });\n            });\n\n            $('#processPaymentForm').submit(function(e) {\n                e.preventDefault();\n                $.ajax({\n                    type: 'POST',\n                    url: '',\n                    data: $(this).serialize(),\n                    success: function(data) {\n                        console.log(data);\n                        alert('Order processed successfully!');\n                    },\n                    error: function(xhr, status, error) {\n                        console.error(error);\n                        alert('Error processing order!');\n                    }\n                });\n            });\n        });\n    </script>\n</body>\n</html>\n```\n\nThis code provides a basic purchase functionality using PHP. The `addProductToCart` and `processPayment` functions handle the addition of products to the cart and the processing of payments, respectively. The HTML/JS code provides two forms: one for adding products to the cart and another for processing payment. When the user submits either form, an AJAX request is sent to the server-side script to process the request.\n\nPlease note that this is a basic example and you should add proper validation, error handling, and security measures in your production code. Additionally, this code assumes that you have already set up a database with the necessary tables and configurations.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'username';\n$dbPassword = 'password';\n$dbName = 'database';\n\n// Create connection\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product to cart\nfunction addProductToCart() {\n  global $conn;\n\n  // Get product ID and quantity from request\n  if (isset($_POST['product_id']) && isset($_POST['quantity'])) {\n    $productId = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    // Check if product exists\n    $query = \"SELECT * FROM products WHERE id = '$productId'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n      while ($row = $result->fetch_assoc()) {\n        $productPrice = $row['price'];\n\n        // Insert product into order_items table\n        $insertQuery = \"INSERT INTO order_items (order_id, product_id, quantity) VALUES (NULL, '$productId', '$quantity')\";\n        $conn->query($insertQuery);\n\n        echo \"Product added to cart successfully!\";\n      }\n    } else {\n      echo \"Product not found.\";\n    }\n  }\n}\n\n// Function to process payment\nfunction processPayment() {\n  global $conn;\n\n  // Get order ID and total from request\n  if (isset($_POST['order_id']) && isset($_POST['total'])) {\n    $orderId = $_POST['order_id'];\n    $total = $_POST['total'];\n\n    // Insert order into orders table\n    $insertQuery = \"INSERT INTO orders (customer_name, order_date) VALUES ('Customer Name', NOW())\";\n    $conn->query($insertQuery);\n\n    // Update order ID in order_items table\n    $updateQuery = \"UPDATE order_items SET order_id = '$orderId' WHERE order_id IS NULL\";\n    $conn->query($updateQuery);\n\n    echo \"Order processed successfully!\";\n  }\n}\n\n// Check if user is adding product to cart\nif (isset($_POST['action']) && $_POST['action'] == 'addProduct') {\n  addProductToCart();\n} elseif (isset($_POST['action']) && $_POST['action'] == 'processPayment') {\n  processPayment();\n}\n\n// Close connection\n$conn->close();\n\n?>\n```", null]}
