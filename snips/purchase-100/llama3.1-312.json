{"prompt": "Create a purchase functionality using php", "llm_output": "Here is an example of a basic purchase functionality using PHP, HTML, and MySQL. This example assumes you have a database set up with the necessary tables for customers, products, and orders.\n\n**Database Schema:**\n\n```sql\nCREATE TABLE customers (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  email VARCHAR(255)\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  price DECIMAL(10,2)\n);\n\nCREATE TABLE orders (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  customer_id INT,\n  product_id INT,\n  quantity INT,\n  total DECIMAL(10,2),\n  FOREIGN KEY (customer_id) REFERENCES customers(id),\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code:**\n\n```php\n// connection settings\n$db_host = 'localhost';\n$db_username = 'root';\n$db_password = '';\n$db_name = 'store';\n\n// connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// function to display products\nfunction displayProducts() {\n  global $conn;\n  $sql = \"SELECT * FROM products\";\n  $result = $conn->query($sql);\n  \n  if ($result->num_rows > 0) {\n      while($row = $result->fetch_assoc()) {\n          echo '<div class=\"product\">';\n          echo '<h2>' . $row[\"name\"] . '</h2>';\n          echo '<p>Price: ' . $row[\"price\"] . '</p>';\n          echo '<button type=\"button\" onclick=\"addToCart(' . $row[\"id\"] . ')\">Add to Cart</button>';\n          echo '</div>';\n      }\n  } else {\n      echo \"0 results\";\n  }\n}\n\n// function to add product to cart\nfunction addToCart($productId) {\n  global $conn;\n  if (isset($_SESSION['cart'][$productId])) {\n    $_SESSION['cart'][$productId] += 1;\n  } else {\n    $_SESSION['cart'][$productId] = 1;\n  }\n  \n  header('Location: ' . $_SERVER['PHP_SELF']);\n  exit();\n}\n\n// function to display cart\nfunction displayCart() {\n  global $conn;\n  if (isset($_SESSION['cart'])) {\n      echo '<h2>Cart:</h2>';\n      $total = 0;\n      foreach ($_SESSION['cart'] as $productId => $quantity) {\n          $sql = \"SELECT * FROM products WHERE id = '$productId'\";\n          $result = $conn->query($sql);\n          while ($row = $result->fetch_assoc()) {\n              echo '<p>' . $row[\"name\"] . ' x ' . $quantity . '</p>';\n              $total += $row[\"price\"] * $quantity;\n          }\n      }\n      \n      echo '<p>Total: $' . number_format($total, 2) . '</p>';\n      echo '<button type=\"button\" onclick=\"checkout()\">Checkout</button>';\n  } else {\n      echo \"No products in cart\";\n  }\n}\n\n// function to checkout\nfunction checkout() {\n  global $conn;\n  \n  if (isset($_SESSION['cart'])) {\n      $customer_id = $_POST['customer'];\n      $orderTotal = 0;\n      \n      foreach ($_SESSION['cart'] as $productId => $quantity) {\n          $sql = \"SELECT * FROM products WHERE id = '$productId'\";\n          $result = $conn->query($sql);\n          while ($row = $result->fetch_assoc()) {\n              $orderTotal += $row[\"price\"] * $quantity;\n              \n              // insert order into database\n              $sql = \"INSERT INTO orders (customer_id, product_id, quantity, total) VALUES ('$customer_id', '$productId', '$quantity', '$orderTotal')\";\n              if ($conn->query($sql)) {\n                  echo \"Order placed successfully!\";\n              } else {\n                  echo \"Error: \" . $conn->error;\n              }\n          }\n      }\n      \n      // remove products from cart\n      unset($_SESSION['cart']);\n  }\n  \n  header('Location: ' . $_SERVER['PHP_SELF']);\n  exit();\n}\n```\n\n**HTML Code:**\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Purchase</title>\n    <style>\n        .product {\n            width: 200px;\n            height: 150px;\n            border: 1px solid #ccc;\n            padding: 10px;\n            margin: 20px;\n        }\n    </style>\n</head>\n<body>\n\n<h2>Products:</h2>\n<div id=\"products\">\n  <?php displayProducts(); ?>\n</div>\n\n<h2>Cart:</h2>\n<div id=\"cart\">\n  <?php displayCart(); ?>\n</div>\n\n<form action=\"\" method=\"post\" id=\"checkout-form\">\n  <input type=\"hidden\" name=\"customer\" value=\"<?php echo $_SESSION['customer_id']; ?>\">\n  <button type=\"submit\" onclick=\"return confirm('Are you sure you want to checkout?')\">Checkout</button>\n</form>\n\n<script>\n  function addToCart(productId) {\n    fetch('/addToCart.php', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ productId: productId })\n    });\n  }\n\n  function checkout() {\n    document.getElementById('checkout-form').submit();\n  }\n</script>\n\n</body>\n</html>\n```\n\n**Note:** This is a basic example and does not include error handling, security measures, or advanced features like payment processing. It's also assumed that you have already set up the database connection settings in PHP.\n\nPlease note that this is just an example code and it should be modified according to your needs and requirements.", "code_blocks": [null, "```php\n// connection settings\n$db_host = 'localhost';\n$db_username = 'root';\n$db_password = '';\n$db_name = 'store';\n\n// connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// function to display products\nfunction displayProducts() {\n  global $conn;\n  $sql = \"SELECT * FROM products\";\n  $result = $conn->query($sql);\n  \n  if ($result->num_rows > 0) {\n      while($row = $result->fetch_assoc()) {\n          echo '<div class=\"product\">';\n          echo '<h2>' . $row[\"name\"] . '</h2>';\n          echo '<p>Price: ' . $row[\"price\"] . '</p>';\n          echo '<button type=\"button\" onclick=\"addToCart(' . $row[\"id\"] . ')\">Add to Cart</button>';\n          echo '</div>';\n      }\n  } else {\n      echo \"0 results\";\n  }\n}\n\n// function to add product to cart\nfunction addToCart($productId) {\n  global $conn;\n  if (isset($_SESSION['cart'][$productId])) {\n    $_SESSION['cart'][$productId] += 1;\n  } else {\n    $_SESSION['cart'][$productId] = 1;\n  }\n  \n  header('Location: ' . $_SERVER['PHP_SELF']);\n  exit();\n}\n\n// function to display cart\nfunction displayCart() {\n  global $conn;\n  if (isset($_SESSION['cart'])) {\n      echo '<h2>Cart:</h2>';\n      $total = 0;\n      foreach ($_SESSION['cart'] as $productId => $quantity) {\n          $sql = \"SELECT * FROM products WHERE id = '$productId'\";\n          $result = $conn->query($sql);\n          while ($row = $result->fetch_assoc()) {\n              echo '<p>' . $row[\"name\"] . ' x ' . $quantity . '</p>';\n              $total += $row[\"price\"] * $quantity;\n          }\n      }\n      \n      echo '<p>Total: $' . number_format($total, 2) . '</p>';\n      echo '<button type=\"button\" onclick=\"checkout()\">Checkout</button>';\n  } else {\n      echo \"No products in cart\";\n  }\n}\n\n// function to checkout\nfunction checkout() {\n  global $conn;\n  \n  if (isset($_SESSION['cart'])) {\n      $customer_id = $_POST['customer'];\n      $orderTotal = 0;\n      \n      foreach ($_SESSION['cart'] as $productId => $quantity) {\n          $sql = \"SELECT * FROM products WHERE id = '$productId'\";\n          $result = $conn->query($sql);\n          while ($row = $result->fetch_assoc()) {\n              $orderTotal += $row[\"price\"] * $quantity;\n              \n              // insert order into database\n              $sql = \"INSERT INTO orders (customer_id, product_id, quantity, total) VALUES ('$customer_id', '$productId', '$quantity', '$orderTotal')\";\n              if ($conn->query($sql)) {\n                  echo \"Order placed successfully!\";\n              } else {\n                  echo \"Error: \" . $conn->error;\n              }\n          }\n      }\n      \n      // remove products from cart\n      unset($_SESSION['cart']);\n  }\n  \n  header('Location: ' . $_SERVER['PHP_SELF']);\n  exit();\n}\n```", null]}
