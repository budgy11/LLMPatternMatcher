{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how to create a forgot password function using PHP:\n\n**Step 1: Database Setup**\n\nFirst, let's assume we have a database table `users` with the following columns:\n\n| Column Name | Data Type |\n| --- | --- |\n| id | int (primary key) |\n| email | varchar(255) |\n| password | varchar(255) |\n\n**Step 2: Password Hashing and Verification**\n\nWe'll use the PHP built-in function `password_hash()` to store hashed passwords in the database. We'll also use `password_verify()` to verify user passwords.\n\n```php\nfunction hash_password($password) {\n    return password_hash($password, PASSWORD_DEFAULT);\n}\n\nfunction verify_password($hashed_password, $password) {\n    return password_verify($password, $hashed_password);\n}\n```\n\n**Step 3: Forgot Password Function**\n\nThis function will take the user's email as input and send a link to reset their password.\n\n```php\nfunction forgot_password($email) {\n    // Check if user exists in database\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 0) {\n        echo \"User not found.\";\n        return;\n    }\n\n    // Generate a random token\n    $token = bin2hex(random_bytes(32));\n\n    // Update user's password reset token in database\n    $query = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n    mysqli_query($conn, $query);\n\n    // Send password reset link to user via email\n    $subject = \"Reset Password\";\n    $message = \"Click here to reset your password: <a href='https://example.com/reset-password/$token'>Reset Password</a>\";\n    mail($email, $subject, $message);\n}\n```\n\n**Step 4: Reset Password Function**\n\nThis function will take the user's token as input and allow them to reset their password.\n\n```php\nfunction reset_password($token) {\n    // Check if token is valid\n    $query = \"SELECT * FROM users WHERE password_reset_token = '$token'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 0) {\n        echo \"Invalid token.\";\n        return;\n    }\n\n    // Get user's email from database\n    $row = mysqli_fetch_assoc($result);\n    $email = $row['email'];\n\n    // Display password reset form to user\n    ?>\n    <form action=\"reset-password.php\" method=\"post\">\n        <input type=\"password\" name=\"new_password\" placeholder=\"New Password\">\n        <button type=\"submit\">Reset Password</button>\n    </form>\n    <?php\n\n    if ($_SERVER['REQUEST_METHOD'] == 'POST') {\n        // Verify new password\n        $new_password = $_POST['new_password'];\n        if (strlen($new_password) < 8) {\n            echo \"Password must be at least 8 characters long.\";\n            return;\n        }\n\n        // Update user's password in database\n        $hashed_password = hash_password($new_password);\n        $query = \"UPDATE users SET password = '$hashed_password', password_reset_token = '' WHERE email = '$email'\";\n        mysqli_query($conn, $query);\n\n        echo \"Password reset successfully.\";\n    }\n}\n```\n\n**Example Usage**\n\nTo use this forgot password function, simply call `forgot_password()` with the user's email as input:\n\n```php\nforgot_password('example@example.com');\n```\n\nThis will send a password reset link to the user's email. The user can then click on the link and follow the instructions to reset their password.\n\nNote that you'll need to modify this code to fit your specific database schema and requirements. Additionally, this is just an example implementation and may not be suitable for production use without additional security measures (e.g. password salting, token expiration, etc.).", "code_blocks": ["```php\nfunction hash_password($password) {\n    return password_hash($password, PASSWORD_DEFAULT);\n}\n\nfunction verify_password($hashed_password, $password) {\n    return password_verify($password, $hashed_password);\n}\n```", "```php\nfunction forgot_password($email) {\n    // Check if user exists in database\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 0) {\n        echo \"User not found.\";\n        return;\n    }\n\n    // Generate a random token\n    $token = bin2hex(random_bytes(32));\n\n    // Update user's password reset token in database\n    $query = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n    mysqli_query($conn, $query);\n\n    // Send password reset link to user via email\n    $subject = \"Reset Password\";\n    $message = \"Click here to reset your password: <a href='https://example.com/reset-password/$token'>Reset Password</a>\";\n    mail($email, $subject, $message);\n}\n```", "```php\nfunction reset_password($token) {\n    // Check if token is valid\n    $query = \"SELECT * FROM users WHERE password_reset_token = '$token'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 0) {\n        echo \"Invalid token.\";\n        return;\n    }\n\n    // Get user's email from database\n    $row = mysqli_fetch_assoc($result);\n    $email = $row['email'];\n\n    // Display password reset form to user\n    ?>\n    <form action=\"reset-password.php\" method=\"post\">\n        <input type=\"password\" name=\"new_password\" placeholder=\"New Password\">\n        <button type=\"submit\">Reset Password</button>\n    </form>\n    <?php\n\n    if ($_SERVER['REQUEST_METHOD'] == 'POST') {\n        // Verify new password\n        $new_password = $_POST['new_password'];\n        if (strlen($new_password) < 8) {\n            echo \"Password must be at least 8 characters long.\";\n            return;\n        }\n\n        // Update user's password in database\n        $hashed_password = hash_password($new_password);\n        $query = \"UPDATE users SET password = '$hashed_password', password_reset_token = '' WHERE email = '$email'\";\n        mysqli_query($conn, $query);\n\n        echo \"Password reset successfully.\";\n    }\n}\n```", "```php\nforgot_password('example@example.com');\n```"]}
