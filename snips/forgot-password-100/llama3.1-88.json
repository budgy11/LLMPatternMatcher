{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nIn this example, we'll create a simple forgotten password function that sends a reset link to the user's email address. We'll use PHP's built-in `mail()` function and store the passwords securely using bcrypt.\n\n**Database Schema**\n-------------------\n\nWe'll assume you have a MySQL database with the following schema:\n\n```sql\nCREATE TABLE users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    username VARCHAR(255),\n    password_hash VARCHAR(255),\n    email VARCHAR(255)\n);\n```\n\n**Forgot Password Function (PHP)**\n---------------------------------\n\n```php\n// Define a function to reset passwords\nfunction forgot_password($username, $email) {\n    // Check if the user exists\n    $query = \"SELECT * FROM users WHERE username = '$username' AND email = '$email'\";\n    $result = mysqli_query($conn, $query);\n\n    if (mysqli_num_rows($result) == 0) {\n        return 'User not found';\n    }\n\n    // Generate a reset token and store it in the database\n    $reset_token = bin2hex(random_bytes(16));\n    $update_query = \"UPDATE users SET reset_token = '$reset_token' WHERE username = '$username'\";\n    mysqli_query($conn, $update_query);\n\n    // Send an email with the reset link\n    send_reset_email($email, $reset_token);\n}\n\n// Define a function to send the reset email\nfunction send_reset_email($email, $reset_token) {\n    // Set up mail server credentials (replace with your own)\n    $server = 'smtp.gmail.com';\n    $port = 587;\n    $username = 'your-email@gmail.com';\n    $password = 'your-password';\n\n    // Compose the email\n    $subject = 'Reset Password Link';\n    $body = \"Click this link to reset your password: <a href='https://example.com/reset-password?token=$reset_token'>Reset Password</a>\";\n\n    try {\n        // Send the email using mail()\n        mail($email, $subject, $body, \"From: $username\");\n        echo 'Email sent successfully!';\n    } catch (Exception $e) {\n        echo 'Error sending email: ' . $e->getMessage();\n    }\n}\n\n// Example usage:\n$username = 'johndoe';\n$email = 'john@example.com';\n\nforgot_password($username, $email);\n```\n\n**Reset Password Link**\n-------------------------\n\nIn the `send_reset_email()` function, we're creating a reset link that looks like this:\n\n`https://example.com/reset-password?token=<reset_token>`\n\nThis link can be used to redirect the user to a password reset page where they can enter their new password.\n\n**Security Notes**\n\n* Make sure to store passwords securely using bcrypt or another secure hashing algorithm.\n* Use a secure connection (HTTPS) for your website to prevent eavesdropping and tampering attacks.\n* Validate all inputs, including email addresses, to prevent SQL injection and cross-site scripting (XSS) attacks.", "code_blocks": [null, "```php\n// Define a function to reset passwords\nfunction forgot_password($username, $email) {\n    // Check if the user exists\n    $query = \"SELECT * FROM users WHERE username = '$username' AND email = '$email'\";\n    $result = mysqli_query($conn, $query);\n\n    if (mysqli_num_rows($result) == 0) {\n        return 'User not found';\n    }\n\n    // Generate a reset token and store it in the database\n    $reset_token = bin2hex(random_bytes(16));\n    $update_query = \"UPDATE users SET reset_token = '$reset_token' WHERE username = '$username'\";\n    mysqli_query($conn, $update_query);\n\n    // Send an email with the reset link\n    send_reset_email($email, $reset_token);\n}\n\n// Define a function to send the reset email\nfunction send_reset_email($email, $reset_token) {\n    // Set up mail server credentials (replace with your own)\n    $server = 'smtp.gmail.com';\n    $port = 587;\n    $username = 'your-email@gmail.com';\n    $password = 'your-password';\n\n    // Compose the email\n    $subject = 'Reset Password Link';\n    $body = \"Click this link to reset your password: <a href='https://example.com/reset-password?token=$reset_token'>Reset Password</a>\";\n\n    try {\n        // Send the email using mail()\n        mail($email, $subject, $body, \"From: $username\");\n        echo 'Email sent successfully!';\n    } catch (Exception $e) {\n        echo 'Error sending email: ' . $e->getMessage();\n    }\n}\n\n// Example usage:\n$username = 'johndoe';\n$email = 'john@example.com';\n\nforgot_password($username, $email);\n```"]}
