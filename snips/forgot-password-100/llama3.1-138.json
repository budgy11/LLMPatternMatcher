{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can create a \"Forgot Password\" function in PHP. This will send a temporary link to the user's email, which they can use to reset their password.\n\n**Note:** We'll be using MySQL as our database for this example.\n\n**Step 1: Create Database Table**\n\nFirst, let's create a table called `users` with the necessary columns:\n```sql\nCREATE TABLE users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    email VARCHAR(255) NOT NULL,\n    password VARCHAR(255) NOT NULL,\n    reset_token VARCHAR(255)\n);\n```\n**Step 2: Create PHP Code**\n\nCreate a new file called `forgot_password.php` and add the following code:\n```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\n// Check connection\nif (!$conn) {\n    die('Connection failed: ' . mysqli_error($conn));\n}\n\n// Function to send email using PHPMailer\nfunction sendEmail($email, $token) {\n    require_once 'PHPMailer/src/PHPMailer.php';\n    require_once 'PHPMailer/src/SMTP.php';\n\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.gmail.com'; // or your SMTP server\n    $mail->Port = 587;\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@gmail.com'; // or your email\n    $mail->Password = 'your_password'; // or your password\n\n    $mail->setFrom('your_email@gmail.com', 'Your Name');\n    $mail->addAddress($email);\n\n    $body = '<p>Click on this link to reset your password: <a href=\"http://localhost/reset_password.php?token=' . $token . '\">Reset Password</a></p>';\n    $mail->isHTML(true);\n    $mail->Subject = 'Reset Your Password';\n    $mail->Body = $body;\n    $mail->AltBody = 'This is a plain text email';\n\n    if (!$mail->send()) {\n        echo 'Message could not be sent. Mailer Error: ' . $mail->ErrorInfo;\n    } else {\n        echo 'Email has been sent successfully!';\n    }\n}\n\n// Function to reset password\nfunction resetPassword($email, $token) {\n    // Connect to database\n    $conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\n    // Check if token exists in database\n    $query = \"SELECT * FROM users WHERE email='$email' AND reset_token='$token'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 1) {\n        // Update password using MD5 hash\n        $new_password = md5('your_new_password');\n        $query = \"UPDATE users SET password='$new_password' WHERE email='$email'\";\n        mysqli_query($conn, $query);\n\n        echo 'Password has been updated successfully!';\n    } else {\n        echo 'Invalid token or email.';\n    }\n\n    // Close database connection\n    mysqli_close($conn);\n}\n\n// Handle forgot password request\nif (isset($_POST['submit'])) {\n    $email = $_POST['email'];\n\n    // Check if user exists in database\n    $query = \"SELECT * FROM users WHERE email='$email'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 1) {\n        // Generate random token and store it in session\n        $token = bin2hex(random_bytes(32));\n        $_SESSION['reset_token'] = $token;\n\n        // Send email to user with reset link\n        sendEmail($email, $token);\n    } else {\n        echo 'User not found.';\n    }\n}\n\n?>\n```\n**Step 3: Create HTML Form**\n\nCreate a new file called `forgot_password.html` and add the following code:\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Forgot Password</title>\n</head>\n<body>\n    <h1>Forgot Password</h1>\n    <form action=\"forgot_password.php\" method=\"post\">\n        <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\"><br><br>\n        <button type=\"submit\" name=\"submit\">Submit</button>\n    </form>\n\n    <?php if (isset($_SESSION['reset_token'])) { ?>\n        <h1>Reset Your Password</h1>\n        <form action=\"reset_password.php\" method=\"post\">\n            <input type=\"hidden\" name=\"token\" value=\"<?php echo $_SESSION['reset_token']; ?>\">\n            <input type=\"password\" name=\"new_password\" placeholder=\"Enter your new password\"><br><br>\n            <button type=\"submit\">Reset Password</button>\n        </form>\n    <?php } ?>\n</body>\n</html>\n```\n**Step 4: Create Reset Password Page**\n\nCreate a new file called `reset_password.php` and add the following code:\n```php\n<?php\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\n// Check if token exists in session\nif (isset($_SESSION['reset_token'])) {\n    // Get user email from token\n    $query = \"SELECT * FROM users WHERE reset_token='\".$_SESSION['reset_token'].\"'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 1) {\n        // Update password using MD5 hash\n        $new_password = md5($_POST['new_password']);\n        $query = \"UPDATE users SET password='$new_password' WHERE reset_token='\".$_SESSION['reset_token'].\"'\";\n        mysqli_query($conn, $query);\n\n        echo 'Password has been updated successfully!';\n    } else {\n        echo 'Invalid token.';\n    }\n}\n\n// Close database connection\nmysqli_close($conn);\n?>\n```\nThat's it! Now you should have a working \"Forgot Password\" function using PHP.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\n// Check connection\nif (!$conn) {\n    die('Connection failed: ' . mysqli_error($conn));\n}\n\n// Function to send email using PHPMailer\nfunction sendEmail($email, $token) {\n    require_once 'PHPMailer/src/PHPMailer.php';\n    require_once 'PHPMailer/src/SMTP.php';\n\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.gmail.com'; // or your SMTP server\n    $mail->Port = 587;\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@gmail.com'; // or your email\n    $mail->Password = 'your_password'; // or your password\n\n    $mail->setFrom('your_email@gmail.com', 'Your Name');\n    $mail->addAddress($email);\n\n    $body = '<p>Click on this link to reset your password: <a href=\"http://localhost/reset_password.php?token=' . $token . '\">Reset Password</a></p>';\n    $mail->isHTML(true);\n    $mail->Subject = 'Reset Your Password';\n    $mail->Body = $body;\n    $mail->AltBody = 'This is a plain text email';\n\n    if (!$mail->send()) {\n        echo 'Message could not be sent. Mailer Error: ' . $mail->ErrorInfo;\n    } else {\n        echo 'Email has been sent successfully!';\n    }\n}\n\n// Function to reset password\nfunction resetPassword($email, $token) {\n    // Connect to database\n    $conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\n    // Check if token exists in database\n    $query = \"SELECT * FROM users WHERE email='$email' AND reset_token='$token'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 1) {\n        // Update password using MD5 hash\n        $new_password = md5('your_new_password');\n        $query = \"UPDATE users SET password='$new_password' WHERE email='$email'\";\n        mysqli_query($conn, $query);\n\n        echo 'Password has been updated successfully!';\n    } else {\n        echo 'Invalid token or email.';\n    }\n\n    // Close database connection\n    mysqli_close($conn);\n}\n\n// Handle forgot password request\nif (isset($_POST['submit'])) {\n    $email = $_POST['email'];\n\n    // Check if user exists in database\n    $query = \"SELECT * FROM users WHERE email='$email'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 1) {\n        // Generate random token and store it in session\n        $token = bin2hex(random_bytes(32));\n        $_SESSION['reset_token'] = $token;\n\n        // Send email to user with reset link\n        sendEmail($email, $token);\n    } else {\n        echo 'User not found.';\n    }\n}\n\n?>\n```", null, "```php\n<?php\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\n// Check if token exists in session\nif (isset($_SESSION['reset_token'])) {\n    // Get user email from token\n    $query = \"SELECT * FROM users WHERE reset_token='\".$_SESSION['reset_token'].\"'\";\n    $result = mysqli_query($conn, $query);\n    if (mysqli_num_rows($result) == 1) {\n        // Update password using MD5 hash\n        $new_password = md5($_POST['new_password']);\n        $query = \"UPDATE users SET password='$new_password' WHERE reset_token='\".$_SESSION['reset_token'].\"'\";\n        mysqli_query($conn, $query);\n\n        echo 'Password has been updated successfully!';\n    } else {\n        echo 'Invalid token.';\n    }\n}\n\n// Close database connection\nmysqli_close($conn);\n?>\n```"]}
