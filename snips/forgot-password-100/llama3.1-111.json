{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can create a \"Forgot Password\" functionality in PHP. This will send a link to the user's email with a token that they can use to reset their password.\n\n**Note:** Before implementing this, make sure your PHP server has the necessary extensions installed, such as `mysqli` or PDO for database operations and `mail()` function for sending emails.\n\n### Database Setup\n\nWe'll assume you have a MySQL database table named `users` with columns `id`, `email`, and `password`.\n\n```sql\nCREATE TABLE users (\n    id INT AUTO_INCREMENT,\n    email VARCHAR(255) NOT NULL,\n    password VARCHAR(255) NOT NULL,\n    PRIMARY KEY (id)\n);\n```\n\n### PHP Code\n\nCreate a file named `forgot_password.php` in your project directory.\n\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Database connection\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send password reset link via email\nfunction sendResetLink($email, $token)\n{\n    // Email configuration (you can use Gmail or other services)\n    $to = $email;\n    $subject = 'Password Reset Link';\n    $message = '<p>Click on this link to reset your password:</p><p><a href=\"' . URL . 'reset-password.php?token=' . $token . '\">Reset Password</a></p>';\n    $headers = 'From: no-reply@yourdomain.com' . \"\\r\\n\" .\n        'Content-Type: text/html; charset=UTF-8' . \"\\r\\n\";\n\n    mail($to, $subject, $message, $headers);\n}\n\n// Function to generate token\nfunction generateToken()\n{\n    return bin2hex(random_bytes(32));\n}\n\n// Handle form submission (forgotten password)\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $email = $_POST['email'];\n\n    // Check if email exists in the database\n    $sql = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            $token = generateToken();\n\n            // Update token in the database\n            $updateSql = \"UPDATE users SET password_token = '$token' WHERE email = '$email'\";\n            $conn->query($updateSql);\n\n            // Send reset link via email\n            sendResetLink($email, $token);\n        }\n    }\n\n    header('Location: thank-you.php');\n    exit;\n}\n\n?>\n\n<!-- Form to enter email address -->\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\" required><br>\n    <button type=\"submit\">Submit</button>\n</form>\n\n```\n\nThis script does the following:\n\n1.  Connects to a MySQL database using your credentials.\n2.  Handles form submission by retrieving the email address from the POST request.\n3.  Checks if an email exists in the database.\n4.  If it does, generates a random token and updates the user's record with this token.\n5.  Sends a password reset link via email to the specified email address using PHP's `mail()` function.\n\n**Note:** This is a basic example. You should always validate and sanitize user input data in a production environment. Additionally, consider implementing a more secure method for storing passwords, such as bcrypt or Argon2.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Database connection\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send password reset link via email\nfunction sendResetLink($email, $token)\n{\n    // Email configuration (you can use Gmail or other services)\n    $to = $email;\n    $subject = 'Password Reset Link';\n    $message = '<p>Click on this link to reset your password:</p><p><a href=\"' . URL . 'reset-password.php?token=' . $token . '\">Reset Password</a></p>';\n    $headers = 'From: no-reply@yourdomain.com' . \"\\r\\n\" .\n        'Content-Type: text/html; charset=UTF-8' . \"\\r\\n\";\n\n    mail($to, $subject, $message, $headers);\n}\n\n// Function to generate token\nfunction generateToken()\n{\n    return bin2hex(random_bytes(32));\n}\n\n// Handle form submission (forgotten password)\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $email = $_POST['email'];\n\n    // Check if email exists in the database\n    $sql = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            $token = generateToken();\n\n            // Update token in the database\n            $updateSql = \"UPDATE users SET password_token = '$token' WHERE email = '$email'\";\n            $conn->query($updateSql);\n\n            // Send reset link via email\n            sendResetLink($email, $token);\n        }\n    }\n\n    header('Location: thank-you.php');\n    exit;\n}\n\n?>\n\n<!-- Form to enter email address -->\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\" required><br>\n    <button type=\"submit\">Submit</button>\n</form>\n\n```"]}
