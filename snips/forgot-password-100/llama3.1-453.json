{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how you can create a \"Forgot Password\" function in PHP:\n\n**Step 1: User Input**\n\nFirst, we need to create a form where the user can input their email address. This will be used to send a password reset link to their email.\n\n```php\n<form action=\"forgot_password.php\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\"><br>\n    <button type=\"submit\">Submit</button>\n</form>\n```\n\n**Step 2: Verify User Input**\n\nNext, we need to verify the user input and check if the email exists in our database. If it does, we will send a password reset link to their email.\n\n```php\n<?php\nif (isset($_POST['email'])) {\n    $email = $_POST['email'];\n    \n    // Query to select user from database\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n    \n    if (mysqli_num_rows($result) > 0) {\n        // Get the user's ID and email\n        $row = mysqli_fetch_assoc($result);\n        $user_id = $row['id'];\n        \n        // Generate a random password reset token\n        $token = bin2hex(random_bytes(32));\n        \n        // Update the user's password reset token in database\n        $query = \"UPDATE users SET password_reset_token = '$token' WHERE id = '$user_id'\";\n        mysqli_query($conn, $query);\n        \n        // Send email with password reset link\n        send_email($email, $token);\n    } else {\n        echo \"Email not found\";\n    }\n}\n\n// Function to send email with password reset link\nfunction send_email($email, $token) {\n    $subject = \"Password Reset Link\";\n    $body = \"\n    <p>Click on the following link to reset your password:</p>\n    <a href='reset_password.php?token=$token'>$url</a>\n    \";\n    \n    $headers = 'From: your-email@example.com' . \"\\r\\n\" .\n        'Reply-To: your-email@example.com' . \"\\r\\n\" .\n        'Content-Type: text/html; charset=UTF-8';\n        \n    mail($email, $subject, $body, $headers);\n}\n\n// Function to reset password\nfunction reset_password() {\n    if (isset($_GET['token'])) {\n        // Get the user's ID and email from database using the token\n        $query = \"SELECT * FROM users WHERE password_reset_token = '$_GET[token]'\";\n        $result = mysqli_query($conn, $query);\n        \n        if (mysqli_num_rows($result) > 0) {\n            // Update the user's password in database\n            $new_password = $_POST['password'];\n            $confirm_password = $_POST['confirm_password'];\n            \n            if ($new_password == $confirm_password) {\n                // Hash the new password and update it in database\n                $hashed_password = password_hash($new_password, PASSWORD_DEFAULT);\n                $query = \"UPDATE users SET password = '$hashed_password' WHERE password_reset_token = '$_GET[token]'\";\n                mysqli_query($conn, $query);\n                \n                // Redirect user to login page\n                header(\"Location: login.php\");\n                exit;\n            } else {\n                echo \"Passwords do not match\";\n            }\n        } else {\n            echo \"Invalid token\";\n        }\n    }\n}\n```\n\nThis code will send a password reset link to the user's email when they submit the form. The link will contain a unique token that can be used to reset the user's password.\n\n**Note:** This is just an example and you should modify it according to your needs. Also, make sure to secure your database connection using prepared statements and never store passwords in plain text.\n\nAlso, you need to have `mail()` function enabled on your server to send emails. If it's not enabled, you can use a third-party email service like Mailgun or Sendgrid.\n\nPlease let me know if you have any questions or need further clarification!", "code_blocks": ["```php\n<form action=\"forgot_password.php\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\"><br>\n    <button type=\"submit\">Submit</button>\n</form>\n```", "```php\n<?php\nif (isset($_POST['email'])) {\n    $email = $_POST['email'];\n    \n    // Query to select user from database\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n    \n    if (mysqli_num_rows($result) > 0) {\n        // Get the user's ID and email\n        $row = mysqli_fetch_assoc($result);\n        $user_id = $row['id'];\n        \n        // Generate a random password reset token\n        $token = bin2hex(random_bytes(32));\n        \n        // Update the user's password reset token in database\n        $query = \"UPDATE users SET password_reset_token = '$token' WHERE id = '$user_id'\";\n        mysqli_query($conn, $query);\n        \n        // Send email with password reset link\n        send_email($email, $token);\n    } else {\n        echo \"Email not found\";\n    }\n}\n\n// Function to send email with password reset link\nfunction send_email($email, $token) {\n    $subject = \"Password Reset Link\";\n    $body = \"\n    <p>Click on the following link to reset your password:</p>\n    <a href='reset_password.php?token=$token'>$url</a>\n    \";\n    \n    $headers = 'From: your-email@example.com' . \"\\r\\n\" .\n        'Reply-To: your-email@example.com' . \"\\r\\n\" .\n        'Content-Type: text/html; charset=UTF-8';\n        \n    mail($email, $subject, $body, $headers);\n}\n\n// Function to reset password\nfunction reset_password() {\n    if (isset($_GET['token'])) {\n        // Get the user's ID and email from database using the token\n        $query = \"SELECT * FROM users WHERE password_reset_token = '$_GET[token]'\";\n        $result = mysqli_query($conn, $query);\n        \n        if (mysqli_num_rows($result) > 0) {\n            // Update the user's password in database\n            $new_password = $_POST['password'];\n            $confirm_password = $_POST['confirm_password'];\n            \n            if ($new_password == $confirm_password) {\n                // Hash the new password and update it in database\n                $hashed_password = password_hash($new_password, PASSWORD_DEFAULT);\n                $query = \"UPDATE users SET password = '$hashed_password' WHERE password_reset_token = '$_GET[token]'\";\n                mysqli_query($conn, $query);\n                \n                // Redirect user to login page\n                header(\"Location: login.php\");\n                exit;\n            } else {\n                echo \"Passwords do not match\";\n            }\n        } else {\n            echo \"Invalid token\";\n        }\n    }\n}\n```"]}
