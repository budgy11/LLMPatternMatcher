{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how to create a \"forgot password\" function using PHP:\n\n**Step 1: User submits the form**\n\nThe user visits your website and clicks on the \"Forgot Password\" link. They are taken to a page where they enter their email address.\n\n**HTML Form**\n```php\n<form action=\"forgot_password.php\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\">\n    <button type=\"submit\">Submit</button>\n</form>\n```\n**Step 2: PHP script checks the email and sends a reset password link**\n\nThe user submits the form, and our PHP script receives their email address. We then query the database to check if the email exists.\n```php\n<?php\n\n// Connect to the database\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check if the form has been submitted\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get the user's email address\n    $email = $_POST['email'];\n\n    // Query the database to check if the email exists\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n\n    // If the email is found, send a reset password link\n    if (mysqli_num_rows($result) > 0) {\n        $user_id = mysqli_fetch_assoc($result)['id'];\n        $token = bin2hex(random_bytes(16));\n        $expires = date(\"Y-m-d H:i:s\", strtotime('+1 hour'));\n\n        // Insert the token into the database\n        $query = \"INSERT INTO reset_tokens (user_id, token, expires) VALUES ('$user_id', '$token', '$expires')\";\n        mysqli_query($conn, $query);\n\n        // Send an email with a reset password link\n        $to = $email;\n        $subject = \"Reset Password Link\";\n        $body = \"\n            Hi there!\n\n            You have requested to reset your password. Click the following link to create a new password:\n\n            <a href='http://example.com/reset_password.php?token=$token'>Reset Password</a>\n\n            Best regards,\n            Your Website\n        \";\n\n        // Send the email using mail() function or a third-party library (e.g., PHPMailer)\n        mail($to, $subject, $body);\n\n        echo \"A password reset link has been sent to your email address.\";\n    } else {\n        echo \"Email not found. Please try again.\";\n    }\n}\n\n?>\n```\n**Step 3: User clicks on the reset password link and is taken to a new page**\n\nThe user receives an email with a reset password link, which they click on. This takes them to a new page where they enter their new password.\n```php\n<?php\n\n// Get the token from the URL parameter\n$token = $_GET['token'];\n\n// Query the database to check if the token is valid\n$query = \"SELECT * FROM reset_tokens WHERE token = '$token'\";\n$result = mysqli_query($conn, $query);\n\nif (mysqli_num_rows($result) > 0) {\n    // Get the user's ID from the result\n    $user_id = mysqli_fetch_assoc($result)['user_id'];\n\n    // User can now enter their new password and submit it\n    echo \"<form action='reset_password.php' method='post'>\n        <input type='password' name='new_password' placeholder='Enter your new password'>\n        <button type='submit'>Submit</button>\n    </form>\";\n} else {\n    echo \"Invalid token. Please try again.\";\n}\n\n?>\n```\n**Step 4: PHP script updates the user's password**\n\nThe user submits their new password, and our PHP script receives it. We then update the user's password in the database.\n```php\n<?php\n\n// Get the new password from the form submission\n$new_password = $_POST['new_password'];\n\n// Hash the new password using a hashing algorithm (e.g., bcrypt)\n$hashed_new_password = password_hash($new_password, PASSWORD_DEFAULT);\n\n// Update the user's password in the database\n$query = \"UPDATE users SET password = '$hashed_new_password' WHERE id = '$user_id'\";\nmysqli_query($conn, $query);\n\necho \"Password updated successfully!\";\n?>\n\n</php>\n```\nThis is a basic example of how to create a forgot password function using PHP. Note that this code assumes you have a database table called `users` with columns for email and password, as well as a separate table called `reset_tokens` with columns for user ID, token, and expiration date.\n\nPlease keep in mind that this is just an example and should not be used in production without proper security measures in place (e.g., hashing passwords securely, validating user input). Additionally, you may want to consider using a more secure password reset system, such as one that uses a third-party service or a library specifically designed for password reset.", "code_blocks": ["```php\n<form action=\"forgot_password.php\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\">\n    <button type=\"submit\">Submit</button>\n</form>\n```", "```php\n<?php\n\n// Connect to the database\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\n// Check if the form has been submitted\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get the user's email address\n    $email = $_POST['email'];\n\n    // Query the database to check if the email exists\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = mysqli_query($conn, $query);\n\n    // If the email is found, send a reset password link\n    if (mysqli_num_rows($result) > 0) {\n        $user_id = mysqli_fetch_assoc($result)['id'];\n        $token = bin2hex(random_bytes(16));\n        $expires = date(\"Y-m-d H:i:s\", strtotime('+1 hour'));\n\n        // Insert the token into the database\n        $query = \"INSERT INTO reset_tokens (user_id, token, expires) VALUES ('$user_id', '$token', '$expires')\";\n        mysqli_query($conn, $query);\n\n        // Send an email with a reset password link\n        $to = $email;\n        $subject = \"Reset Password Link\";\n        $body = \"\n            Hi there!\n\n            You have requested to reset your password. Click the following link to create a new password:\n\n            <a href='http://example.com/reset_password.php?token=$token'>Reset Password</a>\n\n            Best regards,\n            Your Website\n        \";\n\n        // Send the email using mail() function or a third-party library (e.g., PHPMailer)\n        mail($to, $subject, $body);\n\n        echo \"A password reset link has been sent to your email address.\";\n    } else {\n        echo \"Email not found. Please try again.\";\n    }\n}\n\n?>\n```", "```php\n<?php\n\n// Get the token from the URL parameter\n$token = $_GET['token'];\n\n// Query the database to check if the token is valid\n$query = \"SELECT * FROM reset_tokens WHERE token = '$token'\";\n$result = mysqli_query($conn, $query);\n\nif (mysqli_num_rows($result) > 0) {\n    // Get the user's ID from the result\n    $user_id = mysqli_fetch_assoc($result)['user_id'];\n\n    // User can now enter their new password and submit it\n    echo \"<form action='reset_password.php' method='post'>\n        <input type='password' name='new_password' placeholder='Enter your new password'>\n        <button type='submit'>Submit</button>\n    </form>\";\n} else {\n    echo \"Invalid token. Please try again.\";\n}\n\n?>\n```", "```php\n<?php\n\n// Get the new password from the form submission\n$new_password = $_POST['new_password'];\n\n// Hash the new password using a hashing algorithm (e.g., bcrypt)\n$hashed_new_password = password_hash($new_password, PASSWORD_DEFAULT);\n\n// Update the user's password in the database\n$query = \"UPDATE users SET password = '$hashed_new_password' WHERE id = '$user_id'\";\nmysqli_query($conn, $query);\n\necho \"Password updated successfully!\";\n?>\n\n</php>\n```"]}
