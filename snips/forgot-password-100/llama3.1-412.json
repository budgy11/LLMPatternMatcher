{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a \"forgot password\" function using PHP, which will send the user's email with a link to reset their password.\n\n**Note:** This example assumes you have already set up a database and are using a PHP framework such as Laravel or CodeIgniter. The code below uses raw PHP and MySQLi for simplicity.\n\n### Database Schema\n\n```sql\nCREATE TABLE `users` (\n  `id` int(11) NOT NULL PRIMARY KEY AUTO_INCREMENT,\n  `email` varchar(255) NOT NULL UNIQUE,\n  `password` varchar(255) NOT NULL\n);\n```\n\n### Forgot Password Function\n\n**PHP**\n\n```php\n// Define the email sending function\nfunction sendEmail($to, $subject, $body) {\n    // Replace with your own mail server settings\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.gmail.com';\n    $mail->Port = 587;\n    $mail->SMTPSecure = 'tls';\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your-email@gmail.com';\n    $mail->Password = 'your-password';\n\n    $mail->setFrom('your-email@gmail.com', 'Your Name');\n    $mail->addAddress($to);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n\n    if (!$mail->send()) {\n        return false;\n    }\n    return true;\n}\n\n// Forgot password function\nfunction forgotPassword() {\n    // Get user input\n    $email = $_POST['email'];\n\n    // Validate email\n    if (!preg_match(\"/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/\", $email)) {\n        return \"Invalid email address.\";\n    }\n\n    // Connect to database\n    $conn = new mysqli('localhost', 'username', 'password', 'database_name');\n\n    // Check if user exists\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows == 0) {\n        return \"Email not found.\";\n    }\n\n    // Generate random password\n    $password = bin2hex(random_bytes(16));\n\n    // Update user's password in database\n    $updateQuery = \"UPDATE users SET password = '$password' WHERE email = '$email'\";\n    $conn->query($updateQuery);\n\n    // Send email to user with new password\n    $subject = 'Reset Password';\n    $body = 'Your new password is: <b>' . $password . '</b>';\n    sendEmail($email, $subject, $body);\n\n    return \"Password sent to your email.\";\n}\n\n// Call the function and display result\n$result = forgotPassword();\necho $result;\n```\n\n**HTML (for example usage)**\n\n```html\n<form action=\"\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n    <button type=\"submit\">Send Email</button>\n</form>\n```\n\n### Explanation:\n\n1. The `sendEmail` function sends an email to the user with their new password.\n2. The `forgotPassword` function gets the user's input (email), validates it, and checks if a user exists in the database with that email.\n3. If the user exists, the function generates a random password, updates the user's password in the database, and sends an email to the user with their new password.\n\nNote: This is a basic example and you should adapt it according to your specific needs (e.g., adding more validation, using HTTPS for secure password transmission).", "code_blocks": [null, "```php\n// Define the email sending function\nfunction sendEmail($to, $subject, $body) {\n    // Replace with your own mail server settings\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.gmail.com';\n    $mail->Port = 587;\n    $mail->SMTPSecure = 'tls';\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your-email@gmail.com';\n    $mail->Password = 'your-password';\n\n    $mail->setFrom('your-email@gmail.com', 'Your Name');\n    $mail->addAddress($to);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n\n    if (!$mail->send()) {\n        return false;\n    }\n    return true;\n}\n\n// Forgot password function\nfunction forgotPassword() {\n    // Get user input\n    $email = $_POST['email'];\n\n    // Validate email\n    if (!preg_match(\"/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/\", $email)) {\n        return \"Invalid email address.\";\n    }\n\n    // Connect to database\n    $conn = new mysqli('localhost', 'username', 'password', 'database_name');\n\n    // Check if user exists\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows == 0) {\n        return \"Email not found.\";\n    }\n\n    // Generate random password\n    $password = bin2hex(random_bytes(16));\n\n    // Update user's password in database\n    $updateQuery = \"UPDATE users SET password = '$password' WHERE email = '$email'\";\n    $conn->query($updateQuery);\n\n    // Send email to user with new password\n    $subject = 'Reset Password';\n    $body = 'Your new password is: <b>' . $password . '</b>';\n    sendEmail($email, $subject, $body);\n\n    return \"Password sent to your email.\";\n}\n\n// Call the function and display result\n$result = forgotPassword();\necho $result;\n```", null]}
