{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how to create a \"Forgot Password\" functionality using PHP. This will include a form for users to enter their email address, which will then be used to send them an email with a link to reset their password.\n\n**Note:** Before proceeding, you'll need to set up your MySQL database and have a table named `users` with columns `id`, `email`, `password`.\n\n### Database Setup\n\nCreate a new SQL file (`database.sql`) with the following content:\n\n```sql\nCREATE TABLE users (\n  id INT AUTO_INCREMENT,\n  email VARCHAR(255) NOT NULL UNIQUE,\n  password VARCHAR(255) NOT NULL,\n  PRIMARY KEY (id)\n);\n```\n\nAnd import it into your MySQL database.\n\n### PHP Code\n\nCreate a new PHP file (`forgot_password.php`) with the following content:\n\n```php\n<?php\n\n// Configuration\n$databaseHost = 'localhost';\n$databaseName = 'your_database_name';\n$databaseUsername = 'your_database_username';\n$databasePassword = 'your_database_password';\n\n// Connect to database\n$conn = mysqli_connect($databaseHost, $databaseUsername, $databasePassword, $databaseName);\n\nif (!$conn) {\n    die('Connection failed: ' . mysqli_error($conn));\n}\n\n// Get user's email address from form submission\n$email = $_POST['email'];\n\n// Check if user exists\n$query = \"SELECT * FROM users WHERE email = '$email'\";\n$result = mysqli_query($conn, $query);\n\nif (mysqli_num_rows($result) > 0) {\n    // User found, generate a random token and store it in the database\n    $token = bin2hex(random_bytes(32));\n    update_password_token($email, $token);\n    \n    // Send email with password reset link\n    send_password_reset_email($email, $token);\n} else {\n    echo \"Email not found.\";\n}\n\n// Close connection\nmysqli_close($conn);\n\nfunction update_password_token($email, $token) {\n    global $databaseName, $databaseUsername, $databasePassword;\n    \n    // Connect to database\n    $conn = mysqli_connect('localhost', $databaseUsername, $databasePassword, $databaseName);\n    \n    if (!$conn) {\n        die('Connection failed: ' . mysqli_error($conn));\n    }\n    \n    // Update password token in the users table\n    $query = \"UPDATE users SET password_token = '$token' WHERE email = '$email'\";\n    mysqli_query($conn, $query);\n    \n    // Close connection\n    mysqli_close($conn);\n}\n\nfunction send_password_reset_email($email, $token) {\n    // Email configuration\n    $to = $email;\n    $subject = 'Reset Password';\n    $message = \"Click on the link below to reset your password:\\n\\n<a href='https://example.com/reset-password.php?token=\" . $token . \"'>Reset Password</a>\";\n    \n    // Send email using PHPMailer (you'll need to install this library)\n    require_once 'vendor/autoload.php';\n    use PHPMailer\\PHPMailer\\PHPMailer;\n    use PHPMailer\\PHPMailer\\Exception;\n    \n    try {\n        $mail = new PHPMailer();\n        $mail->isSMTP();\n        $mail->Host = 'smtp.example.com';\n        $mail->Port = 587;\n        $mail->SMTPAuth = true;\n        $mail->Username = 'your_email@example.com';\n        $mail->Password = 'your_password';\n        \n        $mail->setFrom('your_email@example.com', 'Your Name');\n        $mail->addAddress($email);\n        $mail->Subject = 'Reset Password';\n        $mail->Body = $message;\n        \n        $mail->send();\n    } catch (Exception $e) {\n        echo \"Message could not be sent. Mailer Error: {$mail->ErrorInfo}\";\n    }\n}\n\n?>\n```\n\nThis code creates a form (`forgot_password.html`) that allows users to enter their email address.\n\n### HTML Form\n\nCreate a new HTML file (`forgot_password.html`) with the following content:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Forgot Password</title>\n</head>\n<body>\n\n<form action=\"forgot_password.php\" method=\"post\">\n    Email Address: <input type=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" value=\"Submit\">\n</form>\n\n</body>\n</html>\n```\n\n**Note:** This is a basic example and you should consider implementing security measures such as email verification, password hashing, and token validation to prevent abuse.\n\nAlso, make sure to replace the placeholders with your actual database credentials, email configuration, and PHPMailer library setup.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$databaseHost = 'localhost';\n$databaseName = 'your_database_name';\n$databaseUsername = 'your_database_username';\n$databasePassword = 'your_database_password';\n\n// Connect to database\n$conn = mysqli_connect($databaseHost, $databaseUsername, $databasePassword, $databaseName);\n\nif (!$conn) {\n    die('Connection failed: ' . mysqli_error($conn));\n}\n\n// Get user's email address from form submission\n$email = $_POST['email'];\n\n// Check if user exists\n$query = \"SELECT * FROM users WHERE email = '$email'\";\n$result = mysqli_query($conn, $query);\n\nif (mysqli_num_rows($result) > 0) {\n    // User found, generate a random token and store it in the database\n    $token = bin2hex(random_bytes(32));\n    update_password_token($email, $token);\n    \n    // Send email with password reset link\n    send_password_reset_email($email, $token);\n} else {\n    echo \"Email not found.\";\n}\n\n// Close connection\nmysqli_close($conn);\n\nfunction update_password_token($email, $token) {\n    global $databaseName, $databaseUsername, $databasePassword;\n    \n    // Connect to database\n    $conn = mysqli_connect('localhost', $databaseUsername, $databasePassword, $databaseName);\n    \n    if (!$conn) {\n        die('Connection failed: ' . mysqli_error($conn));\n    }\n    \n    // Update password token in the users table\n    $query = \"UPDATE users SET password_token = '$token' WHERE email = '$email'\";\n    mysqli_query($conn, $query);\n    \n    // Close connection\n    mysqli_close($conn);\n}\n\nfunction send_password_reset_email($email, $token) {\n    // Email configuration\n    $to = $email;\n    $subject = 'Reset Password';\n    $message = \"Click on the link below to reset your password:\\n\\n<a href='https://example.com/reset-password.php?token=\" . $token . \"'>Reset Password</a>\";\n    \n    // Send email using PHPMailer (you'll need to install this library)\n    require_once 'vendor/autoload.php';\n    use PHPMailer\\PHPMailer\\PHPMailer;\n    use PHPMailer\\PHPMailer\\Exception;\n    \n    try {\n        $mail = new PHPMailer();\n        $mail->isSMTP();\n        $mail->Host = 'smtp.example.com';\n        $mail->Port = 587;\n        $mail->SMTPAuth = true;\n        $mail->Username = 'your_email@example.com';\n        $mail->Password = 'your_password';\n        \n        $mail->setFrom('your_email@example.com', 'Your Name');\n        $mail->addAddress($email);\n        $mail->Subject = 'Reset Password';\n        $mail->Body = $message;\n        \n        $mail->send();\n    } catch (Exception $e) {\n        echo \"Message could not be sent. Mailer Error: {$mail->ErrorInfo}\";\n    }\n}\n\n?>\n```", null]}
