{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a \"Forgot Password\" function in PHP, which sends the user an email with a link to reset their password:\n\n**`forgot_password.php`**\n```php\n<?php\n\nrequire_once 'config.php'; // database connection settings\nrequire_once 'functions.php'; // utility functions for email sending and hashing\n\n// Check if form data has been submitted\nif (isset($_POST['email'])) {\n  // Validate email address\n  $email = filter_var($_POST['email'], FILTER_VALIDATE_EMAIL);\n  if ($email) {\n    // Retrieve user ID from database based on email address\n    $user_id = getUserIDByEmail($db, $email);\n    if ($user_id) {\n      // Generate a random password reset token and store it in the database\n      $token = bin2hex(random_bytes(32));\n      updateToken($db, $user_id, $token);\n\n      // Send an email with a link to reset the password\n      sendPasswordResetEmail($email, $token);\n    } else {\n      echo \"Error: User not found.\";\n    }\n  } else {\n    echo \"Invalid email address.\";\n  }\n} else {\n  // Display forgot password form if no data has been submitted\n  ?>\n  <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email Address:</label>\n    <input type=\"text\" id=\"email\" name=\"email\" />\n    <button type=\"submit\">Reset Password</button>\n  </form>\n  <?php\n}\n```\n**`config.php`**\n```php\n<?php\n\n// Database connection settings\n$db = new PDO('mysql:host=localhost;dbname=mydatabase', 'username', 'password');\n\n// Utility functions for email sending and hashing (e.g. `sendPasswordResetEmail()` and `hash()`)\n\n?>\n```\n**`functions.php`**\n```php\n<?php\n\nfunction sendPasswordResetEmail($email, $token) {\n  // Set up email sender using PHPMailer or similar library\n  $mail = new PHPMailer();\n  $mail->isSMTP();\n  $mail->Host = 'smtp.example.com';\n  $mail->Port = 587;\n  $mail->SMTPAuth = true;\n  $mail->Username = 'your_email@example.com';\n  $mail->Password = 'your_password';\n\n  // Set email body and subject\n  $body = \"Click on this link to reset your password: <a href='http://example.com/reset-password.php?token=$token'>Reset Password</a>\";\n  $subject = \"Password Reset Request\";\n\n  // Send email using PHPMailer\n  $mail->setFrom('your_email@example.com', 'Your Name');\n  $mail->addAddress($email);\n  $mail->Subject = $subject;\n  $mail->Body = $body;\n  $mail->send();\n\n  echo \"Email sent successfully.\";\n}\n\nfunction updateToken($db, $user_id, $token) {\n  // Update user's token in the database\n  $query = \"UPDATE users SET password_reset_token = :token WHERE id = :user_id\";\n  $stmt = $db->prepare($query);\n  $stmt->bindParam(':token', $token);\n  $stmt->bindParam(':user_id', $user_id);\n  $stmt->execute();\n}\n\nfunction getUserIDByEmail($db, $email) {\n  // Retrieve user ID from database based on email address\n  $query = \"SELECT id FROM users WHERE email = :email\";\n  $stmt = $db->prepare($query);\n  $stmt->bindParam(':email', $email);\n  $stmt->execute();\n  return $stmt->fetchColumn();\n}\n\n?>\n```\nThis example uses the following assumptions:\n\n* The `config.php` file contains database connection settings and utility functions for email sending and hashing.\n* The `functions.php` file contains additional utility functions, including those used in the forgot password process (e.g., `sendPasswordResetEmail()`).\n* The `forgot_password.php` file is responsible for handling the forgot password form submission and sending an email with a link to reset the password.\n\nTo use this example, you'll need to:\n\n1. Create a new PHP file (`config.php`) that contains database connection settings and utility functions.\n2. Create a new PHP file (`functions.php`) that contains additional utility functions used in the forgot password process.\n3. Update the `forgot_password.php` file to include code for sending an email with a link to reset the password.\n\nNote: This example uses PHPMailer to send emails, but you can use any other email sending library or service. Additionally, this example assumes that you have already set up a database and created a users table with columns for `id`, `email`, and `password_reset_token`.", "code_blocks": ["```php\n<?php\n\nrequire_once 'config.php'; // database connection settings\nrequire_once 'functions.php'; // utility functions for email sending and hashing\n\n// Check if form data has been submitted\nif (isset($_POST['email'])) {\n  // Validate email address\n  $email = filter_var($_POST['email'], FILTER_VALIDATE_EMAIL);\n  if ($email) {\n    // Retrieve user ID from database based on email address\n    $user_id = getUserIDByEmail($db, $email);\n    if ($user_id) {\n      // Generate a random password reset token and store it in the database\n      $token = bin2hex(random_bytes(32));\n      updateToken($db, $user_id, $token);\n\n      // Send an email with a link to reset the password\n      sendPasswordResetEmail($email, $token);\n    } else {\n      echo \"Error: User not found.\";\n    }\n  } else {\n    echo \"Invalid email address.\";\n  }\n} else {\n  // Display forgot password form if no data has been submitted\n  ?>\n  <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email Address:</label>\n    <input type=\"text\" id=\"email\" name=\"email\" />\n    <button type=\"submit\">Reset Password</button>\n  </form>\n  <?php\n}\n```", "```php\n<?php\n\n// Database connection settings\n$db = new PDO('mysql:host=localhost;dbname=mydatabase', 'username', 'password');\n\n// Utility functions for email sending and hashing (e.g. `sendPasswordResetEmail()` and `hash()`)\n\n?>\n```", "```php\n<?php\n\nfunction sendPasswordResetEmail($email, $token) {\n  // Set up email sender using PHPMailer or similar library\n  $mail = new PHPMailer();\n  $mail->isSMTP();\n  $mail->Host = 'smtp.example.com';\n  $mail->Port = 587;\n  $mail->SMTPAuth = true;\n  $mail->Username = 'your_email@example.com';\n  $mail->Password = 'your_password';\n\n  // Set email body and subject\n  $body = \"Click on this link to reset your password: <a href='http://example.com/reset-password.php?token=$token'>Reset Password</a>\";\n  $subject = \"Password Reset Request\";\n\n  // Send email using PHPMailer\n  $mail->setFrom('your_email@example.com', 'Your Name');\n  $mail->addAddress($email);\n  $mail->Subject = $subject;\n  $mail->Body = $body;\n  $mail->send();\n\n  echo \"Email sent successfully.\";\n}\n\nfunction updateToken($db, $user_id, $token) {\n  // Update user's token in the database\n  $query = \"UPDATE users SET password_reset_token = :token WHERE id = :user_id\";\n  $stmt = $db->prepare($query);\n  $stmt->bindParam(':token', $token);\n  $stmt->bindParam(':user_id', $user_id);\n  $stmt->execute();\n}\n\nfunction getUserIDByEmail($db, $email) {\n  // Retrieve user ID from database based on email address\n  $query = \"SELECT id FROM users WHERE email = :email\";\n  $stmt = $db->prepare($query);\n  $stmt->bindParam(':email', $email);\n  $stmt->execute();\n  return $stmt->fetchColumn();\n}\n\n?>\n```"]}
