{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how you can create a forgot password function in PHP:\n\n**Forgot Password Function:**\n```php\nfunction forgotPassword($email) {\n  // Connect to database\n  $db = new mysqli('localhost', 'username', 'password', 'database');\n\n  if ($db->connect_error) {\n    die(\"Connection failed: \" . $db->connect_error);\n  }\n\n  // Check if email exists in database\n  $sql = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = $db->query($sql);\n\n  if ($result->num_rows > 0) {\n    // If email exists, generate new password and send reset link via email\n    $newPassword = substr(md5(uniqid()), 0, 8);\n    $hashedPassword = hash('sha256', $newPassword);\n\n    $sql = \"UPDATE users SET password = '$hashedPassword' WHERE email = '$email'\";\n    $db->query($sql);\n\n    // Send reset link via email\n    $to = $email;\n    $subject = 'Reset Password';\n    $message = \"Click here to reset your password: <a href='http://yourwebsite.com/reset-password/$newPassword'>$newPassword</a>\";\n    mail($to, $subject, $message);\n\n    return true; // Email sent successfully\n  } else {\n    return false; // Email not found in database\n  }\n\n  $db->close();\n}\n```\n**Reset Password Function:**\n```php\nfunction resetPassword($password) {\n  // Connect to database\n  $db = new mysqli('localhost', 'username', 'password', 'database');\n\n  if ($db->connect_error) {\n    die(\"Connection failed: \" . $db->connect_error);\n  }\n\n  // Check if password is valid (not too short, not too common)\n  if (strlen($password) < 8 || strpos($password, strtolower($password)) === false) {\n    return false; // Invalid password\n  }\n\n  // Update user's password in database\n  $sql = \"UPDATE users SET password = '$password' WHERE reset_password_code = '$password'\";\n  $db->query($sql);\n\n  return true; // Password updated successfully\n}\n\n$db->close();\n```\n**Example Use Case:**\n\n1. User clicks on \"Forgot Password\" link and enters their email address.\n2. The `forgotPassword` function is called with the user's email address as an argument.\n3. If the email exists in the database, a new password is generated and sent to the user via email along with a reset link.\n4. When the user clicks on the reset link, they are taken to a page where they can enter their new password.\n5. The `resetPassword` function is called with the new password as an argument.\n6. If the password is valid (not too short, not too common), it is updated in the database.\n\nNote: This is just a basic example and you should consider implementing additional security measures such as:\n\n* Salting and hashing passwords\n* Using HTTPS for password reset links\n* Implementing rate limiting for password reset requests\n* Using two-factor authentication\n\nAlso, make sure to replace `'yourwebsite.com'` with your actual website URL.", "code_blocks": ["```php\nfunction forgotPassword($email) {\n  // Connect to database\n  $db = new mysqli('localhost', 'username', 'password', 'database');\n\n  if ($db->connect_error) {\n    die(\"Connection failed: \" . $db->connect_error);\n  }\n\n  // Check if email exists in database\n  $sql = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = $db->query($sql);\n\n  if ($result->num_rows > 0) {\n    // If email exists, generate new password and send reset link via email\n    $newPassword = substr(md5(uniqid()), 0, 8);\n    $hashedPassword = hash('sha256', $newPassword);\n\n    $sql = \"UPDATE users SET password = '$hashedPassword' WHERE email = '$email'\";\n    $db->query($sql);\n\n    // Send reset link via email\n    $to = $email;\n    $subject = 'Reset Password';\n    $message = \"Click here to reset your password: <a href='http://yourwebsite.com/reset-password/$newPassword'>$newPassword</a>\";\n    mail($to, $subject, $message);\n\n    return true; // Email sent successfully\n  } else {\n    return false; // Email not found in database\n  }\n\n  $db->close();\n}\n```", "```php\nfunction resetPassword($password) {\n  // Connect to database\n  $db = new mysqli('localhost', 'username', 'password', 'database');\n\n  if ($db->connect_error) {\n    die(\"Connection failed: \" . $db->connect_error);\n  }\n\n  // Check if password is valid (not too short, not too common)\n  if (strlen($password) < 8 || strpos($password, strtolower($password)) === false) {\n    return false; // Invalid password\n  }\n\n  // Update user's password in database\n  $sql = \"UPDATE users SET password = '$password' WHERE reset_password_code = '$password'\";\n  $db->query($sql);\n\n  return true; // Password updated successfully\n}\n\n$db->close();\n```"]}
