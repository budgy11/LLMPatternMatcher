{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a forgotten password function in PHP:\n\n**Step 1: User requests to reset password**\n\nWhen the user clicks on the \"Forgot Password\" link, they are taken to a page where they enter their username or email address. We will store this information in a session variable.\n\n```php\n// forgot_password.php\n\nif (isset($_POST['submit'])) {\n    $username = $_POST['username'];\n    $_SESSION['forgot_username'] = $username;\n}\n```\n\n**Step 2: Send password reset email**\n\nNext, we need to send an email to the user with a link to reset their password. We will use PHP's `mail()` function to send the email.\n\n```php\n// forgot_password.php (continued)\n\nif (isset($_POST['submit'])) {\n    $username = $_POST['username'];\n    $_SESSION['forgot_username'] = $username;\n\n    // Connect to database\n    $conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n\n    // Get user ID and email address from database\n    $stmt = $conn->prepare(\"SELECT id, email FROM users WHERE username = ?\");\n    $stmt->bind_param(\"s\", $username);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            // Send password reset email\n            $email_address = $row['email'];\n            $user_id = $row['id'];\n\n            $subject = \"Password Reset Request\";\n            $body = \"Click on the link below to reset your password: <a href='reset_password.php?id=$user_id'>Reset Password</a>\";\n\n            mail($email_address, $subject, $body);\n\n            echo \"Email sent successfully.\";\n        }\n    } else {\n        echo \"Username not found.\";\n    }\n\n    // Close database connection\n    $conn->close();\n}\n```\n\n**Step 3: User clicks on password reset link**\n\nWhen the user clicks on the password reset link in their email, they are taken to a new page where they can enter their new password.\n\n```php\n// reset_password.php\n\nif (isset($_GET['id'])) {\n    $user_id = $_GET['id'];\n\n    // Connect to database\n    $conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n\n    // Get user data from database\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE id = ?\");\n    $stmt->bind_param(\"i\", $user_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            // Display form to enter new password\n            ?>\n            <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n                <input type=\"password\" name=\"new_password\">\n                <input type=\"hidden\" name=\"user_id\" value=\"<?php echo $row['id']; ?>\">\n                <button type=\"submit\">Submit</button>\n            </form>\n\n            <?php\n        }\n    } else {\n        echo \"User not found.\";\n    }\n\n    // Close database connection\n    $conn->close();\n}\n```\n\n**Step 4: Update user password**\n\nWhen the user submits their new password, we need to update it in the database.\n\n```php\n// reset_password.php (continued)\n\nif (isset($_POST['submit'])) {\n    $user_id = $_POST['user_id'];\n    $new_password = md5($_POST['new_password']);\n\n    // Connect to database\n    $conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n\n    // Update user password in database\n    $stmt = $conn->prepare(\"UPDATE users SET password = ? WHERE id = ?\");\n    $stmt->bind_param(\"si\", $new_password, $user_id);\n    $stmt->execute();\n\n    echo \"Password updated successfully.\";\n}\n\n// Close database connection\n$conn->close();\n```\n\nThis is a basic example of how you can create a forgotten password function using PHP. You should always validate user input and implement additional security measures to prevent hacking attempts.\n\nNote: This example uses the `md5` hashing algorithm, which is not recommended for password storage. Consider using a more secure algorithm like `password_hash`.", "code_blocks": ["```php\n// forgot_password.php\n\nif (isset($_POST['submit'])) {\n    $username = $_POST['username'];\n    $_SESSION['forgot_username'] = $username;\n}\n```", "```php\n// forgot_password.php (continued)\n\nif (isset($_POST['submit'])) {\n    $username = $_POST['username'];\n    $_SESSION['forgot_username'] = $username;\n\n    // Connect to database\n    $conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n\n    // Get user ID and email address from database\n    $stmt = $conn->prepare(\"SELECT id, email FROM users WHERE username = ?\");\n    $stmt->bind_param(\"s\", $username);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            // Send password reset email\n            $email_address = $row['email'];\n            $user_id = $row['id'];\n\n            $subject = \"Password Reset Request\";\n            $body = \"Click on the link below to reset your password: <a href='reset_password.php?id=$user_id'>Reset Password</a>\";\n\n            mail($email_address, $subject, $body);\n\n            echo \"Email sent successfully.\";\n        }\n    } else {\n        echo \"Username not found.\";\n    }\n\n    // Close database connection\n    $conn->close();\n}\n```", "```php\n// reset_password.php\n\nif (isset($_GET['id'])) {\n    $user_id = $_GET['id'];\n\n    // Connect to database\n    $conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n\n    // Get user data from database\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE id = ?\");\n    $stmt->bind_param(\"i\", $user_id);\n    $stmt->execute();\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            // Display form to enter new password\n            ?>\n            <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n                <input type=\"password\" name=\"new_password\">\n                <input type=\"hidden\" name=\"user_id\" value=\"<?php echo $row['id']; ?>\">\n                <button type=\"submit\">Submit</button>\n            </form>\n\n            <?php\n        }\n    } else {\n        echo \"User not found.\";\n    }\n\n    // Close database connection\n    $conn->close();\n}\n```", "```php\n// reset_password.php (continued)\n\nif (isset($_POST['submit'])) {\n    $user_id = $_POST['user_id'];\n    $new_password = md5($_POST['new_password']);\n\n    // Connect to database\n    $conn = new mysqli(\"localhost\", \"username\", \"password\", \"database\");\n\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n\n    // Update user password in database\n    $stmt = $conn->prepare(\"UPDATE users SET password = ? WHERE id = ?\");\n    $stmt->bind_param(\"si\", $new_password, $user_id);\n    $stmt->execute();\n\n    echo \"Password updated successfully.\";\n}\n\n// Close database connection\n$conn->close();\n```"]}
