{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nThis is an example of a basic \"forgot password\" function using PHP. The user will enter their username or email, and the system will send them a reset link to change their password.\n\n**Database Schema**\n------------------\n\nAssuming we have a `users` table with the following columns:\n\n*   `id` (primary key)\n*   `username`\n*   `email`\n*   `password` (hashed)\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255),\n  email VARCHAR(255),\n  password VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_bin\n);\n```\n\n**PHP Code**\n------------\n\n### **Forgot Password Form**\n\nCreate a form that allows the user to enter their username or email.\n\n```php\n<!-- forgot-password.php -->\n\n<?php\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $email = $_POST['email'];\n\n    // Validate input data\n    if (empty($username) || empty($email)) {\n        echo \"Please enter both username and email.\";\n        exit;\n    }\n\n    // Find user by username or email\n    $user = findUser($username, $email);\n    if (!$user) {\n        echo \"No account found with this username or email.\";\n        exit;\n    }\n\n    // Send reset link via email\n    sendResetEmail($user['id']);\n}\n?>\n\n<form method=\"post\">\n    <label for=\"username\">Username:</label>\n    <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <button type=\"submit\">Send Reset Link</button>\n</form>\n```\n\n### **PHP Functions**\n\n```php\n// findUser.php\n\nfunction findUser($username, $email) {\n    global $db;\n\n    // Check if user exists by username or email\n    $query = \"SELECT * FROM users WHERE (username = '$username' OR email = '$email')\";\n    return $db->fetchObject($query);\n}\n```\n\n```php\n// sendResetEmail.php\n\nfunction sendResetEmail($userId) {\n    global $config;\n\n    // Generate reset link and email body\n    $resetLink = \"http://example.com/reset-password?token=\" . generateToken($userId);\n    $emailBody = \"\n        Hello,\n\n        You have requested a password reset for your account. Click the following link to change your password:\n        $resetLink\n\n        Best regards,\n        [Your Name]\n    \";\n\n    // Send email using PHPMailer or similar library\n    $mail->setFrom($config['adminEmail'], $config['siteName']);\n    $mail->addAddress($userId);\n    $mail->Subject = \"Password Reset Link\";\n    $mail->msgHTML($emailBody);\n\n    if (!$mail->send()) {\n        echo \"Error sending email.\";\n    }\n}\n\n// generateToken.php\n\nfunction generateToken($userId) {\n    return hash('sha256', uniqid('', true));\n}\n```\n\n**Example Use Case**\n\n1.  The user enters their username and email in the forgot password form.\n2.  The system checks if a user exists with the provided username or email using `findUser()`.\n3.  If a user is found, the system generates a reset link and sends an email to the user's email address using `sendResetEmail()`.\n\n**Note**\n\n*   Make sure to replace `$config['adminEmail']` and `$config['siteName']` with your actual admin email and site name.\n*   You'll need to install PHPMailer or another email library to send emails programmatically.\n*   This is a basic example, and you should consider implementing additional security measures, such as password hashing and salting.\n\nI hope this helps!", "code_blocks": [null, "```php\n<!-- forgot-password.php -->\n\n<?php\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $email = $_POST['email'];\n\n    // Validate input data\n    if (empty($username) || empty($email)) {\n        echo \"Please enter both username and email.\";\n        exit;\n    }\n\n    // Find user by username or email\n    $user = findUser($username, $email);\n    if (!$user) {\n        echo \"No account found with this username or email.\";\n        exit;\n    }\n\n    // Send reset link via email\n    sendResetEmail($user['id']);\n}\n?>\n\n<form method=\"post\">\n    <label for=\"username\">Username:</label>\n    <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <button type=\"submit\">Send Reset Link</button>\n</form>\n```", "```php\n// findUser.php\n\nfunction findUser($username, $email) {\n    global $db;\n\n    // Check if user exists by username or email\n    $query = \"SELECT * FROM users WHERE (username = '$username' OR email = '$email')\";\n    return $db->fetchObject($query);\n}\n```", "```php\n// sendResetEmail.php\n\nfunction sendResetEmail($userId) {\n    global $config;\n\n    // Generate reset link and email body\n    $resetLink = \"http://example.com/reset-password?token=\" . generateToken($userId);\n    $emailBody = \"\n        Hello,\n\n        You have requested a password reset for your account. Click the following link to change your password:\n        $resetLink\n\n        Best regards,\n        [Your Name]\n    \";\n\n    // Send email using PHPMailer or similar library\n    $mail->setFrom($config['adminEmail'], $config['siteName']);\n    $mail->addAddress($userId);\n    $mail->Subject = \"Password Reset Link\";\n    $mail->msgHTML($emailBody);\n\n    if (!$mail->send()) {\n        echo \"Error sending email.\";\n    }\n}\n\n// generateToken.php\n\nfunction generateToken($userId) {\n    return hash('sha256', uniqid('', true));\n}\n```"]}
