{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a forgotten password function using PHP:\n\n**Password Reset Function**\n```php\nfunction reset_password($email) {\n  // Check if the email exists in the database\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    // Generate a random password\n    $password = generate_password();\n\n    // Update the user's password in the database\n    $query = \"UPDATE users SET password = '$password' WHERE email = '$email'\";\n    mysqli_query($conn, $query);\n\n    // Send an email to the user with their new password\n    send_email($email, 'New Password', 'Your new password is: ' . $password);\n  } else {\n    echo 'Email not found';\n  }\n}\n\nfunction generate_password() {\n  // Generate a random string of characters for the password\n  $characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+~`|}{[]:;?><,./-=';\n  $password = '';\n  for ($i = 0; $i < 12; $i++) {\n    $password .= $characters[rand(0, strlen($characters) - 1)];\n  }\n  return $password;\n}\n\nfunction send_email($to_email, $subject, $message) {\n  // Send an email using PHPMailer\n  require_once 'PHPMailer/PHPMailer.php';\n  require_once 'PHPMailer/SMTP.php';\n\n  $mail = new PHPMailer\\PHPMailer\\PHPMailer();\n  $mail->isSMTP();\n  $mail->Host = 'smtp.example.com';\n  $mail->Port = 587;\n  $mail->SMTPSecure = 'tls';\n  $mail->SMTPAuth = true;\n  $mail->Username = 'your_email@example.com';\n  $mail->Password = 'your_password';\n\n  $mail->setFrom('your_email@example.com', 'Your Name');\n  $mail->addAddress($to_email);\n  $mail->Subject = $subject;\n  $mail->Body = $message;\n\n  if (!$mail->send()) {\n    echo 'Error sending email';\n  }\n}\n```\n**HTML Form**\n```html\n<form action=\"forgot_password.php\" method=\"post\">\n  <input type=\"email\" name=\"email\" placeholder=\"Email address\">\n  <button type=\"submit\">Send Password Reset Link</button>\n</form>\n```\n**Forgot Password Page (forgot_password.php)**\n```php\n<?php\nrequire_once 'functions.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  $email = $_POST['email'];\n  reset_password($email);\n}\n?>\n```\nThis code defines three functions:\n\n* `reset_password()`: generates a random password, updates the user's password in the database, and sends an email with the new password.\n* `generate_password()`: generates a random string of characters for the password.\n* `send_email()`: sends an email using PHPMailer.\n\nThe HTML form submits to the `forgot_password.php` page, which calls the `reset_password()` function if the request method is POST. The `reset_password()` function checks if the email exists in the database, generates a random password, updates the user's password, and sends an email with the new password.\n\nNote: This code assumes you have PHPMailer installed and configured on your server. You will need to modify the SMTP settings and email address to match your own. Additionally, this is just a basic example and you should add additional security measures such as hashing the password before storing it in the database.", "code_blocks": ["```php\nfunction reset_password($email) {\n  // Check if the email exists in the database\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    // Generate a random password\n    $password = generate_password();\n\n    // Update the user's password in the database\n    $query = \"UPDATE users SET password = '$password' WHERE email = '$email'\";\n    mysqli_query($conn, $query);\n\n    // Send an email to the user with their new password\n    send_email($email, 'New Password', 'Your new password is: ' . $password);\n  } else {\n    echo 'Email not found';\n  }\n}\n\nfunction generate_password() {\n  // Generate a random string of characters for the password\n  $characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+~`|}{[]:;?><,./-=';\n  $password = '';\n  for ($i = 0; $i < 12; $i++) {\n    $password .= $characters[rand(0, strlen($characters) - 1)];\n  }\n  return $password;\n}\n\nfunction send_email($to_email, $subject, $message) {\n  // Send an email using PHPMailer\n  require_once 'PHPMailer/PHPMailer.php';\n  require_once 'PHPMailer/SMTP.php';\n\n  $mail = new PHPMailer\\PHPMailer\\PHPMailer();\n  $mail->isSMTP();\n  $mail->Host = 'smtp.example.com';\n  $mail->Port = 587;\n  $mail->SMTPSecure = 'tls';\n  $mail->SMTPAuth = true;\n  $mail->Username = 'your_email@example.com';\n  $mail->Password = 'your_password';\n\n  $mail->setFrom('your_email@example.com', 'Your Name');\n  $mail->addAddress($to_email);\n  $mail->Subject = $subject;\n  $mail->Body = $message;\n\n  if (!$mail->send()) {\n    echo 'Error sending email';\n  }\n}\n```", null, "```php\n<?php\nrequire_once 'functions.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  $email = $_POST['email'];\n  reset_password($email);\n}\n?>\n```"]}
