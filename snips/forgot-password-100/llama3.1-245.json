{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of a forgotten password function in PHP:\n\n**password_reset.php**\n```php\n<?php\n// Configuration variables\ndefine('DB_HOST', 'your_database_host');\ndefine('DB_USERNAME', 'your_database_username');\ndefine('DB_PASSWORD', 'your_database_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send password reset email\nfunction send_password_reset_email($email) {\n    // Generate a random token for the user's account\n    $token = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 32);\n\n    // Update the user's password in the database\n    $sql = \"UPDATE users SET password_token = '$token' WHERE email = '$email'\";\n    if ($conn->query($sql) === TRUE) {\n        // Send a reset email to the user with their token and instructions\n        $to = $email;\n        $subject = 'Reset Your Password';\n        $message = \"\n            Dear User,\n\n            You are receiving this email because we received a request from your account to reset your password. \n\n            To complete the process, please click on the following link: \n            <a href='http://your_website.com/reset_password.php?token=$token'>Reset Password</a>\n\n            If you did not initiate this request, you can ignore this email.\n\n            Best regards,\n            Your Website Team\";\n\n        // Send the email using your preferred method (e.g. PHPMailer, SwiftMailer)\n        mail($to, $subject, $message);\n    } else {\n        echo \"Error updating user password: \" . $conn->error;\n    }\n}\n\n// Handle form submission\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get the email from the form\n    $email = $_POST['email'];\n\n    // Check if the email exists in the database\n    $sql = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($sql);\n    if ($result->num_rows > 0) {\n        send_password_reset_email($email);\n    } else {\n        echo \"Email not found.\";\n    }\n}\n\n// Close the database connection\n$conn->close();\n?>\n```\n**reset_password.php**\n```php\n<?php\n// Configuration variables\ndefine('DB_HOST', 'your_database_host');\ndefine('DB_USERNAME', 'your_database_username');\ndefine('DB_PASSWORD', 'your_database_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get the token from the URL parameter\n$token = $_GET['token'];\n\n// Check if the token is valid and associated with an existing user account\n$sql = \"SELECT * FROM users WHERE password_token = '$token'\";\n$result = $conn->query($sql);\nif ($result->num_rows > 0) {\n    // Get the user's details from the database\n    $user = $result->fetch_assoc();\n\n    // Display a form for the user to enter their new password\n    ?>\n    <form action=\"\" method=\"post\">\n        <label for=\"password\">New Password:</label>\n        <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n        <label for=\"confirm_password\">Confirm New Password:</label>\n        <input type=\"password\" id=\"confirm_password\" name=\"confirm_password\"><br><br>\n        <input type=\"submit\" value=\"Reset Password\">\n    </form>\n\n    <?php\n} else {\n    echo \"Invalid token.\";\n}\n\n// Handle form submission\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get the new password from the form\n    $new_password = $_POST['password'];\n    $confirm_new_password = $_POST['confirm_password'];\n\n    // Check if the passwords match and update the user's account in the database\n    if ($new_password === $confirm_new_password) {\n        $sql = \"UPDATE users SET password = '$new_password', password_token = '' WHERE email = '$user[email]'\";\n        if ($conn->query($sql) === TRUE) {\n            echo \"Password updated successfully!\";\n        } else {\n            echo \"Error updating user password: \" . $conn->error;\n        }\n    } else {\n        echo \"Passwords do not match.\";\n    }\n}\n\n// Close the database connection\n$conn->close();\n?>\n```\n**index.php**\n```php\n<?php\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Forgot Password</title>\n</head>\n<body>\n\n<h1>Forgot Password?</h1>\n\n<form action=\"password_reset.php\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" value=\"Send Password Reset Link\">\n</form>\n\n</body>\n</html>\n```\n**Note:**\n\n* This example assumes you have a MySQL database set up with a `users` table containing columns for `email`, `password`, and `password_token`.\n* You should replace the placeholders (`your_database_host`, `your_database_username`, etc.) with your actual database credentials.\n* This is just an example, you should adjust it to fit your needs. Make sure to secure your database connection by using prepared statements instead of directly inserting user input into queries.\n\nThis code will send a password reset email to the user when they submit their email address on the index page. The email contains a link to the `reset_password.php` page with a token that is associated with the user's account. On the `reset_password.php` page, the user can enter their new password and confirm it by submitting the form. If the passwords match, the user's account will be updated in the database.", "code_blocks": ["```php\n<?php\n// Configuration variables\ndefine('DB_HOST', 'your_database_host');\ndefine('DB_USERNAME', 'your_database_username');\ndefine('DB_PASSWORD', 'your_database_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send password reset email\nfunction send_password_reset_email($email) {\n    // Generate a random token for the user's account\n    $token = substr(str_shuffle('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'), 0, 32);\n\n    // Update the user's password in the database\n    $sql = \"UPDATE users SET password_token = '$token' WHERE email = '$email'\";\n    if ($conn->query($sql) === TRUE) {\n        // Send a reset email to the user with their token and instructions\n        $to = $email;\n        $subject = 'Reset Your Password';\n        $message = \"\n            Dear User,\n\n            You are receiving this email because we received a request from your account to reset your password. \n\n            To complete the process, please click on the following link: \n            <a href='http://your_website.com/reset_password.php?token=$token'>Reset Password</a>\n\n            If you did not initiate this request, you can ignore this email.\n\n            Best regards,\n            Your Website Team\";\n\n        // Send the email using your preferred method (e.g. PHPMailer, SwiftMailer)\n        mail($to, $subject, $message);\n    } else {\n        echo \"Error updating user password: \" . $conn->error;\n    }\n}\n\n// Handle form submission\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get the email from the form\n    $email = $_POST['email'];\n\n    // Check if the email exists in the database\n    $sql = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($sql);\n    if ($result->num_rows > 0) {\n        send_password_reset_email($email);\n    } else {\n        echo \"Email not found.\";\n    }\n}\n\n// Close the database connection\n$conn->close();\n?>\n```", "```php\n<?php\n// Configuration variables\ndefine('DB_HOST', 'your_database_host');\ndefine('DB_USERNAME', 'your_database_username');\ndefine('DB_PASSWORD', 'your_database_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get the token from the URL parameter\n$token = $_GET['token'];\n\n// Check if the token is valid and associated with an existing user account\n$sql = \"SELECT * FROM users WHERE password_token = '$token'\";\n$result = $conn->query($sql);\nif ($result->num_rows > 0) {\n    // Get the user's details from the database\n    $user = $result->fetch_assoc();\n\n    // Display a form for the user to enter their new password\n    ?>\n    <form action=\"\" method=\"post\">\n        <label for=\"password\">New Password:</label>\n        <input type=\"password\" id=\"password\" name=\"password\"><br><br>\n        <label for=\"confirm_password\">Confirm New Password:</label>\n        <input type=\"password\" id=\"confirm_password\" name=\"confirm_password\"><br><br>\n        <input type=\"submit\" value=\"Reset Password\">\n    </form>\n\n    <?php\n} else {\n    echo \"Invalid token.\";\n}\n\n// Handle form submission\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get the new password from the form\n    $new_password = $_POST['password'];\n    $confirm_new_password = $_POST['confirm_password'];\n\n    // Check if the passwords match and update the user's account in the database\n    if ($new_password === $confirm_new_password) {\n        $sql = \"UPDATE users SET password = '$new_password', password_token = '' WHERE email = '$user[email]'\";\n        if ($conn->query($sql) === TRUE) {\n            echo \"Password updated successfully!\";\n        } else {\n            echo \"Error updating user password: \" . $conn->error;\n        }\n    } else {\n        echo \"Passwords do not match.\";\n    }\n}\n\n// Close the database connection\n$conn->close();\n?>\n```", "```php\n<?php\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Forgot Password</title>\n</head>\n<body>\n\n<h1>Forgot Password?</h1>\n\n<form action=\"password_reset.php\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" value=\"Send Password Reset Link\">\n</form>\n\n</body>\n</html>\n```"]}
