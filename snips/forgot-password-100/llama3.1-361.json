{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nHere is an example of how to create a forgot password function using PHP. This function will send an email to the user with a temporary password reset link.\n\n### Database Setup\n\nBefore creating the forgot password function, make sure your database has the following table structure:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL,\n  password_hash VARCHAR(255) NOT NULL\n);\n```\n\n### PHP Code\n\nCreate a new file called `forgot_password.php` and add the following code:\n\n```php\n<?php\n\n// Configuration variables\ndefine('EMAIL_SUBJECT', 'Forgot Password');\ndefine('EMAIL_TEMPLATE', '<p>Hello %s,</p><p>A password reset link is provided below.</p><p><a href=\"%s\">Reset Password</a></p>');\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'username';\n$db_password = 'password';\n$db_name = 'database';\n\n// Connect to the database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send email\nfunction send_email($email, $password_reset_link) {\n  // Email configuration settings\n  $smtp_host = 'smtp.gmail.com';\n  $smtp_username = 'your-email@gmail.com';\n  $smtp_password = 'your-password';\n\n  // Create a new PHPMailer instance\n  require_once 'phpmailer/class.phpmailer.php';\n  $mail = new PHPMailer();\n\n  // Set the SMTP server configuration\n  $mail->isSMTP();\n  $mail->Host = $smtp_host;\n  $mail->Port = 587;\n  $mail->SMTPAuth = true;\n  $mail->Username = $smtp_username;\n  $mail->Password = $smtp_password;\n\n  // Send email\n  $mail->setFrom($smtp_username, 'Your Name');\n  $mail->addAddress($email);\n  $mail->Subject = EMAIL_SUBJECT;\n  $mail->Body = sprintf(EMAIL_TEMPLATE, $email, $password_reset_link);\n\n  if (!$mail->send()) {\n    echo 'Error sending email: ' . $mail->ErrorInfo;\n  }\n}\n\n// Function to reset password\nfunction reset_password($id) {\n  // Generate a new password\n  $new_password = substr(md5(uniqid(mt_rand(), true)), 0, 8);\n\n  // Update the user's password in the database\n  $sql = \"UPDATE users SET password_hash = '$new_password' WHERE id = '$id'\";\n  $conn->query($sql);\n}\n\n// Forgot password function\nfunction forgot_password($username) {\n  // Query the database to retrieve the user's email and ID\n  $sql = \"SELECT email, id FROM users WHERE username = '$username'\";\n  $result = $conn->query($sql);\n\n  if ($result->num_rows > 0) {\n    // Retrieve the user's email and ID from the result set\n    $row = $result->fetch_assoc();\n    $email = $row['email'];\n    $id = $row['id'];\n\n    // Generate a password reset link\n    $password_reset_link = 'http://your-website.com/reset-password.php?id=' . $id;\n\n    // Send email with the password reset link\n    send_email($email, $password_reset_link);\n\n    echo 'A password reset link has been sent to your email.';\n  } else {\n    echo 'User not found.';\n  }\n}\n\n// Example usage:\nforgot_password('example-username');\n\n?>\n```\n\n### Explanation\n\nThis code provides a forgot password function called `forgot_password` that takes the username as an argument. It queries the database to retrieve the user's email and ID, generates a new password, and sends an email with a temporary password reset link.\n\nThe email is sent using PHPMailer, which is a popular email library for PHP. The email template is defined in the `EMAIL_TEMPLATE` constant at the top of the code.\n\nTo use this code, simply replace the placeholders (`your-email@gmail.com`, `your-password`, and `http://your-website.com/reset-password.php`) with your own email account credentials and website URL.\n\nNote that you should also create a new file called `reset-password.php` to handle the password reset process. This file will be linked to in the password reset email sent by this script.", "code_blocks": [null, "```php\n<?php\n\n// Configuration variables\ndefine('EMAIL_SUBJECT', 'Forgot Password');\ndefine('EMAIL_TEMPLATE', '<p>Hello %s,</p><p>A password reset link is provided below.</p><p><a href=\"%s\">Reset Password</a></p>');\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'username';\n$db_password = 'password';\n$db_name = 'database';\n\n// Connect to the database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send email\nfunction send_email($email, $password_reset_link) {\n  // Email configuration settings\n  $smtp_host = 'smtp.gmail.com';\n  $smtp_username = 'your-email@gmail.com';\n  $smtp_password = 'your-password';\n\n  // Create a new PHPMailer instance\n  require_once 'phpmailer/class.phpmailer.php';\n  $mail = new PHPMailer();\n\n  // Set the SMTP server configuration\n  $mail->isSMTP();\n  $mail->Host = $smtp_host;\n  $mail->Port = 587;\n  $mail->SMTPAuth = true;\n  $mail->Username = $smtp_username;\n  $mail->Password = $smtp_password;\n\n  // Send email\n  $mail->setFrom($smtp_username, 'Your Name');\n  $mail->addAddress($email);\n  $mail->Subject = EMAIL_SUBJECT;\n  $mail->Body = sprintf(EMAIL_TEMPLATE, $email, $password_reset_link);\n\n  if (!$mail->send()) {\n    echo 'Error sending email: ' . $mail->ErrorInfo;\n  }\n}\n\n// Function to reset password\nfunction reset_password($id) {\n  // Generate a new password\n  $new_password = substr(md5(uniqid(mt_rand(), true)), 0, 8);\n\n  // Update the user's password in the database\n  $sql = \"UPDATE users SET password_hash = '$new_password' WHERE id = '$id'\";\n  $conn->query($sql);\n}\n\n// Forgot password function\nfunction forgot_password($username) {\n  // Query the database to retrieve the user's email and ID\n  $sql = \"SELECT email, id FROM users WHERE username = '$username'\";\n  $result = $conn->query($sql);\n\n  if ($result->num_rows > 0) {\n    // Retrieve the user's email and ID from the result set\n    $row = $result->fetch_assoc();\n    $email = $row['email'];\n    $id = $row['id'];\n\n    // Generate a password reset link\n    $password_reset_link = 'http://your-website.com/reset-password.php?id=' . $id;\n\n    // Send email with the password reset link\n    send_email($email, $password_reset_link);\n\n    echo 'A password reset link has been sent to your email.';\n  } else {\n    echo 'User not found.';\n  }\n}\n\n// Example usage:\nforgot_password('example-username');\n\n?>\n```"]}
