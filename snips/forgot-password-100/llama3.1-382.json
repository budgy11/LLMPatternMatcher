{"prompt": "Create a forgot password function using php", "llm_output": "**Forgot Password Function in PHP**\n=====================================\n\nIn this example, we will create a simple \"forgot password\" function that allows users to reset their passwords by sending them an email with a temporary password.\n\n**Database Schema**\n-------------------\n\nFor this example, let's assume we have a database table named `users` with the following structure:\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255),\n  email VARCHAR(255),\n  password VARCHAR(255)\n);\n```\n\n**Forgot Password Function Code**\n--------------------------------\n\nCreate a new PHP file named `forgot_password.php` and add the following code:\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($mysqli->connect_errno) {\n  echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n  exit();\n}\n\n// Check if form has been submitted\nif (isset($_POST['submit'])) {\n  // Get email from form submission\n  $email = $_POST['email'];\n\n  // Query database for user with matching email\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = $mysqli->query($query);\n\n  if ($result->num_rows > 0) {\n    // Get user data from result\n    $user_data = $result->fetch_assoc();\n\n    // Generate temporary password\n    $temp_password = substr(md5(uniqid()), 0, 10);\n    echo \"Temporary password sent to email\";\n\n    // Update user password in database\n    $query = \"UPDATE users SET password = '$temp_password' WHERE id = '\" . $user_data['id'] . \"'\";\n    $mysqli->query($query);\n\n    // Send email with temporary password\n    $to = $email;\n    $subject = 'Temporary Password';\n    $body = \"Your temporary password is: $temp_password\";\n    mail($to, $subject, $body);\n  } else {\n    echo \"Email not found in database\";\n  }\n}\n\n// Close database connection\n$mysqli->close();\n\n?>\n```\n\n**HTML Form Code**\n-------------------\n\nCreate a new PHP file named `forgot_password_form.php` and add the following code:\n```php\n<?php include 'forgot_password.php'; ?>\n\n<h1>Forgot Password</h1>\n\n<form action=\"\" method=\"post\">\n  <label for=\"email\">Email:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n  <button type=\"submit\" name=\"submit\">Send Temporary Password</button>\n</form>\n```\n\n**How it Works**\n-----------------\n\n1. The user submits the form with their email address.\n2. The PHP script queries the database to find a matching email address.\n3. If the email is found, a temporary password is generated and sent to the user via email using the `mail()` function.\n4. The temporary password is also updated in the user's record in the database.\n\nNote: This example uses a simple MD5 hash to generate the temporary password. In a real-world application, you should use a more secure method such as bcrypt or Argon2.\n\nAlso note that this code does not include any error handling for the email sending process. You may want to add additional error checking and logging depending on your specific requirements.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($mysqli->connect_errno) {\n  echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n  exit();\n}\n\n// Check if form has been submitted\nif (isset($_POST['submit'])) {\n  // Get email from form submission\n  $email = $_POST['email'];\n\n  // Query database for user with matching email\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = $mysqli->query($query);\n\n  if ($result->num_rows > 0) {\n    // Get user data from result\n    $user_data = $result->fetch_assoc();\n\n    // Generate temporary password\n    $temp_password = substr(md5(uniqid()), 0, 10);\n    echo \"Temporary password sent to email\";\n\n    // Update user password in database\n    $query = \"UPDATE users SET password = '$temp_password' WHERE id = '\" . $user_data['id'] . \"'\";\n    $mysqli->query($query);\n\n    // Send email with temporary password\n    $to = $email;\n    $subject = 'Temporary Password';\n    $body = \"Your temporary password is: $temp_password\";\n    mail($to, $subject, $body);\n  } else {\n    echo \"Email not found in database\";\n  }\n}\n\n// Close database connection\n$mysqli->close();\n\n?>\n```", "```php\n<?php include 'forgot_password.php'; ?>\n\n<h1>Forgot Password</h1>\n\n<form action=\"\" method=\"post\">\n  <label for=\"email\">Email:</label>\n  <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n  <button type=\"submit\" name=\"submit\">Send Temporary Password</button>\n</form>\n```"]}
