{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how you can create a \"Forgot Password\" function in PHP:\n\n**Step 1: Database Setup**\n\nAssuming you have a MySQL database with a table named `users` that has the following columns:\n\n* `id`: primary key\n* `username`\n* `email`\n* `password` (hashed using a library like `phpass`)\n* `reset_token` (a random string generated for password reset)\n\n**Step 2: PHP Code**\n\nCreate a new file named `forgot_password.php` and add the following code:\n```php\n<?php\n\n// Configuration\n$db_host = 'your_host';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\nif (!$conn) {\n    die('Connection failed: ' . mysqli_error($conn));\n}\n\n// Function to generate reset token\nfunction generateResetToken() {\n    return substr(md5(uniqid(rand(), true)), 0, 32);\n}\n\n// Function to send password reset email\nfunction sendPasswordResetEmail($email, $reset_token) {\n    // Your email sending code here (e.g. using PHPMailer)\n    echo \"Email sent to $email with reset token: $reset_token\";\n}\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $email = $_POST['email'];\n\n    // Check if user exists\n    $query = \"SELECT * FROM users WHERE username = '$username' AND email = '$email'\";\n    $result = mysqli_query($conn, $query);\n\n    if (mysqli_num_rows($result) > 0) {\n        // User found, generate reset token and send email\n        $user = mysqli_fetch_assoc($result);\n        $reset_token = generateResetToken();\n        $updateQuery = \"UPDATE users SET reset_token = '$reset_token' WHERE id = '\" . $user['id'] . \"'\";\n        mysqli_query($conn, $updateQuery);\n\n        // Send password reset email\n        sendPasswordResetEmail($email, $reset_token);\n    } else {\n        echo \"User not found\";\n    }\n}\n\n?>\n```\n**Step 3: HTML Form**\n\nCreate a new file named `forgot_password.html` and add the following code:\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Forgot Password</title>\n</head>\n<body>\n    <form action=\"forgot_password.php\" method=\"post\">\n        <label for=\"username\">Username:</label>\n        <input type=\"text\" id=\"username\" name=\"username\"><br><br>\n        <label for=\"email\">Email:</label>\n        <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n        <input type=\"submit\" value=\"Submit\">\n    </form>\n</body>\n</html>\n```\n**How it works**\n\n1. The user submits the form with their username and email.\n2. The PHP script checks if a user exists in the database with matching username and email.\n3. If the user is found, a new reset token is generated using `generateResetToken()`.\n4. The script updates the user's record in the database with the new reset token.\n5. The script sends an email to the user with the reset token.\n\n**Security Notes**\n\n* Make sure to secure your PHP code by following best practices (e.g. validate user input, escape data).\n* Use a library like `phpass` to hash passwords securely.\n* Store sensitive data (e.g. password reset tokens) in a secure manner (e.g. encrypted).\n\nThis is just a basic example and you should adapt it to your specific needs and requirements.", "code_blocks": ["```php\n<?php\n\n// Configuration\n$db_host = 'your_host';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\nif (!$conn) {\n    die('Connection failed: ' . mysqli_error($conn));\n}\n\n// Function to generate reset token\nfunction generateResetToken() {\n    return substr(md5(uniqid(rand(), true)), 0, 32);\n}\n\n// Function to send password reset email\nfunction sendPasswordResetEmail($email, $reset_token) {\n    // Your email sending code here (e.g. using PHPMailer)\n    echo \"Email sent to $email with reset token: $reset_token\";\n}\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $username = $_POST['username'];\n    $email = $_POST['email'];\n\n    // Check if user exists\n    $query = \"SELECT * FROM users WHERE username = '$username' AND email = '$email'\";\n    $result = mysqli_query($conn, $query);\n\n    if (mysqli_num_rows($result) > 0) {\n        // User found, generate reset token and send email\n        $user = mysqli_fetch_assoc($result);\n        $reset_token = generateResetToken();\n        $updateQuery = \"UPDATE users SET reset_token = '$reset_token' WHERE id = '\" . $user['id'] . \"'\";\n        mysqli_query($conn, $updateQuery);\n\n        // Send password reset email\n        sendPasswordResetEmail($email, $reset_token);\n    } else {\n        echo \"User not found\";\n    }\n}\n\n?>\n```", null]}
