{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how you can create a forgot password function in PHP:\n\n**Database Schema:**\n\nFor this example, we will assume that your database schema has the following tables:\n\n* `users`: stores user information\n\t+ `id` (primary key)\n\t+ `email`\n\t+ `password_hash` (hashed password)\n\n**PHP Code:**\n\n```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'username';\n$db_password = 'password';\n$db_name = 'database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send forgot password email\nfunction forgot_password($email)\n{\n    global $conn;\n\n    // Check if user exists\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        $row = $result->fetch_assoc();\n\n        // Generate random password\n        $password = substr(md5(uniqid()), 0, 8);\n        echo \"Password: $password\\n\";\n\n        // Update user's password in database\n        $query = \"UPDATE users SET password_hash = SHA2('$password', 256) WHERE email = '$email'\";\n        $conn->query($query);\n\n        // Send forgot password email\n        send_email($email, 'Forgot Password', 'Your new password is: ' . $password);\n    } else {\n        echo \"User not found.\";\n    }\n}\n\n// Function to send email using PHPMailer\nfunction send_email($to_email, $subject, $body)\n{\n    // Configuration\n    $mail_host = 'smtp.example.com';\n    $mail_username = 'username';\n    $mail_password = 'password';\n\n    require_once 'PHPMailer.php';\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = $mail_host;\n    $mail->Port = 587;\n    $mail->SMTPAuth = true;\n    $mail->Username = $mail_username;\n    $mail->Password = $mail_password;\n\n    $mail->setFrom($mail_username, 'Your Name');\n    $mail->addAddress($to_email);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n\n    if (!$mail->send()) {\n        echo \"Mailer Error: \" . $mail->ErrorInfo;\n    }\n}\n\n// Handle forgot password form submission\nif (isset($_POST['forgot_password'])) {\n    $email = $_POST['email'];\n    forgot_password($email);\n}\n?>\n```\n\n**HTML Code:**\n\n```html\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"email\" id=\"email\" name=\"email\"><br><br>\n    <input type=\"submit\" value=\"Forgot Password\" name=\"forgot_password\">\n</form>\n```\n\n**How it works:**\n\n1. The user submits the forgot password form with their email address.\n2. The `forgot_password()` function checks if a user with the provided email exists in the database.\n3. If the user exists, the function generates a random password using MD5 and updates the user's password hash in the database.\n4. The function then sends an email to the user with their new password using PHPMailer.\n\n**Note:**\n\n* Make sure to replace the placeholders (`$db_host`, `$db_username`, `$db_password`, `$db_name`) with your actual database credentials.\n* This is a basic example and you should consider implementing additional security measures, such as:\n\t+ Password hashing (SHA2 in this example).\n\t+ Email validation using a service like Mailgun or SendGrid.\n\t+ CAPTCHA to prevent automated attempts.", "code_blocks": ["```php\n<?php\n\n// Configuration\n$db_host = 'localhost';\n$db_username = 'username';\n$db_password = 'password';\n$db_name = 'database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to send forgot password email\nfunction forgot_password($email)\n{\n    global $conn;\n\n    // Check if user exists\n    $query = \"SELECT * FROM users WHERE email = '$email'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        $row = $result->fetch_assoc();\n\n        // Generate random password\n        $password = substr(md5(uniqid()), 0, 8);\n        echo \"Password: $password\\n\";\n\n        // Update user's password in database\n        $query = \"UPDATE users SET password_hash = SHA2('$password', 256) WHERE email = '$email'\";\n        $conn->query($query);\n\n        // Send forgot password email\n        send_email($email, 'Forgot Password', 'Your new password is: ' . $password);\n    } else {\n        echo \"User not found.\";\n    }\n}\n\n// Function to send email using PHPMailer\nfunction send_email($to_email, $subject, $body)\n{\n    // Configuration\n    $mail_host = 'smtp.example.com';\n    $mail_username = 'username';\n    $mail_password = 'password';\n\n    require_once 'PHPMailer.php';\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = $mail_host;\n    $mail->Port = 587;\n    $mail->SMTPAuth = true;\n    $mail->Username = $mail_username;\n    $mail->Password = $mail_password;\n\n    $mail->setFrom($mail_username, 'Your Name');\n    $mail->addAddress($to_email);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n\n    if (!$mail->send()) {\n        echo \"Mailer Error: \" . $mail->ErrorInfo;\n    }\n}\n\n// Handle forgot password form submission\nif (isset($_POST['forgot_password'])) {\n    $email = $_POST['email'];\n    forgot_password($email);\n}\n?>\n```", null]}
