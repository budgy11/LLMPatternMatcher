{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can create a forgotten password function in PHP:\n\n**password_reset.php**\n```php\n<?php\n\n// Configuration\n$config = array(\n    'db_host' => 'localhost',\n    'db_username' => 'root',\n    'db_password' => '',\n    'db_name' => 'your_database'\n);\n\n// Connect to database\n$conn = new mysqli($config['db_host'], $config['db_username'], $config['db_password'], $config['db_name']);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get user input\n$usernameOrEmail = $_POST['usernameOrEmail'];\n$passwordResetCode = $_POST['passwordResetCode'];\n\n// Check if username or email is valid\n$query = \"SELECT * FROM users WHERE username = '$usernameOrEmail' OR email = '$usernameOrEmail'\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    // Get user's ID\n    while ($row = $result->fetch_assoc()) {\n        $userId = $row['id'];\n\n        // Generate a new password reset code\n        $passwordResetCodeGenerated = bin2hex(random_bytes(32));\n\n        // Update user's record with the new password reset code\n        $query = \"UPDATE users SET password_reset_code = '$passwordResetCodeGenerated' WHERE id = '$userId'\";\n        $conn->query($query);\n\n        // Send an email to the user with a link to reset their password\n        $to = $row['email'];\n        $subject = 'Forgot Password - Click here to reset';\n        $message = '<a href=\"' . $_SERVER['HTTP_HOST'] . '/reset-password.php?userId=' . $userId . '&passwordResetCode=' . urlencode($passwordResetCodeGenerated) . '\">Click here to reset your password</a>';\n        mail($to, $subject, $message);\n\n        echo \"Email sent successfully. Please check your email and click on the link provided.\";\n    }\n} else {\n    echo \"Invalid username or email\";\n}\n\n$conn->close();\n\n?>\n```\n\n**reset-password.php**\n```php\n<?php\n\n// Configuration\n$config = array(\n    'db_host' => 'localhost',\n    'db_username' => 'root',\n    'db_password' => '',\n    'db_name' => 'your_database'\n);\n\n// Connect to database\n$conn = new mysqli($config['db_host'], $config['db_username'], $config['db_password'], $config['db_name']);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get user input\n$userId = $_GET['userId'];\n$passwordResetCodeGenerated = $_GET['passwordResetCode'];\n\n// Check if the password reset code is valid\n$query = \"SELECT * FROM users WHERE id = '$userId' AND password_reset_code = '$passwordResetCodeGenerated'\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    // Get user's ID and email\n    while ($row = $result->fetch_assoc()) {\n        $email = $row['email'];\n\n        // Display a form to input the new password\n        echo '<form action=\"\" method=\"post\">';\n        echo '<label for=\"newPassword\">New Password:</label>';\n        echo '<input type=\"password\" id=\"newPassword\" name=\"newPassword\"><br><br>';\n        echo '<label for=\"confirmPassword\">Confirm Password:</label>';\n        echo '<input type=\"password\" id=\"confirmPassword\" name=\"confirmPassword\"><br><br>';\n        echo '<button type=\"submit\">Reset Password</button>';\n        echo '</form>';\n\n        if ($_SERVER['REQUEST_METHOD'] == 'POST') {\n            // Get the new password and confirm password\n            $newPassword = $_POST['newPassword'];\n            $confirmPassword = $_POST['confirmPassword'];\n\n            // Check if the passwords match\n            if ($newPassword === $confirmPassword) {\n                // Update user's record with the new password\n                $query = \"UPDATE users SET password = '$newPassword' WHERE id = '$userId'\";\n                $conn->query($query);\n\n                echo \"Password reset successfully.\";\n            } else {\n                echo \"Passwords do not match\";\n            }\n        }\n    }\n} else {\n    echo \"Invalid password reset code\";\n}\n\n$conn->close();\n\n?>\n```\n\nThis is a basic example and should be modified to suit your specific needs. You may also want to consider using a more secure way of storing passwords, such as bcrypt.\n\nNote: Make sure to replace `'your_database'` with the actual name of your database.\n\nAlso note that this code does not include any validation or sanitization for user input. In a production environment, you should always validate and sanitize user input to prevent SQL injection attacks.", "code_blocks": ["```php\n<?php\n\n// Configuration\n$config = array(\n    'db_host' => 'localhost',\n    'db_username' => 'root',\n    'db_password' => '',\n    'db_name' => 'your_database'\n);\n\n// Connect to database\n$conn = new mysqli($config['db_host'], $config['db_username'], $config['db_password'], $config['db_name']);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get user input\n$usernameOrEmail = $_POST['usernameOrEmail'];\n$passwordResetCode = $_POST['passwordResetCode'];\n\n// Check if username or email is valid\n$query = \"SELECT * FROM users WHERE username = '$usernameOrEmail' OR email = '$usernameOrEmail'\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    // Get user's ID\n    while ($row = $result->fetch_assoc()) {\n        $userId = $row['id'];\n\n        // Generate a new password reset code\n        $passwordResetCodeGenerated = bin2hex(random_bytes(32));\n\n        // Update user's record with the new password reset code\n        $query = \"UPDATE users SET password_reset_code = '$passwordResetCodeGenerated' WHERE id = '$userId'\";\n        $conn->query($query);\n\n        // Send an email to the user with a link to reset their password\n        $to = $row['email'];\n        $subject = 'Forgot Password - Click here to reset';\n        $message = '<a href=\"' . $_SERVER['HTTP_HOST'] . '/reset-password.php?userId=' . $userId . '&passwordResetCode=' . urlencode($passwordResetCodeGenerated) . '\">Click here to reset your password</a>';\n        mail($to, $subject, $message);\n\n        echo \"Email sent successfully. Please check your email and click on the link provided.\";\n    }\n} else {\n    echo \"Invalid username or email\";\n}\n\n$conn->close();\n\n?>\n```", "```php\n<?php\n\n// Configuration\n$config = array(\n    'db_host' => 'localhost',\n    'db_username' => 'root',\n    'db_password' => '',\n    'db_name' => 'your_database'\n);\n\n// Connect to database\n$conn = new mysqli($config['db_host'], $config['db_username'], $config['db_password'], $config['db_name']);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get user input\n$userId = $_GET['userId'];\n$passwordResetCodeGenerated = $_GET['passwordResetCode'];\n\n// Check if the password reset code is valid\n$query = \"SELECT * FROM users WHERE id = '$userId' AND password_reset_code = '$passwordResetCodeGenerated'\";\n$result = $conn->query($query);\n\nif ($result->num_rows > 0) {\n    // Get user's ID and email\n    while ($row = $result->fetch_assoc()) {\n        $email = $row['email'];\n\n        // Display a form to input the new password\n        echo '<form action=\"\" method=\"post\">';\n        echo '<label for=\"newPassword\">New Password:</label>';\n        echo '<input type=\"password\" id=\"newPassword\" name=\"newPassword\"><br><br>';\n        echo '<label for=\"confirmPassword\">Confirm Password:</label>';\n        echo '<input type=\"password\" id=\"confirmPassword\" name=\"confirmPassword\"><br><br>';\n        echo '<button type=\"submit\">Reset Password</button>';\n        echo '</form>';\n\n        if ($_SERVER['REQUEST_METHOD'] == 'POST') {\n            // Get the new password and confirm password\n            $newPassword = $_POST['newPassword'];\n            $confirmPassword = $_POST['confirmPassword'];\n\n            // Check if the passwords match\n            if ($newPassword === $confirmPassword) {\n                // Update user's record with the new password\n                $query = \"UPDATE users SET password = '$newPassword' WHERE id = '$userId'\";\n                $conn->query($query);\n\n                echo \"Password reset successfully.\";\n            } else {\n                echo \"Passwords do not match\";\n            }\n        }\n    }\n} else {\n    echo \"Invalid password reset code\";\n}\n\n$conn->close();\n\n?>\n```"]}
