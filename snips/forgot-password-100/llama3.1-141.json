{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how to create a \"Forgot Password\" function in PHP, MySQL:\n\n**Database Schema:**\n\n```sql\nCREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL,\n  password_hash VARCHAR(255) NOT NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n\n**PHP Code ( forgot_password.php ) :**\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n    exit();\n}\n\n// Get the user's email from the input\n$email = $_POST['email'];\n\n// Check if the email exists in the database\n$query = \"SELECT * FROM users WHERE email = '$email'\";\n$result = $mysqli->query($query);\n\nif ($result->num_rows > 0) {\n    // Email found, generate a new password and send it to the user via email\n    $user = $result->fetch_assoc();\n    \n    // Generate a random new password\n    $new_password = rand_str(8);\n    \n    // Update the user's password in the database\n    $query = \"UPDATE users SET password_hash = '$new_password' WHERE id = '\" . $user['id'] . \"'\";\n    $mysqli->query($query);\n    \n    // Send an email to the user with the new password\n    send_email($email, 'New Password', 'Your new password is: ' . $new_password);\n} else {\n    echo \"Email not found.\";\n}\n\n// Close database connection\n$mysqli->close();\n\nfunction rand_str($length) {\n    $characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    return substr(str_shuffle($characters), 0, $length);\n}\n\nfunction send_email($to_email, $subject, $message) {\n    // Configuration for email sending (e.g. using PHPMailer)\n    $mail = new PHPMailer();\n    $mail->IsSMTP();7111\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->SMTPSecure = 'tls';\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@example.com';\n    $mail->Password = 'your_password';\n    \n    $mail->SetFrom('your_email@example.com', 'Your Name');\n    $mail->AddAddress($to_email);\n    $mail->Subject = $subject;\n    $mail->Body = $message;\n    \n    if (!$mail->Send()) {\n        echo \"Mailer Error: \" . $mail->ErrorInfo;\n    }\n}\n\n?>\n```\n\n**HTML Form ( forgot_password.html ) :**\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Forgot Password</title>\n</head>\n<body>\n\n<h1>Forgot Password?</h1>\n\n<form action=\"forgot_password.php\" method=\"post\">\n    <label for=\"email\">Email:</label>\n    <input type=\"text\" id=\"email\" name=\"email\"><br><br>\n    <button type=\"submit\">Send New Password</button>\n</form>\n\n</body>\n</html>\n```\n\n**Note:**\n\n* Replace `your_username`, `your_password`, and `your_database_name` with your actual database credentials.\n* This is a basic example, you may want to add more features such as email verification or password reset link instead of sending the new password directly in the email.\n* The `send_email()` function assumes that you have PHPMailer installed and configured correctly on your server.\n\nRemember that storing plain text passwords is not secure. You should use a library like Bcrypt or PBKDF2 to store hashed versions of passwords securely.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n    exit();\n}\n\n// Get the user's email from the input\n$email = $_POST['email'];\n\n// Check if the email exists in the database\n$query = \"SELECT * FROM users WHERE email = '$email'\";\n$result = $mysqli->query($query);\n\nif ($result->num_rows > 0) {\n    // Email found, generate a new password and send it to the user via email\n    $user = $result->fetch_assoc();\n    \n    // Generate a random new password\n    $new_password = rand_str(8);\n    \n    // Update the user's password in the database\n    $query = \"UPDATE users SET password_hash = '$new_password' WHERE id = '\" . $user['id'] . \"'\";\n    $mysqli->query($query);\n    \n    // Send an email to the user with the new password\n    send_email($email, 'New Password', 'Your new password is: ' . $new_password);\n} else {\n    echo \"Email not found.\";\n}\n\n// Close database connection\n$mysqli->close();\n\nfunction rand_str($length) {\n    $characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    return substr(str_shuffle($characters), 0, $length);\n}\n\nfunction send_email($to_email, $subject, $message) {\n    // Configuration for email sending (e.g. using PHPMailer)\n    $mail = new PHPMailer();\n    $mail->IsSMTP();7111\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->SMTPSecure = 'tls';\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@example.com';\n    $mail->Password = 'your_password';\n    \n    $mail->SetFrom('your_email@example.com', 'Your Name');\n    $mail->AddAddress($to_email);\n    $mail->Subject = $subject;\n    $mail->Body = $message;\n    \n    if (!$mail->Send()) {\n        echo \"Mailer Error: \" . $mail->ErrorInfo;\n    }\n}\n\n?>\n```", null]}
