{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can create a \"Forgot Password\" function in PHP:\n\n**Database Schema:**\n\nLet's assume we have the following database schema for our users table:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  email VARCHAR(255) UNIQUE NOT NULL,\n  password VARCHAR(255) NOT NULL,\n  username VARCHAR(50)\n);\n```\n**Forgot Password Function:**\n\nCreate a new PHP file, e.g., `forgot_password.php`, and add the following code:\n```php\n<?php\n\n// Configuration settings\ndefine('SITE_URL', 'http://example.com');\ndefine('ADMIN_EMAIL', 'admin@example.com');\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Process forgot password request\nif (isset($_POST['forgot_password'])) {\n  $email = $_POST['email'];\n  \n  // Check if email exists in database\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = $conn->query($query);\n\n  if ($result->num_rows > 0) {\n    // Generate reset token and store it in user's record\n    $token = bin2hex(random_bytes(32));\n    $update_query = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n    $conn->query($update_query);\n\n    // Send email with reset link\n    sendEmail($email, $token);\n  } else {\n    echo \"Email not found\";\n  }\n}\n\n// Function to send email with reset link\nfunction sendEmail($email, $token) {\n  $headers = 'From: Admin <' . ADMIN_EMAIL . '>' . \"\\r\\n\";\n  $subject = 'Reset Your Password';\n  $body = '\n    Dear user,\n\n    Click on the following link to reset your password:\n\n    ' . SITE_URL . '/reset-password.php?email=' . $email . '&token=' . $token . '\n\n    Best regards,\n    Admin\n  ';\n\n  mail($email, $subject, $body, $headers);\n}\n\n?>\n```\n**Reset Password Function:**\n\nCreate a new PHP file, e.g., `reset_password.php`, and add the following code:\n```php\n<?php\n\n// Configuration settings\ndefine('SITE_URL', 'http://example.com');\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Process reset password request\nif (isset($_GET['email']) && isset($_GET['token'])) {\n  $email = $_GET['email'];\n  $token = $_GET['token'];\n\n  // Check if token is valid and user exists in database\n  $query = \"SELECT * FROM users WHERE email = '$email' AND password_reset_token = '$token'\";\n  $result = $conn->query($query);\n\n  if ($result->num_rows > 0) {\n    // Generate new password and store it in user's record\n    $new_password = bin2hex(random_bytes(32));\n    $update_query = \"UPDATE users SET password = '$new_password' WHERE email = '$email'\";\n    $conn->query($update_query);\n\n    echo 'Your password has been reset. Please log in with your new password.';\n  } else {\n    echo 'Invalid token or user not found';\n  }\n}\n\n?>\n```\n**HTML Form:**\n\nCreate an HTML form for the \"Forgot Password\" page:\n```html\n<form action=\"forgot_password.php\" method=\"post\">\n  <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\">\n  <button type=\"submit\" name=\"forgot_password\">Send Reset Link</button>\n</form>\n```\n**Example Use Case:**\n\n1. User visits the \"Forgot Password\" page and enters their email address in the form.\n2. The form is submitted to the `forgot_password.php` script, which checks if the email exists in the database.\n3. If the email exists, a reset token is generated and stored in the user's record.\n4. An email with a reset link is sent to the user's email address using the `sendEmail()` function.\n5. The user clicks on the reset link, which directs them to the `reset_password.php` script.\n6. If the token is valid and the user exists in the database, a new password is generated and stored in the user's record.\n7. The user can log in with their new password.\n\nNote: This is just an example code, and you should modify it according to your specific requirements and security standards. Additionally, make sure to hash and store passwords securely using a library like `password_hash()` and `password_verify()`.", "code_blocks": [null, "```php\n<?php\n\n// Configuration settings\ndefine('SITE_URL', 'http://example.com');\ndefine('ADMIN_EMAIL', 'admin@example.com');\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Process forgot password request\nif (isset($_POST['forgot_password'])) {\n  $email = $_POST['email'];\n  \n  // Check if email exists in database\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = $conn->query($query);\n\n  if ($result->num_rows > 0) {\n    // Generate reset token and store it in user's record\n    $token = bin2hex(random_bytes(32));\n    $update_query = \"UPDATE users SET password_reset_token = '$token' WHERE email = '$email'\";\n    $conn->query($update_query);\n\n    // Send email with reset link\n    sendEmail($email, $token);\n  } else {\n    echo \"Email not found\";\n  }\n}\n\n// Function to send email with reset link\nfunction sendEmail($email, $token) {\n  $headers = 'From: Admin <' . ADMIN_EMAIL . '>' . \"\\r\\n\";\n  $subject = 'Reset Your Password';\n  $body = '\n    Dear user,\n\n    Click on the following link to reset your password:\n\n    ' . SITE_URL . '/reset-password.php?email=' . $email . '&token=' . $token . '\n\n    Best regards,\n    Admin\n  ';\n\n  mail($email, $subject, $body, $headers);\n}\n\n?>\n```", "```php\n<?php\n\n// Configuration settings\ndefine('SITE_URL', 'http://example.com');\n\n// Database connection settings\n$db_host = 'localhost';\n$db_username = 'your_username';\n$db_password = 'your_password';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = new mysqli($db_host, $db_username, $db_password, $db_name);\n\nif ($conn->connect_error) {\n  die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Process reset password request\nif (isset($_GET['email']) && isset($_GET['token'])) {\n  $email = $_GET['email'];\n  $token = $_GET['token'];\n\n  // Check if token is valid and user exists in database\n  $query = \"SELECT * FROM users WHERE email = '$email' AND password_reset_token = '$token'\";\n  $result = $conn->query($query);\n\n  if ($result->num_rows > 0) {\n    // Generate new password and store it in user's record\n    $new_password = bin2hex(random_bytes(32));\n    $update_query = \"UPDATE users SET password = '$new_password' WHERE email = '$email'\";\n    $conn->query($update_query);\n\n    echo 'Your password has been reset. Please log in with your new password.';\n  } else {\n    echo 'Invalid token or user not found';\n  }\n}\n\n?>\n```", null]}
