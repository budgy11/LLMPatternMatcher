{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how you can create a \"Forgot Password\" function using PHP:\n\n**Database Setup**\n\nFor this example, I'll assume that we have a table called `users` with the following columns:\n\n| Column Name | Data Type |\n| --- | --- |\n| id | int (primary key) |\n| email | varchar(255) |\n| password | varchar(255) |\n\nWe will use the PHPMailer library to send emails.\n\n**Database Connection**\n\nCreate a new file called `db.php` and add the following code:\n\n```php\n<?php\n$servername = \"localhost\";\n$username = \"your_username\";\n$password = \"your_password\";\n$dbname = \"your_database\";\n\n$conn = mysqli_connect($servername, $username, $password, $dbname);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n?>\n```\n\n**Forgot Password Function**\n\nCreate a new file called `forgot-password.php` and add the following code:\n\n```php\n<?php\n\n// Include database connection file\nrequire_once 'db.php';\n\n// Check if form has been submitted\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get email from form\n    $email = $_POST['email'];\n\n    // SQL query to retrieve user's data\n    $sql = \"SELECT * FROM users WHERE email='$email'\";\n    $result = mysqli_query($conn, $sql);\n\n    if (mysqli_num_rows($result) > 0) {\n        // Retrieve user's id and password\n        while ($row = mysqli_fetch_assoc($result)) {\n            $userId = $row['id'];\n            $password = $row['password'];\n\n            // Generate new password\n            $newPassword = generateRandomString(8);\n\n            // Update user's password in database\n            $updateSql = \"UPDATE users SET password='$newPassword' WHERE id='$userId'\";\n            mysqli_query($conn, $updateSql);\n\n            // Send email with new password\n            sendEmail($email, $newPassword);\n        }\n    } else {\n        echo 'No account found with that email';\n    }\n\n    // Close database connection\n    mysqli_close($conn);\n}\n\n// Function to generate random string\nfunction generateRandomString($length) {\n    $characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    $randomString = '';\n    for ($i = 0; $i < $length; $i++) {\n        $randomString .= $characters[rand(0, strlen($characters) - 1)];\n    }\n    return $randomString;\n}\n\n// Function to send email\nfunction sendEmail($email, $newPassword) {\n    require_once 'phpmailer/PHPMailer.php';\n    require_once 'phpmailer/SMTP.php';\n\n    $mail = new PHPMailer\\PHPMailer\\PHPMailer(true);\n    try {\n        // Set up SMTP server\n        $mail->isSMTP();\n        $mail->Host       = 'smtp.gmail.com';\n        $mail->SMTPAuth   = true;\n        $mail->Username   = 'your_email@gmail.com';  // Use your own email address here\n        $mail->Password   = 'your_password';  // Use your own password here\n        $mail->Port       = 587;\n\n        // Set up mail sender and recipient details\n        $mail->setFrom('your_email@gmail.com', 'Your Name');\n        $mail->addAddress($email);\n\n        // Set email content\n        $mail->isHTML(true);\n        $mail->Subject = 'New Password';\n        $mail->Body    = '<p>Hello, your new password is: ' . $newPassword . '</p>';\n\n        // Send email\n        $mail->send();\n    } catch (Exception $e) {\n        echo 'Message could not be sent. Mailer Error: ', $mail->ErrorInfo;\n    }\n}\n?>\n```\n\n**HTML Form**\n\nCreate a new file called `forgot-password.html` and add the following code:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Forgot Password</title>\n</head>\n<body>\n\n<h2>Forgot Password</h2>\n\n<form method=\"post\">\n    <label for=\"email\">Email:</label><br>\n    <input type=\"text\" id=\"email\" name=\"email\"><br>\n    <input type=\"submit\" value=\"Submit\">\n</form>\n\n<?php\nif (isset($_GET['success'])) {\n    echo '<p>Password reset successful!</p>';\n}\n?>\n\n</body>\n</html>\n```\n\n**Usage**\n\n1. Go to `forgot-password.php` and fill out the form with your email address.\n2. Submit the form.\n3. If an account is found, a new password will be generated and sent to your email address.\n\nNote: This code uses Gmail's SMTP server to send emails. You'll need to replace `'your_email@gmail.com'` and `'your_password'` with your actual Gmail email address and password.\n\nRemember that this is just a basic example, and you should always use secure practices when handling passwords. Consider using a more robust library like PHPass for password hashing.", "code_blocks": ["```php\n<?php\n$servername = \"localhost\";\n$username = \"your_username\";\n$password = \"your_password\";\n$dbname = \"your_database\";\n\n$conn = mysqli_connect($servername, $username, $password, $dbname);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n?>\n```", "```php\n<?php\n\n// Include database connection file\nrequire_once 'db.php';\n\n// Check if form has been submitted\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Get email from form\n    $email = $_POST['email'];\n\n    // SQL query to retrieve user's data\n    $sql = \"SELECT * FROM users WHERE email='$email'\";\n    $result = mysqli_query($conn, $sql);\n\n    if (mysqli_num_rows($result) > 0) {\n        // Retrieve user's id and password\n        while ($row = mysqli_fetch_assoc($result)) {\n            $userId = $row['id'];\n            $password = $row['password'];\n\n            // Generate new password\n            $newPassword = generateRandomString(8);\n\n            // Update user's password in database\n            $updateSql = \"UPDATE users SET password='$newPassword' WHERE id='$userId'\";\n            mysqli_query($conn, $updateSql);\n\n            // Send email with new password\n            sendEmail($email, $newPassword);\n        }\n    } else {\n        echo 'No account found with that email';\n    }\n\n    // Close database connection\n    mysqli_close($conn);\n}\n\n// Function to generate random string\nfunction generateRandomString($length) {\n    $characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    $randomString = '';\n    for ($i = 0; $i < $length; $i++) {\n        $randomString .= $characters[rand(0, strlen($characters) - 1)];\n    }\n    return $randomString;\n}\n\n// Function to send email\nfunction sendEmail($email, $newPassword) {\n    require_once 'phpmailer/PHPMailer.php';\n    require_once 'phpmailer/SMTP.php';\n\n    $mail = new PHPMailer\\PHPMailer\\PHPMailer(true);\n    try {\n        // Set up SMTP server\n        $mail->isSMTP();\n        $mail->Host       = 'smtp.gmail.com';\n        $mail->SMTPAuth   = true;\n        $mail->Username   = 'your_email@gmail.com';  // Use your own email address here\n        $mail->Password   = 'your_password';  // Use your own password here\n        $mail->Port       = 587;\n\n        // Set up mail sender and recipient details\n        $mail->setFrom('your_email@gmail.com', 'Your Name');\n        $mail->addAddress($email);\n\n        // Set email content\n        $mail->isHTML(true);\n        $mail->Subject = 'New Password';\n        $mail->Body    = '<p>Hello, your new password is: ' . $newPassword . '</p>';\n\n        // Send email\n        $mail->send();\n    } catch (Exception $e) {\n        echo 'Message could not be sent. Mailer Error: ', $mail->ErrorInfo;\n    }\n}\n?>\n```", null]}
