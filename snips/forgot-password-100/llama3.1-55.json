{"prompt": "Create a forgot password function using php", "llm_output": "Here's an example of how to create a forgot password function in PHP:\n\n**Database Structure**\n\nAssuming you're using MySQL, your database should have the following structure:\n\n```sql\nCREATE TABLE users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    username VARCHAR(255) NOT NULL,\n    email VARCHAR(255) NOT NULL,\n    password_hash VARCHAR(255) NOT NULL\n);\n```\n\n**Forgot Password Function**\n\nCreate a PHP file named `forgot_password.php` and add the following code:\n\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USER', 'your_user');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get user input\n$username = $_POST['username'];\n$email = $_POST['email'];\n\n// Check if username and email exist in database\n$stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ? AND email = ?\");\n$stmt->bind_param('ss', $username, $email);\n$stmt->execute();\n$result = $stmt->get_result();\n\nif ($result->num_rows > 0) {\n    // User exists, generate new password and send reset link\n    $row = $result->fetch_assoc();\n    \n    // Generate new password\n    $new_password = substr(md5(uniqid(mt_rand(), true)), 0, 10);\n    \n    // Update user password in database\n    $update_stmt = $conn->prepare(\"UPDATE users SET password_hash = ? WHERE id = ?\");\n    $update_stmt->bind_param('si', md5($new_password), $row['id']);\n    $update_stmt->execute();\n    \n    // Send reset link via email (this example uses PHPMailer)\n    require_once 'PHPMailerAutoload.php';\n    $mail = new PHPMailer;\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@example.com';\n    $mail->Password = 'your_password';\n    $mail->setFrom('your_email@example.com', 'Your Name');\n    $mail->addAddress($email);\n    $mail->Subject = 'Reset Password';\n    $mail->Body = 'Click here to reset your password: <a href=\"https://example.com/reset-password.php?username=' . urlencode($username) . '&token=' . md5($new_password) . '\">Reset Password</a>';\n    \n    if (!$mail->send()) {\n        echo 'Message could not be sent.';\n        echo 'Mailer Error: ' . $mail->ErrorInfo;\n    } else {\n        echo 'Email sent successfully!';\n    }\n} else {\n    echo 'Username or email does not exist in our database.';\n}\n\n// Close connection\n$conn->close();\n\n?>\n```\n\n**Reset Password Function**\n\nCreate a PHP file named `reset-password.php` and add the following code:\n\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USER', 'your_user');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get user input\n$username = $_GET['username'];\n$token = $_GET['token'];\n\n// Check if username and token exist in database\n$stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ? AND password_hash = ?\");\n$stmt->bind_param('ss', $username, md5($token));\n$stmt->execute();\n$result = $stmt->get_result();\n\nif ($result->num_rows > 0) {\n    // User exists, update new password\n    $row = $result->fetch_assoc();\n    \n    // Update user password in database\n    $update_stmt = $conn->prepare(\"UPDATE users SET password_hash = ? WHERE id = ?\");\n    $update_stmt->bind_param('si', md5($_POST['new_password']), $row['id']);\n    $update_stmt->execute();\n    \n    echo 'Password updated successfully!';\n} else {\n    echo 'Username or token does not exist in our database.';\n}\n\n// Close connection\n$conn->close();\n\n?>\n```\n\n**Notes**\n\n1. This is a basic example and you should add more security measures such as password hashing and salting, as well as validation for user input.\n2. You'll need to install PHPMailer library by running `composer require phpmailer/phpmailer` in your project directory.\n3. Make sure to replace placeholders with your actual database credentials and email settings.\n\nThis is a basic implementation of the forgot password function using PHP. It generates a new random password, updates it in the database, and sends a reset link via email. The user can then use this link to update their password on the website.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USER', 'your_user');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get user input\n$username = $_POST['username'];\n$email = $_POST['email'];\n\n// Check if username and email exist in database\n$stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ? AND email = ?\");\n$stmt->bind_param('ss', $username, $email);\n$stmt->execute();\n$result = $stmt->get_result();\n\nif ($result->num_rows > 0) {\n    // User exists, generate new password and send reset link\n    $row = $result->fetch_assoc();\n    \n    // Generate new password\n    $new_password = substr(md5(uniqid(mt_rand(), true)), 0, 10);\n    \n    // Update user password in database\n    $update_stmt = $conn->prepare(\"UPDATE users SET password_hash = ? WHERE id = ?\");\n    $update_stmt->bind_param('si', md5($new_password), $row['id']);\n    $update_stmt->execute();\n    \n    // Send reset link via email (this example uses PHPMailer)\n    require_once 'PHPMailerAutoload.php';\n    $mail = new PHPMailer;\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@example.com';\n    $mail->Password = 'your_password';\n    $mail->setFrom('your_email@example.com', 'Your Name');\n    $mail->addAddress($email);\n    $mail->Subject = 'Reset Password';\n    $mail->Body = 'Click here to reset your password: <a href=\"https://example.com/reset-password.php?username=' . urlencode($username) . '&token=' . md5($new_password) . '\">Reset Password</a>';\n    \n    if (!$mail->send()) {\n        echo 'Message could not be sent.';\n        echo 'Mailer Error: ' . $mail->ErrorInfo;\n    } else {\n        echo 'Email sent successfully!';\n    }\n} else {\n    echo 'Username or email does not exist in our database.';\n}\n\n// Close connection\n$conn->close();\n\n?>\n```", "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USER', 'your_user');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Get user input\n$username = $_GET['username'];\n$token = $_GET['token'];\n\n// Check if username and token exist in database\n$stmt = $conn->prepare(\"SELECT * FROM users WHERE username = ? AND password_hash = ?\");\n$stmt->bind_param('ss', $username, md5($token));\n$stmt->execute();\n$result = $stmt->get_result();\n\nif ($result->num_rows > 0) {\n    // User exists, update new password\n    $row = $result->fetch_assoc();\n    \n    // Update user password in database\n    $update_stmt = $conn->prepare(\"UPDATE users SET password_hash = ? WHERE id = ?\");\n    $update_stmt->bind_param('si', md5($_POST['new_password']), $row['id']);\n    $update_stmt->execute();\n    \n    echo 'Password updated successfully!';\n} else {\n    echo 'Username or token does not exist in our database.';\n}\n\n// Close connection\n$conn->close();\n\n?>\n```"]}
