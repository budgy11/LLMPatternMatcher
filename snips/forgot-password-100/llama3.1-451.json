{"prompt": "Create a forgot password function using php", "llm_output": "Here is an example of how to create a \"Forgot Password\" function in PHP:\n\n**Database Schema:**\n\nLet's assume we have the following database schema for our user table:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255),\n  email VARCHAR(255),\n  password_hash VARCHAR(255)\n);\n```\n**PHP Code:**\n\nWe'll use PHP to create a script that will handle the forgot password functionality.\n\nCreate a new file called `forgot_password.php` and add the following code:\n```php\n<?php\n\n// Configuration settings\n$db_host = 'localhost';\n$db_username = 'root';\n$db_password = '';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_error($conn));\n}\n\nfunction forgotPassword() {\n  // Get email from user input\n  $email = $_POST['email'];\n\n  // Check if email exists in database\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    // Get user data from database\n    $user_data = mysqli_fetch_assoc($result);\n\n    // Generate new password and send it to the user's email\n    $new_password = substr(md5(uniqid(rand(), true)), 0, 10);\n    $mail_body = \"Your new password is: $new_password\";\n\n    // Send mail using PHPMailer (you'll need to install this library)\n    require_once 'PHPMailer/PHPMailer.php';\n    require_once 'PHPMailer/SMTP.php';\n\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com'; // Your SMTP host\n    $mail->Port = 587; // Your SMTP port\n    $mail->SMTPSecure = 'tls';\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@example.com'; // Your email address\n    $mail->Password = 'your_password'; // Your email password\n\n    $mail->setFrom('your_email@example.com', 'Your Name');\n    $mail->addAddress($email);\n    $mail->Subject = 'Forgot Password';\n    $mail->Body = $mail_body;\n\n    if (!$mail->send()) {\n      echo \"Mailer Error: \" . $mail->ErrorInfo;\n    } else {\n      // Update user's password in database\n      $update_query = \"UPDATE users SET password_hash = '\" . md5($new_password) . \"' WHERE email = '$email'\";\n      mysqli_query($conn, $update_query);\n\n      echo \"Password reset successfully sent to your email.\";\n    }\n  } else {\n    echo \"Email not found. Please try again.\";\n  }\n\n  // Close database connection\n  mysqli_close($conn);\n}\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  forgotPassword();\n} else {\n  // Display form if user has not submitted it yet\n  ?>\n  <h2>Forgot Password</h2>\n  <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\">\n    <button type=\"submit\">Send Reset Link</button>\n  </form>\n  <?php\n}\n\n?>\n```\n**How it works:**\n\n1. The user submits their email address through the form on the page.\n2. The script checks if the email exists in the database.\n3. If the email exists, the script generates a new password using `md5` and sends an email to the user with the new password.\n4. The script updates the user's password hash in the database with the new password.\n5. If the email does not exist, it displays an error message.\n\n**Note:**\n\n* This is just a basic example of how you can implement forgot password functionality using PHP. You should consider adding more security measures such as CSRF protection and validating user input to prevent attacks.\n* Make sure to replace `your_database`, `your_email@example.com`, and other placeholders with your actual database credentials and email settings.\n\nPlease keep in mind that this is a basic example, you might want to add additional functionality such as sending password reset links via email instead of the new password itself. Also make sure to handle errors properly and don't forget to close the database connection at the end of the script.", "code_blocks": [null, "```php\n<?php\n\n// Configuration settings\n$db_host = 'localhost';\n$db_username = 'root';\n$db_password = '';\n$db_name = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($db_host, $db_username, $db_password, $db_name);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_error($conn));\n}\n\nfunction forgotPassword() {\n  // Get email from user input\n  $email = $_POST['email'];\n\n  // Check if email exists in database\n  $query = \"SELECT * FROM users WHERE email = '$email'\";\n  $result = mysqli_query($conn, $query);\n\n  if (mysqli_num_rows($result) > 0) {\n    // Get user data from database\n    $user_data = mysqli_fetch_assoc($result);\n\n    // Generate new password and send it to the user's email\n    $new_password = substr(md5(uniqid(rand(), true)), 0, 10);\n    $mail_body = \"Your new password is: $new_password\";\n\n    // Send mail using PHPMailer (you'll need to install this library)\n    require_once 'PHPMailer/PHPMailer.php';\n    require_once 'PHPMailer/SMTP.php';\n\n    $mail = new PHPMailer();\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com'; // Your SMTP host\n    $mail->Port = 587; // Your SMTP port\n    $mail->SMTPSecure = 'tls';\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your_email@example.com'; // Your email address\n    $mail->Password = 'your_password'; // Your email password\n\n    $mail->setFrom('your_email@example.com', 'Your Name');\n    $mail->addAddress($email);\n    $mail->Subject = 'Forgot Password';\n    $mail->Body = $mail_body;\n\n    if (!$mail->send()) {\n      echo \"Mailer Error: \" . $mail->ErrorInfo;\n    } else {\n      // Update user's password in database\n      $update_query = \"UPDATE users SET password_hash = '\" . md5($new_password) . \"' WHERE email = '$email'\";\n      mysqli_query($conn, $update_query);\n\n      echo \"Password reset successfully sent to your email.\";\n    }\n  } else {\n    echo \"Email not found. Please try again.\";\n  }\n\n  // Close database connection\n  mysqli_close($conn);\n}\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n  forgotPassword();\n} else {\n  // Display form if user has not submitted it yet\n  ?>\n  <h2>Forgot Password</h2>\n  <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n    <input type=\"email\" name=\"email\" placeholder=\"Enter your email address\">\n    <button type=\"submit\">Send Reset Link</button>\n  </form>\n  <?php\n}\n\n?>\n```"]}
