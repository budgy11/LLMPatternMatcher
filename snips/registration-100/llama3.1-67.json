{"prompt": "Create a user registration function using php", "llm_output": "**User Registration Function in PHP**\n=====================================\n\nBelow is an example of a simple user registration function written in PHP. This example includes input validation, password hashing, and email verification.\n\n### **`register.php`**\n\n```php\n<?php\n\n// Configuration\nrequire_once 'config.php';\n\n// Validation Error Messages\n$validationErrors = array();\n\nfunction registerUser($firstName, $lastName, $email, $password) {\n    // Input Validation\n    if (empty($firstName)) {\n        $validationErrors[] = \"First name is required.\";\n    }\n    if (empty($lastName)) {\n        $validationErrors[] = \"Last name is required.\";\n    }\n    if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n        $validationErrors[] = \"Invalid email address.\";\n    }\n    if (strlen($password) < 8) {\n        $validationErrors[] = \"Password must be at least 8 characters long.\";\n    }\n\n    // If validation errors exist\n    if (!empty($validationErrors)) {\n        $_SESSION['validation_errors'] = $validationErrors;\n        header('Location: register.php');\n        exit();\n    }\n\n    // Hash password\n    $hashedPassword = password_hash($password, PASSWORD_DEFAULT);\n\n    // Prepare query to insert new user into database\n    $query = \"INSERT INTO users (first_name, last_name, email, password) VALUES (?, ?, ?, ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->execute([$firstName, $lastName, $email, $hashedPassword]);\n\n    // Send confirmation email with token\n    sendConfirmationEmail($email);\n\n    $_SESSION['success_message'] = \"Registration successful! Please check your email for verification.\";\n    header('Location: login.php');\n}\n\n// Function to send confirmation email with token\nfunction sendConfirmationEmail($email) {\n    $token = bin2hex(random_bytes(16));\n    $query = \"INSERT INTO tokens (user_id, token) VALUES ((SELECT id FROM users WHERE email = ?), ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->execute([$email, $token]);\n\n    $subject = 'Verify your account';\n    $body = 'Click the link to verify: <a href=\"verify.php?token=' . $token . '\">Verify Account</a>';\n    sendEmail($email, $subject, $body);\n}\n\n// Function to send email using PHPMailer\nfunction sendEmail($to, $subject, $body) {\n    require_once 'PHPMailerAutoload.php';\n    $mail = new PHPMailer;\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your-email@example.com';\n    $mail->Password = 'your-password';\n    $mail->setFrom('your-email@example.com', 'Your Name');\n    $mail->addAddress($to);\n    $mail->isHTML(true);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n    if (!$mail->send()) {\n        return \"Error: Mailer failed\";\n    }\n}\n\n?>\n```\n\n**Configuration (`config.php`):**\n\n```php\n<?php\n\n// Database configuration\n$dsn = 'mysql:host=localhost;dbname=your_database';\n$username = 'your_username';\n$password = 'your_password';\n\n$conn = new PDO($dsn, $username, $password);\n\n?>\n```\n\n### **How to use:**\n\n1. Include the `config.php` file in your registration form.\n2. Create a simple form with input fields for first name, last name, email, and password.\n3. When the user submits the form, call the `registerUser()` function and pass the input values as arguments.\n\n**Example Form (`register.html`):**\n\n```html\n<form action=\"register.php\" method=\"post\">\n    <input type=\"text\" name=\"firstName\" placeholder=\"First Name\">\n    <input type=\"text\" name=\"lastName\" placeholder=\"Last Name\">\n    <input type=\"email\" name=\"email\" placeholder=\"Email\">\n    <input type=\"password\" name=\"password\" placeholder=\"Password\">\n    <button type=\"submit\">Register</button>\n</form>\n```\n\nThis is a basic example, and you should adapt it to your specific needs. You may also want to add more features, such as password strength meter or CAPTCHA verification.\n\n**Note:** This code uses PHPMailer for sending emails, which requires additional configuration and installation. Make sure to follow the instructions in the [PHPMailer documentation](https://github.com/PHPMailer/PHPMailer) for proper setup and usage.", "code_blocks": ["```php\n<?php\n\n// Configuration\nrequire_once 'config.php';\n\n// Validation Error Messages\n$validationErrors = array();\n\nfunction registerUser($firstName, $lastName, $email, $password) {\n    // Input Validation\n    if (empty($firstName)) {\n        $validationErrors[] = \"First name is required.\";\n    }\n    if (empty($lastName)) {\n        $validationErrors[] = \"Last name is required.\";\n    }\n    if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n        $validationErrors[] = \"Invalid email address.\";\n    }\n    if (strlen($password) < 8) {\n        $validationErrors[] = \"Password must be at least 8 characters long.\";\n    }\n\n    // If validation errors exist\n    if (!empty($validationErrors)) {\n        $_SESSION['validation_errors'] = $validationErrors;\n        header('Location: register.php');\n        exit();\n    }\n\n    // Hash password\n    $hashedPassword = password_hash($password, PASSWORD_DEFAULT);\n\n    // Prepare query to insert new user into database\n    $query = \"INSERT INTO users (first_name, last_name, email, password) VALUES (?, ?, ?, ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->execute([$firstName, $lastName, $email, $hashedPassword]);\n\n    // Send confirmation email with token\n    sendConfirmationEmail($email);\n\n    $_SESSION['success_message'] = \"Registration successful! Please check your email for verification.\";\n    header('Location: login.php');\n}\n\n// Function to send confirmation email with token\nfunction sendConfirmationEmail($email) {\n    $token = bin2hex(random_bytes(16));\n    $query = \"INSERT INTO tokens (user_id, token) VALUES ((SELECT id FROM users WHERE email = ?), ?)\";\n    $stmt = $conn->prepare($query);\n    $stmt->execute([$email, $token]);\n\n    $subject = 'Verify your account';\n    $body = 'Click the link to verify: <a href=\"verify.php?token=' . $token . '\">Verify Account</a>';\n    sendEmail($email, $subject, $body);\n}\n\n// Function to send email using PHPMailer\nfunction sendEmail($to, $subject, $body) {\n    require_once 'PHPMailerAutoload.php';\n    $mail = new PHPMailer;\n    $mail->isSMTP();\n    $mail->Host = 'smtp.example.com';\n    $mail->Port = 587;\n    $mail->SMTPAuth = true;\n    $mail->Username = 'your-email@example.com';\n    $mail->Password = 'your-password';\n    $mail->setFrom('your-email@example.com', 'Your Name');\n    $mail->addAddress($to);\n    $mail->isHTML(true);\n    $mail->Subject = $subject;\n    $mail->Body = $body;\n    if (!$mail->send()) {\n        return \"Error: Mailer failed\";\n    }\n}\n\n?>\n```", "```php\n<?php\n\n// Database configuration\n$dsn = 'mysql:host=localhost;dbname=your_database';\n$username = 'your_username';\n$password = 'your_password';\n\n$conn = new PDO($dsn, $username, $password);\n\n?>\n```", null]}
