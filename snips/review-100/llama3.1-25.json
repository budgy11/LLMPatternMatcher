{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you can create a simple user review system using PHP:\n\n**Database Setup**\n\nFirst, let's assume we have the following database tables:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  email VARCHAR(255)\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255),\n  description TEXT\n);\n\nCREATE TABLE reviews (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT,\n  product_id INT,\n  rating TINYINT,\n  review TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n**PHP Code**\n\n```php\n<?php\n\n// Database connection settings\n$dsn = 'mysql:host=localhost;dbname=mydatabase';\n$username = 'myusername';\n$password = 'mypassword';\n\ntry {\n  // Connect to database\n  $db = new PDO($dsn, $username, $password);\n\n  // Function to get user reviews\n  function getUserReviews($userId) {\n    global $db;\n    $stmt = $db->prepare('SELECT * FROM reviews WHERE user_id = :user_id');\n    $stmt->bindParam(':user_id', $userId);\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n  }\n\n  // Function to add review\n  function addReview($productId, $rating, $review) {\n    global $db;\n    $userId = $_SESSION['user']['id']; // assuming you have a session variable with the user's ID\n    $stmt = $db->prepare('INSERT INTO reviews (product_id, user_id, rating, review) VALUES (:product_id, :user_id, :rating, :review)');\n    $stmt->bindParam(':product_id', $productId);\n    $stmt->bindParam(':user_id', $userId);\n    $stmt->bindParam(':rating', $rating);\n    $stmt->bindParam(':review', $review);\n    return $stmt->execute();\n  }\n\n  // Function to get product reviews\n  function getProductReviews($productId) {\n    global $db;\n    $stmt = $db->prepare('SELECT * FROM reviews WHERE product_id = :product_id');\n    $stmt->bindParam(':product_id', $productId);\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n  }\n\n} catch (PDOException $e) {\n  echo 'Error: ' . $e->getMessage();\n}\n\n?>\n```\n**Example Usage**\n\n```php\n// Get user reviews\n$userReviews = getUserReviews(1); // assuming the user ID is 1\nprint_r($userReviews);\n\n// Add review\naddReview(1, 5, 'Great product!'); // assuming the product ID is 1\n\n// Get product reviews\n$productReviews = getProductReviews(1);\nprint_r($productReviews);\n```\nThis code uses PDO (PHP Data Objects) to interact with the database. It includes three functions:\n\n* `getUserReviews($userId)`: Retrieves all reviews written by a specific user.\n* `addReview($productId, $rating, $review)`: Adds a new review for a product.\n* `getProductReviews($productId)`: Retrieves all reviews for a specific product.\n\nNote that this is just a basic example and you may want to add additional functionality (e.g. error handling, validation, etc.) depending on your specific requirements.", "code_blocks": [null, "```php\n<?php\n\n// Database connection settings\n$dsn = 'mysql:host=localhost;dbname=mydatabase';\n$username = 'myusername';\n$password = 'mypassword';\n\ntry {\n  // Connect to database\n  $db = new PDO($dsn, $username, $password);\n\n  // Function to get user reviews\n  function getUserReviews($userId) {\n    global $db;\n    $stmt = $db->prepare('SELECT * FROM reviews WHERE user_id = :user_id');\n    $stmt->bindParam(':user_id', $userId);\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n  }\n\n  // Function to add review\n  function addReview($productId, $rating, $review) {\n    global $db;\n    $userId = $_SESSION['user']['id']; // assuming you have a session variable with the user's ID\n    $stmt = $db->prepare('INSERT INTO reviews (product_id, user_id, rating, review) VALUES (:product_id, :user_id, :rating, :review)');\n    $stmt->bindParam(':product_id', $productId);\n    $stmt->bindParam(':user_id', $userId);\n    $stmt->bindParam(':rating', $rating);\n    $stmt->bindParam(':review', $review);\n    return $stmt->execute();\n  }\n\n  // Function to get product reviews\n  function getProductReviews($productId) {\n    global $db;\n    $stmt = $db->prepare('SELECT * FROM reviews WHERE product_id = :product_id');\n    $stmt->bindParam(':product_id', $productId);\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n  }\n\n} catch (PDOException $e) {\n  echo 'Error: ' . $e->getMessage();\n}\n\n?>\n```", "```php\n// Get user reviews\n$userReviews = getUserReviews(1); // assuming the user ID is 1\nprint_r($userReviews);\n\n// Add review\naddReview(1, 5, 'Great product!'); // assuming the product ID is 1\n\n// Get product reviews\n$productReviews = getProductReviews(1);\nprint_r($productReviews);\n```"]}
