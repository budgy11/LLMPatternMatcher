{"prompt": "Create a user review function using php", "llm_output": "Here's an example of a simple user review system in PHP, including the ability to create reviews, view all reviews, and update/delete individual reviews.\n\n**Database Setup:**\n\nFor this example, we'll assume you have a MySQL database set up with two tables: `users` and `reviews`.\n\n```sql\nCREATE TABLE users (\n  id INT AUTO_INCREMENT,\n  username VARCHAR(255),\n  email VARCHAR(255),\n  password VARCHAR(255),\n  PRIMARY KEY (id)\n);\n\nCREATE TABLE reviews (\n  id INT AUTO_INCREMENT,\n  user_id INT,\n  product_name VARCHAR(255),\n  rating TINYINT(1) CHECK(rating >= 1 AND rating <= 5),\n  review_text TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n```\n\n**PHP Code:**\n\nCreate a new PHP file named `reviews.php` and add the following code:\n\n```php\n<?php\n\n// Connect to database\nrequire_once 'dbconfig.php';\n$connection = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif (!$connection) {\n  die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Function to create a new review\nfunction create_review($user_id, $product_name, $rating, $review_text) {\n  global $connection;\n  \n  $sql = \"INSERT INTO reviews (user_id, product_name, rating, review_text)\n          VALUES ('$user_id', '$product_name', '$rating', '$review_text')\";\n  \n  if (mysqli_query($connection, $sql)) {\n    echo 'Review created successfully!';\n  } else {\n    echo 'Error creating review: ' . mysqli_error($connection);\n  }\n}\n\n// Function to view all reviews\nfunction view_reviews() {\n  global $connection;\n  \n  $sql = \"SELECT * FROM reviews\";\n  $result = mysqli_query($connection, $sql);\n  \n  if (mysqli_num_rows($result) > 0) {\n    echo '<table border=\"1\" cellpadding=\"10\">';\n    while ($row = mysqli_fetch_assoc($result)) {\n      echo '<tr>';\n      echo '<td>' . $row['product_name'] . '</td>';\n      echo '<td>' . $row['rating'] . '</td>';\n      echo '<td>' . $row['review_text'] . '</td>';\n      echo '<td><a href=\"update_review.php?id=' . $row['id'] . '\">Update</a></td>';\n      echo '<td><a href=\"delete_review.php?id=' . $row['id'] . '\">Delete</a></td>';\n      echo '</tr>';\n    }\n    echo '</table>';\n  } else {\n    echo 'No reviews found.';\n  }\n}\n\n// Function to update a review\nfunction update_review($review_id, $product_name, $rating, $review_text) {\n  global $connection;\n  \n  $sql = \"UPDATE reviews SET product_name='$product_name', rating='$rating', review_text='$review_text' WHERE id=$review_id\";\n  \n  if (mysqli_query($connection, $sql)) {\n    echo 'Review updated successfully!';\n  } else {\n    echo 'Error updating review: ' . mysqli_error($connection);\n  }\n}\n\n// Function to delete a review\nfunction delete_review($review_id) {\n  global $connection;\n  \n  $sql = \"DELETE FROM reviews WHERE id=$review_id\";\n  \n  if (mysqli_query($connection, $sql)) {\n    echo 'Review deleted successfully!';\n  } else {\n    echo 'Error deleting review: ' . mysqli_error($connection);\n  }\n}\n\n// Test the functions\nif (isset($_GET['action'])) {\n  switch ($_GET['action']) {\n    case 'create':\n      create_review($_POST['user_id'], $_POST['product_name'], $_POST['rating'], $_POST['review_text']);\n      break;\n    case 'view_reviews':\n      view_reviews();\n      break;\n    case 'update':\n      update_review($_POST['id'], $_POST['product_name'], $_POST['rating'], $_POST['review_text']);\n      break;\n    case 'delete':\n      delete_review($_GET['id']);\n      break;\n  }\n} else {\n  echo '<form action=\"reviews.php?action=create\" method=\"post\">';\n  echo 'Product Name: <input type=\"text\" name=\"product_name\"><br>';\n  echo 'Rating: <select name=\"rating\">\n            <option value=\"1\">1</option>\n            <option value=\"2\">2</option>\n            <option value=\"3\">3</option>\n            <option value=\"4\">4</option>\n            <option value=\"5\">5</option>\n          </select><br>';\n  echo 'Review Text: <textarea name=\"review_text\"></textarea><br>';\n  echo '<input type=\"hidden\" name=\"user_id\" value=\"' . $_SESSION['id'] . '\">';\n  echo '<input type=\"submit\" value=\"Create Review\">';\n  echo '</form>';\n}\n\n?>\n```\n\n**Example Use Cases:**\n\n1. Creating a new review:\n\n   Send an HTTP GET request to `reviews.php?action=create` with the following parameters:\n   ```\nproduct_name=Test+Product&rating=5&review_text=This+is+a+test+review\n```\n2. Viewing all reviews:\n\n   Send an HTTP GET request to `reviews.php?action=view_reviews`.\n3. Updating a review:\n\n   Send an HTTP POST request to `reviews.php?action=update` with the following parameters:\n   ```\nid=1&product_name=Updated+Product&rating=4&review_text=This+is+an+updated+test+review\n```\n4. Deleting a review:\n\n   Send an HTTP GET request to `reviews.php?action=delete&id=1`.", "code_blocks": [null, "```php\n<?php\n\n// Connect to database\nrequire_once 'dbconfig.php';\n$connection = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif (!$connection) {\n  die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Function to create a new review\nfunction create_review($user_id, $product_name, $rating, $review_text) {\n  global $connection;\n  \n  $sql = \"INSERT INTO reviews (user_id, product_name, rating, review_text)\n          VALUES ('$user_id', '$product_name', '$rating', '$review_text')\";\n  \n  if (mysqli_query($connection, $sql)) {\n    echo 'Review created successfully!';\n  } else {\n    echo 'Error creating review: ' . mysqli_error($connection);\n  }\n}\n\n// Function to view all reviews\nfunction view_reviews() {\n  global $connection;\n  \n  $sql = \"SELECT * FROM reviews\";\n  $result = mysqli_query($connection, $sql);\n  \n  if (mysqli_num_rows($result) > 0) {\n    echo '<table border=\"1\" cellpadding=\"10\">';\n    while ($row = mysqli_fetch_assoc($result)) {\n      echo '<tr>';\n      echo '<td>' . $row['product_name'] . '</td>';\n      echo '<td>' . $row['rating'] . '</td>';\n      echo '<td>' . $row['review_text'] . '</td>';\n      echo '<td><a href=\"update_review.php?id=' . $row['id'] . '\">Update</a></td>';\n      echo '<td><a href=\"delete_review.php?id=' . $row['id'] . '\">Delete</a></td>';\n      echo '</tr>';\n    }\n    echo '</table>';\n  } else {\n    echo 'No reviews found.';\n  }\n}\n\n// Function to update a review\nfunction update_review($review_id, $product_name, $rating, $review_text) {\n  global $connection;\n  \n  $sql = \"UPDATE reviews SET product_name='$product_name', rating='$rating', review_text='$review_text' WHERE id=$review_id\";\n  \n  if (mysqli_query($connection, $sql)) {\n    echo 'Review updated successfully!';\n  } else {\n    echo 'Error updating review: ' . mysqli_error($connection);\n  }\n}\n\n// Function to delete a review\nfunction delete_review($review_id) {\n  global $connection;\n  \n  $sql = \"DELETE FROM reviews WHERE id=$review_id\";\n  \n  if (mysqli_query($connection, $sql)) {\n    echo 'Review deleted successfully!';\n  } else {\n    echo 'Error deleting review: ' . mysqli_error($connection);\n  }\n}\n\n// Test the functions\nif (isset($_GET['action'])) {\n  switch ($_GET['action']) {\n    case 'create':\n      create_review($_POST['user_id'], $_POST['product_name'], $_POST['rating'], $_POST['review_text']);\n      break;\n    case 'view_reviews':\n      view_reviews();\n      break;\n    case 'update':\n      update_review($_POST['id'], $_POST['product_name'], $_POST['rating'], $_POST['review_text']);\n      break;\n    case 'delete':\n      delete_review($_GET['id']);\n      break;\n  }\n} else {\n  echo '<form action=\"reviews.php?action=create\" method=\"post\">';\n  echo 'Product Name: <input type=\"text\" name=\"product_name\"><br>';\n  echo 'Rating: <select name=\"rating\">\n            <option value=\"1\">1</option>\n            <option value=\"2\">2</option>\n            <option value=\"3\">3</option>\n            <option value=\"4\">4</option>\n            <option value=\"5\">5</option>\n          </select><br>';\n  echo 'Review Text: <textarea name=\"review_text\"></textarea><br>';\n  echo '<input type=\"hidden\" name=\"user_id\" value=\"' . $_SESSION['id'] . '\">';\n  echo '<input type=\"submit\" value=\"Create Review\">';\n  echo '</form>';\n}\n\n?>\n```", null, null]}
