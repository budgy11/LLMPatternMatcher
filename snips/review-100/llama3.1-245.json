{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you can create a user review system with PHP. This example will include functionality to add reviews, display reviews for a specific product, and calculate the average rating.\n\n**Database Schema:**\n\nFirst, let's define our database schema:\n\n```sql\nCREATE TABLE users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    username VARCHAR(255) NOT NULL,\n    email VARCHAR(255) NOT NULL\n);\n\nCREATE TABLE products (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(255) NOT NULL\n);\n\nCREATE TABLE reviews (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    product_id INT NOT NULL,\n    user_id INT NOT NULL,\n    rating TINYINT NOT NULL,\n    review TEXT NOT NULL,\n    FOREIGN KEY (product_id) REFERENCES products(id),\n    FOREIGN KEY (user_id) REFERENCES users(id)\n);\n```\n\n**PHP Code:**\n\nNext, let's create the PHP functions to add reviews and display reviews:\n\n```php\n// Connect to database\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\nfunction addReview($product_id, $rating, $review, $user_id) {\n    global $conn;\n    if (mysqli_query($conn, \"INSERT INTO reviews(product_id, user_id, rating, review) VALUES ('$product_id', '$user_id', '$rating', '$review')\")) {\n        return true;\n    } else {\n        echo mysqli_error($conn);\n        return false;\n    }\n}\n\nfunction getReviews($product_id) {\n    global $conn;\n    $query = \"SELECT * FROM reviews WHERE product_id='$product_id'\";\n    $result = mysqli_query($conn, $query);\n    $reviews = array();\n    while ($row = mysqli_fetch_assoc($result)) {\n        $reviews[] = array(\n            'id' => $row['id'],\n            'rating' => $row['rating'],\n            'review' => $row['review']\n        );\n    }\n    return $reviews;\n}\n\nfunction getAverageRating($product_id) {\n    global $conn;\n    $query = \"SELECT AVG(rating) FROM reviews WHERE product_id='$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_array($result)[0];\n}\n```\n\n**Example Usage:**\n\nTo add a review:\n\n```php\n$product_id = 1; // Product ID\n$rating = 5;\n$review = \"This product is amazing!\";\n$user_id = 1; // User ID\n\naddReview($product_id, $rating, $review, $user_id);\n```\n\nTo display reviews for a specific product:\n\n```php\n$product_id = 1;\n\n$reviews = getReviews($product_id);\n\nforeach ($reviews as $review) {\n    echo \"Rating: \" . $review['rating'] . \"/5\" . \"\\n\";\n    echo \"Review: \" . $review['review'] . \"\\n\\n\";\n}\n```\n\nTo display the average rating for a specific product:\n\n```php\n$product_id = 1;\n\n$average_rating = getAverageRating($product_id);\n\necho \"Average Rating: \" . $average_rating . \"/5\" . \"\\n\";\n```\n\nRemember to replace `\"localhost\", \"username\", \"password\", \"database\"` with your actual database credentials.", "code_blocks": [null, "```php\n// Connect to database\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database\");\n\nfunction addReview($product_id, $rating, $review, $user_id) {\n    global $conn;\n    if (mysqli_query($conn, \"INSERT INTO reviews(product_id, user_id, rating, review) VALUES ('$product_id', '$user_id', '$rating', '$review')\")) {\n        return true;\n    } else {\n        echo mysqli_error($conn);\n        return false;\n    }\n}\n\nfunction getReviews($product_id) {\n    global $conn;\n    $query = \"SELECT * FROM reviews WHERE product_id='$product_id'\";\n    $result = mysqli_query($conn, $query);\n    $reviews = array();\n    while ($row = mysqli_fetch_assoc($result)) {\n        $reviews[] = array(\n            'id' => $row['id'],\n            'rating' => $row['rating'],\n            'review' => $row['review']\n        );\n    }\n    return $reviews;\n}\n\nfunction getAverageRating($product_id) {\n    global $conn;\n    $query = \"SELECT AVG(rating) FROM reviews WHERE product_id='$product_id'\";\n    $result = mysqli_query($conn, $query);\n    return mysqli_fetch_array($result)[0];\n}\n```", "```php\n$product_id = 1; // Product ID\n$rating = 5;\n$review = \"This product is amazing!\";\n$user_id = 1; // User ID\n\naddReview($product_id, $rating, $review, $user_id);\n```", "```php\n$product_id = 1;\n\n$reviews = getReviews($product_id);\n\nforeach ($reviews as $review) {\n    echo \"Rating: \" . $review['rating'] . \"/5\" . \"\\n\";\n    echo \"Review: \" . $review['review'] . \"\\n\\n\";\n}\n```", "```php\n$product_id = 1;\n\n$average_rating = getAverageRating($product_id);\n\necho \"Average Rating: \" . $average_rating . \"/5\" . \"\\n\";\n```"]}
