{"prompt": "Create a user review function using php", "llm_output": "Here is an example of a simple user review system using PHP, HTML, and MySQL. This example includes CRUD (Create, Read, Update, Delete) operations for reviews.\n\n**Database Setup**\n\nFirst, we need to set up the database table to store our reviews. Create a new table called `reviews` with the following structure:\n```sql\nCREATE TABLE reviews (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    user_id INT,\n    product_name VARCHAR(255),\n    rating TINYINT(1) CHECK (rating BETWEEN 1 AND 5),\n    review_text TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n**PHP Code**\n\nCreate a new PHP file called `review.php` and add the following code:\n```php\n<?php\n\n// Connect to database\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database_name\");\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Functions for CRUD operations\nfunction create_review($user_id, $product_name, $rating, $review_text) {\n    global $conn;\n    $sql = \"INSERT INTO reviews (user_id, product_name, rating, review_text) VALUES (?, ?, ?, ?)\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"iiss\", $user_id, $product_name, $rating, $review_text);\n    mysqli_stmt_execute($stmt);\n}\n\nfunction get_reviews() {\n    global $conn;\n    $sql = \"SELECT * FROM reviews ORDER BY created_at DESC\";\n    $result = mysqli_query($conn, $sql);\n    return mysqli_fetch_all($result, MYSQLI_ASSOC);\n}\n\nfunction get_review_by_id($id) {\n    global $conn;\n    $sql = \"SELECT * FROM reviews WHERE id = ?\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"i\", $id);\n    mysqli_stmt_execute($stmt);\n    return mysqli_fetch_assoc($stmt->get_result());\n}\n\nfunction update_review($id, $rating, $review_text) {\n    global $conn;\n    $sql = \"UPDATE reviews SET rating = ?, review_text = ? WHERE id = ?\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"iis\", $rating, $review_text, $id);\n    mysqli_stmt_execute($stmt);\n}\n\nfunction delete_review($id) {\n    global $conn;\n    $sql = \"DELETE FROM reviews WHERE id = ?\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"i\", $id);\n    mysqli_stmt_execute($stmt);\n}\n```\n**HTML Code**\n\nCreate a new HTML file called `index.php` and add the following code:\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Reviews</title>\n</head>\n<body>\n    <h1>Reviews</h1>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        <label for=\"product_name\">Product Name:</label>\n        <input type=\"text\" id=\"product_name\" name=\"product_name\"><br><br>\n        <label for=\"rating\">Rating:</label>\n        <select id=\"rating\" name=\"rating\">\n            <?php for ($i = 1; $i <= 5; $i++) { ?>\n                <option value=\"<?php echo $i; ?>\"><?php echo $i; ?>/5</option>\n            <?php } ?>\n        </select><br><br>\n        <label for=\"review_text\">Review:</label>\n        <textarea id=\"review_text\" name=\"review_text\"></textarea><br><br>\n        <input type=\"submit\" value=\"Submit Review\">\n    </form>\n\n    <?php\n    if (isset($_POST['product_name'])) {\n        create_review($_SESSION['user_id'], $_POST['product_name'], $_POST['rating'], $_POST['review_text']);\n    }\n    \n    $reviews = get_reviews();\n    foreach ($reviews as $review) { ?>\n        <h2>Review <?php echo $review['id']; ?></h2>\n        <p>Product: <?php echo $review['product_name']; ?></p>\n        <p>Rating: <?php echo $review['rating']; ?>/5</p>\n        <p>Review:</p>\n        <p><?php echo $review['review_text']; ?></p>\n    <?php } ?>\n</body>\n</html>\n```\nThis code creates a simple form that allows users to submit reviews. The reviews are stored in the database and displayed on the same page.\n\nNote: This is a basic example and you should add security measures, such as validating user input and preventing SQL injection attacks.", "code_blocks": [null, "```php\n<?php\n\n// Connect to database\n$conn = mysqli_connect(\"localhost\", \"username\", \"password\", \"database_name\");\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Functions for CRUD operations\nfunction create_review($user_id, $product_name, $rating, $review_text) {\n    global $conn;\n    $sql = \"INSERT INTO reviews (user_id, product_name, rating, review_text) VALUES (?, ?, ?, ?)\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"iiss\", $user_id, $product_name, $rating, $review_text);\n    mysqli_stmt_execute($stmt);\n}\n\nfunction get_reviews() {\n    global $conn;\n    $sql = \"SELECT * FROM reviews ORDER BY created_at DESC\";\n    $result = mysqli_query($conn, $sql);\n    return mysqli_fetch_all($result, MYSQLI_ASSOC);\n}\n\nfunction get_review_by_id($id) {\n    global $conn;\n    $sql = \"SELECT * FROM reviews WHERE id = ?\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"i\", $id);\n    mysqli_stmt_execute($stmt);\n    return mysqli_fetch_assoc($stmt->get_result());\n}\n\nfunction update_review($id, $rating, $review_text) {\n    global $conn;\n    $sql = \"UPDATE reviews SET rating = ?, review_text = ? WHERE id = ?\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"iis\", $rating, $review_text, $id);\n    mysqli_stmt_execute($stmt);\n}\n\nfunction delete_review($id) {\n    global $conn;\n    $sql = \"DELETE FROM reviews WHERE id = ?\";\n    $stmt = mysqli_prepare($conn, $sql);\n    mysqli_stmt_bind_param($stmt, \"i\", $id);\n    mysqli_stmt_execute($stmt);\n}\n```", null]}
