{"prompt": "Create a user review function using php", "llm_output": "**User Review Function in PHP**\n=====================================\n\nThis code creates a simple user review system where users can submit reviews for specific products or services. The reviews are stored in a database and displayed on the website.\n\n**Database Schema**\n-------------------\n\nWe'll use a simple schema with two tables: `products` and `reviews`.\n\n```sql\nCREATE TABLE products (\n  id INT PRIMARY KEY,\n  name VARCHAR(255),\n  description TEXT\n);\n\nCREATE TABLE reviews (\n  id INT PRIMARY KEY,\n  product_id INT,\n  user_name VARCHAR(255),\n  review_text TEXT,\n  rating TINYINT,\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**PHP Code**\n-------------\n\n### **review.php**\n\n```php\n<?php\n\n// Database connection settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n}\n\nfunction get_reviews($product_id) {\n    global $mysqli;\n\n    // Get reviews for a specific product\n    $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n    $result = $mysqli->query($query);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            $reviews[] = array(\n                'id' => $row['id'],\n                'user_name' => $row['user_name'],\n                'review_text' => $row['review_text'],\n                'rating' => $row['rating']\n            );\n        }\n\n        return $reviews;\n    } else {\n        return false;\n    }\n}\n\nfunction submit_review($product_id, $user_name, $review_text, $rating) {\n    global $mysqli;\n\n    // Insert new review into database\n    $query = \"INSERT INTO reviews (product_id, user_name, review_text, rating)\n              VALUES ('$product_id', '$user_name', '$review_text', '$rating')\";\n    $result = $mysqli->query($query);\n\n    if ($result) {\n        return true;\n    } else {\n        echo \"Error submitting review: (\" . $mysqli->errno . \") \" . $mysqli->error;\n        return false;\n    }\n}\n\n// Example usage\n$product_id = 1; // ID of the product for which to display reviews\n\n$reviews = get_reviews($product_id);\n\nif ($reviews) {\n    foreach ($reviews as $review) {\n        echo \"User: $review[user_name] | Rating: $review[rating]/5 | Review: $review[review_text]<br>\";\n    }\n} else {\n    echo \"No reviews found for this product.\";\n}\n\n?>\n```\n\n### **submit_review.php**\n\n```php\n<?php\n\n// Include review.php file\ninclude 'review.php';\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $product_id = $_POST['product_id'];\n    $user_name = $_POST['user_name'];\n    $review_text = $_POST['review_text'];\n    $rating = $_POST['rating'];\n\n    // Submit review to database\n    if (submit_review($product_id, $user_name, $review_text, $rating)) {\n        echo \"Review submitted successfully!\";\n    } else {\n        echo \"Error submitting review.\";\n    }\n}\n\n?>\n```\n\n**HTML Code**\n--------------\n\n### **index.php**\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Product Reviews</title>\n</head>\n<body>\n\n<h1>Product Reviews</h1>\n\n<form action=\"submit_review.php\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $product_id; ?>\">\n    <label for=\"user_name\">User Name:</label>\n    <input type=\"text\" id=\"user_name\" name=\"user_name\"><br><br>\n    <label for=\"review_text\">Review:</label>\n    <textarea id=\"review_text\" name=\"review_text\"></textarea><br><br>\n    <label for=\"rating\">Rating (1-5):</label>\n    <select id=\"rating\" name=\"rating\">\n        <?php for ($i = 1; $i <= 5; $i++) { ?>\n            <option value=\"<?php echo $i; ?>\"><?php echo $i; ?>/5</option>\n        <?php } ?>\n    </select><br><br>\n    <input type=\"submit\" value=\"Submit Review\">\n</form>\n\n<h2>Reviews:</h2>\n\n<?php include 'review.php'; ?>\n\n</body>\n</html>\n```\n\nThis code creates a simple user review system where users can submit reviews for specific products. The reviews are stored in a database and displayed on the website.\n\nNote: This is a basic example and you should consider adding security measures, such as validation and sanitization of input data, to prevent SQL injection attacks and other security vulnerabilities.", "code_blocks": [null, "```php\n<?php\n\n// Database connection settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n}\n\nfunction get_reviews($product_id) {\n    global $mysqli;\n\n    // Get reviews for a specific product\n    $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n    $result = $mysqli->query($query);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            $reviews[] = array(\n                'id' => $row['id'],\n                'user_name' => $row['user_name'],\n                'review_text' => $row['review_text'],\n                'rating' => $row['rating']\n            );\n        }\n\n        return $reviews;\n    } else {\n        return false;\n    }\n}\n\nfunction submit_review($product_id, $user_name, $review_text, $rating) {\n    global $mysqli;\n\n    // Insert new review into database\n    $query = \"INSERT INTO reviews (product_id, user_name, review_text, rating)\n              VALUES ('$product_id', '$user_name', '$review_text', '$rating')\";\n    $result = $mysqli->query($query);\n\n    if ($result) {\n        return true;\n    } else {\n        echo \"Error submitting review: (\" . $mysqli->errno . \") \" . $mysqli->error;\n        return false;\n    }\n}\n\n// Example usage\n$product_id = 1; // ID of the product for which to display reviews\n\n$reviews = get_reviews($product_id);\n\nif ($reviews) {\n    foreach ($reviews as $review) {\n        echo \"User: $review[user_name] | Rating: $review[rating]/5 | Review: $review[review_text]<br>\";\n    }\n} else {\n    echo \"No reviews found for this product.\";\n}\n\n?>\n```", "```php\n<?php\n\n// Include review.php file\ninclude 'review.php';\n\n// Handle form submission\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    $product_id = $_POST['product_id'];\n    $user_name = $_POST['user_name'];\n    $review_text = $_POST['review_text'];\n    $rating = $_POST['rating'];\n\n    // Submit review to database\n    if (submit_review($product_id, $user_name, $review_text, $rating)) {\n        echo \"Review submitted successfully!\";\n    } else {\n        echo \"Error submitting review.\";\n    }\n}\n\n?>\n```", null]}
