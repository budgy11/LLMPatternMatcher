{"prompt": "Create a user review function using php", "llm_output": "Here's an example of a simple user review system written in PHP. This script allows users to submit reviews, which are stored in a MySQL database.\n\n**Database Schema:**\n\n```sql\nCREATE TABLE reviews (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  title VARCHAR(255),\n  content TEXT,\n  rating TINYINT(1) CHECK(rating >= 1 AND rating <= 5),\n  user_id INT,\n  product_id INT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL UNIQUE,\n  password VARCHAR(255)\n);\n```\n\n**review.php (View):**\n\n```php\n<?php\n\n// Display reviews for a specific product\n\n$query = \"SELECT r.* FROM reviews r WHERE product_id = $product_id\";\n$result = mysqli_query($db, $query);\n\n?>\n<div>\n    <h2>Reviews</h2>\n    <?php while ($review = mysqli_fetch_assoc($result)) { ?>\n        <div class=\"review\">\n            <p><?= $review['title'] ?></p>\n            <p><?= $review['content'] ?></p>\n            <p>Ratings: <?= $review['rating'] ?>/5</p>\n            <p>Submitted by <?= $review['username'] ?> on <?= $review['created_at'] ?></p>\n        </div>\n    <?php } ?>\n</div>\n\n<a href=\"submit-review.php\">Submit a Review!</a>\n```\n\n**submit-review.php (View):**\n\n```php\n<?php\n\n// Allow users to submit reviews for a specific product\n\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    $title = $_POST['title'];\n    $content = $_POST['content'];\n    $rating = $_POST['rating'];\n    $product_id = $_POST['product_id'];\n\n    // Validate form data\n    if (empty($title) || empty($content) || empty($rating)) {\n        echo 'Please fill in all fields!';\n    } else {\n        $query = \"INSERT INTO reviews (title, content, rating, user_id, product_id)\n                  VALUES ('$title', '$content', '$rating', '\".$_SESSION['user']['id'].\"', '$product_id')\";\n        mysqli_query($db, $query);\n\n        header(\"Location: index.php\");\n    }\n}\n\n?>\n<h2>Submit a Review</h2>\n<form action=\"<?= $_SERVER[\"PHP_SELF\"] ?>\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?= $product_id ?>\">\n    <label for=\"title\">Title:</label>\n    <input type=\"text\" id=\"title\" name=\"title\"><br><br>\n    <label for=\"content\">Content:</label>\n    <textarea id=\"content\" name=\"content\"></textarea><br><br>\n    <label for=\"rating\">Rating (1-5):</label>\n    <select id=\"rating\" name=\"rating\">\n        <?php for ($i = 1; $i <= 5; $i++) { ?>\n            <option value=\"<?= $i ?>\"><?= $i ?>/5</option>\n        <?php } ?>\n    </select><br><br>\n    <input type=\"submit\" value=\"Submit Review\">\n</form>\n```\n\n**review-model.php (Controller):**\n\n```php\n<?php\n\nclass ReviewModel {\n    private $db;\n\n    function __construct($db) {\n        $this->db = $db;\n    }\n\n    public function create_review($title, $content, $rating, $user_id, $product_id) {\n        $query = \"INSERT INTO reviews (title, content, rating, user_id, product_id)\n                  VALUES ('$title', '$content', '$rating', '$user_id', '$product_id')\";\n        mysqli_query($this->db, $query);\n    }\n\n    public function get_reviews_for_product($product_id) {\n        $query = \"SELECT * FROM reviews WHERE product_id = $product_id\";\n        return mysqli_query($this->db, $query);\n    }\n}\n\n?>\n```\n\n**Please note:**\n\n*   This code is a simplified example and doesn't include any error checking or security measures that you would want to use in a production environment.\n*   You should replace `mysqli_` with your preferred database extension (e.g., PDO).\n*   You'll need to modify the database schema to fit your specific needs.\n\n**Example usage:**\n\n1.  Create a new product and get its ID (`$product_id`).\n2.  Allow users to submit reviews for this product by linking them to `submit-review.php`.\n3.  On `submit-review.php`, store user-submitted data in the database using the `create_review()` method.\n4.  Display submitted reviews on a page (e.g., `review.php`) using the `get_reviews_for_product()` method.\n\nThis is a basic example of how to create a review system with PHP and MySQL. You can customize it as needed for your specific application.", "code_blocks": [null, "```php\n<?php\n\n// Display reviews for a specific product\n\n$query = \"SELECT r.* FROM reviews r WHERE product_id = $product_id\";\n$result = mysqli_query($db, $query);\n\n?>\n<div>\n    <h2>Reviews</h2>\n    <?php while ($review = mysqli_fetch_assoc($result)) { ?>\n        <div class=\"review\">\n            <p><?= $review['title'] ?></p>\n            <p><?= $review['content'] ?></p>\n            <p>Ratings: <?= $review['rating'] ?>/5</p>\n            <p>Submitted by <?= $review['username'] ?> on <?= $review['created_at'] ?></p>\n        </div>\n    <?php } ?>\n</div>\n\n<a href=\"submit-review.php\">Submit a Review!</a>\n```", "```php\n<?php\n\n// Allow users to submit reviews for a specific product\n\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    $title = $_POST['title'];\n    $content = $_POST['content'];\n    $rating = $_POST['rating'];\n    $product_id = $_POST['product_id'];\n\n    // Validate form data\n    if (empty($title) || empty($content) || empty($rating)) {\n        echo 'Please fill in all fields!';\n    } else {\n        $query = \"INSERT INTO reviews (title, content, rating, user_id, product_id)\n                  VALUES ('$title', '$content', '$rating', '\".$_SESSION['user']['id'].\"', '$product_id')\";\n        mysqli_query($db, $query);\n\n        header(\"Location: index.php\");\n    }\n}\n\n?>\n<h2>Submit a Review</h2>\n<form action=\"<?= $_SERVER[\"PHP_SELF\"] ?>\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?= $product_id ?>\">\n    <label for=\"title\">Title:</label>\n    <input type=\"text\" id=\"title\" name=\"title\"><br><br>\n    <label for=\"content\">Content:</label>\n    <textarea id=\"content\" name=\"content\"></textarea><br><br>\n    <label for=\"rating\">Rating (1-5):</label>\n    <select id=\"rating\" name=\"rating\">\n        <?php for ($i = 1; $i <= 5; $i++) { ?>\n            <option value=\"<?= $i ?>\"><?= $i ?>/5</option>\n        <?php } ?>\n    </select><br><br>\n    <input type=\"submit\" value=\"Submit Review\">\n</form>\n```", "```php\n<?php\n\nclass ReviewModel {\n    private $db;\n\n    function __construct($db) {\n        $this->db = $db;\n    }\n\n    public function create_review($title, $content, $rating, $user_id, $product_id) {\n        $query = \"INSERT INTO reviews (title, content, rating, user_id, product_id)\n                  VALUES ('$title', '$content', '$rating', '$user_id', '$product_id')\";\n        mysqli_query($this->db, $query);\n    }\n\n    public function get_reviews_for_product($product_id) {\n        $query = \"SELECT * FROM reviews WHERE product_id = $product_id\";\n        return mysqli_query($this->db, $query);\n    }\n}\n\n?>\n```"]}
