{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you can implement a user review function in PHP:\n\n```php\n<?php\n\n// Database Connection\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"review_system\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction add_review() {\n    global $conn;\n    \n    if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n        \n        // Get the review data\n        $product_id = $_POST['product_id'];\n        $user_id = $_POST['user_id'];\n        $rating = $_POST['rating'];\n        $review_text = $_POST['review_text'];\n\n        // Check if the product exists in the database\n        $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($query);\n\n        if ($result->num_rows > 0) {\n            // Add review to database\n            $sql = \"INSERT INTO reviews (user_id, product_id, rating, review_text)\n                    VALUES ('$user_id', '$product_id', '$rating', '$review_text')\";\n            \n            if ($conn->query($sql) === TRUE) {\n                echo \"Review added successfully!\";\n            } else {\n                echo \"Error: \" . $sql . \"<br>\" . $conn->error;\n            }\n        } else {\n            echo \"Product not found.\";\n        }\n    }\n}\n\nfunction get_reviews() {\n    global $conn;\n    \n    // Get reviews for a specific product\n    $product_id = $_GET['product_id'];\n    \n    $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        while($row = $result->fetch_assoc()) {\n            echo \"<h2>Review</h2>\";\n            echo \"Rating: \" . $row['rating'] . \"/5\";\n            echo \"<br>Text: \" . $row['review_text'];\n            echo \"<hr>\";\n        }\n    } else {\n        echo \"No reviews found for this product.\";\n    }\n}\n\nfunction delete_review() {\n    global $conn;\n    \n    if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n        \n        // Get the review id\n        $review_id = $_POST['review_id'];\n        \n        $query = \"DELETE FROM reviews WHERE id = '$review_id'\";\n        \n        if ($conn->query($query) === TRUE) {\n            echo \"Review deleted successfully!\";\n        } else {\n            echo \"Error: \" . $sql . \"<br>\" . $conn->error;\n        }\n    }\n}\n\n?>\n```\n\nYou can add, view and delete reviews using the following URLs:\n\n*   `add_review.php`: Add a new review to a product.\n*   `get_reviews.php?product_id=<id>`: View all reviews for a specific product.\n*   `delete_review.php`: Delete an existing review from the database.\n\nHere's how you can use these functions in your code:\n\n```php\n// add_review.php\n\nadd_review();\n?>\n\n<form action=\"\" method=\"post\">\n    <label>Product ID:</label>\n    <input type=\"text\" name=\"product_id\"><br><br>\n    <label>User ID:</label>\n    <input type=\"text\" name=\"user_id\"><br><br>\n    <label>Rating:</label>\n    <select name=\"rating\">\n        <option value=\"1\">1</option>\n        <option value=\"2\">2</option>\n        <option value=\"3\">3</option>\n        <option value=\"4\">4</option>\n        <option value=\"5\">5</option>\n    </select><br><br>\n    <label>Review:</label>\n    <textarea name=\"review_text\"></textarea><br><br>\n    <input type=\"submit\" value=\"Add Review\">\n</form>\n\n<?php\n// get_reviews.php\n\nget_reviews();\n?>\n\n<form action=\"\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['product_id']; ?>\">\n    <input type=\"submit\" value=\"Delete Review\" onclick=\"return confirm('Are you sure you want to delete this review?')\">\n</form>\n\n<?php\n// delete_review.php\n\ndelete_review();\n?>\n```\n\nRemember to replace `<id>` with the actual ID of the product whose reviews you want to view. Also, make sure that the database credentials are correct and that the database tables `reviews` and `products` exist in your database.\n\nNote: This is a basic example and does not include any error checking or validation for user input. You should always validate user input before inserting it into your database to prevent SQL injection attacks.", "code_blocks": ["```php\n<?php\n\n// Database Connection\n$servername = \"localhost\";\n$username = \"root\";\n$password = \"\";\n$dbname = \"review_system\";\n\n$conn = new mysqli($servername, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction add_review() {\n    global $conn;\n    \n    if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n        \n        // Get the review data\n        $product_id = $_POST['product_id'];\n        $user_id = $_POST['user_id'];\n        $rating = $_POST['rating'];\n        $review_text = $_POST['review_text'];\n\n        // Check if the product exists in the database\n        $query = \"SELECT * FROM products WHERE id = '$product_id'\";\n        $result = $conn->query($query);\n\n        if ($result->num_rows > 0) {\n            // Add review to database\n            $sql = \"INSERT INTO reviews (user_id, product_id, rating, review_text)\n                    VALUES ('$user_id', '$product_id', '$rating', '$review_text')\";\n            \n            if ($conn->query($sql) === TRUE) {\n                echo \"Review added successfully!\";\n            } else {\n                echo \"Error: \" . $sql . \"<br>\" . $conn->error;\n            }\n        } else {\n            echo \"Product not found.\";\n        }\n    }\n}\n\nfunction get_reviews() {\n    global $conn;\n    \n    // Get reviews for a specific product\n    $product_id = $_GET['product_id'];\n    \n    $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        while($row = $result->fetch_assoc()) {\n            echo \"<h2>Review</h2>\";\n            echo \"Rating: \" . $row['rating'] . \"/5\";\n            echo \"<br>Text: \" . $row['review_text'];\n            echo \"<hr>\";\n        }\n    } else {\n        echo \"No reviews found for this product.\";\n    }\n}\n\nfunction delete_review() {\n    global $conn;\n    \n    if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n        \n        // Get the review id\n        $review_id = $_POST['review_id'];\n        \n        $query = \"DELETE FROM reviews WHERE id = '$review_id'\";\n        \n        if ($conn->query($query) === TRUE) {\n            echo \"Review deleted successfully!\";\n        } else {\n            echo \"Error: \" . $sql . \"<br>\" . $conn->error;\n        }\n    }\n}\n\n?>\n```", "```php\n// add_review.php\n\nadd_review();\n?>\n\n<form action=\"\" method=\"post\">\n    <label>Product ID:</label>\n    <input type=\"text\" name=\"product_id\"><br><br>\n    <label>User ID:</label>\n    <input type=\"text\" name=\"user_id\"><br><br>\n    <label>Rating:</label>\n    <select name=\"rating\">\n        <option value=\"1\">1</option>\n        <option value=\"2\">2</option>\n        <option value=\"3\">3</option>\n        <option value=\"4\">4</option>\n        <option value=\"5\">5</option>\n    </select><br><br>\n    <label>Review:</label>\n    <textarea name=\"review_text\"></textarea><br><br>\n    <input type=\"submit\" value=\"Add Review\">\n</form>\n\n<?php\n// get_reviews.php\n\nget_reviews();\n?>\n\n<form action=\"\" method=\"post\">\n    <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['product_id']; ?>\">\n    <input type=\"submit\" value=\"Delete Review\" onclick=\"return confirm('Are you sure you want to delete this review?')\">\n</form>\n\n<?php\n// delete_review.php\n\ndelete_review();\n?>\n```"]}
