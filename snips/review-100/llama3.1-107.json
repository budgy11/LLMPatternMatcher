{"prompt": "Create a user review function using php", "llm_output": "Here's an example of a basic user review system in PHP. This code will create a simple interface for users to submit reviews, and store them in a database.\n\n**Note:** This is a simplified example and you should adapt it to your needs and ensure proper security measures are taken.\n\n### Database Structure ( MySQL )\n\n```sql\nCREATE TABLE products (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(255),\n  description TEXT\n);\n\nCREATE TABLE reviews (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  product_id INT,\n  user_id INT,\n  rating INT,\n  comment TEXT,\n  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n### PHP Code\n\nCreate a new file called `review.php` and add the following code:\n\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'username');\ndefine('DB_PASSWORD', 'password');\ndefine('DB_NAME', 'database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nclass ReviewSystem {\n\n  // Function to submit a review\n  public function submitReview($productId, $rating, $comment) {\n    if (!empty($_SESSION['user_id'])) {\n      $query = \"INSERT INTO reviews (product_id, user_id, rating, comment)\n                VALUES (?, ?, ?, ?)\";\n      $stmt = $conn->prepare($query);\n      $stmt->bind_param(\"iis\", $productId, $_SESSION['user_id'], $rating, $comment);\n      if ($stmt->execute()) {\n        return true;\n      } else {\n        echo \"Error submitting review: \" . $conn->error;\n        return false;\n      }\n    } else {\n      echo \"You must be logged in to submit a review.\";\n      return false;\n    }\n  }\n\n  // Function to display reviews\n  public function getReviews($productId) {\n    $query = \"SELECT r.id, u.username, r.rating, r.comment, r.created_at\n              FROM reviews r\n              JOIN users u ON r.user_id = u.id\n              WHERE product_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $productId);\n    if ($stmt->execute()) {\n      $result = $stmt->get_result();\n      while ($row = $result->fetch_assoc()) {\n        echo \"<h3>Review by \" . $row['username'] . \"</h3>\";\n        echo \"<p>Rating: \" . $row['rating'] . \"/5</p>\";\n        echo \"<p>Comment: \" . $row['comment'] . \"</p>\";\n        echo \"<p>Created at: \" . $row['created_at'] . \"</p>\";\n      }\n    } else {\n      echo \"Error fetching reviews: \" . $conn->error;\n    }\n  }\n\n}\n\n// Usage example\n$reviewSystem = new ReviewSystem();\n\nif (isset($_POST['submit'])) {\n  $productId = $_POST['product_id'];\n  $rating = $_POST['rating'];\n  $comment = $_POST['comment'];\n\n  if ($reviewSystem->submitReview($productId, $rating, $comment)) {\n    echo \"Review submitted successfully!\";\n  }\n}\n\n?>\n```\n\n### HTML Interface\n\nCreate an HTML file called `index.html` and add the following code:\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Product Reviews</title>\n</head>\n<body>\n\n<h1>Submit a Review</h1>\n\n<form action=\"\" method=\"post\">\n  <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['id']; ?>\">\n  <label for=\"rating\">Rating:</label>\n  <select id=\"rating\" name=\"rating\">\n    <option value=\"1\">1/5</option>\n    <option value=\"2\">2/5</option>\n    <option value=\"3\">3/5</option>\n    <option value=\"4\">4/5</option>\n    <option value=\"5\">5/5</option>\n  </select>\n  <br><br>\n  <label for=\"comment\">Comment:</label>\n  <textarea id=\"comment\" name=\"comment\"></textarea>\n  <br><br>\n  <input type=\"submit\" name=\"submit\" value=\"Submit Review\">\n</form>\n\n<h1>Reviews for <?php echo $_GET['id']; ?></h1>\n\n<?php\nif (isset($_GET['id'])) {\n  $reviewSystem->getReviews($_GET['id']);\n}\n?>\n\n</body>\n</html>\n```\n\nThis code creates a simple user review system, where users can submit reviews for specific products. The reviews are stored in a database and displayed on the same page.\n\nPlease note that this is a basic example and you should adapt it to your needs and ensure proper security measures are taken.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'username');\ndefine('DB_PASSWORD', 'password');\ndefine('DB_NAME', 'database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nclass ReviewSystem {\n\n  // Function to submit a review\n  public function submitReview($productId, $rating, $comment) {\n    if (!empty($_SESSION['user_id'])) {\n      $query = \"INSERT INTO reviews (product_id, user_id, rating, comment)\n                VALUES (?, ?, ?, ?)\";\n      $stmt = $conn->prepare($query);\n      $stmt->bind_param(\"iis\", $productId, $_SESSION['user_id'], $rating, $comment);\n      if ($stmt->execute()) {\n        return true;\n      } else {\n        echo \"Error submitting review: \" . $conn->error;\n        return false;\n      }\n    } else {\n      echo \"You must be logged in to submit a review.\";\n      return false;\n    }\n  }\n\n  // Function to display reviews\n  public function getReviews($productId) {\n    $query = \"SELECT r.id, u.username, r.rating, r.comment, r.created_at\n              FROM reviews r\n              JOIN users u ON r.user_id = u.id\n              WHERE product_id = ?\";\n    $stmt = $conn->prepare($query);\n    $stmt->bind_param(\"i\", $productId);\n    if ($stmt->execute()) {\n      $result = $stmt->get_result();\n      while ($row = $result->fetch_assoc()) {\n        echo \"<h3>Review by \" . $row['username'] . \"</h3>\";\n        echo \"<p>Rating: \" . $row['rating'] . \"/5</p>\";\n        echo \"<p>Comment: \" . $row['comment'] . \"</p>\";\n        echo \"<p>Created at: \" . $row['created_at'] . \"</p>\";\n      }\n    } else {\n      echo \"Error fetching reviews: \" . $conn->error;\n    }\n  }\n\n}\n\n// Usage example\n$reviewSystem = new ReviewSystem();\n\nif (isset($_POST['submit'])) {\n  $productId = $_POST['product_id'];\n  $rating = $_POST['rating'];\n  $comment = $_POST['comment'];\n\n  if ($reviewSystem->submitReview($productId, $rating, $comment)) {\n    echo \"Review submitted successfully!\";\n  }\n}\n\n?>\n```", null]}
