{"prompt": "Create a user review function using php", "llm_output": "**User Review Function in PHP**\n=====================================\n\nThis is an example of a simple user review system implemented in PHP. It includes functions for creating, reading, updating and deleting reviews.\n\n**Database Schema**\n-------------------\n\nAssuming we have a `reviews` table with the following structure:\n\n| Field Name | Data Type |\n| --- | --- |\n| id | int (primary key) |\n| product_id | int |\n| user_id | int |\n| rating | tinyint |\n| review_text | text |\n\n**Code**\n-----\n\n### Review Class\n\n```php\nclass Review {\n    private $db;\n\n    public function __construct() {\n        $this->db = new mysqli('localhost', 'username', 'password', 'database');\n    }\n\n    // Create a new review\n    public function create($product_id, $user_id, $rating, $review_text) {\n        if (!$this->db->query(\"INSERT INTO reviews (product_id, user_id, rating, review_text) VALUES ('$product_id', '$user_id', '$rating', '$review_text')\")) {\n            return false;\n        }\n        return true;\n    }\n\n    // Get all reviews for a product\n    public function getAllReviewsForProduct($product_id) {\n        $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n        $result = $this->db->query($query);\n        while ($row = $result->fetch_assoc()) {\n            $reviews[] = array(\n                'id' => $row['id'],\n                'rating' => $row['rating'],\n                'review_text' => $row['review_text']\n            );\n        }\n        return $reviews;\n    }\n\n    // Get all reviews for a user\n    public function getAllReviewsForUser($user_id) {\n        $query = \"SELECT * FROM reviews WHERE user_id = '$user_id'\";\n        $result = $this->db->query($query);\n        while ($row = $result->fetch_assoc()) {\n            $reviews[] = array(\n                'id' => $row['id'],\n                'rating' => $row['rating'],\n                'review_text' => $row['review_text']\n            );\n        }\n        return $reviews;\n    }\n\n    // Update a review\n    public function update($review_id, $product_id, $user_id, $rating, $review_text) {\n        if (!$this->db->query(\"UPDATE reviews SET product_id = '$product_id', user_id = '$user_id', rating = '$rating', review_text = '$review_text' WHERE id = '$review_id'\")) {\n            return false;\n        }\n        return true;\n    }\n\n    // Delete a review\n    public function delete($review_id) {\n        if (!$this->db->query(\"DELETE FROM reviews WHERE id = '$review_id'\")) {\n            return false;\n        }\n        return true;\n    }\n}\n```\n\n### Example Usage\n\n```php\n$review = new Review();\n\n// Create a new review\n$result = $review->create(1, 1, 5, 'Great product!');\necho var_dump($result); // bool(true)\n\n// Get all reviews for a product\n$reviews = $review->getAllReviewsForProduct(1);\necho '<pre>';\nprint_r($reviews);\necho '</pre>';\n\n// Update a review\n$result = $review->update(1, 2, 2, 4, 'Not bad');\necho var_dump($result); // bool(true)\n\n// Delete a review\n$result = $review->delete(1);\necho var_dump($result); // bool(true)\n```\n\nNote: This is a simplified example and does not include error handling or security measures that you would need in a real-world application.", "code_blocks": ["```php\nclass Review {\n    private $db;\n\n    public function __construct() {\n        $this->db = new mysqli('localhost', 'username', 'password', 'database');\n    }\n\n    // Create a new review\n    public function create($product_id, $user_id, $rating, $review_text) {\n        if (!$this->db->query(\"INSERT INTO reviews (product_id, user_id, rating, review_text) VALUES ('$product_id', '$user_id', '$rating', '$review_text')\")) {\n            return false;\n        }\n        return true;\n    }\n\n    // Get all reviews for a product\n    public function getAllReviewsForProduct($product_id) {\n        $query = \"SELECT * FROM reviews WHERE product_id = '$product_id'\";\n        $result = $this->db->query($query);\n        while ($row = $result->fetch_assoc()) {\n            $reviews[] = array(\n                'id' => $row['id'],\n                'rating' => $row['rating'],\n                'review_text' => $row['review_text']\n            );\n        }\n        return $reviews;\n    }\n\n    // Get all reviews for a user\n    public function getAllReviewsForUser($user_id) {\n        $query = \"SELECT * FROM reviews WHERE user_id = '$user_id'\";\n        $result = $this->db->query($query);\n        while ($row = $result->fetch_assoc()) {\n            $reviews[] = array(\n                'id' => $row['id'],\n                'rating' => $row['rating'],\n                'review_text' => $row['review_text']\n            );\n        }\n        return $reviews;\n    }\n\n    // Update a review\n    public function update($review_id, $product_id, $user_id, $rating, $review_text) {\n        if (!$this->db->query(\"UPDATE reviews SET product_id = '$product_id', user_id = '$user_id', rating = '$rating', review_text = '$review_text' WHERE id = '$review_id'\")) {\n            return false;\n        }\n        return true;\n    }\n\n    // Delete a review\n    public function delete($review_id) {\n        if (!$this->db->query(\"DELETE FROM reviews WHERE id = '$review_id'\")) {\n            return false;\n        }\n        return true;\n    }\n}\n```", "```php\n$review = new Review();\n\n// Create a new review\n$result = $review->create(1, 1, 5, 'Great product!');\necho var_dump($result); // bool(true)\n\n// Get all reviews for a product\n$reviews = $review->getAllReviewsForProduct(1);\necho '<pre>';\nprint_r($reviews);\necho '</pre>';\n\n// Update a review\n$result = $review->update(1, 2, 2, 4, 'Not bad');\necho var_dump($result); // bool(true)\n\n// Delete a review\n$result = $review->delete(1);\necho var_dump($result); // bool(true)\n```"]}
