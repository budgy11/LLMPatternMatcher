{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you can create a user review function using PHP. This will include a form for users to submit reviews, store them in the database, and then display all reviews on a page.\n\n**Database Setup**\n\nFirst, let's assume we have a `reviews` table with the following columns:\n\n- `id` (primary key): An auto-incrementing integer\n- `reviewer_id`: The ID of the user who submitted the review\n- `product_id`: The ID of the product being reviewed\n- `rating`: A rating out of 5 stars\n- `text`: The text content of the review\n\n**PHP Code**\n\n```php\n// Include database connection file\nrequire 'database.php';\n\nfunction displayReviews() {\n    // Query for all reviews from database\n    $query = \"SELECT * FROM reviews\";\n    $reviews = mysqli_query($GLOBALS['db'], $query);\n\n    if (!$reviews) {\n        die('Error: ' . mysqli_error($GLOBALS['db']));\n    }\n\n    echo \"<h1>Product Reviews</h1>\";\n    while ($review = mysqli_fetch_assoc($reviews)) {\n        // Display each review\n        echo '<div>';\n        echo \"Reviewer ID: $review[reviewer_id]\";\n        echo \"<br>\";\n        echo \"Rating: $review[rating] / 5\";\n        echo \"<br>\";\n        echo \"Text: $review[text]\";\n        echo \"</div>\";\n    }\n}\n\nfunction addReview($data) {\n    // Insert new review into database\n    $query = \"INSERT INTO reviews (reviewer_id, product_id, rating, text)\n              VALUES ('\" . $_SESSION['user_id'] . \"', '\" . $_POST['product_id'] . \"', '\".$_POST['rating'].\"','\".$_POST['text'].\"')\";\n    \n    if (!mysqli_query($GLOBALS['db'], $query)) {\n        die('Error: ' . mysqli_error($GLOBALS['db']));\n    }\n}\n\n// Form for submitting reviews\nfunction reviewForm() {\n    echo \"<h1>Submit a Review</h1>\";\n    echo '<form action=\"review.php\" method=\"post\">';\n    echo \"Product ID: <input type='text' name='product_id'><br><br>\";\n    echo \"Rating (out of 5): <input type='number' name='rating' min='0' max='5'><br><br>\";\n    echo \"Text: <textarea name='text'></textarea><br><br>\";\n    echo '<button type=\"submit\">Submit Review</button>';\n    echo '</form>';\n}\n\n// Main script\nif (isset($_POST['product_id'])) {\n    addReview($_POST);\n} else if ($_SERVER[\"REQUEST_METHOD\"] == \"GET\") {\n    reviewForm();\n}\ndisplayReviews();\n```\n\n**index.php**\n\n```php\n// Connect to database\nrequire 'database.php';\n\n// Start session\nsession_start();\n\n// If user is logged in, display product selection page and add option for them to submit reviews\nif ($_SESSION['is_logged_in']) {\n    // Query for all products from database\n    $query = \"SELECT * FROM products\";\n    $products = mysqli_query($GLOBALS['db'], $query);\n\n    echo \"<h1>Products</h1>\";\n    while ($product = mysqli_fetch_assoc($products)) {\n        // Display each product and add link to submit review for logged-in user\n        echo '<div>';\n        echo \"Product ID: $product[id]\";\n        echo \"<br>\";\n        echo \"Name: $product[name]\";\n        echo \"<br>\";\n        echo '<a href=\"review.php?product_id='.$product['id'].'\">Submit Review</a>';\n        echo \"</div>\";\n    }\n}\n```\n\nThis example will allow logged-in users to submit reviews for products. The reviews are stored in the database and can be displayed on a page.\n\nNote that this is a simplified example, you should consider implementing proper validation and security measures (like sanitizing input data and preventing SQL injection) when using user-submitted content in your application.", "code_blocks": ["```php\n// Include database connection file\nrequire 'database.php';\n\nfunction displayReviews() {\n    // Query for all reviews from database\n    $query = \"SELECT * FROM reviews\";\n    $reviews = mysqli_query($GLOBALS['db'], $query);\n\n    if (!$reviews) {\n        die('Error: ' . mysqli_error($GLOBALS['db']));\n    }\n\n    echo \"<h1>Product Reviews</h1>\";\n    while ($review = mysqli_fetch_assoc($reviews)) {\n        // Display each review\n        echo '<div>';\n        echo \"Reviewer ID: $review[reviewer_id]\";\n        echo \"<br>\";\n        echo \"Rating: $review[rating] / 5\";\n        echo \"<br>\";\n        echo \"Text: $review[text]\";\n        echo \"</div>\";\n    }\n}\n\nfunction addReview($data) {\n    // Insert new review into database\n    $query = \"INSERT INTO reviews (reviewer_id, product_id, rating, text)\n              VALUES ('\" . $_SESSION['user_id'] . \"', '\" . $_POST['product_id'] . \"', '\".$_POST['rating'].\"','\".$_POST['text'].\"')\";\n    \n    if (!mysqli_query($GLOBALS['db'], $query)) {\n        die('Error: ' . mysqli_error($GLOBALS['db']));\n    }\n}\n\n// Form for submitting reviews\nfunction reviewForm() {\n    echo \"<h1>Submit a Review</h1>\";\n    echo '<form action=\"review.php\" method=\"post\">';\n    echo \"Product ID: <input type='text' name='product_id'><br><br>\";\n    echo \"Rating (out of 5): <input type='number' name='rating' min='0' max='5'><br><br>\";\n    echo \"Text: <textarea name='text'></textarea><br><br>\";\n    echo '<button type=\"submit\">Submit Review</button>';\n    echo '</form>';\n}\n\n// Main script\nif (isset($_POST['product_id'])) {\n    addReview($_POST);\n} else if ($_SERVER[\"REQUEST_METHOD\"] == \"GET\") {\n    reviewForm();\n}\ndisplayReviews();\n```", "```php\n// Connect to database\nrequire 'database.php';\n\n// Start session\nsession_start();\n\n// If user is logged in, display product selection page and add option for them to submit reviews\nif ($_SESSION['is_logged_in']) {\n    // Query for all products from database\n    $query = \"SELECT * FROM products\";\n    $products = mysqli_query($GLOBALS['db'], $query);\n\n    echo \"<h1>Products</h1>\";\n    while ($product = mysqli_fetch_assoc($products)) {\n        // Display each product and add link to submit review for logged-in user\n        echo '<div>';\n        echo \"Product ID: $product[id]\";\n        echo \"<br>\";\n        echo \"Name: $product[name]\";\n        echo \"<br>\";\n        echo '<a href=\"review.php?product_id='.$product['id'].'\">Submit Review</a>';\n        echo \"</div>\";\n    }\n}\n```"]}
