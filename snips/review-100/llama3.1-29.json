{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you can create a simple user review system using PHP. This system will allow users to add, view and delete reviews.\n\n**Database Structure:**\n\nWe'll use a MySQL database with the following tables:\n\n- `reviews`: stores the reviews\n  - id (primary key)\n  - title\n  - content\n  - rating\n  - date_added\n- `users`: stores the users\n  - id (primary key)\n  - username\n  - email\n\n**PHP Code:**\n\n```php\n// configuration.php\n<?php\n    $servername = \"localhost\";\n    $username = \"your_username\";\n    $password = \"your_password\";\n    $dbname = \"reviews_db\";\n\n    // Create connection\n    $conn = new mysqli($servername, $username, $password, $dbname);\n\n    // Check connection\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n?>\n```\n\n```php\n// functions.php\n<?php\n    include 'configuration.php';\n\n    function add_review($title, $content, $rating) {\n        global $conn;\n\n        // Check if review already exists for the user\n        $query = \"SELECT * FROM reviews WHERE title='$title' AND content='$content'\";\n        $result = $conn->query($query);\n        if ($result->num_rows > 0) {\n            return \"Review already exists.\";\n        }\n\n        // Add new review\n        $sql = \"INSERT INTO reviews (title, content, rating)\n                VALUES ('$title', '$content', $rating)\";\n        if ($conn->query($sql) === TRUE) {\n            echo \"New review created successfully\";\n        } else {\n            return \"Error creating review: \" . $conn->error;\n        }\n    }\n\n    function view_reviews() {\n        global $conn;\n\n        // Get all reviews\n        $sql = \"SELECT * FROM reviews ORDER BY date_added DESC\";\n        $result = $conn->query($sql);\n\n        if ($result->num_rows > 0) {\n            while($row = $result->fetch_assoc()) {\n                echo \"Title: \" . $row[\"title\"] . \"<br>Content: \" . $row[\"content\"]. \"<br>Rating: \" . $row[\"rating\"]. \"<br>Date Added: \" . $row[\"date_added\"]. \"<hr>\";\n            }\n        } else {\n            return \"No reviews available.\";\n        }\n    }\n\n    function delete_review($id) {\n        global $conn;\n\n        // Check if review exists\n        $query = \"SELECT * FROM reviews WHERE id='$id'\";\n        $result = $conn->query($query);\n        if ($result->num_rows > 0) {\n            // Delete review\n            $sql = \"DELETE FROM reviews WHERE id=$id\";\n            if ($conn->query($sql) === TRUE) {\n                return \"Review deleted successfully.\";\n            } else {\n                return \"Error deleting review: \" . $conn->error;\n            }\n        } else {\n            return \"Review does not exist.\";\n        }\n    }\n\n?>\n```\n\n```php\n// index.php (example usage)\n<?php\n    include 'functions.php';\n\n    // Add a new review\n    if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n        $title = $_POST['title'];\n        $content = $_POST['content'];\n        $rating = $_POST['rating'];\n\n        echo add_review($title, $content, $rating);\n    }\n\n    // View all reviews\n    view_reviews();\n\n    // Delete a review by id\n    if (isset($_GET['delete_id'])) {\n        echo delete_review($_GET['delete_id']);\n    }\n?>\n```\n\nIn this code:\n\n1. We have three PHP files: `configuration.php` contains the database connection settings, `functions.php` defines the functions for adding, viewing and deleting reviews, and `index.php` is an example usage of these functions.\n\n2. The `add_review`, `view_reviews`, and `delete_review` functions are used to add a new review, view all existing reviews, and delete a specific review by its id respectively.\n\n3. In the `index.php` file, we demonstrate how to use these functions in a simple web application. When a user submits a form with title, content, and rating, it calls the `add_review` function. After adding the review, it also displays all existing reviews using the `view_reviews` function.\n\nNote that this code does not handle errors or implement security measures like authentication or authorization for users. You should add these features according to your needs.", "code_blocks": ["```php\n// configuration.php\n<?php\n    $servername = \"localhost\";\n    $username = \"your_username\";\n    $password = \"your_password\";\n    $dbname = \"reviews_db\";\n\n    // Create connection\n    $conn = new mysqli($servername, $username, $password, $dbname);\n\n    // Check connection\n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n?>\n```", "```php\n// functions.php\n<?php\n    include 'configuration.php';\n\n    function add_review($title, $content, $rating) {\n        global $conn;\n\n        // Check if review already exists for the user\n        $query = \"SELECT * FROM reviews WHERE title='$title' AND content='$content'\";\n        $result = $conn->query($query);\n        if ($result->num_rows > 0) {\n            return \"Review already exists.\";\n        }\n\n        // Add new review\n        $sql = \"INSERT INTO reviews (title, content, rating)\n                VALUES ('$title', '$content', $rating)\";\n        if ($conn->query($sql) === TRUE) {\n            echo \"New review created successfully\";\n        } else {\n            return \"Error creating review: \" . $conn->error;\n        }\n    }\n\n    function view_reviews() {\n        global $conn;\n\n        // Get all reviews\n        $sql = \"SELECT * FROM reviews ORDER BY date_added DESC\";\n        $result = $conn->query($sql);\n\n        if ($result->num_rows > 0) {\n            while($row = $result->fetch_assoc()) {\n                echo \"Title: \" . $row[\"title\"] . \"<br>Content: \" . $row[\"content\"]. \"<br>Rating: \" . $row[\"rating\"]. \"<br>Date Added: \" . $row[\"date_added\"]. \"<hr>\";\n            }\n        } else {\n            return \"No reviews available.\";\n        }\n    }\n\n    function delete_review($id) {\n        global $conn;\n\n        // Check if review exists\n        $query = \"SELECT * FROM reviews WHERE id='$id'\";\n        $result = $conn->query($query);\n        if ($result->num_rows > 0) {\n            // Delete review\n            $sql = \"DELETE FROM reviews WHERE id=$id\";\n            if ($conn->query($sql) === TRUE) {\n                return \"Review deleted successfully.\";\n            } else {\n                return \"Error deleting review: \" . $conn->error;\n            }\n        } else {\n            return \"Review does not exist.\";\n        }\n    }\n\n?>\n```", "```php\n// index.php (example usage)\n<?php\n    include 'functions.php';\n\n    // Add a new review\n    if ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n        $title = $_POST['title'];\n        $content = $_POST['content'];\n        $rating = $_POST['rating'];\n\n        echo add_review($title, $content, $rating);\n    }\n\n    // View all reviews\n    view_reviews();\n\n    // Delete a review by id\n    if (isset($_GET['delete_id'])) {\n        echo delete_review($_GET['delete_id']);\n    }\n?>\n```"]}
