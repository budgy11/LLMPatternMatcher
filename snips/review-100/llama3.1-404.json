{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you can create a simple user review function in PHP:\n\n**review.php**\n```php\n<?php\n\nclass Review {\n  private $db;\n\n  public function __construct() {\n    $this->db = new mysqli('localhost', 'username', 'password', 'database');\n    if ($this->db->connect_error) {\n      die(\"Connection failed: \" . $this->db->connect_error);\n    }\n  }\n\n  public function addReview($productId, $userId, $rating, $comment) {\n    $sql = \"INSERT INTO reviews (product_id, user_id, rating, comment)\n            VALUES (?, ?, ?, ?)\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"iiss\", $productId, $userId, $rating, $comment);\n    if ($stmt->execute()) {\n      return true;\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n  public function getReviewsForProduct($productId) {\n    $sql = \"SELECT * FROM reviews WHERE product_id = ?\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"i\", $productId);\n    if ($stmt->execute()) {\n      return $stmt->get_result();\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n  public function getReviewsForUser($userId) {\n    $sql = \"SELECT * FROM reviews WHERE user_id = ?\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"i\", $userId);\n    if ($stmt->execute()) {\n      return $stmt->get_result();\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n  public function deleteReview($reviewId) {\n    $sql = \"DELETE FROM reviews WHERE id = ?\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"i\", $reviewId);\n    if ($stmt->execute()) {\n      return true;\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n  public function updateReview($reviewId, $rating, $comment) {\n    $sql = \"UPDATE reviews SET rating = ?, comment = ?\n            WHERE id = ?\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"is\", $rating, $comment, $reviewId);\n    if ($stmt->execute()) {\n      return true;\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n}\n\n?>\n```\n\n**Example usage**\n```php\n$review = new Review();\n\n// Add a review\nif ($review->addReview(1, 1, 5, 'Great product!')) {\n  echo 'Review added successfully!';\n} else {\n  echo 'Error adding review';\n}\n\n// Get reviews for a product\n$results = $review->getReviewsForProduct(1);\nwhile ($row = $results->fetch_assoc()) {\n  echo $row['rating'] . ': ' . $row['comment'];\n}\n\n// Get reviews for a user\n$results = $review->getReviewsForUser(1);\nwhile ($row = $results->fetch_assoc()) {\n  echo $row['product_id'] . ': ' . $row['rating'] . ': ' . $row['comment'];\n}\n\n// Delete a review\nif ($review->deleteReview(1)) {\n  echo 'Review deleted successfully!';\n} else {\n  echo 'Error deleting review';\n}\n\n// Update a review\nif ($review->updateReview(1, 4, 'Good product!')) {\n  echo 'Review updated successfully!';\n} else {\n  echo 'Error updating review';\n}\n```\nThis code defines a `Review` class that encapsulates the database operations for managing reviews. The class has methods for adding, getting, deleting and updating reviews.\n\nThe example usage shows how to use the `Review` class to perform these operations.\n\nNote: This is just an example code and you should adapt it to your specific needs and database schema. Also, make sure to sanitize user input to prevent SQL injection attacks!", "code_blocks": ["```php\n<?php\n\nclass Review {\n  private $db;\n\n  public function __construct() {\n    $this->db = new mysqli('localhost', 'username', 'password', 'database');\n    if ($this->db->connect_error) {\n      die(\"Connection failed: \" . $this->db->connect_error);\n    }\n  }\n\n  public function addReview($productId, $userId, $rating, $comment) {\n    $sql = \"INSERT INTO reviews (product_id, user_id, rating, comment)\n            VALUES (?, ?, ?, ?)\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"iiss\", $productId, $userId, $rating, $comment);\n    if ($stmt->execute()) {\n      return true;\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n  public function getReviewsForProduct($productId) {\n    $sql = \"SELECT * FROM reviews WHERE product_id = ?\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"i\", $productId);\n    if ($stmt->execute()) {\n      return $stmt->get_result();\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n  public function getReviewsForUser($userId) {\n    $sql = \"SELECT * FROM reviews WHERE user_id = ?\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"i\", $userId);\n    if ($stmt->execute()) {\n      return $stmt->get_result();\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n  public function deleteReview($reviewId) {\n    $sql = \"DELETE FROM reviews WHERE id = ?\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"i\", $reviewId);\n    if ($stmt->execute()) {\n      return true;\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n  public function updateReview($reviewId, $rating, $comment) {\n    $sql = \"UPDATE reviews SET rating = ?, comment = ?\n            WHERE id = ?\";\n    $stmt = $this->db->prepare($sql);\n    $stmt->bind_param(\"is\", $rating, $comment, $reviewId);\n    if ($stmt->execute()) {\n      return true;\n    } else {\n      echo \"Error: \" . $stmt->error;\n      return false;\n    }\n  }\n\n}\n\n?>\n```", "```php\n$review = new Review();\n\n// Add a review\nif ($review->addReview(1, 1, 5, 'Great product!')) {\n  echo 'Review added successfully!';\n} else {\n  echo 'Error adding review';\n}\n\n// Get reviews for a product\n$results = $review->getReviewsForProduct(1);\nwhile ($row = $results->fetch_assoc()) {\n  echo $row['rating'] . ': ' . $row['comment'];\n}\n\n// Get reviews for a user\n$results = $review->getReviewsForUser(1);\nwhile ($row = $results->fetch_assoc()) {\n  echo $row['product_id'] . ': ' . $row['rating'] . ': ' . $row['comment'];\n}\n\n// Delete a review\nif ($review->deleteReview(1)) {\n  echo 'Review deleted successfully!';\n} else {\n  echo 'Error deleting review';\n}\n\n// Update a review\nif ($review->updateReview(1, 4, 'Good product!')) {\n  echo 'Review updated successfully!';\n} else {\n  echo 'Error updating review';\n}\n```"]}
