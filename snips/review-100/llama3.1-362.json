{"prompt": "Create a user review function using php", "llm_output": "Here is an example of a simple user review system implemented in PHP. This system includes functions to add, view, edit, and delete reviews.\n\n**Database Schema**\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL UNIQUE\n);\n\nCREATE TABLE products (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  name VARCHAR(255) NOT NULL,\n  description TEXT\n);\n\nCREATE TABLE reviews (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  user_id INT NOT NULL,\n  product_id INT NOT NULL,\n  rating TINYINT NOT NULL CHECK (rating BETWEEN 1 AND 5),\n  comment TEXT NOT NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n**PHP Code**\n```php\n// Connect to the database\n$mysqli = new mysqli('localhost', 'username', 'password', 'database');\n\n// Function to add a review\nfunction add_review($user_id, $product_id, $rating, $comment) {\n  $query = \"INSERT INTO reviews (user_id, product_id, rating, comment) VALUES (?, ?, ?, ?)\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('iiis', $user_id, $product_id, $rating, $comment);\n  if ($stmt->execute()) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Function to view reviews for a product\nfunction get_reviews_for_product($product_id) {\n  $query = \"SELECT * FROM reviews WHERE product_id = ?\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('i', $product_id);\n  $stmt->execute();\n  return $stmt->get_result()->fetch_all(MYSQLI_ASSOC);\n}\n\n// Function to view reviews for a user\nfunction get_reviews_for_user($user_id) {\n  $query = \"SELECT * FROM reviews WHERE user_id = ?\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('i', $user_id);\n  $stmt->execute();\n  return $stmt->get_result()->fetch_all(MYSQLI_ASSOC);\n}\n\n// Function to edit a review\nfunction edit_review($review_id, $rating, $comment) {\n  $query = \"UPDATE reviews SET rating = ?, comment = ? WHERE id = ?\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('iis', $rating, $comment, $review_id);\n  if ($stmt->execute()) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Function to delete a review\nfunction delete_review($review_id) {\n  $query = \"DELETE FROM reviews WHERE id = ?\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('i', $review_id);\n  if ($stmt->execute()) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Example usage:\n$user_id = 1;\n$product_id = 2;\n$rating = 4;\n$comment = 'Great product!';\n\nadd_review($user_id, $product_id, $rating, $comment);\n\n$reviews = get_reviews_for_product($product_id);\nprint_r($reviews);\n\n$review = get_reviews_for_user($user_id)[0];\necho \"Review ID: \" . $review['id'] . \"\\n\";\necho \"Rating: \" . $review['rating'] . \"\\n\";\necho \"Comment: \" . $review['comment'] . \"\\n\";\n\nedit_review($review['id'], 5, 'Excellent product!');\n\ndelete_review($review['id']);\n```\nThis code provides basic CRUD (Create, Read, Update, Delete) functionality for reviews. The `add_review` function adds a new review to the database, while the `get_reviews_for_product` and `get_reviews_for_user` functions retrieve all reviews for a given product or user, respectively. The `edit_review` function updates an existing review, and the `delete_review` function removes a review from the database.\n\nNote that this is just a simple example to illustrate the concept, and you should consider implementing additional features such as validation, error handling, and security measures (e.g., authentication and authorization) in your production code.", "code_blocks": [null, "```php\n// Connect to the database\n$mysqli = new mysqli('localhost', 'username', 'password', 'database');\n\n// Function to add a review\nfunction add_review($user_id, $product_id, $rating, $comment) {\n  $query = \"INSERT INTO reviews (user_id, product_id, rating, comment) VALUES (?, ?, ?, ?)\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('iiis', $user_id, $product_id, $rating, $comment);\n  if ($stmt->execute()) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Function to view reviews for a product\nfunction get_reviews_for_product($product_id) {\n  $query = \"SELECT * FROM reviews WHERE product_id = ?\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('i', $product_id);\n  $stmt->execute();\n  return $stmt->get_result()->fetch_all(MYSQLI_ASSOC);\n}\n\n// Function to view reviews for a user\nfunction get_reviews_for_user($user_id) {\n  $query = \"SELECT * FROM reviews WHERE user_id = ?\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('i', $user_id);\n  $stmt->execute();\n  return $stmt->get_result()->fetch_all(MYSQLI_ASSOC);\n}\n\n// Function to edit a review\nfunction edit_review($review_id, $rating, $comment) {\n  $query = \"UPDATE reviews SET rating = ?, comment = ? WHERE id = ?\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('iis', $rating, $comment, $review_id);\n  if ($stmt->execute()) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Function to delete a review\nfunction delete_review($review_id) {\n  $query = \"DELETE FROM reviews WHERE id = ?\";\n  $stmt = $mysqli->prepare($query);\n  $stmt->bind_param('i', $review_id);\n  if ($stmt->execute()) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\n// Example usage:\n$user_id = 1;\n$product_id = 2;\n$rating = 4;\n$comment = 'Great product!';\n\nadd_review($user_id, $product_id, $rating, $comment);\n\n$reviews = get_reviews_for_product($product_id);\nprint_r($reviews);\n\n$review = get_reviews_for_user($user_id)[0];\necho \"Review ID: \" . $review['id'] . \"\\n\";\necho \"Rating: \" . $review['rating'] . \"\\n\";\necho \"Comment: \" . $review['comment'] . \"\\n\";\n\nedit_review($review['id'], 5, 'Excellent product!');\n\ndelete_review($review['id']);\n```"]}
