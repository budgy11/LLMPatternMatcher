{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you can create a user review system using PHP, including the ability to add, edit and delete reviews.\n\n### Review System Database Structure:\n\n```sql\nCREATE TABLE users (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(255) NOT NULL\n);\n\nCREATE TABLE products (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    title VARCHAR(255) NOT NULL\n);\n\nCREATE TABLE reviews (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    user_id INT NOT NULL,\n    product_id INT NOT NULL,\n    content TEXT NOT NULL,\n    rating TINYINT NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id),\n    FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n### PHP Review System:\n\n```php\n// database connection settings\n$dsn = 'mysql:host=localhost;dbname=reviews';\n$username = 'your_username';\n$password = 'your_password';\n\ntry {\n    $pdo = new PDO($dsn, $username, $password);\n} catch (PDOException $e) {\n    echo 'Connection failed: ' . $e->getMessage();\n}\n\nfunction getReviews() {\n    global $pdo;\n    $stmt = $pdo->prepare('SELECT r.id, u.name as username, p.title as product_title, r.content, r.rating FROM reviews r INNER JOIN users u ON r.user_id = u.id INNER JOIN products p ON r.product_id = p.id');\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction addReview($reviewData) {\n    global $pdo;\n    try {\n        $stmt = $pdo->prepare('INSERT INTO reviews (user_id, product_id, content, rating) VALUES (:user_id, :product_id, :content, :rating)');\n        $stmt->execute([\n            ':user_id' => $reviewData['user_id'],\n            ':product_id' => $reviewData['product_id'],\n            ':content' => $reviewData['content'],\n            ':rating' => $reviewData['rating']\n        ]);\n        return true;\n    } catch (PDOException $e) {\n        echo 'Error adding review: ' . $e->getMessage();\n        return false;\n    }\n}\n\nfunction editReview($reviewId, $newReviewData) {\n    global $pdo;\n    try {\n        $stmt = $pdo->prepare('UPDATE reviews SET user_id = :user_id, product_id = :product_id, content = :content, rating = :rating WHERE id = :id');\n        $stmt->execute([\n            ':user_id' => $newReviewData['user_id'],\n            ':product_id' => $newReviewData['product_id'],\n            ':content' => $newReviewData['content'],\n            ':rating' => $newReviewData['rating'],\n            ':id' => $reviewId\n        ]);\n        return true;\n    } catch (PDOException $e) {\n        echo 'Error editing review: ' . $e->getMessage();\n        return false;\n    }\n}\n\nfunction deleteReview($reviewId) {\n    global $pdo;\n    try {\n        $stmt = $pdo->prepare('DELETE FROM reviews WHERE id = :id');\n        $stmt->execute([':id' => $reviewId]);\n        return true;\n    } catch (PDOException $e) {\n        echo 'Error deleting review: ' . $e->getMessage();\n        return false;\n    }\n}\n\n// Usage:\n\n$reviews = getReviews();\necho '<pre>';\nprint_r($reviews);\necho '</pre>';\n\n$newReviewData = [\n    'user_id' => 1,\n    'product_id' => 1,\n    'content' => 'This is a great product!',\n    'rating' => 5\n];\nif (addReview($newReviewData)) {\n    echo \"Review added successfully!\";\n}\n\n$editedReviewData = [\n    'user_id' => 1,\n    'product_id' => 2,\n    'content' => 'This is an even better product!',\n    'rating' => 6\n];\nif (editReview(1, $editedReviewData)) {\n    echo \"Review edited successfully!\";\n}\n\nif (deleteReview(1)) {\n    echo \"Review deleted successfully!\";\n}\n```\n\nNote: Replace `'mysql:host=localhost;dbname=reviews'`, `'your_username'` and `'your_password'` with your actual database connection settings.", "code_blocks": [null, "```php\n// database connection settings\n$dsn = 'mysql:host=localhost;dbname=reviews';\n$username = 'your_username';\n$password = 'your_password';\n\ntry {\n    $pdo = new PDO($dsn, $username, $password);\n} catch (PDOException $e) {\n    echo 'Connection failed: ' . $e->getMessage();\n}\n\nfunction getReviews() {\n    global $pdo;\n    $stmt = $pdo->prepare('SELECT r.id, u.name as username, p.title as product_title, r.content, r.rating FROM reviews r INNER JOIN users u ON r.user_id = u.id INNER JOIN products p ON r.product_id = p.id');\n    $stmt->execute();\n    return $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction addReview($reviewData) {\n    global $pdo;\n    try {\n        $stmt = $pdo->prepare('INSERT INTO reviews (user_id, product_id, content, rating) VALUES (:user_id, :product_id, :content, :rating)');\n        $stmt->execute([\n            ':user_id' => $reviewData['user_id'],\n            ':product_id' => $reviewData['product_id'],\n            ':content' => $reviewData['content'],\n            ':rating' => $reviewData['rating']\n        ]);\n        return true;\n    } catch (PDOException $e) {\n        echo 'Error adding review: ' . $e->getMessage();\n        return false;\n    }\n}\n\nfunction editReview($reviewId, $newReviewData) {\n    global $pdo;\n    try {\n        $stmt = $pdo->prepare('UPDATE reviews SET user_id = :user_id, product_id = :product_id, content = :content, rating = :rating WHERE id = :id');\n        $stmt->execute([\n            ':user_id' => $newReviewData['user_id'],\n            ':product_id' => $newReviewData['product_id'],\n            ':content' => $newReviewData['content'],\n            ':rating' => $newReviewData['rating'],\n            ':id' => $reviewId\n        ]);\n        return true;\n    } catch (PDOException $e) {\n        echo 'Error editing review: ' . $e->getMessage();\n        return false;\n    }\n}\n\nfunction deleteReview($reviewId) {\n    global $pdo;\n    try {\n        $stmt = $pdo->prepare('DELETE FROM reviews WHERE id = :id');\n        $stmt->execute([':id' => $reviewId]);\n        return true;\n    } catch (PDOException $e) {\n        echo 'Error deleting review: ' . $e->getMessage();\n        return false;\n    }\n}\n\n// Usage:\n\n$reviews = getReviews();\necho '<pre>';\nprint_r($reviews);\necho '</pre>';\n\n$newReviewData = [\n    'user_id' => 1,\n    'product_id' => 1,\n    'content' => 'This is a great product!',\n    'rating' => 5\n];\nif (addReview($newReviewData)) {\n    echo \"Review added successfully!\";\n}\n\n$editedReviewData = [\n    'user_id' => 1,\n    'product_id' => 2,\n    'content' => 'This is an even better product!',\n    'rating' => 6\n];\nif (editReview(1, $editedReviewData)) {\n    echo \"Review edited successfully!\";\n}\n\nif (deleteReview(1)) {\n    echo \"Review deleted successfully!\";\n}\n```"]}
