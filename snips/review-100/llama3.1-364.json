{"prompt": "Create a user review function using php", "llm_output": "Here is an example of a simple user review system in PHP:\n\n**Database Schema**\n\nFirst, let's define the database schema for our reviews table:\n```sql\nCREATE TABLE reviews (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  title VARCHAR(255),\n  content TEXT,\n  rating TINYINT(1) CHECK (rating >= 1 AND rating <= 5),\n  user_id INT,\n  product_id INT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n**PHP Code**\n\nNow, let's create a PHP function to handle user reviews:\n```php\nfunction add_review($title, $content, $rating, $product_id, $user_id) {\n  // Create a new review in the database\n  $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n  $stmt = $db->prepare(\"INSERT INTO reviews (title, content, rating, product_id, user_id) VALUES (?, ?, ?, ?, ?)\");\n  $stmt->execute(array($title, $content, $rating, $product_id, $user_id));\n  return $db->lastInsertId();\n}\n\nfunction get_reviews($product_id = null) {\n  // Retrieve reviews from the database\n  if ($product_id === null) {\n    $reviews = array();\n    $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n    $stmt = $db->query(\"SELECT * FROM reviews\");\n    while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {\n      $review = array(\n        'id' => $row['id'],\n        'title' => $row['title'],\n        'content' => $row['content'],\n        'rating' => $row['rating'],\n        'user_id' => $row['user_id'],\n        'product_id' => $row['product_id']\n      );\n      array_push($reviews, $review);\n    }\n  } else {\n    $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n    $stmt = $db->query(\"SELECT * FROM reviews WHERE product_id = ?\", array($product_id));\n    while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {\n      $review = array(\n        'id' => $row['id'],\n        'title' => $row['title'],\n        'content' => $row['content'],\n        'rating' => $row['rating'],\n        'user_id' => $row['user_id'],\n        'product_id' => $row['product_id']\n      );\n      array_push($reviews, $review);\n    }\n  }\n  return $reviews;\n}\n\nfunction delete_review($review_id) {\n  // Delete a review from the database\n  $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n  $stmt = $db->prepare(\"DELETE FROM reviews WHERE id = ?\");\n  $stmt->execute(array($review_id));\n}\n\nfunction update_review($review_id, $title, $content, $rating) {\n  // Update a review in the database\n  $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n  $stmt = $db->prepare(\"UPDATE reviews SET title = ?, content = ?, rating = ? WHERE id = ?\");\n  $stmt->execute(array($title, $content, $rating, $review_id));\n}\n```\n**Usage**\n\nHere's an example of how to use the `add_review` function:\n```php\n$title = \"My review\";\n$content = \"This is a great product!\";\n$rating = 5;\n$product_id = 1;\n$user_id = 1;\n\n$review_id = add_review($title, $content, $rating, $product_id, $user_id);\necho \"Review created with ID: $review_id\";\n```\nAnd here's an example of how to use the `get_reviews` function:\n```php\n$product_id = 1;\n$reviews = get_reviews($product_id);\n\nforeach ($reviews as $review) {\n  echo \"Title: $review[title]\\n\";\n  echo \"Content: $review[content]\\n\";\n  echo \"Rating: $review[rating]/5\\n\";\n}\n```\nNote that this is a very basic example and you may want to add additional functionality such as authentication, validation, and error handling.", "code_blocks": [null, "```php\nfunction add_review($title, $content, $rating, $product_id, $user_id) {\n  // Create a new review in the database\n  $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n  $stmt = $db->prepare(\"INSERT INTO reviews (title, content, rating, product_id, user_id) VALUES (?, ?, ?, ?, ?)\");\n  $stmt->execute(array($title, $content, $rating, $product_id, $user_id));\n  return $db->lastInsertId();\n}\n\nfunction get_reviews($product_id = null) {\n  // Retrieve reviews from the database\n  if ($product_id === null) {\n    $reviews = array();\n    $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n    $stmt = $db->query(\"SELECT * FROM reviews\");\n    while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {\n      $review = array(\n        'id' => $row['id'],\n        'title' => $row['title'],\n        'content' => $row['content'],\n        'rating' => $row['rating'],\n        'user_id' => $row['user_id'],\n        'product_id' => $row['product_id']\n      );\n      array_push($reviews, $review);\n    }\n  } else {\n    $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n    $stmt = $db->query(\"SELECT * FROM reviews WHERE product_id = ?\", array($product_id));\n    while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {\n      $review = array(\n        'id' => $row['id'],\n        'title' => $row['title'],\n        'content' => $row['content'],\n        'rating' => $row['rating'],\n        'user_id' => $row['user_id'],\n        'product_id' => $row['product_id']\n      );\n      array_push($reviews, $review);\n    }\n  }\n  return $reviews;\n}\n\nfunction delete_review($review_id) {\n  // Delete a review from the database\n  $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n  $stmt = $db->prepare(\"DELETE FROM reviews WHERE id = ?\");\n  $stmt->execute(array($review_id));\n}\n\nfunction update_review($review_id, $title, $content, $rating) {\n  // Update a review in the database\n  $db = new PDO('mysql:host=localhost;dbname=your_database', 'your_username', 'your_password');\n  $stmt = $db->prepare(\"UPDATE reviews SET title = ?, content = ?, rating = ? WHERE id = ?\");\n  $stmt->execute(array($title, $content, $rating, $review_id));\n}\n```", "```php\n$title = \"My review\";\n$content = \"This is a great product!\";\n$rating = 5;\n$product_id = 1;\n$user_id = 1;\n\n$review_id = add_review($title, $content, $rating, $product_id, $user_id);\necho \"Review created with ID: $review_id\";\n```", "```php\n$product_id = 1;\n$reviews = get_reviews($product_id);\n\nforeach ($reviews as $review) {\n  echo \"Title: $review[title]\\n\";\n  echo \"Content: $review[content]\\n\";\n  echo \"Rating: $review[rating]/5\\n\";\n}\n```"]}
