{"prompt": "Create a user review function using php", "llm_output": "Here's an example of how you can create a simple user review system using PHP:\n\n**Database Schema:**\n\nFirst, let's assume we have the following database schema for our review system:\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY,\n  username VARCHAR(255),\n  password VARCHAR(255)\n);\n\nCREATE TABLE reviews (\n  id INT PRIMARY KEY,\n  user_id INT,\n  product_name VARCHAR(255),\n  rating TINYINT,\n  review TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n```\n**PHP Code:**\n\nCreate a new PHP file (e.g. `review.php`) and add the following code:\n```php\n// Include database connection settings\nrequire 'db_connection.php';\n\n// Function to display all reviews\nfunction display_reviews() {\n  $sql = \"SELECT * FROM reviews ORDER BY created_at DESC\";\n  $result = mysqli_query($conn, $sql);\n  while ($review = mysqli_fetch_assoc($result)) {\n    echo '<div class=\"review\">';\n    echo '<h2>' . $review['product_name'] . '</h2>';\n    echo '<p>Rating: ' . $review['rating'] . '/5</p>';\n    echo '<p>' . substr($review['review'], 0, 200) . '...</p>';\n    echo '<p>Posted by ' . get_user_name($review['user_id']) . '</p>';\n    echo '</div>';\n  }\n}\n\n// Function to display user reviews\nfunction display_user_reviews($user_id) {\n  $sql = \"SELECT * FROM reviews WHERE user_id = '$user_id' ORDER BY created_at DESC\";\n  $result = mysqli_query($conn, $sql);\n  while ($review = mysqli_fetch_assoc($result)) {\n    echo '<div class=\"review\">';\n    echo '<h2>' . $review['product_name'] . '</h2>';\n    echo '<p>Rating: ' . $review['rating'] . '/5</p>';\n    echo '<p>' . substr($review['review'], 0, 200) . '...</p>';\n    echo '<p>Posted by ' . get_user_name($review['user_id']) . '</p>';\n    echo '</div>';\n  }\n}\n\n// Function to add a new review\nfunction add_review($product_name, $rating, $review, $user_id) {\n  $sql = \"INSERT INTO reviews (product_name, rating, review, user_id) VALUES ('$product_name', '$rating', '$review', '$user_id')\";\n  if (mysqli_query($conn, $sql)) {\n    echo 'Review added successfully!';\n  } else {\n    echo 'Error adding review: ' . mysqli_error($conn);\n  }\n}\n\n// Function to get the name of a user\nfunction get_user_name($user_id) {\n  $sql = \"SELECT username FROM users WHERE id = '$user_id'\";\n  $result = mysqli_query($conn, $sql);\n  return mysqli_fetch_assoc($result)['username'];\n}\n```\n**Example Usage:**\n\nTo display all reviews:\n```php\n<?php display_reviews(); ?>\n```\nTo display user reviews (e.g. for a specific user):\n```php\n<?php display_user_reviews(1); // Replace 1 with the desired user ID ?>\n```\nTo add a new review:\n```php\n<?php add_review('Product Name', 4, 'This is a great product!', 2); // Replace values with your own ?>\n```\nNote that this is just a basic example and you should consider implementing proper validation, security measures (e.g. escaping user input), and error handling for a production-ready application.\n\nAlso, make sure to replace the placeholders (`db_connection.php`, `product_name`, etc.) with actual values for your database connection settings and application logic.", "code_blocks": [null, "```php\n// Include database connection settings\nrequire 'db_connection.php';\n\n// Function to display all reviews\nfunction display_reviews() {\n  $sql = \"SELECT * FROM reviews ORDER BY created_at DESC\";\n  $result = mysqli_query($conn, $sql);\n  while ($review = mysqli_fetch_assoc($result)) {\n    echo '<div class=\"review\">';\n    echo '<h2>' . $review['product_name'] . '</h2>';\n    echo '<p>Rating: ' . $review['rating'] . '/5</p>';\n    echo '<p>' . substr($review['review'], 0, 200) . '...</p>';\n    echo '<p>Posted by ' . get_user_name($review['user_id']) . '</p>';\n    echo '</div>';\n  }\n}\n\n// Function to display user reviews\nfunction display_user_reviews($user_id) {\n  $sql = \"SELECT * FROM reviews WHERE user_id = '$user_id' ORDER BY created_at DESC\";\n  $result = mysqli_query($conn, $sql);\n  while ($review = mysqli_fetch_assoc($result)) {\n    echo '<div class=\"review\">';\n    echo '<h2>' . $review['product_name'] . '</h2>';\n    echo '<p>Rating: ' . $review['rating'] . '/5</p>';\n    echo '<p>' . substr($review['review'], 0, 200) . '...</p>';\n    echo '<p>Posted by ' . get_user_name($review['user_id']) . '</p>';\n    echo '</div>';\n  }\n}\n\n// Function to add a new review\nfunction add_review($product_name, $rating, $review, $user_id) {\n  $sql = \"INSERT INTO reviews (product_name, rating, review, user_id) VALUES ('$product_name', '$rating', '$review', '$user_id')\";\n  if (mysqli_query($conn, $sql)) {\n    echo 'Review added successfully!';\n  } else {\n    echo 'Error adding review: ' . mysqli_error($conn);\n  }\n}\n\n// Function to get the name of a user\nfunction get_user_name($user_id) {\n  $sql = \"SELECT username FROM users WHERE id = '$user_id'\";\n  $result = mysqli_query($conn, $sql);\n  return mysqli_fetch_assoc($result)['username'];\n}\n```", "```php\n<?php display_reviews(); ?>\n```", "```php\n<?php display_user_reviews(1); // Replace 1 with the desired user ID ?>\n```", "```php\n<?php add_review('Product Name', 4, 'This is a great product!', 2); // Replace values with your own ?>\n```"]}
