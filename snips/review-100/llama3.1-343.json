{"prompt": "Create a user review function using php", "llm_output": "**User Review Function in PHP**\n=====================================\n\nThis example demonstrates how to create a simple user review system using PHP, HTML, and MySQL. We will store the reviews in a database and display them on a webpage.\n\n**Database Schema**\n--------------------\n\nWe need a table to store the reviews. Create a new table called `reviews` with the following columns:\n\n```sql\nCREATE TABLE reviews (\n  id INT AUTO_INCREMENT,\n  user_id INT,\n  review TEXT,\n  rating TINYINT(1) UNSIGNED,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  PRIMARY KEY (id)\n);\n```\n\n**PHP Code**\n-------------\n\nCreate a new file called `review.php` and add the following code:\n\n```php\n<?php\n\n// Database connection settings\n$host = 'localhost';\n$dbname = 'your_database_name';\n$username = 'your_username';\n$password = 'your_password';\n\n// Connect to database\n$conn = new mysqli($host, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to display reviews\nfunction displayReviews() {\n  global $conn;\n  \n  // Query to retrieve reviews from database\n  $query = \"SELECT * FROM reviews ORDER BY created_at DESC\";\n  $result = $conn->query($query);\n  \n  if ($result->num_rows > 0) {\n    while($row = $result->fetch_assoc()) {\n      echo \"<p>\" . $row[\"review\"] . \"</p>\";\n      echo \"<small>Rating: \" . $row[\"rating\"] . \"/5</small><br>\";\n      echo \"<small>Posted by User ID \" . $row[\"user_id\"] . \"</small><br>\";\n    }\n  } else {\n    echo \"No reviews yet!\";\n  }\n}\n\n// Function to add a new review\nfunction addReview($review, $rating) {\n  global $conn;\n  \n  // Insert new review into database\n  $query = \"INSERT INTO reviews (review, rating) VALUES ('$review', '$rating')\";\n  if ($conn->query($query)) {\n    echo \"Review added successfully!\";\n  } else {\n    echo \"Error adding review: \" . $conn->error;\n  }\n}\n\n// Display form to add a new review\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"review\">Write your review:</label>\n  <textarea id=\"review\" name=\"review\"></textarea><br>\n  <label for=\"rating\">Rating (1-5):</label>\n  <input type=\"number\" id=\"rating\" name=\"rating\" min=\"1\" max=\"5\"><br>\n  <button type=\"submit\" name=\"submit\">Submit Review</button>\n</form>\n\n<?php\nif (isset($_POST['submit'])) {\n  addReview($_POST['review'], $_POST['rating']);\n}\n\ndisplayReviews();\n\n// Close database connection\n$conn->close();\n?>\n```\n\n**HTML**\n------\n\nThis code assumes you're using a basic HTML template with the PHP code injected into it.\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Reviews</title>\n</head>\n<body>\n  <?php include 'review.php'; ?>\n</body>\n</html>\n```\n\n**Example Use Cases**\n----------------------\n\nTo add a new review:\n\n*   Fill in the form with your review and rating.\n*   Click the \"Submit Review\" button.\n\nTo display reviews:\n\n*   Visit the webpage with the PHP code included.\n*   The reviews will be displayed below the form, sorted by most recent first.", "code_blocks": [null, "```php\n<?php\n\n// Database connection settings\n$host = 'localhost';\n$dbname = 'your_database_name';\n$username = 'your_username';\n$password = 'your_password';\n\n// Connect to database\n$conn = new mysqli($host, $username, $password, $dbname);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to display reviews\nfunction displayReviews() {\n  global $conn;\n  \n  // Query to retrieve reviews from database\n  $query = \"SELECT * FROM reviews ORDER BY created_at DESC\";\n  $result = $conn->query($query);\n  \n  if ($result->num_rows > 0) {\n    while($row = $result->fetch_assoc()) {\n      echo \"<p>\" . $row[\"review\"] . \"</p>\";\n      echo \"<small>Rating: \" . $row[\"rating\"] . \"/5</small><br>\";\n      echo \"<small>Posted by User ID \" . $row[\"user_id\"] . \"</small><br>\";\n    }\n  } else {\n    echo \"No reviews yet!\";\n  }\n}\n\n// Function to add a new review\nfunction addReview($review, $rating) {\n  global $conn;\n  \n  // Insert new review into database\n  $query = \"INSERT INTO reviews (review, rating) VALUES ('$review', '$rating')\";\n  if ($conn->query($query)) {\n    echo \"Review added successfully!\";\n  } else {\n    echo \"Error adding review: \" . $conn->error;\n  }\n}\n\n// Display form to add a new review\n?>\n<form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n  <label for=\"review\">Write your review:</label>\n  <textarea id=\"review\" name=\"review\"></textarea><br>\n  <label for=\"rating\">Rating (1-5):</label>\n  <input type=\"number\" id=\"rating\" name=\"rating\" min=\"1\" max=\"5\"><br>\n  <button type=\"submit\" name=\"submit\">Submit Review</button>\n</form>\n\n<?php\nif (isset($_POST['submit'])) {\n  addReview($_POST['review'], $_POST['rating']);\n}\n\ndisplayReviews();\n\n// Close database connection\n$conn->close();\n?>\n```", null]}
