{"prompt": "Create a user login function using php", "llm_output": "Here is an example of a simple user login function in PHP:\n\n**login.php**\n```php\n<?php\n\n// Configuration variables\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to check user credentials\nfunction login_user($username, $password) {\n    global $conn;\n    \n    // SQL query to select user data\n    $sql = \"SELECT * FROM users WHERE username = '$username' AND password = '$password'\";\n    \n    // Execute query and get result\n    $result = $conn->query($sql);\n    \n    if ($result->num_rows > 0) {\n        // User found, return true\n        return true;\n    } else {\n        // User not found, return false\n        return false;\n    }\n}\n\n// Function to login user and create session\nfunction do_login($username, $password) {\n    global $conn;\n    \n    // Check if user credentials are valid\n    if (login_user($username, $password)) {\n        // Get user data from database\n        $sql = \"SELECT * FROM users WHERE username = '$username'\";\n        $result = $conn->query($sql);\n        \n        // Fetch user data as an array\n        $user_data = $result->fetch_assoc();\n        \n        // Create session variables\n        $_SESSION['username'] = $user_data['username'];\n        $_SESSION['email'] = $user_data['email'];\n        $_SESSION['role'] = $user_data['role'];\n        \n        // Redirect to protected page\n        header('Location: protected_page.php');\n        exit();\n    } else {\n        // Invalid credentials, display error message\n        echo \"Invalid username or password\";\n    }\n}\n\n?>\n```\n**login_form.html**\n```html\n<form action=\"login.php\" method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Login\">\n</form>\n```\n**protected_page.php**\n```php\n<?php\n// Check if user is logged in\nif (!isset($_SESSION['username'])) {\n    header('Location: login_form.html');\n    exit();\n}\n\n// Display protected page content\necho \"Welcome, \" . $_SESSION['username'] . \"!\";\n\n?>\n```\nThis code defines two functions:\n\n1. `login_user($username, $password)`: checks if user credentials are valid by executing a SQL query to select the user data from the database.\n2. `do_login($username, $password)`: logs in the user and creates session variables by checking if user credentials are valid.\n\nThe `login_form.html` file contains a simple form that submits the username and password to the `login.php` file. The `protected_page.php` file checks if the user is logged in before displaying protected page content.\n\nNote: This code uses a simple `mysqli` connection, which is not secure for production use. You should consider using prepared statements or an ORM library to protect against SQL injection attacks. Additionally, this example assumes that you have already set up a database with a table called \"users\" containing the user data.", "code_blocks": ["```php\n<?php\n\n// Configuration variables\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to check user credentials\nfunction login_user($username, $password) {\n    global $conn;\n    \n    // SQL query to select user data\n    $sql = \"SELECT * FROM users WHERE username = '$username' AND password = '$password'\";\n    \n    // Execute query and get result\n    $result = $conn->query($sql);\n    \n    if ($result->num_rows > 0) {\n        // User found, return true\n        return true;\n    } else {\n        // User not found, return false\n        return false;\n    }\n}\n\n// Function to login user and create session\nfunction do_login($username, $password) {\n    global $conn;\n    \n    // Check if user credentials are valid\n    if (login_user($username, $password)) {\n        // Get user data from database\n        $sql = \"SELECT * FROM users WHERE username = '$username'\";\n        $result = $conn->query($sql);\n        \n        // Fetch user data as an array\n        $user_data = $result->fetch_assoc();\n        \n        // Create session variables\n        $_SESSION['username'] = $user_data['username'];\n        $_SESSION['email'] = $user_data['email'];\n        $_SESSION['role'] = $user_data['role'];\n        \n        // Redirect to protected page\n        header('Location: protected_page.php');\n        exit();\n    } else {\n        // Invalid credentials, display error message\n        echo \"Invalid username or password\";\n    }\n}\n\n?>\n```", null, "```php\n<?php\n// Check if user is logged in\nif (!isset($_SESSION['username'])) {\n    header('Location: login_form.html');\n    exit();\n}\n\n// Display protected page content\necho \"Welcome, \" . $_SESSION['username'] . \"!\";\n\n?>\n```"]}
