{"prompt": "Create a user login function using php", "llm_output": "Here is an example of a basic user login function in PHP:\n\n**login.php**\n```php\n<?php\n\n// Configuration settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to the database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to validate user credentials\nfunction login_user($username, $password) {\n    // SQL query to retrieve user data from the database\n    $sql = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        // Retrieve user data from the result set\n        $user_data = $result->fetch_assoc();\n\n        // Verify password using SHA-256 hash\n        $password_hash = sha1($password);\n        if ($password_hash == $user_data['password']) {\n            // Login successful, return user data\n            return array('username' => $username, 'email' => $user_data['email'], 'role' => $user_data['role']);\n        } else {\n            echo \"Invalid password\";\n        }\n    } else {\n        echo \"User not found\";\n    }\n\n    return false;\n}\n\n// Handle POST request from the login form\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Retrieve username and password from the $_POST array\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Call the login_user function to authenticate user credentials\n    $user_data = login_user($username, $password);\n\n    if ($user_data) {\n        // Login successful, redirect to a protected page or dashboard\n        header('Location: protected-page.php');\n        exit;\n    } else {\n        // Login failed, display an error message\n        echo \"Login failed\";\n    }\n}\n\n?>\n```\n**login_form.html**\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Login Form</title>\n</head>\n<body>\n    <form action=\"login.php\" method=\"post\">\n        <label>Username:</label>\n        <input type=\"text\" name=\"username\"><br><br>\n        <label>Password:</label>\n        <input type=\"password\" name=\"password\"><br><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n</body>\n</html>\n```\n**How it works:**\n\n1. The user submits the login form, which sends a POST request to the `login.php` script.\n2. The script retrieves the username and password from the `$_POST` array using PHP superglobal variables.\n3. The `login_user` function is called with the retrieved username and password as arguments.\n4. The function attempts to retrieve user data from the database using a SQL query.\n5. If the user data is found, the function verifies the password using SHA-256 hash comparison.\n6. If the login credentials are valid, the function returns an array containing user data (username, email, and role).\n7. If the login fails, the script displays an error message.\n\n**Note:**\n\n* This example uses a simple SHA-256 hash for password storage, which is not recommended in production environments due to security concerns.\n* In a real-world application, you should use a secure password hashing algorithm like bcrypt or Argon2.\n* The database connection settings are hardcoded for simplicity; in a production environment, consider using a configuration file or an environment variable for security reasons.", "code_blocks": ["```php\n<?php\n\n// Configuration settings\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to the database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to validate user credentials\nfunction login_user($username, $password) {\n    // SQL query to retrieve user data from the database\n    $sql = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $conn->query($sql);\n\n    if ($result->num_rows > 0) {\n        // Retrieve user data from the result set\n        $user_data = $result->fetch_assoc();\n\n        // Verify password using SHA-256 hash\n        $password_hash = sha1($password);\n        if ($password_hash == $user_data['password']) {\n            // Login successful, return user data\n            return array('username' => $username, 'email' => $user_data['email'], 'role' => $user_data['role']);\n        } else {\n            echo \"Invalid password\";\n        }\n    } else {\n        echo \"User not found\";\n    }\n\n    return false;\n}\n\n// Handle POST request from the login form\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    // Retrieve username and password from the $_POST array\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Call the login_user function to authenticate user credentials\n    $user_data = login_user($username, $password);\n\n    if ($user_data) {\n        // Login successful, redirect to a protected page or dashboard\n        header('Location: protected-page.php');\n        exit;\n    } else {\n        // Login failed, display an error message\n        echo \"Login failed\";\n    }\n}\n\n?>\n```", null]}
