{"prompt": "Create a user login function using php", "llm_output": "**User Login Function in PHP**\n=====================================\n\nBelow is an example of a basic user login function in PHP. This example includes input validation and password hashing for security.\n\n### Configuration File (config.php)\n```php\n<?php\n\n// Database configuration\n$host = 'localhost';\n$dbname = 'your_database_name';\n$username = 'your_username';\n$password = 'your_password';\n\n// Create a connection to the database\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n\n?>\n```\n### User Login Function (login.php)\n```php\n<?php\n\nrequire_once 'config.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n\n    // Input validation\n    if (!empty($_POST['username']) && !empty($_POST['password'])) {\n        $username = $_POST['username'];\n        $password = $_POST['password'];\n\n        // Hash the password for comparison with stored hash\n        $hashedPassword = hash('sha256', $password);\n\n        try {\n            // SQL query to retrieve user data from database\n            $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = :username\");\n            $stmt->bindParam(':username', $username);\n            $stmt->execute();\n\n            // Fetch and store user data\n            $userData = $stmt->fetch(PDO::FETCH_ASSOC);\n\n            if ($userData) {\n                // Compare hashed password with stored hash\n                if ($hashedPassword === $userData['password']) {\n                    $_SESSION['username'] = $username;\n                    header('Location: dashboard.php');\n                    exit();\n                } else {\n                    echo 'Incorrect password';\n                }\n            } else {\n                echo 'User not found';\n            }\n\n        } catch (PDOException $e) {\n            die('Database error: ' . $e->getMessage());\n        }\n\n    } else {\n        echo 'Please enter both username and password';\n    }\n\n} else {\n    // Display login form\n    ?>\n\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br><br>\n        Password: <input type=\"password\" name=\"password\"><br><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n\n    <?php\n}\n?>\n```\n### Explanation\n\n1. The `config.php` file includes the database connection settings.\n2. In `login.php`, we first check if the form has been submitted using `$_SERVER['REQUEST_METHOD']`.\n3. If the form has been submitted, we perform input validation to ensure that both username and password are provided.\n4. We hash the provided password for comparison with the stored hash in the database.\n5. We execute an SQL query to retrieve user data from the database based on the provided username.\n6. If a match is found, we compare the hashed password with the stored hash.\n7. If both passwords match, we start a session and redirect the user to `dashboard.php`.\n8. Otherwise, we display error messages for incorrect password or user not found.\n\n**Security Notes**\n\n* Passwords should be stored in a secure manner (e.g., using bcrypt).\n* Always validate user input to prevent SQL injection attacks.\n* Use prepared statements to prevent SQL injection attacks.\n\nThis code is a basic example and may require modifications based on your specific requirements. Additionally, it's essential to follow best practices for password storage and security.", "code_blocks": ["```php\n<?php\n\n// Database configuration\n$host = 'localhost';\n$dbname = 'your_database_name';\n$username = 'your_username';\n$password = 'your_password';\n\n// Create a connection to the database\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $username, $password);\n\n?>\n```", "```php\n<?php\n\nrequire_once 'config.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n\n    // Input validation\n    if (!empty($_POST['username']) && !empty($_POST['password'])) {\n        $username = $_POST['username'];\n        $password = $_POST['password'];\n\n        // Hash the password for comparison with stored hash\n        $hashedPassword = hash('sha256', $password);\n\n        try {\n            // SQL query to retrieve user data from database\n            $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = :username\");\n            $stmt->bindParam(':username', $username);\n            $stmt->execute();\n\n            // Fetch and store user data\n            $userData = $stmt->fetch(PDO::FETCH_ASSOC);\n\n            if ($userData) {\n                // Compare hashed password with stored hash\n                if ($hashedPassword === $userData['password']) {\n                    $_SESSION['username'] = $username;\n                    header('Location: dashboard.php');\n                    exit();\n                } else {\n                    echo 'Incorrect password';\n                }\n            } else {\n                echo 'User not found';\n            }\n\n        } catch (PDOException $e) {\n            die('Database error: ' . $e->getMessage());\n        }\n\n    } else {\n        echo 'Please enter both username and password';\n    }\n\n} else {\n    // Display login form\n    ?>\n\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br><br>\n        Password: <input type=\"password\" name=\"password\"><br><br>\n        <input type=\"submit\" value=\"Login\">\n    </form>\n\n    <?php\n}\n?>\n```"]}
