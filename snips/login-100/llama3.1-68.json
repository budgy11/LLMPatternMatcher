{"prompt": "Create a user login function using php", "llm_output": "**User Login Function in PHP**\n=====================================\n\nThis is a basic example of a user login function using PHP. It includes functionality for validating the username and password, as well as hashing and verifying passwords.\n\n**login.php**\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to hash password\nfunction hashPassword($password) {\n    return password_hash($password, PASSWORD_DEFAULT);\n}\n\n// Function to verify password\nfunction verifyPassword($hashedPassword, $providedPassword) {\n    return password_verify($providedPassword, $hashedPassword);\n}\n\n// Function to login user\nfunction loginUser($username, $password) {\n    // Prepare query\n    $stmt = $conn->prepare(\"SELECT id, username, hashed_password FROM users WHERE username = ?\");\n\n    // Bind parameters\n    $stmt->bind_param(\"s\", $username);\n\n    // Execute query\n    $stmt->execute();\n\n    // Get result\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // Fetch row\n        $row = $result->fetch_assoc();\n\n        // Verify password\n        if (verifyPassword($row['hashed_password'], $password)) {\n            return true;\n        } else {\n            echo \"Invalid username or password\";\n        }\n    } else {\n        echo \"Username not found\";\n    }\n\n    return false;\n}\n\n// Login user\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (loginUser($username, $password)) {\n        // User logged in successfully\n        echo \"Welcome, \" . $username;\n    }\n}\n\n// Close connection\n$conn->close();\n\n?>\n```\n**Explanation**\n\nThis code defines a `loginUser` function that takes a username and password as input. It connects to the database using MySQLi, prepares a query to select the user's hashed password from the database, binds the username parameter, executes the query, and verifies the provided password against the stored hash.\n\nIf the login is successful, it outputs a welcome message with the username. Otherwise, it displays an error message.\n\n**Example Use Case**\n\nTo use this function, you would create a form in your HTML file to collect the user's input:\n```html\n<form action=\"login.php\" method=\"post\">\n    <input type=\"text\" name=\"username\" placeholder=\"Username\">\n    <input type=\"password\" name=\"password\" placeholder=\"Password\">\n    <button type=\"submit\">Login</button>\n</form>\n```\nWhen the form is submitted, it will call the `loginUser` function and attempt to log in the user. If successful, it will display a welcome message.\n\n**Security Notes**\n\n* This code uses prepared statements with parameter binding to prevent SQL injection.\n* It uses PHP's built-in password hashing and verification functions (`password_hash()` and `password_verify()`) to securely store and verify passwords.\n* You should replace `'your_host'`, `'your_username'`, `'your_password'`, and `'your_database'` with your actual database connection details.", "code_blocks": ["```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'your_host');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to hash password\nfunction hashPassword($password) {\n    return password_hash($password, PASSWORD_DEFAULT);\n}\n\n// Function to verify password\nfunction verifyPassword($hashedPassword, $providedPassword) {\n    return password_verify($providedPassword, $hashedPassword);\n}\n\n// Function to login user\nfunction loginUser($username, $password) {\n    // Prepare query\n    $stmt = $conn->prepare(\"SELECT id, username, hashed_password FROM users WHERE username = ?\");\n\n    // Bind parameters\n    $stmt->bind_param(\"s\", $username);\n\n    // Execute query\n    $stmt->execute();\n\n    // Get result\n    $result = $stmt->get_result();\n\n    if ($result->num_rows > 0) {\n        // Fetch row\n        $row = $result->fetch_assoc();\n\n        // Verify password\n        if (verifyPassword($row['hashed_password'], $password)) {\n            return true;\n        } else {\n            echo \"Invalid username or password\";\n        }\n    } else {\n        echo \"Username not found\";\n    }\n\n    return false;\n}\n\n// Login user\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (loginUser($username, $password)) {\n        // User logged in successfully\n        echo \"Welcome, \" . $username;\n    }\n}\n\n// Close connection\n$conn->close();\n\n?>\n```", null]}
