{"prompt": "Create a user login function using php", "llm_output": "Here is an example of a basic user login function using PHP:\n\n**login.php**\n```php\n<?php\n\n// Configuration variables\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to the database\n$conn = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Function to check if a user exists in the database\nfunction checkUserExists($username, $password) {\n    global $conn;\n\n    // Prepare and execute query\n    $stmt = mysqli_prepare($conn, \"SELECT * FROM users WHERE username = ?\");\n    mysqli_stmt_bind_param($stmt, \"s\", $username);\n    mysqli_stmt_execute($stmt);\n\n    // Get the result\n    $result = mysqli_stmt_get_result($stmt);\n\n    if (mysqli_num_rows($result) > 0) {\n        // If a row is found, check the password\n        while ($row = mysqli_fetch_assoc($result)) {\n            if (password_verify($password, $row['password'])) {\n                return true;\n            }\n        }\n    }\n\n    // If no rows are found or password does not match\n    return false;\n}\n\n// Function to log in a user\nfunction loginUser($username, $password) {\n    global $conn;\n\n    // Check if the username and password combination is valid\n    if (checkUserExists($username, $password)) {\n        // If valid, set a session variable to indicate that the user is logged in\n        $_SESSION['logged_in'] = true;\n        $_SESSION['username'] = $username;\n\n        return true;\n    } else {\n        return false;\n    }\n}\n\n// Check if the user has submitted the login form\nif (isset($_POST['login'])) {\n    // Get the username and password from the form\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Login the user\n    if (loginUser($username, $password)) {\n        echo \"Welcome, \" . $_SESSION['username'] . \"! You are now logged in.\";\n    } else {\n        echo \"Invalid username or password.\";\n    }\n}\n\n// Close the database connection\nmysqli_close($conn);\n\n?>\n```\n**form.html**\n```html\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Login Form</title>\n</head>\n<body>\n\n<form action=\"login.php\" method=\"post\">\n    <label for=\"username\">Username:</label><br>\n    <input type=\"text\" id=\"username\" name=\"username\"><br>\n    <label for=\"password\">Password:</label><br>\n    <input type=\"password\" id=\"password\" name=\"password\"><br>\n    <input type=\"submit\" value=\"Login\" name=\"login\">\n</form>\n\n<?php\n// If the user is already logged in, display a message and prevent login form from being displayed\nif (isset($_SESSION['logged_in'])) {\n    echo \"You are already logged in.\";\n} else {\n    // Display the login form\n}\n?>\n\n</body>\n</html>\n```\nThis code uses PHP's built-in `mysqli` extension to connect to a MySQL database, and stores user credentials in the database. The `checkUserExists()` function checks if a username exists in the database and if the password matches. If both conditions are met, it sets a session variable to indicate that the user is logged in.\n\n**Note:**\n\n* This code uses a simple password hashing scheme using `password_verify()`. In production environments, consider using more secure methods like bcrypt.\n* Always validate user input data before processing or storing it in the database.\n* Store sensitive data (like passwords) securely by hashing and salting them.", "code_blocks": ["```php\n<?php\n\n// Configuration variables\ndefine('DB_HOST', 'localhost');\ndefine('DB_USER', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to the database\n$conn = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);\n\nif (!$conn) {\n    die(\"Connection failed: \" . mysqli_connect_error());\n}\n\n// Function to check if a user exists in the database\nfunction checkUserExists($username, $password) {\n    global $conn;\n\n    // Prepare and execute query\n    $stmt = mysqli_prepare($conn, \"SELECT * FROM users WHERE username = ?\");\n    mysqli_stmt_bind_param($stmt, \"s\", $username);\n    mysqli_stmt_execute($stmt);\n\n    // Get the result\n    $result = mysqli_stmt_get_result($stmt);\n\n    if (mysqli_num_rows($result) > 0) {\n        // If a row is found, check the password\n        while ($row = mysqli_fetch_assoc($result)) {\n            if (password_verify($password, $row['password'])) {\n                return true;\n            }\n        }\n    }\n\n    // If no rows are found or password does not match\n    return false;\n}\n\n// Function to log in a user\nfunction loginUser($username, $password) {\n    global $conn;\n\n    // Check if the username and password combination is valid\n    if (checkUserExists($username, $password)) {\n        // If valid, set a session variable to indicate that the user is logged in\n        $_SESSION['logged_in'] = true;\n        $_SESSION['username'] = $username;\n\n        return true;\n    } else {\n        return false;\n    }\n}\n\n// Check if the user has submitted the login form\nif (isset($_POST['login'])) {\n    // Get the username and password from the form\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Login the user\n    if (loginUser($username, $password)) {\n        echo \"Welcome, \" . $_SESSION['username'] . \"! You are now logged in.\";\n    } else {\n        echo \"Invalid username or password.\";\n    }\n}\n\n// Close the database connection\nmysqli_close($conn);\n\n?>\n```", null]}
