{"prompt": "Create a user login function using php", "llm_output": "Here's an example of a basic user login function using PHP:\n\n**login.php**\n```php\n<?php\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction login_user($username, $password) {\n    // Hash password for comparison (using bcrypt)\n    $hashed_password = hash('sha256', $password);\n\n    // Query database to retrieve user data\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // Retrieve the row from the result\n        $row = $result->fetch_assoc();\n\n        // Compare hashed password with stored hash\n        if (hash('sha256', $row['password']) == $hashed_password) {\n            // User authenticated successfully\n            return true;\n        } else {\n            echo \"Incorrect password\";\n            return false;\n        }\n    } else {\n        echo \"User not found\";\n        return false;\n    }\n\n    // Close database connection\n    $conn->close();\n}\n\n// Example usage:\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (login_user($username, $password)) {\n        echo \"Login successful!\";\n        // Redirect user to dashboard or other secure page\n        header('Location: dashboard.php');\n        exit();\n    } else {\n        echo \"Login failed\";\n    }\n}\n\n?>\n```\nThis script uses the following:\n\n1. **MySQLi** extension for database interactions (you can use **PDO** if you prefer).\n2. **Bcrypt** hashing for password storage (using the `hash()` function with a SHA-256 hash).\n\n**Important notes:**\n\n* This is a basic example and should not be used in production without proper error handling, security measures, and user authentication techniques.\n* Store passwords securely using bcrypt or a more modern algorithm like Argon2.\n* Use prepared statements to prevent SQL injection attacks.\n\nAlso, consider implementing additional features such as:\n\n1. **Error handling**: Properly handle errors and exceptions during database connections and queries.\n2. **Input validation**: Validate user input (e.g., username and password) to ensure they match expected formats.\n3. **Rate limiting**: Limit login attempts to prevent brute-force attacks.\n\nRemember, security is a continuous process; stay up-to-date with the latest best practices and adapt this code as needed for your specific application.", "code_blocks": ["```php\n<?php\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\nfunction login_user($username, $password) {\n    // Hash password for comparison (using bcrypt)\n    $hashed_password = hash('sha256', $password);\n\n    // Query database to retrieve user data\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // Retrieve the row from the result\n        $row = $result->fetch_assoc();\n\n        // Compare hashed password with stored hash\n        if (hash('sha256', $row['password']) == $hashed_password) {\n            // User authenticated successfully\n            return true;\n        } else {\n            echo \"Incorrect password\";\n            return false;\n        }\n    } else {\n        echo \"User not found\";\n        return false;\n    }\n\n    // Close database connection\n    $conn->close();\n}\n\n// Example usage:\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (login_user($username, $password)) {\n        echo \"Login successful!\";\n        // Redirect user to dashboard or other secure page\n        header('Location: dashboard.php');\n        exit();\n    } else {\n        echo \"Login failed\";\n    }\n}\n\n?>\n```"]}
