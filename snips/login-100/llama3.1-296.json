{"prompt": "Create a user login function using php", "llm_output": "Here's an example of a simple user login function in PHP. This example uses a combination of HTML and PHP to create the login form, validate user input, and connect to a database to verify the user credentials.\n\n**Note:** For this example, I'll be assuming you're connecting to a MySQL database using the mysqli extension. If you're using PDO or another extension, the code will need to be adjusted accordingly.\n\n### Database Setup\n\nFirst, let's create a table in our database to store users:\n\n```sql\nCREATE TABLE users (\n  id INT AUTO_INCREMENT,\n  username VARCHAR(255) NOT NULL UNIQUE,\n  password VARCHAR(255) NOT NULL,\n  PRIMARY KEY (id)\n);\n```\n\n**PHP Code**\n\nCreate a new file called `login.php` and add the following code:\n\n```php\n<?php\n\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif (!$conn) {\n  die(\"Connection failed: \" . mysqli_connect_error());\n}\n\nfunction login_user() {\n  global $conn;\n\n  if (isset($_POST['username']) && isset($_POST['password'])) {\n\n    // Get user input\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Query to select the user from database\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = mysqli_query($conn, $query);\n\n    if (mysqli_num_rows($result) > 0) {\n      while ($row = mysqli_fetch_assoc($result)) {\n        if (password_verify($password, $row['password'])) {\n\n          // Login successful\n          $_SESSION['logged_in'] = true;\n          $_SESSION['username'] = $username;\n\n          header('Location: dashboard.php');\n          exit();\n        }\n      }\n    } else {\n      echo 'Invalid username or password.';\n    }\n  }\n}\n\nif (isset($_POST['login'])) {\n  login_user();\n}\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Login</title>\n</head>\n<body>\n\n<form action=\"\" method=\"post\">\n  <label>Username:</label><br>\n  <input type=\"text\" name=\"username\"><br>\n  <label>Password:</label><br>\n  <input type=\"password\" name=\"password\"><br>\n  <button type=\"submit\" name=\"login\">Login</button>\n</form>\n\n</body>\n</html>\n```\n\n**What's happening in this code:**\n\n1. We establish a connection to the database.\n2. The `login_user` function checks if the user has submitted their login credentials and then queries the database for a matching username and password.\n3. If a match is found, it verifies the password using `password_verify`.\n4. If verification succeeds, it logs the user in by setting session variables.\n\n**Note:**\n\n* This example uses `password_verify` to verify passwords securely. In production environments, consider hashing your stored passwords with `password_hash` instead of storing plain text.\n* Always validate and sanitize your input data to prevent SQL injection attacks.\n* Use HTTPS (SSL/TLS) for secure communication between the client's web browser and your server.\n\n**Next Steps:**\n\n1. Create a file called `dashboard.php` as your landing page after logging in.\n2. Set up user authentication with other features like registration, forgot password, etc.\n3. Implement session management using PHP to persist login sessions across multiple requests.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'your_database';\n\n// Connect to database\n$conn = mysqli_connect($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif (!$conn) {\n  die(\"Connection failed: \" . mysqli_connect_error());\n}\n\nfunction login_user() {\n  global $conn;\n\n  if (isset($_POST['username']) && isset($_POST['password'])) {\n\n    // Get user input\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Query to select the user from database\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = mysqli_query($conn, $query);\n\n    if (mysqli_num_rows($result) > 0) {\n      while ($row = mysqli_fetch_assoc($result)) {\n        if (password_verify($password, $row['password'])) {\n\n          // Login successful\n          $_SESSION['logged_in'] = true;\n          $_SESSION['username'] = $username;\n\n          header('Location: dashboard.php');\n          exit();\n        }\n      }\n    } else {\n      echo 'Invalid username or password.';\n    }\n  }\n}\n\nif (isset($_POST['login'])) {\n  login_user();\n}\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n  <title>Login</title>\n</head>\n<body>\n\n<form action=\"\" method=\"post\">\n  <label>Username:</label><br>\n  <input type=\"text\" name=\"username\"><br>\n  <label>Password:</label><br>\n  <input type=\"password\" name=\"password\"><br>\n  <button type=\"submit\" name=\"login\">Login</button>\n</form>\n\n</body>\n</html>\n```"]}
