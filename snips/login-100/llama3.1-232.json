{"prompt": "Create a user login function using php", "llm_output": "Here's an example of a simple user login function in PHP:\n\n**users table structure (assuming MySQL database):**\n\n```sql\nCREATE TABLE users (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  username VARCHAR(255) NOT NULL,\n  password VARCHAR(255) NOT NULL,\n  email VARCHAR(255) NOT NULL\n);\n```\n\n**login.php file:**\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'root');\ndefine('DB_PASSWORD', '');\ndefine('DB_NAME', 'database_name');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to hash password (using SHA-256)\nfunction hash_password($password) {\n    return sha256($password);\n}\n\n// Function to check user login\nfunction check_login($username, $password) {\n    // Query users table for matching username and hashed password\n    $query = \"SELECT * FROM users WHERE username = '$username' AND password = '\" . hash_password($password) . \"'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        return true; // Login successful\n    } else {\n        return false; // Login failed\n    }\n}\n\n// User login function\nfunction user_login() {\n    // Get POST data from login form\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Check if user credentials are valid\n    if (check_login($username, $password)) {\n        session_start();\n        $_SESSION['username'] = $username;\n        header('Location: dashboard.php');\n        exit();\n    } else {\n        echo \"Invalid username or password.\";\n    }\n}\n\n// Run the login function when this script is executed\nif (isset($_POST['login'])) {\n    user_login();\n} else {\n    // Display a login form if not submitted yet\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Log In</title>\n</head>\n<body>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br><br>\n        Password: <input type=\"password\" name=\"password\"><br><br>\n        <input type=\"submit\" name=\"login\" value=\"Log In\">\n    </form>\n\n<?php\n}\n?>\n```\nHere's a breakdown of what this code does:\n\n1. **Connects** to the database using MySQLi.\n2. **Hashes passwords** (using SHA-256) and stores them in the `password` column of the `users` table.\n3. Defines two functions:\n\t* `check_login`: Queries the `users` table for a matching username and hashed password. Returns `true` if found, `false` otherwise.\n\t* `user_login`: Runs when the user submits the login form. It gets the POST data from the form, checks if the credentials are valid using `check_login`, and logs in the user by starting a session and redirecting to a dashboard page (`dashboard.php`) if successful.\n4. Finally, it displays a simple login form if not submitted yet.\n\nNote that this is a very basic example. In practice, you should consider:\n* Storing passwords securely (e.g., using bcrypt or Argon2)\n* Validating user input\n* Preventing SQL injection attacks\n* Improving the login experience with features like password recovery and account linking", "code_blocks": [null, "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'root');\ndefine('DB_PASSWORD', '');\ndefine('DB_NAME', 'database_name');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to hash password (using SHA-256)\nfunction hash_password($password) {\n    return sha256($password);\n}\n\n// Function to check user login\nfunction check_login($username, $password) {\n    // Query users table for matching username and hashed password\n    $query = \"SELECT * FROM users WHERE username = '$username' AND password = '\" . hash_password($password) . \"'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        return true; // Login successful\n    } else {\n        return false; // Login failed\n    }\n}\n\n// User login function\nfunction user_login() {\n    // Get POST data from login form\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Check if user credentials are valid\n    if (check_login($username, $password)) {\n        session_start();\n        $_SESSION['username'] = $username;\n        header('Location: dashboard.php');\n        exit();\n    } else {\n        echo \"Invalid username or password.\";\n    }\n}\n\n// Run the login function when this script is executed\nif (isset($_POST['login'])) {\n    user_login();\n} else {\n    // Display a login form if not submitted yet\n?>\n\n<!DOCTYPE html>\n<html>\n<head>\n    <title>Log In</title>\n</head>\n<body>\n    <form action=\"<?php echo $_SERVER['PHP_SELF']; ?>\" method=\"post\">\n        Username: <input type=\"text\" name=\"username\"><br><br>\n        Password: <input type=\"password\" name=\"password\"><br><br>\n        <input type=\"submit\" name=\"login\" value=\"Log In\">\n    </form>\n\n<?php\n}\n?>\n```"]}
