{"prompt": "Create a user login function using php", "llm_output": "**User Login Function in PHP**\n=====================================\n\nThis example demonstrates a basic user login function using PHP, utilizing prepared statements for security.\n\n### database.php\n```php\n<?php\n\n// Database configuration\n$host = 'localhost';\n$dbname = 'users_database';\n$user = 'your_username';\n$password = 'your_password';\n\n// Connect to the database\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $user, $password);\n\n?>\n```\n\n### login.php\n```php\n<?php\n\nrequire_once 'database.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get user input\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Prepare and execute SQL query\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = :username\");\n    $stmt->bindParam(':username', $username);\n    $stmt->execute();\n\n    // Fetch result\n    $user = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    if ($user) {\n        // Hashed password comparison (using a library like bcrypt)\n        require_once 'password.php';\n        if (verify_password($password, $user['password'])) {\n            // User authenticated successfully\n            session_start();\n            $_SESSION['username'] = $username;\n            header('Location: index.php');\n            exit;\n        } else {\n            echo \"Incorrect password\";\n        }\n    } else {\n        echo \"User not found\";\n    }\n\n} else {\n    // Display login form\n?>\n\n<form method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Login\">\n</form>\n\n<?php\n}\n?>\n```\n\n### password.php\n```php\n<?php\n\nfunction verify_password($password, $hash) {\n    // Bcrypt library implementation\n    require_once 'vendor/autoload.php';\n    use Benschmidt\\Bcrypt\\Bcrypt;\n\n    return (new Bcrypt())->verify($password, $hash);\n}\n\n?>\n```\n\n### Explanation\n\n1. The `database.php` file connects to the database using PDO.\n2. The `login.php` file checks if the user has submitted a form request (`$_SERVER['REQUEST_METHOD'] == 'POST'`). If so:\n\t* Retrieves the username and password from the input fields.\n\t* Prepares an SQL query to select the user's data based on their username.\n\t* Executes the query using prepared statements for security.\n\t* Fetches the result, which should be a single row if the user exists in the database.\n3. If the user is found:\n\t* Compares the input password with the stored hashed password using the `verify_password` function (bcrypt library).\n\t* If the passwords match, starts a session and redirects to the index page.\n\n**Note:**\n\n* This example assumes you're storing hashed passwords in your database. Make sure to use a secure hashing algorithm like bcrypt.\n* You'll need to modify the code to fit your specific database schema and requirements.\n* Always validate user input to prevent SQL injection attacks!", "code_blocks": ["```php\n<?php\n\n// Database configuration\n$host = 'localhost';\n$dbname = 'users_database';\n$user = 'your_username';\n$password = 'your_password';\n\n// Connect to the database\n$conn = new PDO(\"mysql:host=$host;dbname=$dbname\", $user, $password);\n\n?>\n```", "```php\n<?php\n\nrequire_once 'database.php';\n\nif ($_SERVER['REQUEST_METHOD'] == 'POST') {\n    // Get user input\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    // Prepare and execute SQL query\n    $stmt = $conn->prepare(\"SELECT * FROM users WHERE username = :username\");\n    $stmt->bindParam(':username', $username);\n    $stmt->execute();\n\n    // Fetch result\n    $user = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    if ($user) {\n        // Hashed password comparison (using a library like bcrypt)\n        require_once 'password.php';\n        if (verify_password($password, $user['password'])) {\n            // User authenticated successfully\n            session_start();\n            $_SESSION['username'] = $username;\n            header('Location: index.php');\n            exit;\n        } else {\n            echo \"Incorrect password\";\n        }\n    } else {\n        echo \"User not found\";\n    }\n\n} else {\n    // Display login form\n?>\n\n<form method=\"post\">\n    <label>Username:</label>\n    <input type=\"text\" name=\"username\"><br><br>\n    <label>Password:</label>\n    <input type=\"password\" name=\"password\"><br><br>\n    <input type=\"submit\" value=\"Login\">\n</form>\n\n<?php\n}\n?>\n```", "```php\n<?php\n\nfunction verify_password($password, $hash) {\n    // Bcrypt library implementation\n    require_once 'vendor/autoload.php';\n    use Benschmidt\\Bcrypt\\Bcrypt;\n\n    return (new Bcrypt())->verify($password, $hash);\n}\n\n?>\n```"]}
