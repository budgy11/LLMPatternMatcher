{"prompt": "Create a user login function using php", "llm_output": "Here is an example of a basic user login function in PHP:\n\n**`login.php`**\n```php\n<?php\n\n// Configuration settings\n$database_host = 'localhost';\n$database_username = 'your_username';\n$database_password = 'your_password';\n$database_name = 'your_database';\n\n// Connect to the database\n$mysqli = new mysqli($database_host, $database_username, $database_password, $database_name);\n\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n    exit();\n}\n\n// Function to check user credentials\nfunction login_user($username, $password) {\n    global $mysqli;\n\n    // Prepare query to retrieve user data\n    $query = 'SELECT * FROM users WHERE username = ? AND password = ?';\n\n    // Bind parameters\n    $stmt = $mysqli->prepare($query);\n    $stmt->bind_param('ss', $username, $password);\n\n    // Execute query and get result\n    $result = $stmt->execute();\n    $user_data = $stmt->get_result()->fetch_assoc();\n\n    if ($result && $user_data) {\n        return true; // User found\n    } else {\n        return false; // User not found or incorrect credentials\n    }\n}\n\n// Function to login user and set session variables\nfunction do_login($username, $password) {\n    global $mysqli;\n\n    // Check user credentials\n    if (login_user($username, $password)) {\n        // Get user data from database\n        $query = 'SELECT * FROM users WHERE username = ?';\n        $stmt = $mysqli->prepare($query);\n        $stmt->bind_param('s', $username);\n        $result = $stmt->execute();\n        $user_data = $stmt->get_result()->fetch_assoc();\n\n        // Set session variables\n        $_SESSION['username'] = $username;\n        $_SESSION['id'] = $user_data['id'];\n        $_SESSION['email'] = $user_data['email'];\n\n        return true; // Login successful\n    } else {\n        return false; // Login failed\n    }\n}\n\n// Example usage:\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (do_login($username, $password)) {\n        echo \"Login successful! You are now logged in.\";\n    } else {\n        echo \"Invalid username or password.\";\n    }\n}\n\n?>\n```\n**Explanation:**\n\nThis code uses the `mysqli` extension to connect to a MySQL database. The `login_user()` function takes two parameters (`$username` and `$password`) and returns `true` if the user is found in the database with the correct credentials, or `false` otherwise.\n\nThe `do_login()` function calls `login_user()` and sets session variables (`$_SESSION['username']`, etc.) if the login is successful. It also retrieves the user's data from the database using a prepared statement.\n\nIn the example usage section, we show how to call these functions with POST variables sent from an HTML form (not shown here). When the login is successful, it sets session variables and prints a success message; otherwise, it displays an error message.\n\n**Note:** This code uses `mysqli` extension for database connectivity. For security reasons, always use prepared statements and bind parameters instead of concatenating user input into SQL queries.\n\nAlso, this example does not handle errors in case the session is already set or something goes wrong during login process. You should add proper error handling to make it more robust.\n\nPlease let me know if you have any questions or need further assistance!", "code_blocks": ["```php\n<?php\n\n// Configuration settings\n$database_host = 'localhost';\n$database_username = 'your_username';\n$database_password = 'your_password';\n$database_name = 'your_database';\n\n// Connect to the database\n$mysqli = new mysqli($database_host, $database_username, $database_password, $database_name);\n\nif ($mysqli->connect_errno) {\n    echo \"Failed to connect to MySQL: (\" . $mysqli->connect_errno . \") \" . $mysqli->connect_error;\n    exit();\n}\n\n// Function to check user credentials\nfunction login_user($username, $password) {\n    global $mysqli;\n\n    // Prepare query to retrieve user data\n    $query = 'SELECT * FROM users WHERE username = ? AND password = ?';\n\n    // Bind parameters\n    $stmt = $mysqli->prepare($query);\n    $stmt->bind_param('ss', $username, $password);\n\n    // Execute query and get result\n    $result = $stmt->execute();\n    $user_data = $stmt->get_result()->fetch_assoc();\n\n    if ($result && $user_data) {\n        return true; // User found\n    } else {\n        return false; // User not found or incorrect credentials\n    }\n}\n\n// Function to login user and set session variables\nfunction do_login($username, $password) {\n    global $mysqli;\n\n    // Check user credentials\n    if (login_user($username, $password)) {\n        // Get user data from database\n        $query = 'SELECT * FROM users WHERE username = ?';\n        $stmt = $mysqli->prepare($query);\n        $stmt->bind_param('s', $username);\n        $result = $stmt->execute();\n        $user_data = $stmt->get_result()->fetch_assoc();\n\n        // Set session variables\n        $_SESSION['username'] = $username;\n        $_SESSION['id'] = $user_data['id'];\n        $_SESSION['email'] = $user_data['email'];\n\n        return true; // Login successful\n    } else {\n        return false; // Login failed\n    }\n}\n\n// Example usage:\nif (isset($_POST['username']) && isset($_POST['password'])) {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (do_login($username, $password)) {\n        echo \"Login successful! You are now logged in.\";\n    } else {\n        echo \"Invalid username or password.\";\n    }\n}\n\n?>\n```"]}
