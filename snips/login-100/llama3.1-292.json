{"prompt": "Create a user login function using php", "llm_output": "**User Login Function in PHP**\n=====================================\n\nThis code snippet provides a basic implementation of a user login function in PHP. It includes input validation, password hashing, and database interaction.\n\n**Database Setup**\n\nFor this example, we'll assume you have a MySQL database with the following schema:\n```sql\nCREATE TABLE users (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    username VARCHAR(255) NOT NULL,\n    password_hash VARCHAR(255) NOT NULL,\n    email VARCHAR(255) NOT NULL\n);\n```\n**login.php**\n```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to hash password\nfunction hashPassword($password) {\n    return password_hash($password, PASSWORD_DEFAULT);\n}\n\n// Login function\nfunction login($username, $password) {\n    // Check if username exists in database\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // Fetch user data\n        $user_data = $result->fetch_assoc();\n\n        // Verify password\n        if (password_verify($password, $user_data['password_hash'])) {\n            return true; // Password matches, login successful\n        } else {\n            return false; // Password does not match\n        }\n    } else {\n        return false; // Username not found in database\n    }\n}\n\n// Main logic\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (empty($username) || empty($password)) {\n        echo 'Please fill in both username and password.';\n    } else {\n        $login_result = login($username, $password);\n\n        if ($login_result) {\n            // Login successful, redirect to dashboard\n            header('Location: dashboard.php');\n            exit;\n        } else {\n            echo 'Invalid username or password.';\n        }\n    }\n}\n\n?>\n```\n**Usage**\n\n1. Save the above code in a file named `login.php`.\n2. Create a HTML form with input fields for username and password.\n3. Set up the database connection using your own credentials.\n4. When the user submits the login form, call the `login()` function with their username and password as arguments.\n\n**Security Notes**\n\n* Always use prepared statements to prevent SQL injection attacks.\n* Use a secure password hashing algorithm like bcrypt (PHP's default).\n* Never store plaintext passwords in the database.\n\nExample HTML Form:\n```html\n<form action=\"login.php\" method=\"post\">\n    <input type=\"text\" name=\"username\" placeholder=\"Username\">\n    <input type=\"password\" name=\"password\" placeholder=\"Password\">\n    <button type=\"submit\">Login</button>\n</form>\n```\nRemember to replace the `dashboard.php` file with your own dashboard script or redirect to a protected area of your website.", "code_blocks": [null, "```php\n<?php\n\n// Configuration\ndefine('DB_HOST', 'localhost');\ndefine('DB_USERNAME', 'your_username');\ndefine('DB_PASSWORD', 'your_password');\ndefine('DB_NAME', 'your_database_name');\n\n// Connect to database\n$conn = new mysqli(DB_HOST, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to hash password\nfunction hashPassword($password) {\n    return password_hash($password, PASSWORD_DEFAULT);\n}\n\n// Login function\nfunction login($username, $password) {\n    // Check if username exists in database\n    $query = \"SELECT * FROM users WHERE username = '$username'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // Fetch user data\n        $user_data = $result->fetch_assoc();\n\n        // Verify password\n        if (password_verify($password, $user_data['password_hash'])) {\n            return true; // Password matches, login successful\n        } else {\n            return false; // Password does not match\n        }\n    } else {\n        return false; // Username not found in database\n    }\n}\n\n// Main logic\nif ($_SERVER[\"REQUEST_METHOD\"] == \"POST\") {\n    $username = $_POST['username'];\n    $password = $_POST['password'];\n\n    if (empty($username) || empty($password)) {\n        echo 'Please fill in both username and password.';\n    } else {\n        $login_result = login($username, $password);\n\n        if ($login_result) {\n            // Login successful, redirect to dashboard\n            header('Location: dashboard.php');\n            exit;\n        } else {\n            echo 'Invalid username or password.';\n        }\n    }\n}\n\n?>\n```", null]}
