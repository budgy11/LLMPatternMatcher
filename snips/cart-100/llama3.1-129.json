{"prompt": "Create a user cart session using php", "llm_output": "Here's an example of how to create a simple user cart system in PHP, including functionality for adding products to the cart and viewing the contents of the cart.\n\n**Step 1: Create database tables**\n\nFirst, you'll need to create two tables in your database: `products` and `cart`. The `products` table will store information about each product, while the `cart` table will store a user's current selection.\n\n```sql\nCREATE TABLE products (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(255) NOT NULL,\n    price DECIMAL(10, 2)\n);\n\nCREATE TABLE cart (\n    id INT PRIMARY KEY AUTO_INCREMENT,\n    user_id INT NOT NULL,\n    product_id INT NOT NULL,\n    quantity INT NOT NULL,\n    FOREIGN KEY (user_id) REFERENCES users(id),\n    FOREIGN KEY (product_id) REFERENCES products(id)\n);\n```\n\n**Step 2: Create PHP functions**\n\nCreate a new file called `cart.php` and add the following code:\n\n```php\n// Configuration settings\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'your_database';\n\n// Establish database connection\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product to cart\nfunction addToCart($productId, $quantity) {\n    global $conn;\n\n    // Check if product exists in database\n    $query = \"SELECT * FROM products WHERE id = '$productId'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // Retrieve user ID from session (assuming you have one set)\n        $userId = $_SESSION['user_id'];\n\n        // Check if product already exists in cart\n        $query = \"SELECT * FROM cart WHERE user_id = '$userId' AND product_id = '$productId'\";\n        $result2 = $conn->query($query);\n\n        if ($result2->num_rows > 0) {\n            // Update quantity if product is already in cart\n            $row = $result2->fetch_assoc();\n            $newQuantity = $row['quantity'] + $quantity;\n            $updateQuery = \"UPDATE cart SET quantity = '$newQuantity' WHERE id = '\" . $row['id'] . \"'\";\n            $conn->query($updateQuery);\n        } else {\n            // Add new product to cart\n            $insertQuery = \"INSERT INTO cart (user_id, product_id, quantity) VALUES ('$userId', '$productId', '$quantity')\";\n            $conn->query($insertQuery);\n        }\n\n        return true;\n    } else {\n        return false; // Product not found in database\n    }\n}\n\n// Function to view cart contents\nfunction viewCart() {\n    global $conn;\n\n    // Retrieve user ID from session (assuming you have one set)\n    $userId = $_SESSION['user_id'];\n\n    // Retrieve all products in cart for current user\n    $query = \"SELECT * FROM cart WHERE user_id = '$userId'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            // Retrieve product details from database\n            $productQuery = \"SELECT * FROM products WHERE id = '\" . $row['product_id'] . \"'\";\n            $productResult = $conn->query($productQuery);\n            $productRow = $productResult->fetch_assoc();\n\n            echo 'Product: ' . $productRow['name'] . ' | Quantity: ' . $row['quantity'] . ' | Price: $' . number_format($productRow['price'], 2) . '<br>';\n        }\n\n        return true;\n    } else {\n        return false; // Cart is empty\n    }\n}\n\n// Example usage:\nif (isset($_POST['add_to_cart'])) {\n    $productId = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    if (addToCart($productId, $quantity)) {\n        echo 'Product added to cart!';\n    } else {\n        echo 'Failed to add product to cart.';\n    }\n}\n\nif (isset($_POST['view_cart'])) {\n    viewCart();\n}\n```\n\n**Step 3: Create HTML interface**\n\nCreate a new file called `index.php` and add the following code:\n\n```php\n<?php include 'cart.php'; ?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Cart System</title>\n</head>\n<body>\n\n    <!-- Form to add product to cart -->\n    <form action=\"\" method=\"post\">\n        <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['product_id']; ?>\">\n        <label for=\"quantity\">Quantity:</label>\n        <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n        <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n    </form>\n\n    <!-- Button to view cart contents -->\n    <button type=\"submit\" name=\"view_cart\">View Cart Contents</button>\n\n    <?php\n    if (isset($_POST['view_cart'])) {\n        viewCart();\n    }\n    ?>\n</body>\n</html>\n```\n\nThis is a basic example of how you can create a user cart system in PHP. You'll need to adjust the code to fit your specific needs, such as adding error handling and security measures.\n\nRemember to replace `'your_username'`, `'your_password'`, and `'your_database'` with your actual database credentials.", "code_blocks": [null, "```php\n// Configuration settings\n$dbHost = 'localhost';\n$dbUsername = 'your_username';\n$dbPassword = 'your_password';\n$dbName = 'your_database';\n\n// Establish database connection\n$conn = new mysqli($dbHost, $dbUsername, $dbPassword, $dbName);\n\nif ($conn->connect_error) {\n    die(\"Connection failed: \" . $conn->connect_error);\n}\n\n// Function to add product to cart\nfunction addToCart($productId, $quantity) {\n    global $conn;\n\n    // Check if product exists in database\n    $query = \"SELECT * FROM products WHERE id = '$productId'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        // Retrieve user ID from session (assuming you have one set)\n        $userId = $_SESSION['user_id'];\n\n        // Check if product already exists in cart\n        $query = \"SELECT * FROM cart WHERE user_id = '$userId' AND product_id = '$productId'\";\n        $result2 = $conn->query($query);\n\n        if ($result2->num_rows > 0) {\n            // Update quantity if product is already in cart\n            $row = $result2->fetch_assoc();\n            $newQuantity = $row['quantity'] + $quantity;\n            $updateQuery = \"UPDATE cart SET quantity = '$newQuantity' WHERE id = '\" . $row['id'] . \"'\";\n            $conn->query($updateQuery);\n        } else {\n            // Add new product to cart\n            $insertQuery = \"INSERT INTO cart (user_id, product_id, quantity) VALUES ('$userId', '$productId', '$quantity')\";\n            $conn->query($insertQuery);\n        }\n\n        return true;\n    } else {\n        return false; // Product not found in database\n    }\n}\n\n// Function to view cart contents\nfunction viewCart() {\n    global $conn;\n\n    // Retrieve user ID from session (assuming you have one set)\n    $userId = $_SESSION['user_id'];\n\n    // Retrieve all products in cart for current user\n    $query = \"SELECT * FROM cart WHERE user_id = '$userId'\";\n    $result = $conn->query($query);\n\n    if ($result->num_rows > 0) {\n        while ($row = $result->fetch_assoc()) {\n            // Retrieve product details from database\n            $productQuery = \"SELECT * FROM products WHERE id = '\" . $row['product_id'] . \"'\";\n            $productResult = $conn->query($productQuery);\n            $productRow = $productResult->fetch_assoc();\n\n            echo 'Product: ' . $productRow['name'] . ' | Quantity: ' . $row['quantity'] . ' | Price: $' . number_format($productRow['price'], 2) . '<br>';\n        }\n\n        return true;\n    } else {\n        return false; // Cart is empty\n    }\n}\n\n// Example usage:\nif (isset($_POST['add_to_cart'])) {\n    $productId = $_POST['product_id'];\n    $quantity = $_POST['quantity'];\n\n    if (addToCart($productId, $quantity)) {\n        echo 'Product added to cart!';\n    } else {\n        echo 'Failed to add product to cart.';\n    }\n}\n\nif (isset($_POST['view_cart'])) {\n    viewCart();\n}\n```", "```php\n<?php include 'cart.php'; ?>\n\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Cart System</title>\n</head>\n<body>\n\n    <!-- Form to add product to cart -->\n    <form action=\"\" method=\"post\">\n        <input type=\"hidden\" name=\"product_id\" value=\"<?php echo $_GET['product_id']; ?>\">\n        <label for=\"quantity\">Quantity:</label>\n        <input type=\"number\" id=\"quantity\" name=\"quantity\"><br><br>\n        <button type=\"submit\" name=\"add_to_cart\">Add to Cart</button>\n    </form>\n\n    <!-- Button to view cart contents -->\n    <button type=\"submit\" name=\"view_cart\">View Cart Contents</button>\n\n    <?php\n    if (isset($_POST['view_cart'])) {\n        viewCart();\n    }\n    ?>\n</body>\n</html>\n```"]}
